<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GEN UI v2.0 - Living Interface | œÜ¬≤ + 1/œÜ¬≤ = 3</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: #000;
            color: #fff;
            font-family: system-ui, sans-serif;
            overflow: hidden;
        }
        #app {
            display: grid;
            grid-template-columns: 250px 1fr 250px;
            height: 100vh;
        }
        .panel {
            background: #0a0a12;
            padding: 15px;
            border-right: 1px solid #222;
            overflow-y: auto;
        }
        .panel-right { border-right: none; border-left: 1px solid #222; }
        h1 { font-size: 1.1em; color: #ffd700; margin-bottom: 10px; }
        .section {
            background: #111;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 12px;
        }
        .section h3 { font-size: 0.8em; color: #0af; margin-bottom: 8px; }
        .btn {
            display: block;
            width: 100%;
            padding: 8px;
            margin: 4px 0;
            background: #222;
            border: 1px solid #333;
            border-radius: 4px;
            color: #fff;
            cursor: pointer;
            font-size: 0.75em;
        }
        .btn:hover { background: #333; border-color: #ffd700; }
        .btn.active { background: #ffd70033; border-color: #ffd700; }
        .slider { width: 100%; margin: 8px 0; }
        .label { font-size: 0.7em; color: #888; display: flex; justify-content: space-between; }
        canvas { width: 100%; height: 100%; display: block; }
        .stats { font-size: 0.7em; color: #888; }
        .stats span { color: #0f0; }
        .info { position: absolute; top: 10px; left: 260px; background: #000a; padding: 8px 12px; border-radius: 4px; font-size: 0.75em; }
        .canvas-wrap { position: relative; background: #000; }
    </style>
</head>
<body>
<div id="app">
    <div class="panel">
        <h1>üîÆ GEN UI v2.0</h1>
        <p style="font-size:0.65em;color:#666;margin-bottom:15px">Living Interface - Like TV but alive</p>
        
        <div class="section">
            <h3>üåä Wave Mode</h3>
            <button class="btn active" data-mode="3d">3D Spherical</button>
            <button class="btn" data-mode="soliton">Solitons</button>
            <button class="btn" data-mode="standing">Standing Waves</button>
            <button class="btn" data-mode="hologram">Holographic</button>
        </div>
        
        <div class="section">
            <h3>üé≠ Emotion</h3>
            <button class="btn active" data-emo="joy">Joy ‚òÄÔ∏è</button>
            <button class="btn" data-emo="calm">Calm üåä</button>
            <button class="btn" data-emo="energy">Energy ‚ö°</button>
            <button class="btn" data-emo="mystery">Mystery üåô</button>
        </div>
        
        <div class="section">
            <h3>‚öôÔ∏è Parameters</h3>
            <div class="label"><span>Frequency</span><span id="freq-v">œÜ</span></div>
            <input type="range" class="slider" id="freq" min="0.5" max="5" step="0.1" value="1.618">
            <div class="label"><span>Depth</span><span id="depth-v">1.0</span></div>
            <input type="range" class="slider" id="depth" min="0" max="2" step="0.1" value="1">
            <div class="label"><span>Photons</span><span id="count-v">1000</span></div>
            <input type="range" class="slider" id="count" min="100" max="10000" step="100" value="1000">
        </div>
    </div>
    
    <div class="canvas-wrap">
        <canvas id="c"></canvas>
        <div class="info">
            <span id="fps">60</span> FPS | 
            Photons: <span id="ph">0</span> |
            Mode: <span id="mode">3D</span>
        </div>
    </div>
    
    <div class="panel panel-right">
        <div class="section">
            <h3>üîä Audio</h3>
            <button class="btn" id="audio-toggle">Enable Sound</button>
            <div class="label"><span>Volume</span><span id="vol-v">50%</span></div>
            <input type="range" class="slider" id="vol" min="0" max="100" value="50">
        </div>
        
        <div class="section">
            <h3>üìπ Record</h3>
            <button class="btn" id="rec-btn">‚è∫ Start Recording</button>
            <button class="btn" id="play-btn" disabled>‚ñ∂ Play</button>
        </div>
        
        <div class="section">
            <h3>üìä Stats</h3>
            <div class="stats">
                Coherence: <span id="coh">0%</span><br>
                Interference: <span id="int">0</span><br>
                GPU: <span id="gpu">N/A</span>
            </div>
        </div>
        
        <div class="section">
            <h3>œÜ¬≤ + 1/œÜ¬≤ = 3</h3>
            <div style="text-align:center;color:#ffd700;font-size:1.5em">PHOENIX = 999</div>
        </div>
    </div>
</div>

<script>
const PHI = 1.618033988749895;
const TAU = Math.PI * 2;

const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');

function resize() {
    canvas.width = canvas.offsetWidth;
    canvas.height = canvas.offsetHeight;
}
resize();
window.addEventListener('resize', resize);

// State
let photons = [];
let time = 0;
let mode = '3d';
let emotion = { hue: 45, sat: 1, bri: 1.2, speed: 1 };
let params = { freq: PHI, depth: 1, count: 1000 };
let audioEnabled = false;
let audioCtx = null;
let recording = false;
let recorded = [];

// Emotions
const emotions = {
    joy: { hue: 45, sat: 1, bri: 1.2, speed: 1 },
    calm: { hue: 200, sat: 0.5, bri: 0.8, speed: 0.5 },
    energy: { hue: 0, sat: 1, bri: 1.5, speed: 2 },
    mystery: { hue: 280, sat: 0.8, bri: 0.6, speed: 0.7 }
};

// 3D Photon
class Photon3D {
    constructor(x, y, z) {
        this.x = x; this.y = y; this.z = z;
        this.vx = (Math.random() - 0.5) * 2;
        this.vy = (Math.random() - 0.5) * 2;
        this.vz = (Math.random() - 0.5) * 2;
        this.wavelength = params.freq * 50 + Math.random() * 50;
        this.phase = Math.random() * TAU;
        this.amp = 1;
        this.life = 1;
    }
    
    wave3D(px, py, pz, t) {
        const dx = px - this.x, dy = py - this.y, dz = pz - this.z;
        const r = Math.sqrt(dx*dx + dy*dy + dz*dz);
        const k = TAU / this.wavelength;
        const omega = k * PHI * emotion.speed;
        return this.amp * Math.cos(k * r - omega * t + this.phase) * Math.exp(-0.01 * r) * this.life;
    }
    
    evolve(dt) {
        if (mode === 'soliton') {
            this.x += this.vx * dt * 50;
            this.y += this.vy * dt * 50;
        }
        this.phase += dt * PHI * emotion.speed;
        if (this.phase > TAU) this.phase -= TAU;
        this.life *= (1 - dt * 0.02);
    }
}

// Spawn photons
function spawn(count) {
    const cx = canvas.width / 2, cy = canvas.height / 2;
    for (let i = 0; i < count; i++) {
        const angle = Math.random() * TAU;
        const r = Math.random() * Math.min(cx, cy) * 0.8;
        const x = cx + Math.cos(angle) * r;
        const y = cy + Math.sin(angle) * r;
        const z = (Math.random() - 0.5) * params.depth * 200;
        photons.push(new Photon3D(x, y, z));
    }
}

// HSL to RGB
function hsl(h, s, l) {
    let r, g, b;
    if (s === 0) { r = g = b = l; }
    else {
        const hue2rgb = (p, q, t) => {
            if (t < 0) t += 1; if (t > 1) t -= 1;
            if (t < 1/6) return p + (q - p) * 6 * t;
            if (t < 1/2) return q;
            if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
            return p;
        };
        const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
        const p = 2 * l - q;
        r = hue2rgb(p, q, h + 1/3);
        g = hue2rgb(p, q, h);
        b = hue2rgb(p, q, h - 1/3);
    }
    return [r * 255 | 0, g * 255 | 0, b * 255 | 0];
}

// Render
function render() {
    const w = canvas.width, h = canvas.height;
    const img = ctx.createImageData(w, h);
    const d = img.data;
    const step = 4;
    
    for (let y = 0; y < h; y += step) {
        for (let x = 0; x < w; x += step) {
            let sum = 0;
            const z = 0;
            
            for (const p of photons) {
                if (p.life > 0.01) {
                    sum += p.wave3D(x, y, z, time);
                }
            }
            
            // Standing wave mode
            if (mode === 'standing') {
                sum *= Math.sin(x * 0.05) * Math.sin(y * 0.05);
            }
            
            // Hologram mode
            if (mode === 'hologram') {
                const ref = Math.cos(x * 0.1 + time);
                sum = sum * ref;
            }
            
            const i = (sum + 1) / 2;
            const hue = ((emotion.hue + sum * 30) % 360) / 360;
            const bri = Math.min(1, Math.max(0, i * emotion.bri * 0.4));
            const [r, g, b] = hsl(hue, emotion.sat, bri);
            
            for (let dy = 0; dy < step && y + dy < h; dy++) {
                for (let dx = 0; dx < step && x + dx < w; dx++) {
                    const idx = ((y + dy) * w + (x + dx)) * 4;
                    d[idx] = r; d[idx+1] = g; d[idx+2] = b; d[idx+3] = 255;
                }
            }
        }
    }
    
    ctx.putImageData(img, 0, 0);
    
    // Draw photon centers with depth
    for (const p of photons) {
        if (p.life > 0.1) {
            const size = 2 + p.z * 0.01 * params.depth;
            const alpha = p.life * (1 - Math.abs(p.z) / 200);
            ctx.fillStyle = `rgba(255,255,255,${alpha * 0.5})`;
            ctx.beginPath();
            ctx.arc(p.x, p.y, Math.max(1, size), 0, TAU);
            ctx.fill();
        }
    }
}

// Audio
function playTone(freq, amp) {
    if (!audioEnabled || !audioCtx) return;
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.frequency.value = 200 + freq * 400;
    gain.gain.value = amp * 0.1 * (document.getElementById('vol').value / 100);
    osc.start();
    gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.1);
    osc.stop(audioCtx.currentTime + 0.1);
}

// Animation
let frameCount = 0, lastFps = performance.now();

function animate() {
    time += 0.016 * emotion.speed;
    
    for (const p of photons) p.evolve(0.016);
    photons = photons.filter(p => p.life > 0.01);
    
    // Respawn
    if (photons.length < params.count * 0.5) {
        spawn(Math.min(50, params.count - photons.length));
    }
    
    // Limit
    if (photons.length > params.count) {
        photons = photons.slice(-params.count);
    }
    
    render();
    
    // Audio from waves
    if (audioEnabled && Math.random() < 0.1) {
        const avgAmp = photons.reduce((s, p) => s + p.amp * p.life, 0) / photons.length;
        playTone(params.freq, avgAmp);
    }
    
    // Recording
    if (recording) {
        recorded.push({ time, photons: photons.map(p => ({x:p.x, y:p.y, z:p.z, phase:p.phase})) });
    }
    
    // Stats
    frameCount++;
    const now = performance.now();
    if (now - lastFps >= 1000) {
        document.getElementById('fps').textContent = frameCount;
        frameCount = 0;
        lastFps = now;
    }
    document.getElementById('ph').textContent = photons.length;
    document.getElementById('coh').textContent = Math.round((1 - 0.02 * 50) * 100) + '%';
    document.getElementById('int').textContent = photons.length > 1 ? 'Active' : 'None';
    
    requestAnimationFrame(animate);
}

// Events
document.querySelectorAll('[data-mode]').forEach(btn => {
    btn.onclick = () => {
        document.querySelectorAll('[data-mode]').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        mode = btn.dataset.mode;
        document.getElementById('mode').textContent = mode.toUpperCase();
    };
});

document.querySelectorAll('[data-emo]').forEach(btn => {
    btn.onclick = () => {
        document.querySelectorAll('[data-emo]').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        emotion = emotions[btn.dataset.emo];
    };
});

document.getElementById('freq').oninput = e => {
    params.freq = +e.target.value;
    document.getElementById('freq-v').textContent = params.freq.toFixed(2);
};

document.getElementById('depth').oninput = e => {
    params.depth = +e.target.value;
    document.getElementById('depth-v').textContent = params.depth.toFixed(1);
};

document.getElementById('count').oninput = e => {
    params.count = +e.target.value;
    document.getElementById('count-v').textContent = params.count;
};

document.getElementById('vol').oninput = e => {
    document.getElementById('vol-v').textContent = e.target.value + '%';
};

document.getElementById('audio-toggle').onclick = () => {
    audioEnabled = !audioEnabled;
    if (audioEnabled && !audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    }
    document.getElementById('audio-toggle').textContent = audioEnabled ? 'Disable Sound' : 'Enable Sound';
    document.getElementById('audio-toggle').classList.toggle('active', audioEnabled);
};

document.getElementById('rec-btn').onclick = () => {
    recording = !recording;
    document.getElementById('rec-btn').textContent = recording ? '‚èπ Stop' : '‚è∫ Start Recording';
    document.getElementById('rec-btn').classList.toggle('active', recording);
    if (!recording && recorded.length > 0) {
        document.getElementById('play-btn').disabled = false;
    }
    if (recording) recorded = [];
};

canvas.onclick = e => {
    const rect = canvas.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    for (let i = 0; i < 20; i++) {
        const p = new Photon3D(x + (Math.random()-0.5)*50, y + (Math.random()-0.5)*50, (Math.random()-0.5)*100);
        photons.push(p);
    }
};

// Start
spawn(params.count);
animate();

// Check WebGPU
if (navigator.gpu) {
    document.getElementById('gpu').textContent = 'Available';
    document.getElementById('gpu').style.color = '#0f0';
} else {
    document.getElementById('gpu').textContent = 'Fallback CPU';
}
</script>
</body>
</html>
