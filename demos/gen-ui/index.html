<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GEN UI - Generative Interface | œÜ¬≤ + 1/œÜ¬≤ = 3</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background: #0a0a0f;
            color: #e0e0e0;
            font-family: 'JetBrains Mono', monospace;
            min-height: 100vh;
            overflow: hidden;
        }
        
        .app {
            display: grid;
            grid-template-columns: 280px 1fr 280px;
            height: 100vh;
        }
        
        .sidebar {
            background: #0f0f1a;
            padding: 15px;
            border-right: 1px solid #2a2a4e;
            overflow-y: auto;
        }
        
        .sidebar-right {
            border-right: none;
            border-left: 1px solid #2a2a4e;
        }
        
        .canvas-area {
            position: relative;
            background: #000;
        }
        
        canvas {
            width: 100%;
            height: 100%;
        }
        
        h1 {
            font-size: 1em;
            color: #ffd700;
            margin-bottom: 5px;
        }
        
        .subtitle {
            font-size: 0.65em;
            color: #666;
            margin-bottom: 15px;
        }
        
        .section {
            margin-bottom: 15px;
            padding: 12px;
            background: #1a1a2e;
            border-radius: 6px;
            border: 1px solid #2a2a4e;
        }
        
        .section h3 {
            font-size: 0.75em;
            color: #00d4ff;
            margin-bottom: 10px;
        }
        
        .element-btn {
            display: block;
            width: 100%;
            padding: 8px 12px;
            margin-bottom: 6px;
            background: #2a2a4e;
            border: 1px solid #3a3a6e;
            border-radius: 4px;
            color: #e0e0e0;
            cursor: pointer;
            font-size: 0.75em;
            text-align: left;
            transition: all 0.2s;
        }
        
        .element-btn:hover {
            background: #3a3a6e;
            border-color: #ffd700;
        }
        
        .element-btn.active {
            background: #ffd70033;
            border-color: #ffd700;
        }
        
        .theme-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 6px;
        }
        
        .theme-btn {
            padding: 6px;
            background: #2a2a4e;
            border: 1px solid #3a3a6e;
            border-radius: 4px;
            color: #e0e0e0;
            cursor: pointer;
            font-size: 0.7em;
            transition: all 0.2s;
        }
        
        .theme-btn:hover {
            border-color: #ffd700;
        }
        
        .theme-btn.active {
            background: #ffd700;
            color: #000;
        }
        
        .slider-group {
            margin: 8px 0;
        }
        
        .slider-group label {
            display: flex;
            justify-content: space-between;
            font-size: 0.7em;
            color: #888;
            margin-bottom: 4px;
        }
        
        input[type="range"] {
            width: 100%;
            height: 4px;
            background: #2a2a4e;
            border-radius: 2px;
            outline: none;
            -webkit-appearance: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 12px;
            height: 12px;
            background: #ffd700;
            border-radius: 50%;
            cursor: pointer;
        }
        
        .code-preview {
            background: #0a0a0f;
            border: 1px solid #2a2a4e;
            border-radius: 4px;
            padding: 10px;
            font-size: 0.65em;
            color: #0f0;
            max-height: 150px;
            overflow-y: auto;
            white-space: pre-wrap;
            font-family: monospace;
        }
        
        .stats {
            font-size: 0.7em;
            color: #888;
        }
        
        .stats span {
            color: #00d4ff;
        }
        
        .formula {
            text-align: center;
            padding: 8px;
            background: linear-gradient(135deg, #1a1a2e, #2a2a4e);
            border-radius: 6px;
            margin-top: 10px;
        }
        
        .formula .phi {
            font-size: 1.1em;
            color: #ffd700;
        }
        
        .info {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.75em;
        }
        
        .info .fps {
            color: #0f0;
        }
    </style>
</head>
<body>
    <div class="app">
        <div class="sidebar">
            <h1>üé® GEN UI</h1>
            <div class="subtitle">Generative Interface via Waves</div>
            
            <div class="section">
                <h3>üì¶ Elements</h3>
                <button class="element-btn" data-el="button">+ Button (pulsing wave)</button>
                <button class="element-btn" data-el="text">+ Text (standing wave)</button>
                <button class="element-btn" data-el="panel">+ Panel (interference)</button>
                <button class="element-btn" data-el="slider">+ Slider (traveling wave)</button>
                <button class="element-btn" data-el="input">+ Input (resonator)</button>
            </div>
            
            <div class="section">
                <h3>üé≠ Emotion Theme</h3>
                <div class="theme-grid">
                    <button class="theme-btn active" data-theme="joy">Joy</button>
                    <button class="theme-btn" data-theme="calm">Calm</button>
                    <button class="theme-btn" data-theme="energy">Energy</button>
                    <button class="theme-btn" data-theme="mystery">Mystery</button>
                </div>
            </div>
            
            <div class="section">
                <h3>üåä Wave Params</h3>
                <div class="slider-group">
                    <label>Frequency <span id="freq-val">1.618</span></label>
                    <input type="range" id="freq" min="0.5" max="5" step="0.1" value="1.618">
                </div>
                <div class="slider-group">
                    <label>Amplitude <span id="amp-val">1.0</span></label>
                    <input type="range" id="amp" min="0.1" max="2" step="0.1" value="1">
                </div>
                <div class="slider-group">
                    <label>Decay <span id="decay-val">0.01</span></label>
                    <input type="range" id="decay" min="0.005" max="0.05" step="0.001" value="0.01">
                </div>
            </div>
            
            <div class="formula">
                <div class="phi">œÜ¬≤ + 1/œÜ¬≤ = 3</div>
            </div>
        </div>
        
        <div class="canvas-area">
            <canvas id="canvas"></canvas>
            <div class="info">
                <span class="fps" id="fps">60 FPS</span> | 
                Elements: <span id="el-count">0</span> |
                Photons: <span id="ph-count">0</span>
            </div>
        </div>
        
        <div class="sidebar sidebar-right">
            <div class="section">
                <h3>üìã Generated Code</h3>
                <div class="code-preview" id="code">// Click canvas to add elements
// Drag to position
// Use themes to change style

gen_ui {
  theme: joy
  elements: []
}</div>
            </div>
            
            <div class="section">
                <h3>üéØ Selected Element</h3>
                <div id="selected-info" class="stats">
                    No element selected
                </div>
            </div>
            
            <div class="section">
                <h3>‚å®Ô∏è Controls</h3>
                <div class="stats">
                    <strong>Click:</strong> Add element<br>
                    <strong>Drag:</strong> Move element<br>
                    <strong>Delete:</strong> Remove selected<br>
                    <strong>Space:</strong> Clear all
                </div>
            </div>
            
            <div class="section">
                <h3>üìä Stats</h3>
                <div class="stats">
                    Coherence: <span id="coherence">0%</span><br>
                    Interference: <span id="interference">Active</span><br>
                    Wave count: <span id="wave-count">0</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        const PHI = 1.618033988749895;
        const TAU = Math.PI * 2;
        
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        function resize() {
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
        }
        resize();
        window.addEventListener('resize', resize);
        
        // Themes
        const themes = {
            joy: { hue: 45, sat: 1.0, bri: 1.2, speed: 1.0 },
            calm: { hue: 200, sat: 0.5, bri: 0.8, speed: 0.5 },
            energy: { hue: 0, sat: 1.0, bri: 1.5, speed: 2.0 },
            mystery: { hue: 280, sat: 0.8, bri: 0.6, speed: 0.7 }
        };
        
        // Element types
        const elementTypes = {
            button: { freq: PHI, amp: 1.2, decay: 0.02, width: 120, height: 40 },
            text: { freq: 0.5, amp: 0.8, decay: 0.01, width: 100, height: 30 },
            panel: { freq: 0.3, amp: 0.6, decay: 0.005, width: 200, height: 150 },
            slider: { freq: 1.0, amp: 1.0, decay: 0.015, width: 150, height: 20 },
            input: { freq: 0.8, amp: 0.9, decay: 0.012, width: 180, height: 35 }
        };
        
        // State
        let elements = [];
        let photons = [];
        let time = 0;
        let theme = themes.joy;
        let selectedType = 'button';
        let selectedElement = null;
        let dragging = false;
        let dragOffset = { x: 0, y: 0 };
        let params = { freq: PHI, amp: 1.0, decay: 0.01 };
        let frameCount = 0;
        let lastFps = performance.now();
        
        // UI Element class
        class UIElement {
            constructor(type, x, y) {
                this.id = Math.random().toString(36).substr(2, 9);
                this.type = type;
                this.x = x;
                this.y = y;
                const config = elementTypes[type];
                this.width = config.width;
                this.height = config.height;
                this.freq = config.freq * params.freq;
                this.amp = config.amp * params.amp;
                this.decay = config.decay;
                this.phase = Math.random() * TAU;
                this.label = type.charAt(0).toUpperCase() + type.slice(1);
            }
            
            contains(px, py) {
                return px >= this.x && px <= this.x + this.width &&
                       py >= this.y && py <= this.y + this.height;
            }
            
            spawnPhotons() {
                const cx = this.x + this.width / 2;
                const cy = this.y + this.height / 2;
                
                // Spawn photons based on element type
                const count = this.type === 'panel' ? 5 : 3;
                for (let i = 0; i < count; i++) {
                    const angle = (i / count) * TAU;
                    const r = Math.min(this.width, this.height) / 4;
                    photons.push(new Photon(
                        cx + Math.cos(angle) * r,
                        cy + Math.sin(angle) * r,
                        this.freq
                    ));
                }
            }
        }
        
        // Photon class
        class Photon {
            constructor(x, y, freq) {
                this.x = x;
                this.y = y;
                this.wavelength = freq * 80;
                this.phase = Math.random() * TAU;
                this.amplitude = 1.0;
            }
            
            waveAt(x, y, t) {
                const dx = x - this.x;
                const dy = y - this.y;
                const r = Math.sqrt(dx * dx + dy * dy);
                const k = TAU / this.wavelength;
                const omega = k * PHI * theme.speed;
                return this.amplitude * Math.cos(k * r - omega * t + this.phase) * Math.exp(-params.decay * r);
            }
            
            evolve(dt) {
                this.phase += dt * PHI * theme.speed;
                if (this.phase > TAU) this.phase -= TAU;
                this.amplitude *= (1 - dt * 0.01);
            }
        }
        
        // HSL to RGB
        function hsl2rgb(h, s, l) {
            let r, g, b;
            if (s === 0) { r = g = b = l; }
            else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1/6) return p + (q - p) * 6 * t;
                    if (t < 1/2) return q;
                    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                    return p;
                };
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r = hue2rgb(p, q, h + 1/3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1/3);
            }
            return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];
        }
        
        // Render
        function render() {
            const w = canvas.width, h = canvas.height;
            const img = ctx.createImageData(w, h);
            const d = img.data;
            const step = 3;
            
            for (let y = 0; y < h; y += step) {
                for (let x = 0; x < w; x += step) {
                    let sum = 0;
                    for (const p of photons) {
                        if (p.amplitude > 0.01) {
                            sum += p.waveAt(x, y, time);
                        }
                    }
                    
                    const i = (sum + 1) / 2;
                    const hue = (theme.hue + sum * 20) % 360;
                    const bri = Math.min(1, i * theme.bri * 0.3 + 0.05);
                    const [r, g, b] = hsl2rgb(hue / 360, theme.sat, bri);
                    
                    for (let dy = 0; dy < step && y + dy < h; dy++) {
                        for (let dx = 0; dx < step && x + dx < w; dx++) {
                            const idx = ((y + dy) * w + (x + dx)) * 4;
                            d[idx] = r; d[idx+1] = g; d[idx+2] = b; d[idx+3] = 255;
                        }
                    }
                }
            }
            
            ctx.putImageData(img, 0, 0);
            
            // Draw elements
            for (const el of elements) {
                const isSelected = el === selectedElement;
                
                // Element background
                ctx.fillStyle = isSelected ? 'rgba(255, 215, 0, 0.2)' : 'rgba(255, 255, 255, 0.1)';
                ctx.strokeStyle = isSelected ? '#ffd700' : 'rgba(255, 255, 255, 0.3)';
                ctx.lineWidth = isSelected ? 2 : 1;
                
                if (el.type === 'button') {
                    roundRect(ctx, el.x, el.y, el.width, el.height, 6);
                } else if (el.type === 'slider') {
                    ctx.fillRect(el.x, el.y + el.height/2 - 3, el.width, 6);
                    ctx.beginPath();
                    ctx.arc(el.x + el.width * 0.5, el.y + el.height/2, 8, 0, TAU);
                    ctx.fill();
                    ctx.stroke();
                } else if (el.type === 'input') {
                    roundRect(ctx, el.x, el.y, el.width, el.height, 4);
                } else {
                    ctx.fillRect(el.x, el.y, el.width, el.height);
                    ctx.strokeRect(el.x, el.y, el.width, el.height);
                }
                
                // Label
                ctx.fillStyle = '#fff';
                ctx.font = '12px JetBrains Mono';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(el.label, el.x + el.width/2, el.y + el.height/2);
            }
            
            // Draw photon centers
            ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
            for (const p of photons) {
                if (p.amplitude > 0.1) {
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, 2, 0, TAU);
                    ctx.fill();
                }
            }
        }
        
        function roundRect(ctx, x, y, w, h, r) {
            ctx.beginPath();
            ctx.moveTo(x + r, y);
            ctx.lineTo(x + w - r, y);
            ctx.quadraticCurveTo(x + w, y, x + w, y + r);
            ctx.lineTo(x + w, y + h - r);
            ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
            ctx.lineTo(x + r, y + h);
            ctx.quadraticCurveTo(x, y + h, x, y + h - r);
            ctx.lineTo(x, y + r);
            ctx.quadraticCurveTo(x, y, x + r, y);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
        }
        
        // Update code preview
        function updateCode() {
            const code = `gen_ui {
  theme: ${Object.keys(themes).find(k => themes[k] === theme)}
  freq: ${params.freq.toFixed(3)}
  decay: ${params.decay.toFixed(3)}
  
  elements: [
${elements.map(el => `    ${el.type}("${el.label}", ${Math.round(el.x)}, ${Math.round(el.y)})`).join(',\n')}
  ]
}`;
            document.getElementById('code').textContent = code;
        }
        
        // Update stats
        function updateStats() {
            document.getElementById('el-count').textContent = elements.length;
            document.getElementById('ph-count').textContent = photons.filter(p => p.amplitude > 0.01).length;
            document.getElementById('wave-count').textContent = photons.length;
            document.getElementById('coherence').textContent = Math.round((1 - params.decay * 50) * 100) + '%';
            
            if (selectedElement) {
                document.getElementById('selected-info').innerHTML = `
                    Type: <span>${selectedElement.type}</span><br>
                    Position: <span>${Math.round(selectedElement.x)}, ${Math.round(selectedElement.y)}</span><br>
                    Size: <span>${selectedElement.width}√ó${selectedElement.height}</span><br>
                    Freq: <span>${selectedElement.freq.toFixed(2)}</span>
                `;
            } else {
                document.getElementById('selected-info').textContent = 'No element selected';
            }
        }
        
        // Animation loop
        function animate() {
            time += 0.016 * theme.speed;
            
            for (const p of photons) p.evolve(0.016);
            photons = photons.filter(p => p.amplitude > 0.01);
            
            // Respawn photons for elements
            for (const el of elements) {
                if (Math.random() < 0.02) {
                    el.spawnPhotons();
                }
            }
            
            if (photons.length > 500) photons = photons.slice(-500);
            
            render();
            updateStats();
            
            frameCount++;
            const now = performance.now();
            if (now - lastFps >= 1000) {
                document.getElementById('fps').textContent = frameCount + ' FPS';
                frameCount = 0;
                lastFps = now;
            }
            
            requestAnimationFrame(animate);
        }
        
        // Event handlers
        canvas.addEventListener('mousedown', e => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            // Check if clicking on element
            selectedElement = null;
            for (let i = elements.length - 1; i >= 0; i--) {
                if (elements[i].contains(x, y)) {
                    selectedElement = elements[i];
                    dragging = true;
                    dragOffset = { x: x - elements[i].x, y: y - elements[i].y };
                    break;
                }
            }
            
            // If not clicking on element, create new one
            if (!selectedElement) {
                const el = new UIElement(selectedType, x - elementTypes[selectedType].width/2, y - elementTypes[selectedType].height/2);
                elements.push(el);
                el.spawnPhotons();
                selectedElement = el;
                updateCode();
            }
        });
        
        canvas.addEventListener('mousemove', e => {
            if (dragging && selectedElement) {
                const rect = canvas.getBoundingClientRect();
                selectedElement.x = e.clientX - rect.left - dragOffset.x;
                selectedElement.y = e.clientY - rect.top - dragOffset.y;
                updateCode();
            }
        });
        
        canvas.addEventListener('mouseup', () => dragging = false);
        canvas.addEventListener('mouseleave', () => dragging = false);
        
        document.addEventListener('keydown', e => {
            if (e.code === 'Space') {
                elements = [];
                photons = [];
                selectedElement = null;
                updateCode();
                e.preventDefault();
            } else if (e.code === 'Delete' || e.code === 'Backspace') {
                if (selectedElement) {
                    elements = elements.filter(el => el !== selectedElement);
                    selectedElement = null;
                    updateCode();
                    e.preventDefault();
                }
            }
        });
        
        // Element buttons
        document.querySelectorAll('.element-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.element-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                selectedType = btn.dataset.el;
            });
        });
        
        // Theme buttons
        document.querySelectorAll('.theme-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                theme = themes[btn.dataset.theme];
                updateCode();
            });
        });
        
        // Sliders
        document.getElementById('freq').addEventListener('input', e => {
            params.freq = parseFloat(e.target.value);
            document.getElementById('freq-val').textContent = params.freq.toFixed(3);
        });
        
        document.getElementById('amp').addEventListener('input', e => {
            params.amp = parseFloat(e.target.value);
            document.getElementById('amp-val').textContent = params.amp.toFixed(1);
        });
        
        document.getElementById('decay').addEventListener('input', e => {
            params.decay = parseFloat(e.target.value);
            document.getElementById('decay-val').textContent = params.decay.toFixed(3);
        });
        
        // Start
        animate();
        updateCode();
    </script>
</body>
</html>
