name: ui_system
version: "1.0.0"
language: zig
module: ui_system
description: Canvas-based UI system with 105+ components and 60 FPS rendering

behaviors:
  - name: render_canvas_component
    given: Component definition and canvas context
    when: Render function called
    then: Component drawn on canvas at 60 FPS
    test_cases:
      - name: render_button
        input: {type: "button", x: 100, y: 100, width: 200, height: 50, text: "Click Me"}
        expected: {rendered: true, fps: 60}
      - name: render_card
        input: {type: "card", x: 50, y: 50, width: 300, height: 200, title: "Card Title"}
        expected: {rendered: true, has_shadow: true}

  - name: handle_ui_interaction
    given: User interaction event (click, hover, scroll)
    when: Event handler processes the event
    then: UI state updated and component re-rendered
    test_cases:
      - name: handle_button_click
        input: {event: "click", component_id: "btn-1", x: 150, y: 125}
        expected: {state_changed: true, callback_fired: true}
      - name: handle_hover
        input: {event: "hover", component_id: "card-1"}
        expected: {hover_state: true, style_updated: true}

  - name: manage_component_state
    given: Component with internal state
    when: State management functions called
    then: State updated and component re-rendered
    test_cases:
      - name: update_input_value
        input: {component_id: "input-1", value: "Hello World"}
        expected: {value: "Hello World", dirty: true}
      - name: toggle_checkbox
        input: {component_id: "checkbox-1", checked: true}
        expected: {checked: true, changed: true}

  - name: animate_component
    given: Component with animation properties
    when: Animation loop runs
    then: Component animated smoothly at 60 FPS
    test_cases:
      - name: fade_in_animation
        input: {component_id: "modal-1", animation: "fadeIn", duration: 300}
        expected: {animated: true, fps: 60, completed: true}
      - name: slide_animation
        input: {component_id: "drawer-1", animation: "slideIn", direction: "left"}
        expected: {animated: true, final_position: 0}

types:
  Component:
    id: str
    type: str
    x: int
    y: int
    width: int
    height: int
    visible: bool
    enabled: bool
    style: ComponentStyle
    state: ComponentState
    children: list<Component>

  ComponentStyle:
    background_color: str
    border_color: str
    border_width: int
    border_radius: int
    shadow: bool
    opacity: float
    font_family: str
    font_size: int
    color: str

  ComponentState:
    hovered: bool
    focused: bool
    pressed: bool
    disabled: bool
    value: optional<str>
    checked: optional<bool>
    selected: optional<bool>

  UIEvent:
    type: str
    component_id: str
    x: optional<int>
    y: optional<int>
    key: optional<str>
    timestamp: int

  Animation:
    component_id: str
    type: str
    duration: int
    easing: str
    start_value: float
    end_value: float
    current_frame: int
    total_frames: int

  Canvas:
    width: int
    height: int
    dpi: float
    context: str

  RenderContext:
    canvas: Canvas
    components: list<Component>
    animations: list<Animation>
    fps: int
    frame_time: float

functions:
  # Rendering
  - name: render_component
    params: {component: Component, context: RenderContext}
    returns: bool
    description: Render component on canvas

  - name: render_button
    params: {component: Component, context: RenderContext}
    returns: bool
    description: Render button component

  - name: render_card
    params: {component: Component, context: RenderContext}
    returns: bool
    description: Render card component

  - name: render_input
    params: {component: Component, context: RenderContext}
    returns: bool
    description: Render input component

  - name: render_modal
    params: {component: Component, context: RenderContext}
    returns: bool
    description: Render modal component

  # Event handling
  - name: handle_event
    params: {event: UIEvent, components: list<Component>}
    returns: optional<Component>
    description: Handle UI event and return affected component

  - name: handle_click
    params: {x: int, y: int, components: list<Component>}
    returns: optional<Component>
    description: Handle click event

  - name: handle_hover
    params: {x: int, y: int, components: list<Component>}
    returns: optional<Component>
    description: Handle hover event

  - name: handle_key
    params: {key: str, components: list<Component>}
    returns: optional<Component>
    description: Handle keyboard event

  # State management
  - name: update_component_state
    params: {component_id: str, state: ComponentState}
    returns: bool
    description: Update component state

  - name: get_component_by_id
    params: {component_id: str, components: list<Component>}
    returns: optional<Component>
    description: Find component by ID

  - name: update_component_style
    params: {component_id: str, style: ComponentStyle}
    returns: bool
    description: Update component style

  # Animation
  - name: start_animation
    params: {animation: Animation}
    returns: bool
    description: Start component animation

  - name: update_animation
    params: {animation: Animation, delta_time: float}
    returns: Animation
    description: Update animation frame

  - name: is_animation_complete
    params: {animation: Animation}
    returns: bool
    description: Check if animation is complete

  # Layout
  - name: calculate_layout
    params: {components: list<Component>, canvas: Canvas}
    returns: list<Component>
    description: Calculate component positions

  - name: hit_test
    params: {x: int, y: int, component: Component}
    returns: bool
    description: Check if point is inside component

imports:
  - std.json
  - std.mem
  - std.ArrayList
  - std.math
  - std.time

optimization:
  target: zig
  level: ReleaseFast
  features:
    - inline_small_functions
    - unroll_loops
    - vectorize

performance:
  expected_fps: 60
  max_components: 1000
  max_memory_mb: 500
  target_frame_time_ms: 16.67
