name: claude_integration
version: 1.0.0
description: Integration with Claude AI for spec-first development
type: ai_integration
category: ai

behaviors:
  - name: generate_spec_from_prompt
    description: Generate spec.yml from natural language prompt
    given: User provides natural language description
    when: Claude analyzes and creates spec.yml
    then: Complete spec.yml generated with behaviors and test cases
    test_cases:
      - name: simple_feature
        input:
          prompt: "Create a user login feature with username and password"
        expected:
          spec_generated: true
          behaviors_count: 1
          test_cases_count: 3
      
      - name: complex_feature
        input:
          prompt: "Create a blog system with posts, comments, and likes"
        expected:
          spec_generated: true
          behaviors_count: 5
          test_cases_count: 15

  - name: improve_existing_spec
    description: Improve existing spec.yml with AI suggestions
    given: Existing spec.yml file
    when: Claude analyzes and suggests improvements
    then: Enhanced spec.yml with better test coverage
    test_cases:
      - name: add_missing_tests
        input:
          spec: "spec.yml with 1 behavior, 2 test cases"
        expected:
          test_cases_added: 3
          coverage_improved: true
      
      - name: add_edge_cases
        input:
          spec: "spec.yml with basic tests"
        expected:
          edge_cases_added: 5
          error_handling_added: true

  - name: validate_spec_quality
    description: Validate spec.yml quality and completeness
    given: spec.yml file
    when: Claude checks for completeness and best practices
    then: Quality report with suggestions
    test_cases:
      - name: complete_spec
        input:
          spec: "spec.yml with all required fields"
        expected:
          quality_score: 100
          issues: 0
      
      - name: incomplete_spec
        input:
          spec: "spec.yml missing test cases"
        expected:
          quality_score: 60
          issues: 3
          suggestions: ["Add test cases", "Add edge cases", "Add error handling"]

  - name: generate_code_from_conversation
    description: Generate spec.yml from conversation with Claude
    given: User has conversation with Claude about feature
    when: Claude extracts requirements and creates spec
    then: spec.yml generated from conversation context
    test_cases:
      - name: multi_turn_conversation
        input:
          messages: [
            "I need a user system",
            "With login and registration",
            "And password reset"
          ]
        expected:
          spec_generated: true
          behaviors_count: 3
          requirements_extracted: true

functions:
  - name: generate_spec
    signature: "generate_spec(prompt: String) → Result(Spec, String)"
    description: Generate spec.yml from natural language
    
  - name: improve_spec
    signature: "improve_spec(spec: Spec) → Result(Spec, String)"
    description: Improve existing spec with AI suggestions
    
  - name: validate_spec
    signature: "validate_spec(spec: Spec) → Result(QualityReport, String)"
    description: Validate spec quality
    
  - name: extract_requirements
    signature: "extract_requirements(conversation: List(Message)) → Result(Requirements, String)"
    description: Extract requirements from conversation

types:
  QualityReport:
    score: int
    issues: list<str>
    suggestions: list<str>
    completeness: int
  
  Requirements:
    behaviors: list<str>
    test_cases: list<str>
    types: list<str>
    functions: list<str>

completeness:
  test_coverage: 100%
  all_behaviors_implemented: true
