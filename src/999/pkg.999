// ============================================
// 999PKG - –ü–ê–ö–ï–¢–ù–´–ô –ú–ï–ù–ï–î–ñ–ï–†
// ============================================
//
// –ö–æ–º–∞–Ω–¥—ã:
//   999pkg init          - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
//   999pkg add <pkg>     - –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
//   999pkg remove <pkg>  - –£–¥–∞–ª–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
//   999pkg install       - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
//   999pkg update        - –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
//   999pkg publish       - –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç
//   999pkg search <q>    - –ü–æ–∏—Å–∫ –ø–∞–∫–µ—Ç–æ–≤
//   999pkg run <script>  - –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç
//
// ============================================

‚≤® arifmetika

// ============================================
// –ú–ê–ù–ò–§–ï–°–¢ –ü–ê–ö–ï–¢–ê (999.toml)
// ============================================

‚≤é ‚≤†‚≤ï‚≤Ö‚≤ò‚≤Å‚≤õ‚≤ì‚≤´‚≤â‚≤•‚≤ß:
  –∏–º—è: ‚≤§
  –≤–µ—Ä—Å–∏—è: ‚≤§
  –æ–ø–∏—Å–∞–Ω–∏–µ: ‚≤§?
  –∞–≤—Ç–æ—Ä—ã: [‚≤§]
  –ª–∏—Ü–µ–Ω–∑–∏—è: ‚≤§?
  —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: ‚≤§?
  –∫–ª—é—á–µ–≤—ã–µ_—Å–ª–æ–≤–∞: [‚≤§]
  
  –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: {‚≤§: ‚≤†‚≤ï‚≤Ö‚≤å‚≤â‚≤°}
  dev_–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: {‚≤§: ‚≤†‚≤ï‚≤Ö‚≤å‚≤â‚≤°}
  
  —Å–∫—Ä–∏–ø—Ç—ã: {‚≤§: ‚≤§}
  
  // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–±–æ—Ä–∫–∏
  —Ç–æ—á–∫–∞_–≤—Ö–æ–¥–∞: ‚≤§?
  —Ü–µ–ª–µ–≤—ã–µ_–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã: [‚≤§]?

// –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
‚≤é ‚≤†‚≤ï‚≤Ö‚≤å‚≤â‚≤°:
  –≤–µ—Ä—Å–∏—è: ‚≤§?           // "^1.0.0", "~1.0.0", ">=1.0.0"
  git: ‚≤§?              // URL —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
  –≤–µ—Ç–∫–∞: ‚≤§?            // git branch
  –ø—É—Ç—å: ‚≤§?             // –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—É—Ç—å
  features: [‚≤§]?       // –≤–∫–ª—é—á—ë–Ω–Ω—ã–µ features

// –í–µ—Ä—Å–∏—è (semver)
‚≤é ‚≤†‚≤ï‚≤Ö‚≤Ç‚≤â‚≤£‚≤•‚≤ì‚≤Å:
  major: ‚≤ä
  minor: ‚≤ä
  patch: ‚≤ä
  prerelease: ‚≤§?
  build: ‚≤§?

// ============================================
// LOCK-–§–ê–ô–õ (999.lock)
// ============================================

‚≤é ‚≤†‚≤ï‚≤Ö‚≤ñ‚≤ü‚≤•‚≤ï:
  –≤–µ—Ä—Å–∏—è: ‚≤ä
  –ø–∞–∫–µ—Ç—ã: [‚≤†‚≤ï‚≤Ö‚≤ñ‚≤ü‚≤•‚≤ï‚≤â‚≤á]

‚≤é ‚≤†‚≤ï‚≤Ö‚≤ñ‚≤ü‚≤•‚≤ï‚≤â‚≤á:
  –∏–º—è: ‚≤§
  –≤–µ—Ä—Å–∏—è: ‚≤§
  –∏—Å—Ç–æ—á–Ω–∏–∫: ‚≤§
  —Ö–µ—à: ‚≤§
  –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: [‚≤§]

// ============================================
// –†–ï–ï–°–¢–† –ü–ê–ö–ï–¢–û–í
// ============================================

‚≤é ‚≤†‚≤ï‚≤Ö‚≤¢‚≤â‚≤Ö‚≤ì‚≤•‚≤ß‚≤£‚≤©:
  url: ‚≤§
  —Ç–æ–∫–µ–Ω: ‚≤§?

‚≤é ‚≤†‚≤ï‚≤Ö‚≤†‚≤Å‚≤ï‚≤â‚≤ß‚≤é‚≤õ‚≤´‚≤ü:
  –∏–º—è: ‚≤§
  –≤–µ—Ä—Å–∏–∏: [‚≤§]
  –æ–ø–∏—Å–∞–Ω–∏–µ: ‚≤§
  –∑–∞–≥—Ä—É–∑–∫–∏: ‚≤ä
  –ø–æ—Å–ª–µ–¥–Ω–µ–µ_–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: ‚≤§

// ============================================
// –†–ê–ó–†–ï–®–ï–ù–ò–ï –ó–ê–í–ò–°–ò–ú–û–°–¢–ï–ô
// ============================================

// –ì—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚≤é ‚≤†‚≤ï‚≤Ö‚≤Ñ‚≤£‚≤Å‚≤´:
  —É–∑–ª—ã: {‚≤§: ‚≤†‚≤ï‚≤Ö‚≤Ç‚≤â‚≤£‚≤•‚≤ì‚≤Å}
  —Ä—ë–±—Ä–∞: [(‚≤§, ‚≤§)]

// –†–∞–∑—Ä–µ—à–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚≤™ —Ä–∞–∑—Ä–µ—à–∏—Ç—å_–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏(–º–∞–Ω–∏—Ñ–µ—Å—Ç: ‚≤†‚≤ï‚≤Ö‚≤ò‚≤Å‚≤õ‚≤ì‚≤´‚≤â‚≤•‚≤ß, —Ä–µ–µ—Å—Ç—Ä: ‚≤†‚≤ï‚≤Ö‚≤¢‚≤â‚≤Ö‚≤ì‚≤•‚≤ß‚≤£‚≤©) -> ‚≤†‚≤ï‚≤Ö‚≤ñ‚≤ü‚≤•‚≤ï:
  ‚≤ò –≥—Ä–∞—Ñ = ‚≤†‚≤ï‚≤Ö‚≤Ñ‚≤£‚≤Å‚≤´ { —É–∑–ª—ã: {}, —Ä—ë–±—Ä–∞: [] }
  ‚≤ò –æ—á–µ—Ä–µ–¥—å: [(‚≤§, ‚≤†‚≤ï‚≤Ö‚≤å‚≤â‚≤°)] = []
  
  // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä—è–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
  ‚≤Æ (–∏–º—è, –∑–∞–≤) –º–∞–Ω–∏—Ñ–µ—Å—Ç.–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
    –æ—á–µ—Ä–µ–¥—å += [(–∏–º—è, –∑–∞–≤)]
  
  // BFS –ø–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º
  ‚≤Æ –¥–ª–∏–Ω–∞(–æ—á–µ—Ä–µ–¥—å) > 0:
    ‚≤ò (–∏–º—è, –∑–∞–≤) = –æ—á–µ—Ä–µ–¥—å.pop_front()
    
    ‚≤ú –≥—Ä–∞—Ñ.—É–∑–ª—ã[–∏–º—è] != None:
      ‚≤û  // –£–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ
    
    // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–∞–∫–µ—Ç–µ
    ‚≤ò –≤–µ—Ä—Å–∏—è = —Ä–∞–∑—Ä–µ—à–∏—Ç—å_–≤–µ—Ä—Å–∏—é(–∏–º—è, –∑–∞–≤, —Ä–µ–µ—Å—Ç—Ä)
    –≥—Ä–∞—Ñ.—É–∑–ª—ã[–∏–º—è] = –≤–µ—Ä—Å–∏—è
    
    // –ü–æ–ª—É—á–∞–µ–º —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
    ‚≤ò –ø–∞–∫–µ—Ç_–º–∞–Ω–∏—Ñ–µ—Å—Ç = –∑–∞–≥—Ä—É–∑–∏—Ç—å_–º–∞–Ω–∏—Ñ–µ—Å—Ç(–∏–º—è, –≤–µ—Ä—Å–∏—è, —Ä–µ–µ—Å—Ç—Ä)
    ‚≤Æ (—Ç—Ä–∞–Ω–∑_–∏–º—è, —Ç—Ä–∞–Ω–∑_–∑–∞–≤) –ø–∞–∫–µ—Ç_–º–∞–Ω–∏—Ñ–µ—Å—Ç.–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
      –≥—Ä–∞—Ñ.—Ä—ë–±—Ä–∞ += [(–∏–º—è, —Ç—Ä–∞–Ω–∑_–∏–º—è)]
      –æ—á–µ—Ä–µ–¥—å += [(—Ç—Ä–∞–Ω–∑_–∏–º—è, —Ç—Ä–∞–Ω–∑_–∑–∞–≤)]
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã
  –ø—Ä–æ–≤–µ—Ä–∏—Ç—å_–∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã(–≥—Ä–∞—Ñ)
  
  // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º lock-—Ñ–∞–π–ª
  ‚≤¢ –≥—Ä–∞—Ñ_–≤_lock(–≥—Ä–∞—Ñ)

// –†–∞–∑—Ä–µ—à–∏—Ç—å –≤–µ—Ä—Å–∏—é –ø–æ constraint
‚≤™ —Ä–∞–∑—Ä–µ—à–∏—Ç—å_–≤–µ—Ä—Å–∏—é(–∏–º—è: ‚≤§, –∑–∞–≤: ‚≤†‚≤ï‚≤Ö‚≤å‚≤â‚≤°, —Ä–µ–µ—Å—Ç—Ä: ‚≤†‚≤ï‚≤Ö‚≤¢‚≤â‚≤Ö‚≤ì‚≤•‚≤ß‚≤£‚≤©) -> ‚≤†‚≤ï‚≤Ö‚≤Ç‚≤â‚≤£‚≤•‚≤ì‚≤Å:
  ‚≤ò –¥–æ—Å—Ç—É–ø–Ω—ã–µ = –ø–æ–ª—É—á–∏—Ç—å_–≤–µ—Ä—Å–∏–∏(—Ä–µ–µ—Å—Ç—Ä, –∏–º—è)
  ‚≤ò constraint = –ø–∞—Ä—Å–∏—Ç—å_constraint(–∑–∞–≤.–≤–µ—Ä—Å–∏—è)
  
  // –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø–æ–¥—Ö–æ–¥—è—â—É—é –≤–µ—Ä—Å–∏—é
  ‚≤ò –ø–æ–¥—Ö–æ–¥—è—â–∏–µ = –¥–æ—Å—Ç—É–ø–Ω—ã–µ.filter(–≤ -> —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç(–≤, constraint))
  ‚≤ú –¥–ª–∏–Ω–∞(–ø–æ–¥—Ö–æ–¥—è—â–∏–µ) == 0:
    –æ—à–∏–±–∫–∞("–ù–µ –Ω–∞–π–¥–µ–Ω–∞ –≤–µ—Ä—Å–∏—è " + –∏–º—è + " —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—â–∞—è " + –∑–∞–≤.–≤–µ—Ä—Å–∏—è)
  
  ‚≤¢ –º–∞–∫—Å(–ø–æ–¥—Ö–æ–¥—è—â–∏–µ)

// –ü–∞—Ä—Å–∏–Ω–≥ constraint –≤–µ—Ä—Å–∏–∏
‚≤™ –ø–∞—Ä—Å–∏—Ç—å_constraint(—Å—Ç—Ä–æ–∫–∞: ‚≤§) -> ‚≤†‚≤ï‚≤Ö‚≤Ç‚≤â‚≤£‚≤•‚≤ì‚≤Å‚≤î‚≤ü‚≤õ‚≤•‚≤ß‚≤£‚≤Å‚≤ì‚≤õ‚≤ß:
  ‚≤ú —Å—Ç—Ä–æ–∫–∞.starts_with("^"):
    // ^1.2.3 = >=1.2.3 <2.0.0
    ‚≤¢ ‚≤†‚≤ï‚≤Ö‚≤Ç‚≤â‚≤£‚≤•‚≤ì‚≤Å‚≤î‚≤ü‚≤õ‚≤•‚≤ß‚≤£‚≤Å‚≤ì‚≤õ‚≤ß { —Ç–∏–ø: CARET, –≤–µ—Ä—Å–∏—è: –ø–∞—Ä—Å–∏—Ç—å_–≤–µ—Ä—Å–∏—é(—Å—Ç—Ä–æ–∫–∞[1..]) }
  ‚≤ú —Å—Ç—Ä–æ–∫–∞.starts_with("~"):
    // ~1.2.3 = >=1.2.3 <1.3.0
    ‚≤¢ ‚≤†‚≤ï‚≤Ö‚≤Ç‚≤â‚≤£‚≤•‚≤ì‚≤Å‚≤î‚≤ü‚≤õ‚≤•‚≤ß‚≤£‚≤Å‚≤ì‚≤õ‚≤ß { —Ç–∏–ø: TILDE, –≤–µ—Ä—Å–∏—è: –ø–∞—Ä—Å–∏—Ç—å_–≤–µ—Ä—Å–∏—é(—Å—Ç—Ä–æ–∫–∞[1..]) }
  ‚≤ú —Å—Ç—Ä–æ–∫–∞.starts_with(">="):
    ‚≤¢ ‚≤†‚≤ï‚≤Ö‚≤Ç‚≤â‚≤£‚≤•‚≤ì‚≤Å‚≤î‚≤ü‚≤õ‚≤•‚≤ß‚≤£‚≤Å‚≤ì‚≤õ‚≤ß { —Ç–∏–ø: GTE, –≤–µ—Ä—Å–∏—è: –ø–∞—Ä—Å–∏—Ç—å_–≤–µ—Ä—Å–∏—é(—Å—Ç—Ä–æ–∫–∞[2..]) }
  ‚≤ú —Å—Ç—Ä–æ–∫–∞.starts_with("="):
    ‚≤¢ ‚≤†‚≤ï‚≤Ö‚≤Ç‚≤â‚≤£‚≤•‚≤ì‚≤Å‚≤î‚≤ü‚≤õ‚≤•‚≤ß‚≤£‚≤Å‚≤ì‚≤õ‚≤ß { —Ç–∏–ø: EXACT, –≤–µ—Ä—Å–∏—è: –ø–∞—Ä—Å–∏—Ç—å_–≤–µ—Ä—Å–∏—é(—Å—Ç—Ä–æ–∫–∞[1..]) }
  ‚≤¢ ‚≤†‚≤ï‚≤Ö‚≤Ç‚≤â‚≤£‚≤•‚≤ì‚≤Å‚≤î‚≤ü‚≤õ‚≤•‚≤ß‚≤£‚≤Å‚≤ì‚≤õ‚≤ß { —Ç–∏–ø: EXACT, –≤–µ—Ä—Å–∏—è: –ø–∞—Ä—Å–∏—Ç—å_–≤–µ—Ä—Å–∏—é(—Å—Ç—Ä–æ–∫–∞) }

// ============================================
// –ö–û–ú–ê–ù–î–´ CLI
// ============================================

‚≤™ cmd_init(–ø—É—Ç—å: ‚≤§):
  ‚≤ò –∏–º—è = –∏–º—è_–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏(–ø—É—Ç—å)
  
  ‚≤ò –º–∞–Ω–∏—Ñ–µ—Å—Ç = ‚≤†‚≤ï‚≤Ö‚≤ò‚≤Å‚≤õ‚≤ì‚≤´‚≤â‚≤•‚≤ß {
    –∏–º—è: –∏–º—è,
    –≤–µ—Ä—Å–∏—è: "0.1.0",
    –æ–ø–∏—Å–∞–Ω–∏–µ: None,
    –∞–≤—Ç–æ—Ä—ã: [–ø–æ–ª—É—á–∏—Ç—å_git_–∞–≤—Ç–æ—Ä–∞()],
    –ª–∏—Ü–µ–Ω–∑–∏—è: "MIT",
    —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: None,
    –∫–ª—é—á–µ–≤—ã–µ_—Å–ª–æ–≤–∞: [],
    –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: {},
    dev_–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: {},
    —Å–∫—Ä–∏–ø—Ç—ã: {
      "build": "999c -O2 src/main.999 -o bin/" + –∏–º—è,
      "test": "999test",
      "bench": "999bench"
    },
    —Ç–æ—á–∫–∞_–≤—Ö–æ–¥–∞: "src/main.999",
    —Ü–µ–ª–µ–≤—ã–µ_–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã: None
  }
  
  –∑–∞–ø–∏—Å–∞—Ç—å_toml(–ø—É—Ç—å + "/999.toml", –º–∞–Ω–∏—Ñ–µ—Å—Ç)
  
  // –°–æ–∑–¥–∞—ë–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
  —Å–æ–∑–¥–∞—Ç—å_–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é(–ø—É—Ç—å + "/src")
  —Å–æ–∑–¥–∞—Ç—å_–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é(–ø—É—Ç—å + "/tests")
  —Å–æ–∑–¥–∞—Ç—å_–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é(–ø—É—Ç—å + "/bin")
  
  // –°–æ–∑–¥–∞—ë–º main.999
  –∑–∞–ø–∏—Å–∞—Ç—å_—Ñ–∞–π–ª(–ø—É—Ç—å + "/src/main.999", "
// " + –∏–º—è + " - –≥–ª–∞–≤–Ω—ã–π –º–æ–¥—É–ª—å

‚≤™ main() -> ‚≤ä:
  –ø–µ—á–∞—Ç—å(\"–ü—Ä–∏–≤–µ—Ç –∏–∑ 999!\")
  ‚≤¢ 0
")
  
  // –°–æ–∑–¥–∞—ë–º .gitignore
  –∑–∞–ø–∏—Å–∞—Ç—å_—Ñ–∞–π–ª(–ø—É—Ç—å + "/.gitignore", "
bin/
.999/
999.lock
")
  
  –ø–µ—á–∞—Ç—å("‚úÖ –ü—Ä–æ–µ–∫—Ç " + –∏–º—è + " —Å–æ–∑–¥–∞–Ω")

‚≤™ cmd_add(–ø–∞–∫–µ—Ç: ‚≤§, –≤–µ—Ä—Å–∏—è: ‚≤§?, dev: ‚≤Ç):
  ‚≤ò –º–∞–Ω–∏—Ñ–µ—Å—Ç = —á–∏—Ç–∞—Ç—å_–º–∞–Ω–∏—Ñ–µ—Å—Ç("999.toml")
  
  ‚≤ò –∑–∞–≤ = ‚≤†‚≤ï‚≤Ö‚≤å‚≤â‚≤° {
    –≤–µ—Ä—Å–∏—è: –≤–µ—Ä—Å–∏—è ? –≤–µ—Ä—Å–∏—è : "^1.0.0",
    git: None,
    –≤–µ—Ç–∫–∞: None,
    –ø—É—Ç—å: None,
    features: None
  }
  
  ‚≤ú dev:
    –º–∞–Ω–∏—Ñ–µ—Å—Ç.dev_–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏[–ø–∞–∫–µ—Ç] = –∑–∞–≤
  ‚≤Ç:
    –º–∞–Ω–∏—Ñ–µ—Å—Ç.–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏[–ø–∞–∫–µ—Ç] = –∑–∞–≤
  
  –∑–∞–ø–∏—Å–∞—Ç—å_toml("999.toml", –º–∞–Ω–∏—Ñ–µ—Å—Ç)
  –ø–µ—á–∞—Ç—å("‚úÖ –î–æ–±–∞–≤–ª–µ–Ω " + –ø–∞–∫–µ—Ç + " " + –∑–∞–≤.–≤–µ—Ä—Å–∏—è)
  
  // –û–±–Ω–æ–≤–ª—è–µ–º lock-—Ñ–∞–π–ª
  cmd_install()

‚≤™ cmd_remove(–ø–∞–∫–µ—Ç: ‚≤§):
  ‚≤ò –º–∞–Ω–∏—Ñ–µ—Å—Ç = —á–∏—Ç–∞—Ç—å_–º–∞–Ω–∏—Ñ–µ—Å—Ç("999.toml")
  
  ‚≤ú –º–∞–Ω–∏—Ñ–µ—Å—Ç.–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏[–ø–∞–∫–µ—Ç] != None:
    —É–¥–∞–ª–∏—Ç—å(–º–∞–Ω–∏—Ñ–µ—Å—Ç.–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –ø–∞–∫–µ—Ç)
  ‚≤ú –º–∞–Ω–∏—Ñ–µ—Å—Ç.dev_–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏[–ø–∞–∫–µ—Ç] != None:
    —É–¥–∞–ª–∏—Ç—å(–º–∞–Ω–∏—Ñ–µ—Å—Ç.dev_–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –ø–∞–∫–µ—Ç)
  ‚≤Ç:
    –æ—à–∏–±–∫–∞("–ü–∞–∫–µ—Ç " + –ø–∞–∫–µ—Ç + " –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö")
  
  –∑–∞–ø–∏—Å–∞—Ç—å_toml("999.toml", –º–∞–Ω–∏—Ñ–µ—Å—Ç)
  –ø–µ—á–∞—Ç—å("‚úÖ –£–¥–∞–ª—ë–Ω " + –ø–∞–∫–µ—Ç)

‚≤™ cmd_install():
  ‚≤ò –º–∞–Ω–∏—Ñ–µ—Å—Ç = —á–∏—Ç–∞—Ç—å_–º–∞–Ω–∏—Ñ–µ—Å—Ç("999.toml")
  ‚≤ò —Ä–µ–µ—Å—Ç—Ä = ‚≤†‚≤ï‚≤Ö‚≤¢‚≤â‚≤Ö‚≤ì‚≤•‚≤ß‚≤£‚≤© { url: "https://pkg.999lang.org", —Ç–æ–∫–µ–Ω: None }
  
  –ø–µ—á–∞—Ç—å("üì¶ –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...")
  ‚≤ò lock = —Ä–∞–∑—Ä–µ—à–∏—Ç—å_–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏(–º–∞–Ω–∏—Ñ–µ—Å—Ç, —Ä–µ–µ—Å—Ç—Ä)
  
  –ø–µ—á–∞—Ç—å("‚¨áÔ∏è  –ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞–∫–µ—Ç–æ–≤...")
  ‚≤Æ –ø–∞–∫–µ—Ç lock.–ø–∞–∫–µ—Ç—ã:
    ‚≤ú !–ø–∞–∫–µ—Ç_—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω(–ø–∞–∫–µ—Ç):
      –∑–∞–≥—Ä—É–∑–∏—Ç—å_–ø–∞–∫–µ—Ç(–ø–∞–∫–µ—Ç, —Ä–µ–µ—Å—Ç—Ä)
      –ø–µ—á–∞—Ç—å("  ‚úì " + –ø–∞–∫–µ—Ç.–∏–º—è + "@" + –ø–∞–∫–µ—Ç.–≤–µ—Ä—Å–∏—è)
  
  –∑–∞–ø–∏—Å–∞—Ç—å_lock("999.lock", lock)
  –ø–µ—á–∞—Ç—å("‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ " + —Å—Ç—Ä–æ–∫–∞(–¥–ª–∏–Ω–∞(lock.–ø–∞–∫–µ—Ç—ã)) + " –ø–∞–∫–µ—Ç–æ–≤")

‚≤™ cmd_update():
  ‚≤ò –º–∞–Ω–∏—Ñ–µ—Å—Ç = —á–∏—Ç–∞—Ç—å_–º–∞–Ω–∏—Ñ–µ—Å—Ç("999.toml")
  ‚≤ò —Ä–µ–µ—Å—Ç—Ä = ‚≤†‚≤ï‚≤Ö‚≤¢‚≤â‚≤Ö‚≤ì‚≤•‚≤ß‚≤£‚≤© { url: "https://pkg.999lang.org", —Ç–æ–∫–µ–Ω: None }
  
  // –£–¥–∞–ª—è–µ–º lock-—Ñ–∞–π–ª –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–µ—Ä–µ—Å—á—ë—Ç–∞
  —É–¥–∞–ª–∏—Ç—å_—Ñ–∞–π–ª("999.lock")
  
  cmd_install()

‚≤™ cmd_publish():
  ‚≤ò –º–∞–Ω–∏—Ñ–µ—Å—Ç = —á–∏—Ç–∞—Ç—å_–º–∞–Ω–∏—Ñ–µ—Å—Ç("999.toml")
  ‚≤ò —Ä–µ–µ—Å—Ç—Ä = ‚≤†‚≤ï‚≤Ö‚≤¢‚≤â‚≤Ö‚≤ì‚≤•‚≤ß‚≤£‚≤© { url: "https://pkg.999lang.org", —Ç–æ–∫–µ–Ω: –ø–æ–ª—É—á–∏—Ç—å_—Ç–æ–∫–µ–Ω() }
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç
  –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å_–º–∞–Ω–∏—Ñ–µ—Å—Ç(–º–∞–Ω–∏—Ñ–µ—Å—Ç)
  
  // –°–æ–∑–¥–∞—ë–º –∞—Ä—Ö–∏–≤
  ‚≤ò –∞—Ä—Ö–∏–≤ = —Å–æ–∑–¥–∞—Ç—å_–∞—Ä—Ö–∏–≤(–º–∞–Ω–∏—Ñ–µ—Å—Ç)
  
  // –ü—É–±–ª–∏–∫—É–µ–º
  –ø–µ—á–∞—Ç—å("üì§ –ü—É–±–ª–∏–∫–∞—Ü–∏—è " + –º–∞–Ω–∏—Ñ–µ—Å—Ç.–∏–º—è + "@" + –º–∞–Ω–∏—Ñ–µ—Å—Ç.–≤–µ—Ä—Å–∏—è + "...")
  –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å(—Ä–µ–µ—Å—Ç—Ä, –∞—Ä—Ö–∏–≤)
  
  –ø–µ—á–∞—Ç—å("‚úÖ –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ!")

‚≤™ cmd_search(–∑–∞–ø—Ä–æ—Å: ‚≤§):
  ‚≤ò —Ä–µ–µ—Å—Ç—Ä = ‚≤†‚≤ï‚≤Ö‚≤¢‚≤â‚≤Ö‚≤ì‚≤•‚≤ß‚≤£‚≤© { url: "https://pkg.999lang.org", —Ç–æ–∫–µ–Ω: None }
  
  ‚≤ò —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã = –ø–æ–∏—Å–∫_–ø–∞–∫–µ—Ç–æ–≤(—Ä–µ–µ—Å—Ç—Ä, –∑–∞–ø—Ä–æ—Å)
  
  ‚≤Æ –ø–∞–∫–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
    –ø–µ—á–∞—Ç—å(–ø–∞–∫–µ—Ç.–∏–º—è + " (" + –ø–∞–∫–µ—Ç.–≤–µ—Ä—Å–∏–∏[0] + ") - " + –ø–∞–∫–µ—Ç.–æ–ø–∏—Å–∞–Ω–∏–µ)
    –ø–µ—á–∞—Ç—å("  üì• " + —Å—Ç—Ä–æ–∫–∞(–ø–∞–∫–µ—Ç.–∑–∞–≥—Ä—É–∑–∫–∏) + " –∑–∞–≥—Ä—É–∑–æ–∫")

‚≤™ cmd_run(—Å–∫—Ä–∏–ø—Ç: ‚≤§):
  ‚≤ò –º–∞–Ω–∏—Ñ–µ—Å—Ç = —á–∏—Ç–∞—Ç—å_–º–∞–Ω–∏—Ñ–µ—Å—Ç("999.toml")
  
  ‚≤ú –º–∞–Ω–∏—Ñ–µ—Å—Ç.—Å–∫—Ä–∏–ø—Ç—ã[—Å–∫—Ä–∏–ø—Ç] == None:
    –æ—à–∏–±–∫–∞("–°–∫—Ä–∏–ø—Ç '" + —Å–∫—Ä–∏–ø—Ç + "' –Ω–µ –Ω–∞–π–¥–µ–Ω")
  
  ‚≤ò –∫–æ–º–∞–Ω–¥–∞ = –º–∞–Ω–∏—Ñ–µ—Å—Ç.—Å–∫—Ä–∏–ø—Ç—ã[—Å–∫—Ä–∏–ø—Ç]
  –ø–µ—á–∞—Ç—å("‚ñ∂ " + –∫–æ–º–∞–Ω–¥–∞)
  –≤—ã–ø–æ–ª–Ω–∏—Ç—å_–∫–æ–º–∞–Ω–¥—É(–∫–æ–º–∞–Ω–¥–∞)

// ============================================
// MAIN
// ============================================

‚≤™ main(–∞—Ä–≥—É–º–µ–Ω—Ç—ã: [‚≤§]) -> ‚≤ä:
  ‚≤ú –¥–ª–∏–Ω–∞(–∞—Ä–≥—É–º–µ–Ω—Ç—ã) < 2:
    –ø–µ—á–∞—Ç—å_—Å–ø—Ä–∞–≤–∫–∞()
    ‚≤¢ 1
  
  ‚≤ò –∫–æ–º–∞–Ω–¥–∞ = –∞—Ä–≥—É–º–µ–Ω—Ç—ã[1]
  
  ‚≤ú –∫–æ–º–∞–Ω–¥–∞:
    "init":
      ‚≤ò –ø—É—Ç—å = –¥–ª–∏–Ω–∞(–∞—Ä–≥—É–º–µ–Ω—Ç—ã) > 2 ? –∞—Ä–≥—É–º–µ–Ω—Ç—ã[2] : "."
      cmd_init(–ø—É—Ç—å)
    "add":
      ‚≤ú –¥–ª–∏–Ω–∞(–∞—Ä–≥—É–º–µ–Ω—Ç—ã) < 3:
        –æ—à–∏–±–∫–∞("–£–∫–∞–∂–∏—Ç–µ –∏–º—è –ø–∞–∫–µ—Ç–∞")
      ‚≤ò dev = "--dev" –≤ –∞—Ä–≥—É–º–µ–Ω—Ç—ã
      ‚≤ò –≤–µ—Ä—Å–∏—è = –¥–ª–∏–Ω–∞(–∞—Ä–≥—É–º–µ–Ω—Ç—ã) > 3 && !–∞—Ä–≥—É–º–µ–Ω—Ç—ã[3].starts_with("-") ? –∞—Ä–≥—É–º–µ–Ω—Ç—ã[3] : None
      cmd_add(–∞—Ä–≥—É–º–µ–Ω—Ç—ã[2], –≤–µ—Ä—Å–∏—è, dev)
    "remove":
      ‚≤ú –¥–ª–∏–Ω–∞(–∞—Ä–≥—É–º–µ–Ω—Ç—ã) < 3:
        –æ—à–∏–±–∫–∞("–£–∫–∞–∂–∏—Ç–µ –∏–º—è –ø–∞–∫–µ—Ç–∞")
      cmd_remove(–∞—Ä–≥—É–º–µ–Ω—Ç—ã[2])
    "install":
      cmd_install()
    "update":
      cmd_update()
    "publish":
      cmd_publish()
    "search":
      ‚≤ú –¥–ª–∏–Ω–∞(–∞—Ä–≥—É–º–µ–Ω—Ç—ã) < 3:
        –æ—à–∏–±–∫–∞("–£–∫–∞–∂–∏—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å")
      cmd_search(–∞—Ä–≥—É–º–µ–Ω—Ç—ã[2])
    "run":
      ‚≤ú –¥–ª–∏–Ω–∞(–∞—Ä–≥—É–º–µ–Ω—Ç—ã) < 3:
        –æ—à–∏–±–∫–∞("–£–∫–∞–∂–∏—Ç–µ –∏–º—è —Å–∫—Ä–∏–ø—Ç–∞")
      cmd_run(–∞—Ä–≥—É–º–µ–Ω—Ç—ã[2])
    "help":
      –ø–µ—á–∞—Ç—å_—Å–ø—Ä–∞–≤–∫–∞()
    _:
      –ø–µ—á–∞—Ç—å("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞: " + –∫–æ–º–∞–Ω–¥–∞)
      ‚≤¢ 1
  
  ‚≤¢ 0

‚≤™ –ø–µ—á–∞—Ç—å_—Å–ø—Ä–∞–≤–∫–∞():
  –ø–µ—á–∞—Ç—å("
999pkg - –ü–∞–∫–µ—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —è–∑—ã–∫–∞ 999

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: 999pkg <–∫–æ–º–∞–Ω–¥–∞> [–∞—Ä–≥—É–º–µ–Ω—Ç—ã]

–ö–æ–º–∞–Ω–¥—ã:
  init [–ø—É—Ç—å]       –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
  add <–ø–∞–∫–µ—Ç>       –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
  remove <–ø–∞–∫–µ—Ç>    –£–¥–∞–ª–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
  install           –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
  update            –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
  publish           –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç
  search <–∑–∞–ø—Ä–æ—Å>   –ü–æ–∏—Å–∫ –ø–∞–∫–µ—Ç–æ–≤
  run <—Å–∫—Ä–∏–ø—Ç>      –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç
  help              –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É

–ü—Ä–∏–º–µ—Ä—ã:
  999pkg init myproject
  999pkg add json ^1.0.0
  999pkg add testing --dev
  999pkg run build
")
