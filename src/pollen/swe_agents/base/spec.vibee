name: swe_agent_base
version: "1.0.0"
language: zig
module: swe_agent_base
target: swe_agent_base.zig
description: Base interface for all SWE agents integration

behaviors:
  - name: analyze_code
    given: Code path provided
    when: Agent analyzes code
    then: Analysis result returned
    test_cases:
      - name: analyze_simple_file
        input: {path: "main.zig", agent: "aider"}
        expected: {complexity: 5, issues: 0}

  - name: generate_code
    given: Specification provided
    when: Agent generates code
    then: Code generated successfully
    test_cases:
      - name: generate_from_spec
        input: {spec: "hello.vibee", agent: "gpt-engineer"}
        expected: {generated: true, files: 1}

  - name: refactor_code
    given: Code and instructions
    when: Agent refactors code
    then: Refactored code returned
    test_cases:
      - name: optimize_performance
        input: {code: "slow_function", instructions: "optimize"}
        expected: {improved: true, speedup: 2.0}

  - name: review_code
    given: Code to review
    when: Agent reviews code
    then: Review with suggestions returned
    test_cases:
      - name: review_pr
        input: {pr_number: 123, agent: "sweep"}
        expected: {issues_found: 3, suggestions: 5}

  - name: fix_issue
    given: GitHub issue
    when: Agent fixes issue
    then: Pull request created
    test_cases:
      - name: fix_bug_issue
        input: {issue_number: 456, repo: "vibee"}
        expected: {pr_created: true, pr_number: 789}

types:
  SWEAgent:
    name: String
    type: AgentType
    capabilities: List<Capability>
    config: AgentConfig
    status: AgentStatus
    
  AgentType:
    - CLI
    - API
    - GitHub
    - IDE
    
  Capability:
    - CodeGeneration
    - CodeReview
    - Refactoring
    - Testing
    - Documentation
    - IssueResolution
    - ProjectGeneration
    
  AgentConfig:
    api_key: String
    model: String
    temperature: Float
    max_tokens: Int
    timeout: Int
    
  AgentStatus:
    - Available
    - Busy
    - Error
    - Offline
    
  Analysis:
    complexity: Int
    issues: List<Issue>
    suggestions: List<String>
    metrics: CodeMetrics
    
  CodeMetrics:
    lines: Int
    functions: Int
    classes: Int
    cyclomatic_complexity: Int
    
  Issue:
    type: IssueType
    severity: Severity
    line: Int
    message: String
    
  IssueType:
    - Bug
    - Performance
    - Security
    - Style
    - Documentation
    
  Severity:
    - Critical
    - High
    - Medium
    - Low
    - Info
    
  Review:
    agent: String
    issues: List<Issue>
    suggestions: List<String>
    score: Int
    approved: Bool
    
  PullRequest:
    number: Int
    title: String
    description: String
    files_changed: Int
    status: PRStatus
    
  PRStatus:
    - Open
    - Closed
    - Merged
    - Draft

functions:
  - name: create_agent
    params: {name: String, type: AgentType, config: AgentConfig}
    returns: Result<SWEAgent, Error>
    
  - name: analyze_code
    params: {agent: SWEAgent, path: String}
    returns: Result<Analysis, Error>
    
  - name: generate_code
    params: {agent: SWEAgent, spec: String}
    returns: Result<String, Error>
    
  - name: refactor_code
    params: {agent: SWEAgent, code: String, instructions: String}
    returns: Result<String, Error>
    
  - name: review_code
    params: {agent: SWEAgent, code: String}
    returns: Result<Review, Error>
    
  - name: fix_issue
    params: {agent: SWEAgent, issue_number: Int, repo: String}
    returns: Result<PullRequest, Error>
    
  - name: write_tests
    params: {agent: SWEAgent, code: String}
    returns: Result<String, Error>
    
  - name: generate_docs
    params: {agent: SWEAgent, code: String}
    returns: Result<String, Error>
    
  - name: get_agent_status
    params: {agent: SWEAgent}
    returns: Result<AgentStatus, Error>

imports:
  - std
  - std.fs
  - std.process
  - std.http
