name: scout_bees
version: "1.0.0"
language: zig
module: vibee_lang/scouts
target: code_scanner.zig
description: |
  üîç SCOUT BEES - Code Analyzers
  
  –†–∞–∑–≤–µ–¥—á–∏–∫–∏ —Å–∫–∞–Ω–∏—Ä—É—é—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –Ω–∞—Ö–æ–¥—è—Ç –≤–µ—Å—å —Ä—É—á–Ω–æ–π –∫–æ–¥,
  –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ .vibee —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏.

behaviors:
  - name: scan_repository
    given: Repository path
    when: Scout scans for manual code
    then: Complete report of all manual files
    test_cases:
      - name: scan_vibee_repo
        input: {repo_path: "/workspaces/vibee-lang"}
        expected: {manual_files: 169, total_lines: 50000, languages: ["gleam", "zig", "rust", "typescript"]}

  - name: detect_patterns
    given: Source code file
    when: Pattern detection runs
    then: Code patterns identified
    test_cases:
      - name: detect_gleam_patterns
        input: {file_path: "gleam/src/example.gleam"}
        expected: {patterns: ["function_definition", "type_definition", "import_statement"], count: 15}

  - name: map_dependencies
    given: Multiple source files
    when: Dependency mapping runs
    then: Dependency graph created
    test_cases:
      - name: map_module_dependencies
        input: {files: ["a.gleam", "b.gleam", "c.gleam"]}
        expected: {dependencies: [["a", "b"], ["b", "c"]], circular: false}

  - name: estimate_complexity
    given: Source code file
    when: Complexity analysis runs
    then: Complexity metrics calculated
    test_cases:
      - name: analyze_simple_file
        input: {file_path: "simple.gleam", lines: 50}
        expected: {complexity: "low", functions: 5, types: 2, cyclomatic: 8}

types:
  ScoutBee:
    scout_id: String
    status: ScoutStatus
    files_scanned: Int
    patterns_detected: Int

  ScoutStatus:
    status: String  # "idle" | "scanning" | "analyzing" | "reporting"
    current_file: Option(String)
    progress: Float

  ScanReport:
    repo_path: String
    manual_files: List(FileInfo)
    total_lines: Int
    languages: List(String)
    scan_duration_ms: Int
    timestamp: String

  FileInfo:
    path: String
    language: String
    lines: Int
    functions: Int
    types: Int
    imports: Int
    complexity: String  # "low" | "medium" | "high"
    patterns: List(String)
    dependencies: List(String)

  DependencyGraph:
    nodes: List(String)
    edges: List(Dependency)
    circular_dependencies: List(List(String))

  Dependency:
    from: String
    to: String
    import_type: String  # "direct" | "indirect"

  ComplexityMetrics:
    cyclomatic_complexity: Int
    cognitive_complexity: Int
    lines_of_code: Int
    comment_ratio: Float
    overall_complexity: String

functions:
  - name: create_scout
    params: {scout_id: String}
    returns: ScoutBee

  - name: scan_repository
    params: {scout: ScoutBee, repo_path: String}
    returns: Result(ScanReport, String)

  - name: scan_file
    params: {scout: ScoutBee, file_path: String}
    returns: Result(FileInfo, String)

  - name: detect_patterns
    params: {code: String, language: String}
    returns: List(String)

  - name: map_dependencies
    params: {files: List(FileInfo)}
    returns: DependencyGraph

  - name: estimate_complexity
    params: {file_info: FileInfo}
    returns: ComplexityMetrics

  - name: get_scout_status
    params: {scout: ScoutBee}
    returns: ScoutStatus

imports:
  - gleam/io
  - gleam/list
  - gleam/result
  - gleam/string
  - gleam/option
  - simplifile
