name: guard_bees
version: "1.0.0"
language: gleam
module: honeycomb/guards
description: |
  ðŸ›¡ï¸ GUARD BEES - Code Validators
  
  ÐžÑ…Ñ€Ð°Ð½Ð½Ð¸ÐºÐ¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÑŽÑ‚ ÑÐ³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ ÐºÐ¾Ð´ Ð½Ð° ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ÑÑ‚ÑŒ,
  ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¸ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ðµ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð°Ð¼.

behaviors:
  - name: validate_syntax
    given: Generated code file
    when: Syntax validation runs
    then: Syntax errors detected or code approved
    test_cases:
      - name: validate_correct_gleam
        input: {code: "pub fn add(a: Int, b: Int) -> Int { a + b }", language: "gleam"}
        expected: {valid: true, errors: []}
      - name: validate_incorrect_gleam
        input: {code: "pub fn add(a: Int, b: Int) { a + }", language: "gleam"}
        expected: {valid: false, errors: ["Syntax error: incomplete expression"]}

  - name: validate_types
    given: Generated code with type annotations
    when: Type checking runs
    then: Type errors detected or code approved
    test_cases:
      - name: validate_correct_types
        input: {code: "let x: Int = 42", language: "gleam"}
        expected: {valid: true, errors: []}
      - name: validate_incorrect_types
        input: {code: "let x: Int = \"hello\"", language: "gleam"}
        expected: {valid: false, errors: ["Type error: expected Int, got String"]}

  - name: check_quality
    given: Generated code
    when: Quality check runs
    then: Quality metrics calculated
    test_cases:
      - name: check_high_quality_code
        input: {code: "pub fn add(a: Int, b: Int) -> Int { a + b }"}
        expected: {quality_score: 0.95, issues: []}
      - name: check_low_quality_code
        input: {code: "pub fn x(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p) { ... }"}
        expected: {quality_score: 0.45, issues: ["Too many parameters", "Poor naming"]}

  - name: run_tests
    given: Generated code with tests
    when: Test suite runs
    then: Test results reported
    test_cases:
      - name: all_tests_pass
        input: {test_file: "example_test.gleam"}
        expected: {passed: 10, failed: 0, skipped: 0}

types:
  GuardBee:
    guard_id: String
    guard_type: String  # "syntax" | "type" | "quality" | "test"
    checks_performed: Int
    issues_found: Int

  ValidationResult:
    valid: Bool
    errors: List(ValidationError)
    warnings: List(String)
    quality_score: Float

  ValidationError:
    error_type: String  # "syntax" | "type" | "style" | "logic"
    message: String
    line: Int
    column: Int
    severity: String  # "error" | "warning" | "info"

  QualityMetrics:
    code_coverage: Float
    cyclomatic_complexity: Int
    maintainability_index: Float
    technical_debt_ratio: Float
    overall_score: Float

  TestResult:
    passed: Int
    failed: Int
    skipped: Int
    duration_ms: Int
    failures: List(TestFailure)

  TestFailure:
    test_name: String
    error_message: String
    stack_trace: String

functions:
  - name: create_guard
    params: {guard_id: String, guard_type: String}
    returns: GuardBee

  - name: validate_syntax
    params: {guard: GuardBee, code: String, language: String}
    returns: ValidationResult

  - name: validate_types
    params: {guard: GuardBee, code: String, language: String}
    returns: ValidationResult

  - name: check_quality
    params: {guard: GuardBee, code: String}
    returns: QualityMetrics

  - name: run_tests
    params: {guard: GuardBee, test_file: String}
    returns: Result(TestResult, String)

  - name: batch_validate
    params: {guard: GuardBee, files: List(String)}
    returns: List(ValidationResult)

imports:
  - gleam/io
  - gleam/list
  - gleam/result
  - gleam/string
