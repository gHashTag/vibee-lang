%YAML 1.2
---
# VIBEE syntax for Warp terminal (via bat/syntect)
# Install: bat cache --build after copying to ~/.config/bat/syntaxes/
name: VIBEE
file_extensions:
  - vibee
  - vib
scope: source.vibee

variables:
  identifier: '[a-zA-Z_][a-zA-Z0-9_]*'

contexts:
  main:
    - include: comments
    - include: decorators
    - include: keywords
    - include: strings
    - include: numbers
    - include: operators
    - include: types
    - include: constants

  comments:
    - match: '#.*$'
      scope: comment.line.vibee

  decorators:
    - match: '@(desc|spec|const|import|llm|fallback_models|retry|timeout|budget|ffi|one_of|range)\b'
      scope: keyword.other.decorator.vibee
    - match: '@{{identifier}}'
      scope: entity.name.function.decorator.vibee

  keywords:
    - match: '\b(tool|scene|fn|struct|agent|machine)\b'
      scope: keyword.declaration.vibee
    - match: '\b(on|enter|exit|callback|message|stay|transition|reply)\b'
      scope: keyword.control.vibee
    - match: '\b(case|if|else|match)\b'
      scope: keyword.control.conditional.vibee
    - match: '\b(as)\b'
      scope: keyword.control.import.vibee

  strings:
    - match: '"""'
      scope: punctuation.definition.string.begin.vibee
      push:
        - meta_scope: string.quoted.triple.vibee
        - match: '"""'
          scope: punctuation.definition.string.end.vibee
          pop: true
    - match: '"'
      scope: punctuation.definition.string.begin.vibee
      push:
        - meta_scope: string.quoted.double.vibee
        - match: '\\[nrt\\"'']'
          scope: constant.character.escape.vibee
        - match: '"'
          scope: punctuation.definition.string.end.vibee
          pop: true

  numbers:
    - match: '\b\d+\.\d+\b'
      scope: constant.numeric.float.vibee
    - match: '\b\d+\b'
      scope: constant.numeric.integer.vibee

  operators:
    - match: '->'
      scope: keyword.operator.arrow.vibee
    - match: '\|>'
      scope: keyword.operator.pipe.vibee
    - match: '<>'
      scope: keyword.operator.concat.vibee
    - match: '==|!=|<=|>=|<|>'
      scope: keyword.operator.comparison.vibee
    - match: '&&|\|\|'
      scope: keyword.operator.logical.vibee

  types:
    - match: '\b(str|int|float|bool|list|map|any|nil|void)\b'
      scope: storage.type.vibee
    - match: '[!?]'
      scope: storage.modifier.vibee

  constants:
    - match: '\b(true|false)\b'
      scope: constant.language.boolean.vibee
    - match: '\bnil\b'
      scope: constant.language.null.vibee
    - match: '\b(Ok|Error|Some|None)\b'
      scope: support.type.vibee
