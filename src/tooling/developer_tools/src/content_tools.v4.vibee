// Content Tools - MCP Tools for digital clone content generation
  // Performance Warning:   // AI Suggestion: Replace magic numbers with named constants  // AI Suggestion: Consider extracting hardcoded strings to constants// Avatar generation, script writing, full pipeline
// Converted from mcp/content_tools.gleam → content_tools.vibee

// =============================================================================
// Tool Definitions
// =============================================================================

tool avatar_generate {
  /// Generate NEURO_SAGE avatar image with LoRA model
  description: "Сгенерировать изображение аватара NEURO_SAGE с помощью LoRA модели. Используется для создания talking head видео."

  @param style: str? {
    enum: ["excited", "serious", "friendly", "confident", "promotional"]
    description: "Стиль аватара (default: friendly)"
    default: "friendly"
  }

  @param format: str? {
    enum: ["instagram_reel", "tiktok", "youtube_short", "telegram", "square"]
    description: "Формат/размер изображения (default: instagram_reel)"
    default: "instagram_reel"
  }

  @param custom_prompt: str? {
    description: "Дополнительный промпт для кастомизации (опционально)"
  }
}

tool content_generate_script {
  /// Generate video content script
  description: "Сгенерировать скрипт для видео контента на основе темы, категории и платформы. Использует шаблоны VIBEE."

  @param topic: str {
    description: "Тема контента, например 'Как я завайбкодил ферму роботов'"
    required: true
  }

  @param category: str? {
    enum: ["story", "tech_backstage", "educational", "case_study", "offer", "engagement"]
    description: "Категория контента (default: story)"
    default: "story"
  }

  @param platform: str? {
    enum: ["telegram", "instagram", "tiktok", "youtube", "twitter"]
    description: "Целевая платформа (default: instagram)"
    default: "instagram"
  }

  @param context: str? {
    description: "Дополнительный контекст (GitHub профиль, кейсы и т.д.)"
  }
}

tool content_pipeline_run {
  /// Run full content generation pipeline
  description: "Запустить полный пайплайн генерации контента: скрипт → аватар → TTS → lipsync → рендер. Создаёт готовое видео для публикации."

  @param topic: str {
    description: "Тема контента"
    required: true
  }

  @param category: str? {
    enum: ["story", "tech_backstage", "educational", "case_study", "offer", "engagement"]
    description: "Категория (default: story)"
    default: "story"
  }

  @param platforms: [str]? {
    description: "Целевые платформы (default: [instagram, tiktok])"
  }

  @param github_type type type User {
  name: String,
  email: String,
  id: Int} {
  name: String,
  email: String,
  id: Int} {
  name: String,
  email: String,
  id: Int}name: str? {
    description: "GitHub type type type User {
  name: String,
  email: String,
  id: Int} {
  name: String,
  email: String,
  id: Int} {
  name: String,
  email: String,
  id: Int}name для контекста (default: gHashTag)"
    default: "gHashTag"
  }
}

tool content_get_template {
  /// Get script template for content category
  description: "Получить шаблон скрипта для категории контента. Показывает структуру, примеры хуков и CTA."

  @param category: str {
    enum: ["story", "tech_backstage", "educational", "case_study", "offer", "engagement"]
    description: "Категория контента"
    required: true
  }
}

// =============================================================================
// Types
// =============================================================================

derive(Json)
@enum AvatarStyle {
  "excited" => Excited       // Энергичный
  "serious" => Serious       // Серьёзный
  "friendly" => Friendly      // Дружелюбный
  "confident" => Confident     // Уверенный
  "promotional" => Promotional   // Промо
}

derive(Json)
@enum ContentFormat {
  "instagram_reel" => InstagramReel   // 1080x1920 (9:16)
  "instagram_post" => InstagramPost   // 1080x1080 (1)
  "tiktok" => TikTokVideo     // 1080x1920 (9:16)
  "youtube_short" => YouTubeShort    // 1080x1920 (9:16)
  "telegram" => TelegramPost    // Flexible
  "tweet" => Tweet           // Text-based
}

derive(Json)
@enum ContentCategory {
  "story" => Story           // Личная история
  "tech_backstage" => TechBackstage   // Техническое закулисье
  "educational" => Educational     // Обучающий контент
  "case_study" => CaseStudy       // Кейс/результат
  "offer" => Offer           // Оффер/продажа
  "engagement" => Engagement      // Вовлечение
}

derive(Json)
@enum Platform {
  "telegram" => Telegram
  "instagram" => Instagram
  "tiktok" => TikTok
  "youtube" => YouTube
  "twitter" => Twitter
}

type ContentPlan(
  ContentPlan(
    id: int?,
    topic: str,
    category: ContentCategory,
    platforms: [Platform],
    formats: [ContentFormat],
    avatar_style: AvatarStyle,
    language: str,
    context: str?,
    status: ContentStatus,
    created_at: str,
    updated_at: str
  )
}

@enum ContentStatus {
  "draft" => Draft
  "script_generated" => ScriptGenerated
  "avatar_generated" => AvatarGenerated
  "audio_generated" => AudioGenerated
  "video_rendered" => VideoRendered
  "published" => Published
}

type GeneratedContent(
  GeneratedContent(
    platform: Platform,
    format: ContentFormat,
    script: str,
    avatar_url: str?,
    audio_url: str?,
    final_video_url: str?,
    hashtags: [str],
    status: ContentStatus
  )
}

type AvatarGenerationResult(
  AvatarGenerationResult(
    image_url: str,
    seed: int,
    generation_time: float
  )
}

type ContentTemplate(
  ContentTemplate(
    category: ContentCategory,
    structure: str,
    hook_examples: [str],
    cta_examples: [str],
    duration_seconds: int,
    voice_tone: str
  )
}

// =============================================================================
// Helper Functions
// =============================================================================

@spec avatar_style_from_string(s: str) → AvatarStyle {
  /// Parse avatar style from string
  given: Style string
  when: Parsing tool input
  then: Returns AvatarStyle enum
}

@impl {
  match s {
    "excited" → Excited
    "serious" → Serious
    "confident" → Confident
    "promotional" → Promotional
    _ → Friendly
  }
}

@spec avatar_style_to_string(style: AvatarStyle) → str {
  /// Convert avatar style to string
  given: AvatarStyle enum
  when: Building prompt
  then: Returns style string
}

@impl {
  match style {
    Excited → "excited"
    Serious → "serious"
    Friendly → "friendly"
    Confident → "confident"
    Promotional → "promotional"
  }
}

@spec format_from_string(s: str) → ContentFormat {
  /// Parse content format from string
  given: Format string
  when: Parsing tool input
  then: Returns ContentFormat enum
}

@impl {
  match s {
    "instagram_reel" → InstagramReel
    "instagram_post" → InstagramPost
    "tiktok" → TikTokVideo
    "youtube_short" → YouTubeShort
    "telegram" → TelegramPost
    "square" → InstagramPost
    "tweet" → Tweet
    _ → InstagramReel
  }
}

@spec format_dimensions(format: ContentFormat) → #(int, int) {
  /// Get width/height for content format
  given: ContentFormat enum
  when: Creating image/video
  then: Returns (width, height) tuple
}

@impl {
  match format {
    InstagramReel → #(1080, 1920)
    InstagramPost → #(1080, 1080)
    TikTokVideo → #(1080, 1920)
    YouTubeShort → #(1080, 1920)
    TelegramPost → #(1280, 720)
    Tweet → #(1200, 675)
  }
}

@spec category_from_string(s: str) → Nil · Result {
  /// Parse content category from string
  given: Category string
  when: Parsing tool input
  then: Returns ContentCategory or error
}

@impl {
  match s {
    "story" → ✅Story)
    "tech_backstage" → ✅TechBackstage)
    "educational" → ✅Educational)
    "case_study" → ✅CaseStudy)
    "offer" → ✅Offer)
    "engagement" → ✅Engagement)
    _ → ❌Nil)
  }
}

@spec category_to_string(cat: ContentCategory) → str {
  /// Convert category to string
  given: ContentCategory enum
  when: Serializing response
  then: Returns category string
}

@impl {
  match cat {
    Story → "story"
    TechBackstage → "tech_backstage"
    Educational → "educational"
    CaseStudy → "case_study"
    Offer → "offer"
    Engagement → "engagement"
  }
}

@spec platform_from_string(s: str) → Nil · Result {
  /// Parse platform from string
  given: Platform string
  when: Parsing tool input
  then: Returns Platform or error
}

@impl {
  match s {
    "telegram" → ✅Telegram)
    "instagram" → ✅Instagram)
    "tiktok" → ✅TikTok)
    "youtube" → ✅YouTube)
    "twitter" → ✅Twitter)
    _ → ❌Nil)
  }
}

@spec platform_to_string(p: Platform) → str {
  /// Convert platform to string
  given: Platform enum
  when: Serializing response
  then: Returns platform string
}

@impl {
  match p {
    Telegram → "telegram"
    Instagram → "instagram"
    TikTok → "tiktok"
    YouTube → "youtube"
    Twitter → "twitter"
  }
}

@spec category_to_style(cat: ContentCategory) → AvatarStyle {
  /// Map content category to recommended avatar style
  given: ContentCategory
  when: Auto-selecting style
  then: Returns AvatarStyle
}

@impl {
  match cat {
    Story → Friendly
    TechBackstage → Confident
    Educational → Serious
    CaseStudy → Confident
    Offer → Promotional
    Engagement → Excited
  }
}

// =============================================================================
// FFI Imports - handlers in infra/mcp/content_tools.gleam
// =============================================================================

// @ffi handle_avatar_generate(args: Json) → ToolResult
// @ffi handle_content_generate_script(args: Json) → ToolResult
// @ffi handle_content_pipeline_run(args: Json) → ToolResult
// @ffi handle_content_get_template(args: Json) → ToolResult

# v8.0

# v8.0
# v10.0 - ML-Powered Migration
