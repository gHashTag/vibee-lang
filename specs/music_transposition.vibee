name: music_transposition
version: "1.0.0"
language: zig
module: music_transposition
target: music.zig
description: Musical note transposition using VIBEE's universal transformation pattern

behaviors:
  - name: transpose_note
    given: Musical note in C major scale
    when: Transpose to D major requested (up 2 semitones)
    then: Transposed note returned
    test_cases:
      - name: c_to_d
        input: {note: "C", semitones: 2}
        expected: {note: "D"}
      - name: d_to_e
        input: {note: "D", semitones: 2}
        expected: {note: "E"}
      - name: e_to_fsharp
        input: {note: "E", semitones: 2}
        expected: {note: "F#"}
      - name: g_to_a
        input: {note: "G", semitones: 2}
        expected: {note: "A"}

  - name: transpose_chord
    given: Chord in C major
    when: Transpose to D major requested
    then: All notes in chord transposed
    test_cases:
      - name: c_major_to_d_major
        input: {chord: ["C", "E", "G"], semitones: 2}
        expected: {chord: ["D", "F#", "A"]}
      - name: g_major_to_a_major
        input: {chord: ["G", "B", "D"], semitones: 2}
        expected: {chord: ["A", "C#", "E"]}

  - name: transpose_melody
    given: Melody (sequence of notes)
    when: Transpose requested
    then: All notes transposed maintaining intervals
    test_cases:
      - name: simple_melody
        input: {melody: ["C", "D", "E", "F", "G"], semitones: 2}
        expected: {melody: ["D", "E", "F#", "G", "A"]}

types:
  Note:
    name: String      # C, D, E, F, G, A, B
    octave: Int       # 0-8
    accidental: Accidental  # Sharp, Flat, Natural
    
  Accidental:
    - Natural
    - Sharp
    - Flat
    - DoubleSharp
    - DoubleFlat
    
  Interval:
    semitones: Int    # 0-12
    
  Chord:
    notes: List<Note>
    name: String      # C major, D minor, etc.
    
  Melody:
    notes: List<Note>
    tempo: Int        # BPM
    time_signature: String  # 4/4, 3/4, etc.
    
  Scale:
    root: Note
    intervals: List<Int>  # Semitone pattern
    name: String      # Major, Minor, etc.

functions:
  - name: transpose_note
    params: {note: String, semitones: Int}
    returns: Result<String, Error>
    
  - name: transpose_chord
    params: {chord: List<String>, semitones: Int}
    returns: Result<List<String>, Error>
    
  - name: transpose_melody
    params: {melody: List<String>, semitones: Int}
    returns: Result<List<String>, Error>
    
  - name: note_to_midi
    params: {note: String}
    returns: Int
    
  - name: midi_to_note
    params: {midi: Int}
    returns: String
    
  - name: calculate_interval
    params: {note1: String, note2: String}
    returns: Int

music_theory:
  chromatic_scale:
    - C
    - C#/Db
    - D
    - D#/Eb
    - E
    - F
    - F#/Gb
    - G
    - G#/Ab
    - A
    - A#/Bb
    - B
    
  major_scale_intervals:
    - 2  # Whole step
    - 2  # Whole step
    - 1  # Half step
    - 2  # Whole step
    - 2  # Whole step
    - 2  # Whole step
    - 1  # Half step
    
  minor_scale_intervals:
    - 2  # Whole step
    - 1  # Half step
    - 2  # Whole step
    - 2  # Whole step
    - 1  # Half step
    - 2  # Whole step
    - 2  # Whole step

imports:
  - std
  - std.mem
