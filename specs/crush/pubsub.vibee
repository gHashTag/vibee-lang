# pubsub.vibee - Publish/Subscribe Module
# Author: Dmitrii Vasilev
# Source: github.com/charmbracelet/crush/internal/pubsub

name: pubsub
version: "1.0.0"
language: zig
module: pubsub

sacred_formula:
  V: "n × 3^k × π^m × φ^p × e^q"
  golden_identity: "φ² + 1/φ² = 3"

creation_pattern:
  source: Event
  transformer: Broker
  result: Subscribers

behaviors:
  - name: subscribe
    given: "Broker instance"
    when: "Subscribe is called"
    then: "Returns channel for receiving events"

  - name: publish
    given: "Event and payload"
    when: "Publish is called"
    then: "All subscribers receive event"

  - name: shutdown
    given: "Active broker"
    when: "Shutdown is called"
    then: "All channels closed"

dependencies:
  - "context"
  - "sync"
