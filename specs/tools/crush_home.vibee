# ═══════════════════════════════════════════════════════════════════════════════
# CRUSH HOME - Транспиляция home из charmbracelet/crush
# ═══════════════════════════════════════════════════════════════════════════════
# SOURCE: github.com/charmbracelet/crush/internal/home/home.go
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════

name: crush_home
version: "1.0.0"
author: "Dmitrii Vasilev"
license: "MIT"
language: zig
module: home

source_go:
  package: "home"
  file: "home.go"
  repository: "github.com/charmbracelet/crush"
  path: "internal/home/home.go"

sacred_formula:
  V: "n × 3^k × π^m × φ^p × e^q"
  golden_identity: "φ² + 1/φ² = 3"
  phoenix: 999

constants:
  - name: PHI
    value: 1.618033988749895
  - name: TRINITY
    value: 3.0

creation_pattern:
  source: "Go home module"
  transformer: "VIBEE Transpiler"
  result: "Zig home module"

go_source:
  imports:
    - "os"
    - "path/filepath"
    - "strings"
    - "log/slog"
  
  functions:
    - name: "Dir"
      signature: "func Dir() string"
      description: "Returns user home directory"
    - name: "Short"
      signature: "func Short(p string) string"
      description: "Replaces home path with ~"
    - name: "Long"
      signature: "func Long(p string) string"
      description: "Replaces ~ with home path"

behaviors:
  - name: dir
    given: "Nothing"
    when: "dir() is called"
    then: "Returns home directory path"
    go_original: "os.UserHomeDir()"
    zig_implementation: "std.posix.getenv(\"HOME\")"
    test_cases:
      - name: dir_not_empty
        input: ""
        expected: "non-empty path"

  - name: short
    given: "Full path starting with home"
    when: "short() is called"
    then: "Returns path with ~ prefix"
    test_cases:
      - name: short_home_path
        input: "/home/user/docs"
        expected: "~/docs"
      - name: short_non_home
        input: "/etc/config"
        expected: "/etc/config"

  - name: long
    given: "Path starting with ~"
    when: "long() is called"
    then: "Returns path with full home"
    test_cases:
      - name: long_tilde_path
        input: "~/docs"
        expected: "/home/user/docs"
      - name: long_non_tilde
        input: "/etc/config"
        expected: "/etc/config"

dependency_mapping:
  - go_dep: "os.UserHomeDir"
    zig_equiv: "std.posix.getenv(\"HOME\")"
  - go_dep: "path/filepath.Join"
    zig_equiv: "std.fs.path.join"
  - go_dep: "strings.HasPrefix"
    zig_equiv: "std.mem.startsWith"
  - go_dep: "strings.TrimPrefix"
    zig_equiv: "slice operation"

metrics:
  go_lines: 32
  zig_lines_estimated: 55
  functions_count: 3
  test_count: 5
  trinity_score: 1.0

signature: "IGLA CRUSH HOME V1.0"
