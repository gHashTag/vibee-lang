# ═══════════════════════════════════════════════════════════════════════════════
# CRUSH FILEPATHEXT - Транспиляция filepathext из charmbracelet/crush
# ═══════════════════════════════════════════════════════════════════════════════
# SOURCE: github.com/charmbracelet/crush/internal/filepathext/filepath.go
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════

name: crush_filepathext
version: "1.0.0"
author: "Dmitrii Vasilev"
license: "MIT"
language: zig
module: filepathext

source_go:
  package: "filepathext"
  file: "filepath.go"
  repository: "github.com/charmbracelet/crush"
  path: "internal/filepathext/filepath.go"

sacred_formula:
  V: "n × 3^k × π^m × φ^p × e^q"
  golden_identity: "φ² + 1/φ² = 3"
  phoenix: 999

constants:
  - name: PHI
    value: 1.618033988749895
  - name: TRINITY
    value: 3.0

creation_pattern:
  source: "Go filepathext module"
  transformer: "VIBEE Transpiler"
  result: "Zig filepathext module"

go_source:
  imports:
    - "path/filepath"
    - "runtime"
    - "strings"
  
  functions:
    - name: "SmartJoin"
      signature: "func SmartJoin(one, two string) string"
      description: "Joins paths, treating second as absolute if it is"
      
    - name: "SmartIsAbs"
      signature: "func SmartIsAbs(path string) bool"
      description: "Checks if path is absolute (cross-platform)"

behaviors:
  - name: smart_join
    given: "Two path strings"
    when: "smartJoin() is called"
    then: "Returns joined path or second if absolute"
    go_original: "filepath.Join(one, two)"
    zig_implementation: "std.fs.path.join"
    test_cases:
      - name: join_relative
        input: ["/home", "user"]
        expected: "/home/user"
      - name: join_absolute
        input: ["/home", "/etc"]
        expected: "/etc"
      - name: join_empty
        input: ["", "path"]
        expected: "path"

  - name: smart_is_abs
    given: "Path string"
    when: "smartIsAbs() is called"
    then: "Returns true if path is absolute"
    go_original: "filepath.IsAbs(path)"
    zig_implementation: "std.fs.path.isAbsolute"
    test_cases:
      - name: is_abs_unix
        input: "/home/user"
        expected: true
      - name: is_abs_relative
        input: "relative/path"
        expected: false
      - name: is_abs_dot
        input: "./path"
        expected: false

dependency_mapping:
  - go_dep: "path/filepath.Join"
    zig_equiv: "std.fs.path.join"
  - go_dep: "path/filepath.IsAbs"
    zig_equiv: "std.fs.path.isAbsolute"
  - go_dep: "runtime.GOOS"
    zig_equiv: "@import(\"builtin\").os.tag"

metrics:
  go_lines: 24
  zig_lines_estimated: 40
  functions_count: 2
  test_count: 6
  trinity_score: 1.0

signature: "IGLA CRUSH FILEPATHEXT V1.0"
