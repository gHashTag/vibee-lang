# ═══════════════════════════════════════════════════════════════════════════════
# CRUSH STRINGEXT - Транспиляция stringext из charmbracelet/crush
# ═══════════════════════════════════════════════════════════════════════════════
# ⲤⲀⲔⲢⲀ ⲪⲞⲢⲘⲨⲖⲀ: V = n × 3^k × π^m × φ^p × e^q
# ⲌⲞⲖⲞⲦⲀⲒⲀ ⲒⲆⲈⲚⲦⲒⲬⲚⲞⲤⲦⲒ: φ² + 1/φ² = 3
# PHOENIX = 999 = 3³ × 37
# ═══════════════════════════════════════════════════════════════════════════════
# SOURCE: github.com/charmbracelet/crush/internal/stringext/string.go
# ═══════════════════════════════════════════════════════════════════════════════

name: crush_stringext
version: "1.0.0"
author: "Dmitrii Vasilev"
license: "MIT"
language: zig
module: stringext

source_go:
  package: "stringext"
  file: "string.go"
  repository: "github.com/charmbracelet/crush"
  path: "internal/stringext/string.go"

sacred_formula:
  V: "n × 3^k × π^m × φ^p × e^q"
  golden_identity: "φ² + 1/φ² = 3"
  phoenix: 999

constants:
  - name: PHI
    value: 1.618033988749895
    description: "Golden ratio"
  - name: TRINITY
    value: 3.0
    description: "Sacred trinity"

creation_pattern:
  source: "Go stringext module"
  transformer: "VIBEE Transpiler"
  result: "Zig stringext module"

# Original Go code analysis
go_source:
  imports:
    - "strings"
    - "golang.org/x/text/cases"
    - "golang.org/x/text/language"
  
  functions:
    - name: "Capitalize"
      signature: "func Capitalize(text string) string"
      description: "Converts text to title case"
      uses_external: true
      external_dep: "golang.org/x/text/cases"
      
    - name: "ContainsAny"
      signature: "func ContainsAny(str string, args ...string) bool"
      description: "Returns true if str contains any of args"
      uses_external: false
      pure_logic: true

# Zig implementation specification
types:
  - name: StringResult
    kind: struct
    description: "Result of string operation"
    fields:
      - name: value
        type: "[]const u8"
      - name: success
        type: bool

behaviors:
  - name: capitalize
    given: "Input text string"
    when: "capitalize() is called"
    then: "Returns title-cased string"
    go_original: "cases.Title(language.English, cases.Compact).String(text)"
    zig_implementation: "Manual ASCII title case"
    test_cases:
      - name: capitalize_hello
        input: "hello world"
        expected: "Hello World"
      - name: capitalize_empty
        input: ""
        expected: ""
      - name: capitalize_single
        input: "a"
        expected: "A"

  - name: contains_any
    given: "String and variadic args"
    when: "containsAny() is called"
    then: "Returns true if any arg is found in string"
    go_original: "strings.Contains(str, arg)"
    zig_implementation: "std.mem.indexOf"
    test_cases:
      - name: contains_found
        input: ["hello world", ["world", "foo"]]
        expected: true
      - name: contains_not_found
        input: ["hello", ["world", "foo"]]
        expected: false
      - name: contains_empty_args
        input: ["hello", []]
        expected: false

algorithms:
  - name: ascii_title_case
    complexity: "O(n)"
    description: "Convert ASCII string to title case"
    steps:
      - "Iterate through characters"
      - "If previous char is space or start, uppercase current"
      - "Otherwise lowercase"
      - "Return new string"

  - name: contains_any_search
    complexity: "O(n*m) where m = number of args"
    description: "Search for any substring"
    steps:
      - "For each arg in args"
      - "Use std.mem.indexOf to search"
      - "Return true on first match"
      - "Return false if no match"

# Dependencies mapping
dependency_mapping:
  - go_dep: "strings.Contains"
    zig_equiv: "std.mem.indexOf"
    notes: "Direct equivalent"
    
  - go_dep: "golang.org/x/text/cases"
    zig_equiv: "Manual implementation"
    notes: "No Zig equivalent, implement ASCII version"
    limitation: "ASCII only, no Unicode support"

pas_predictions:
  - target: "String operations"
    current: "O(n) linear"
    predicted: "O(n) SIMD"
    speedup: "4x"
    confidence: 0.80
    patterns: [SIMD]
    timeline: "2026"

wasm_exports:
  functions:
    - name: stringext_capitalize
      params: [ptr: i32, len: i32]
      returns: i32
      description: "Capitalize string"
    - name: stringext_contains_any
      params: [str_ptr: i32, str_len: i32, args_ptr: i32, args_count: i32]
      returns: i32
      description: "Check if contains any"

metrics:
  go_lines: 19
  zig_lines_estimated: 45
  functions_count: 2
  test_count: 6
  trinity_score: 1.0
  self_evolution: enabled
  transpilation_coverage: 100%

signature: "IGLA CRUSH STRINGEXT V1.0"
