# Consistency Mapping - Консистентный маппинг идентификаторов
# Гарантирует одинаковое кодирование одинаковых идентификаторов
# Author: Dmitrii Vasilev
# Version: 1.0.0

name: consistency_mapping
version: "1.0.0"
language: 999
module: consistency

# =============================================================================
# CREATION PATTERN
# =============================================================================

creation_pattern:
  source: Identifier
  transformer: ConsistentEncoder
  result: CopticSymbols

# =============================================================================
# ПРИНЦИП КОНСИСТЕНТНОСТИ
# =============================================================================

principle:
  description: |
    КОНСИСТЕНТНОСТЬ означает:
    1. Один идентификатор → всегда один коптский код
    2. Детерминированность: f(x) = f(x) всегда
    3. Глобальная таблица маппинга для всего проекта
    4. Сохранение маппинга между сессиями
    
  rules:
    - "layout" → всегда "ⲖⲀⲨⲞ" (не случайный хеш)
    - "function" → всегда "ⲪⲨⲚⲔ"
    - "module" → всегда "ⲘⲞⲆⲨ"
    - Новые идентификаторы добавляются в таблицу

# =============================================================================
# ФИКСИРОВАННЫЙ МАППИНГ КЛЮЧЕВЫХ СЛОВ
# =============================================================================

fixed_keywords:
  # Управление потоком
  if:       "ⲈⲤ"
  else:     "ⲈⲖ"
  for:      "ⲆⲖ"
  while:    "ⲠⲔ"
  return:   "ⲂⲌ"
  break:    "ⲂⲢ"
  continue: "ⲠⲢ"
  in:       "Ⲃ"
  range:    "ⲆⲀ"
  
  # Объявления
  module:   "Ⲙ"
  function: "Ⲫ"
  struct:   "Ⲥ"
  const:    "Ⲕ"
  var:      "Ⲝ"
  type:     "Ⲧ"
  export:   "Ⲉ"
  import:   "Ⲓ"
  
  # Типы
  int:      "Ⲓ"
  float:    "Ⲫ"
  string:   "Ⲥ"
  bool:     "Ⲃ"
  list:     "Ⲗ"
  map:      "Ⲙ"
  void:     "Ⲱ"
  
  # Литералы
  true:     "Ⲑ"
  false:    "Ⲁ"
  null:     "Ⲱ"

# =============================================================================
# ФИКСИРОВАННЫЙ МАППИНГ ОБЩИХ ИДЕНТИФИКАТОРОВ
# =============================================================================

fixed_identifiers:
  # UI компоненты
  layout:       "ⲖⲀⲨⲞ"
  button:       "ⲂⲦⲚⲔ"
  input:        "ⲒⲚⲠⲦ"
  text:         "ⲦⲈⲜⲦ"
  image:        "ⲒⲘⲀⲄ"
  container:    "ⲔⲞⲚⲦ"
  card:         "ⲔⲀⲢⲆ"
  modal:        "ⲘⲞⲆⲖ"
  navbar:       "ⲚⲀⲂⲢ"
  sidebar:      "ⲤⲒⲆⲂ"
  
  # Действия
  click:        "ⲔⲖⲒⲔ"
  submit:       "ⲤⲂⲘⲦ"
  change:       "ⲬⲚⲄⲈ"
  load:         "ⲖⲞⲀⲆ"
  save:         "ⲤⲀⲂⲈ"
  delete:       "ⲆⲈⲖⲦ"
  update:       "ⲨⲠⲆⲦ"
  create:       "ⲔⲢⲈⲦ"
  
  # Данные
  data:         "ⲆⲀⲦⲀ"
  value:        "ⲂⲀⲖⲨ"
  result:       "ⲢⲈⲤⲖ"
  error:        "ⲈⲢⲢⲢ"
  state:        "ⲤⲦⲀⲦ"
  props:        "ⲠⲢⲞⲠ"
  config:       "ⲔⲞⲚⲪ"
  options:      "ⲞⲠⲦⲤ"
  
  # Генерация
  generate:     "ⲄⲈⲚⲢ"
  render:       "ⲢⲚⲆⲢ"
  transform:    "ⲦⲢⲚⲤ"
  encode:       "ⲈⲚⲔⲆ"
  decode:       "ⲆⲈⲔⲆ"
  parse:        "ⲠⲀⲢⲤ"
  compile:      "ⲔⲘⲠⲖ"
  
  # 3D/WorldGen
  world:        "ⲰⲢⲖⲆ"
  terrain:      "ⲦⲢⲢⲚ"
  object:       "ⲞⲂⲒⲔ"
  scene:        "ⲤⲤⲈⲚ"
  camera:       "ⲔⲀⲘⲢ"
  light:        "ⲖⲒⲄⲦ"
  mesh:         "ⲘⲈⲰⲤ"
  texture:      "ⲦⲈⲜⲢ"
  
  # GNN/ML
  graph:        "ⲄⲢⲀⲪ"
  node:         "ⲚⲞⲆⲈ"
  edge:         "ⲈⲆⲄⲈ"
  layer:        "ⲖⲀⲨⲢ"
  model:        "ⲘⲞⲆⲖ"
  train:        "ⲦⲢⲀⲚ"
  predict:      "ⲠⲢⲈⲆ"
  loss:         "ⲖⲞⲤⲤ"
  
  # Diffusion
  diffusion:    "ⲆⲒⲪⲤ"
  noise:        "ⲚⲞⲒⲤ"
  denoise:      "ⲆⲚⲞⲤ"
  step:         "ⲤⲦⲈⲠ"
  sample:       "ⲤⲘⲠⲖ"
  
  # Gradient
  gradient:     "ⲄⲢⲀⲆ"
  optimize:     "ⲞⲠⲦⲘ"
  minimize:     "ⲘⲒⲚⲘ"
  maximize:     "ⲘⲀⲜⲘ"
  constraint:   "ⲔⲚⲤⲦ"

# =============================================================================
# АЛГОРИТМ КОДИРОВАНИЯ НОВЫХ ИДЕНТИФИКАТОРОВ
# =============================================================================

encoding_algorithm:
  description: |
    Для идентификаторов НЕ в таблице:
    1. Взять первые 4 буквы
    2. Преобразовать каждую в коптский эквивалент
    3. Добавить в таблицу для консистентности
    
  latin_to_coptic:
    a: "Ⲁ"
    b: "Ⲃ"
    c: "Ⲕ"  # C → K звук
    d: "Ⲇ"
    e: "Ⲉ"
    f: "Ⲫ"
    g: "Ⲅ"
    h: "Ⲏ"
    i: "Ⲓ"
    j: "Ⲓ"  # J → I
    k: "Ⲕ"
    l: "Ⲗ"
    m: "Ⲙ"
    n: "Ⲛ"
    o: "Ⲟ"
    p: "Ⲡ"
    q: "Ⲕ"  # Q → K
    r: "Ⲣ"
    s: "Ⲥ"
    t: "Ⲧ"
    u: "Ⲩ"
    v: "Ⲃ"  # V → B
    w: "Ⲱ"
    x: "Ⲭ"
    y: "Ⲩ"  # Y → U
    z: "Ⲍ"

# =============================================================================
# BEHAVIORS
# =============================================================================

behaviors:
  - name: consistent_encoding
    given: "Идентификатор 'layout'"
    when: "Кодирование в коптский"
    then: "Всегда возвращает 'ⲖⲀⲨⲞ'"
    test_cases:
      - input: "layout"
        expected: "ⲖⲀⲨⲞ"
      - input: "layout"
        expected: "ⲖⲀⲨⲞ"  # Повторный вызов = тот же результат
        
  - name: deterministic_new_identifier
    given: "Новый идентификатор 'myCustomVar'"
    when: "Кодирование в коптский"
    then: "Возвращает детерминированный результат"
    test_cases:
      - input: "myCustomVar"
        expected: "ⲘⲨⲔⲨ"  # my -> ⲘⲨ, cu -> ⲔⲨ
        
  - name: keyword_priority
    given: "Ключевое слово 'function'"
    when: "Кодирование"
    then: "Возвращает фиксированный символ Ⲫ"
    test_cases:
      - input: "function"
        expected: "Ⲫ"

# =============================================================================
# VALIDATION
# =============================================================================

validation:
  - name: "no_collisions"
    description: "Разные идентификаторы → разные коды"
    
  - name: "idempotent"
    description: "f(f(x)) = f(x)"
    
  - name: "deterministic"
    description: "Одинаковый вход → одинаковый выход"
