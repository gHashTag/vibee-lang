# ActiveInference - Free Energy Principle and Predictive Coding
# Source: arXiv:2503.21796 - Meta-Representational PC, arXiv:2301.05832 - World Models Survey
# PAS Analysis: PRB (variational inference), ALG (free energy), D&C (hierarchical)

name: active_inference
version: "1.0.0"
language: 999
module: ⲀⲔⲦⲒⲂⲈ_ⲒⲚⲪⲈⲢⲈⲚⲤⲈ

pas_analysis:
  source_paper: "arXiv:2503.21796, arXiv:2301.05832, arXiv:2508.08762"
  current_complexity: "O(n²) full inference"
  theoretical_lower_bound: "O(n) amortized inference"
  gap: "Quadratic to linear via predictive coding"
  patterns_applicable:
    - symbol: PRB
      name: "Probabilistic"
      success_rate: 0.12
      rationale: "Variational Bayesian inference"
    - symbol: ALG
      name: "Algebraic Reorganization"
      success_rate: 0.22
      rationale: "Free energy minimization"
    - symbol: D&C
      name: "Divide-and-Conquer"
      success_rate: 0.31
      rationale: "Hierarchical predictive coding"
    - symbol: PRE
      name: "Precomputation"
      success_rate: 0.16
      rationale: "Pre-trained generative model"
  confidence: 0.74
  predicted_improvement: "Biologically plausible learning"

creation_pattern:
  source: SensoryInput
  transformer: PredictiveCodingNetwork
  result: BeliefState

behaviors:
  - name: predictive_coding
    given: "Sensory observation"
    when: "Minimize prediction error"
    then: "Update internal model"
    test_cases:
      - name: visual_prediction
        input:
          observation: "image"
          hierarchy_levels: 3
        expected:
          prediction_error_reduced: true
          local_learning: true

  - name: active_inference_loop
    given: "Belief state and preferences"
    when: "Select action to minimize expected free energy"
    then: "Execute action, update beliefs"
    test_cases:
      - name: goal_directed
        input:
          goal: "reach_target"
          uncertainty: "high"
        expected:
          exploration: true
          exploitation: true

  - name: meta_representational_pc
    given: "Parallel sensory streams"
    when: "Predict representations across streams"
    then: "Learn self-supervised"
    test_cases:
      - name: mpc_learning
        input:
          streams: 2
          glimpses: 10
        expected:
          no_pixel_prediction: true
          encoder_only: true

  - name: world_model_learning
    given: "Experience sequence"
    when: "Learn dynamics model"
    then: "Predict future states"
    test_cases:
      - name: dreamer_style
        input:
          horizon: 15
          latent_dim: 32
        expected:
          imagination_planning: true
          sample_efficiency: 100

algorithms:
  free_energy:
    formula: "F = E_q[log q(z) - log p(o,z)]"
    decomposition: "F = -log p(o) + KL[q(z)||p(z|o)]"
    minimization: "Gradient descent on F"
    
  predictive_coding:
    forward: "Predictions flow top-down"
    backward: "Errors flow bottom-up"
    learning: "Local Hebbian-like updates"
    
  active_inference:
    perception: "Minimize prediction error"
    action: "Minimize expected free energy"
    planning: "Imagination in generative model"

principles:
  free_energy_principle:
    statement: "Living systems minimize variational free energy"
    author: "Karl Friston"
    implications: ["perception", "action", "learning", "attention"]
    
  predictive_processing:
    statement: "Brain is a prediction machine"
    hierarchy: "Predictions cascade down, errors propagate up"
    
  active_inference:
    statement: "Action and perception unified under free energy"
    exploration: "Epistemic value (information gain)"
    exploitation: "Pragmatic value (goal achievement)"

metrics:
  biological_plausibility: "high"
  local_learning: true
  sample_efficiency: 100
  unified_framework: true
