# VIBEE E2E VSCode v4.0.0
# End-to-end testing for embedded VSCode

name: vibee_e2e_vscode
version: "4.0.0"
language: zig
module: vibee_e2e_vscode

constants:
  PHI: 1.6180339887498948482
  PHOENIX: 999
  EDITOR_READY_TIMEOUT_MS: 10000

types:
  EditorTest:
    fields:
      id: String
      name: String
      file_path: String
      actions: List<Object>

  EditorAction:
    fields:
      type: String
      params: Object

  EditorAssertion:
    fields:
      type: String
      expected: String
      line: Option<Int>

  EditorTestResult:
    fields:
      test_id: String
      passed: Bool
      duration_ms: Float
      error: Option<String>

behaviors:
  - name: create_editor_test
    given: Config
    when: Create
    then: EditorTest ready

  - name: run_editor_test
    given: EditorTest
    when: Execute
    then: EditorTestResult

  - name: open_file
    given: File path
    when: Open
    then: File opened

  - name: type_text
    given: Text
    when: Type
    then: Text inserted

  - name: trigger_completion
    given: Position
    when: Trigger
    then: Completions shown

  - name: select_completion
    given: Index
    when: Select
    then: Completion applied

  - name: format_document
    given: Nothing
    when: Format
    then: Document formatted

  - name: assert_content
    given: Expected content
    when: Check
    then: Assertion result

  - name: assert_diagnostics
    given: Expected count
    when: Check
    then: Assertion result

  - name: assert_cursor_position
    given: Line and column
    when: Check
    then: Assertion result

  - name: undo_redo_test
    given: Actions
    when: Test undo/redo
    then: State correct

  - name: multi_cursor_test
    given: Positions
    when: Test multi-cursor
    then: All cursors work

test_cases:
  - name: test_open_file
    input:
      path: "test.ts"
    expected:
      opened: true

  - name: test_completion
    input:
      trigger: "."
    expected:
      completions_shown: true
