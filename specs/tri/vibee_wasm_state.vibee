# vibee_wasm_state.vibee - WASM State Management
# Centralized state for UI components
# V = n × 3^k × π^m × φ^p × e^q

name: vibee_wasm_state
version: "1.0.0"
language: zig
module: vibee_wasm_state

creation_pattern:
  source: StateSpec
  transformer: StateManager
  result: AppState

constants:
  MAX_PANELS: 16
  MAX_SPLITTERS: 8
  STATE_IDLE: 0
  STATE_DRAGGING: 1
  STATE_RESIZING: 2
  STATE_ANIMATING: 3

types:
  AppState:
    fields:
      width: Float
      height: Float
      state_code: Int
      dirty: Bool
      frame_count: Int

  PanelState:
    fields:
      id: Int
      x: Float
      y: Float
      width: Float
      height: Float
      visible: Bool

  SplitterState:
    fields:
      id: Int
      position: Float
      dragging: Bool

  StateSnapshot:
    fields:
      timestamp: Int
      panel_count: Int
      splitter_count: Int

behaviors:
  - name: init_state
    given: Width and height
    when: Initialize
    then: AppState created

  - name: get_state
    given: Nothing
    when: Query
    then: Current AppState

  - name: set_dimensions
    given: Width and height
    when: Resize
    then: Dimensions updated

  - name: set_state_code
    given: State code
    when: Transition
    then: State changed

  - name: mark_dirty
    given: Nothing
    when: Change detected
    then: Dirty flag set

  - name: clear_dirty
    given: Nothing
    when: Render complete
    then: Dirty flag cleared

  - name: is_dirty
    given: Nothing
    when: Check
    then: Dirty status

  - name: increment_frame
    given: Nothing
    when: Frame tick
    then: Frame count incremented

  - name: create_snapshot
    given: Nothing
    when: Save state
    then: StateSnapshot created
