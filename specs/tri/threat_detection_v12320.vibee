# VIBEE Specification v12320
# Threat Detection - Real-time threat detection and response
name: threat_detection_v12320
version: "1.0.0"
language: zig
module: threat_detection

types:
  ThreatType:
    fields:
      intrusion: String
      malware: String
      data_exfiltration: String
      anomalous_behavior: String

  Threat:
    fields:
      id: String
      type: String
      source: String
      target: String
      severity: String
      detected_at: Timestamp

  ThreatIndicator:
    fields:
      id: String
      type: String
      value: String
      confidence: Float

  ThreatResponse:
    fields:
      threat_id: String
      action: String
      automated: Bool
      executed_at: Timestamp

  DetectionRule:
    fields:
      id: String
      name: String
      pattern: String
      action: String
      enabled: Bool

behaviors:
  - name: create_rule
    given: Rule configuration
    when: Rule created
    then: Returns detection rule

  - name: detect_threat
    given: Event data
    when: Threat detected
    then: Returns threat with indicators

  - name: respond_to_threat
    given: Threat and action
    when: Response executed
    then: Returns threat response

  - name: add_indicator
    given: Indicator data
    when: Indicator added
    then: Returns threat indicator
