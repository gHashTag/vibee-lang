# iGLA Training Metrics
# Training monitoring and logging
# φ² + 1/φ² = 3 | V = n × 3^k × π^m × φ^p

name: igla_training_metrics
version: "1.0.0"
language: zig
module: igla_training_metrics

sacred_constants:
  phi: 1.618033988749895
  trinity: 3.0
  phoenix: 999

types:
  MetricsConfig:
    fields:
      log_interval: Int
      eval_interval: Int
      save_interval: Int
      wandb_project: String

  TrainingMetrics:
    fields:
      step: Int
      loss: Float
      perplexity: Float
      learning_rate: Float
      grad_norm: Float
      tokens_per_sec: Float

  EvalMetrics:
    fields:
      val_loss: Float
      val_perplexity: Float
      downstream_scores: Object

  ResourceMetrics:
    fields:
      gpu_memory_gb: Float
      gpu_utilization: Float
      throughput_tps: Float
      mfu: Float

behaviors:
  - name: log_training
    given: "Training state"
    when: "Log interval"
    then: "Metrics logged to wandb"

  - name: compute_mfu
    given: "Throughput"
    when: "MFU computation"
    then: "Model FLOPS utilization"

  - name: track_loss
    given: "Loss history"
    when: "Loss tracking"
    then: "Loss curve tracked"

  - name: evaluate_downstream
    given: "Checkpoints"
    when: "Downstream eval"
    then: "Benchmark scores computed"

  - name: alert_anomaly
    given: "Metrics"
    when: "Anomaly detection"
    then: "Loss spikes detected"

  - name: compute_eta
    given: "Progress"
    when: "ETA"
    then: "Training completion estimate"

  - name: phi_metrics_harmony
    given: "All metrics"
    when: "Harmony"
    then: "φ-weighted progress score"
