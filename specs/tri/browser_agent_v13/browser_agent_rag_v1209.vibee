# VIBEE YOLO MODE XIII - browser_agent_rag v1209
# RAG Retrieval - Retrieval Augmented Generation
# Reference: Lewis et al. (2020) - RAG
name: browser_agent_rag_v1209
version: "13.0.0"
language: zig
module: browser_agent_rag

sacred_constants:
  phi: 1.618033988749895
  phi_identity: 3
  phoenix: 999
  yolo_mode: 13

types:
  RAGConfig:
    fields:
      embedding_model: String
      chunk_size: Int
      overlap: Int
      top_k: Int

  Document:
    fields:
      id: String
      content: String
      metadata: Map<String,String>
      embedding: List<Float>

  RetrievalResult:
    fields:
      documents: List<String>
      scores: List<Float>
      total_found: Int

  RAGContext:
    fields:
      query: String
      retrieved_docs: List<String>
      augmented_prompt: String

behaviors:
  - name: index_document
    given: Document
    when: Index
    then: Document indexed with embeddings
  - name: retrieve
    given: Query
    when: Retrieve
    then: Top-k documents retrieved
  - name: augment_prompt
    given: RAGContext
    when: Augment
    then: Prompt augmented with context
  - name: rerank
    given: RetrievalResult
    when: Rerank
    then: Results reranked by relevance
  - name: hybrid_search
    given: Query
    when: Search
    then: Hybrid semantic + keyword search

test_cases:
  - name: test_rag_index
    input: {content: "test doc"}
    expected: {indexed: true}
  - name: test_rag_retrieve
    input: {query: "search"}
    expected: {retrieved: true}
  - name: test_rag_augment
    input: {docs: 3}
    expected: {augmented: true}
  - name: test_rag_rerank
    input: {results: 10}
    expected: {reranked: true}
  - name: test_phi_rag
    input: {phi: 1.618033988749895}
    expected: {identity: 3}
