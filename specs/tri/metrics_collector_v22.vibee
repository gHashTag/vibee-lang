name: metrics_collector_v22
version: "22.6.0"
language: zig
module: metrics_collector_v22

types:
  MetricType:
    fields:
      name: String

  Counter:
    fields:
      name: String
      value: Int
      labels: Object

  Gauge:
    fields:
      name: String
      value: Float
      labels: Object

  Histogram:
    fields:
      name: String
      buckets: List<String>
      count: Int
      sum: Float

  MetricsCollector:
    fields:
      counters: Object
      gauges: Object
      histograms: Object

behaviors:
  - name: create_collector
    given: Config
    when: Initialize collector
    then: MetricsCollector instance

  - name: inc_counter
    given: MetricsCollector and name
    when: Increment counter
    then: Incremented

  - name: set_gauge
    given: MetricsCollector and name and value
    when: Set gauge
    then: Gauge set

  - name: observe_histogram
    given: MetricsCollector and name and value
    when: Observe value
    then: Observed

  - name: get_counter
    given: MetricsCollector and name
    when: Get counter
    then: Counter value

  - name: get_gauge
    given: MetricsCollector and name
    When: Get gauge
    then: Gauge value

  - name: get_histogram
    given: MetricsCollector and name
    When: Get histogram
    then: Histogram

  - name: export_prometheus
    given: MetricsCollector
    When: Export Prometheus format
    then: Prometheus string

  - name: reset
    given: MetricsCollector
    When: Reset all metrics
    then: Reset complete

  - name: get_all
    given: MetricsCollector
    When: Get all metrics
    then: All metrics
