# Error Recovery Module
# Timeout, element not found, network errors
# Graceful degradation

name: browser_error_recovery
version: "1.0.0"
language: zig
module: browser_error_recovery

types:
  BrowserError:
    fields:
      error_id: String
      error_type: String
      message: String
      selector: Option<String>
      url: Option<String>
      timestamp: Timestamp

  RecoveryStrategy:
    fields:
      strategy_id: String
      error_type: String
      max_retries: Int
      backoff_ms: Int
      fallback_action: Option<String>

  RecoveryResult:
    fields:
      success: Bool
      attempts: Int
      final_error: Option<String>
      recovery_action: String

  ErrorPattern:
    fields:
      pattern_id: String
      error_regex: String
      frequency: Int
      last_seen: Timestamp

  CircuitBreaker:
    fields:
      breaker_id: String
      failure_threshold: Int
      reset_timeout_ms: Int
      state: String

behaviors:
  - name: handle_timeout
    given: Timeout error and strategy
    when: Timeout recovery needed
    then: Returns recovery result

  - name: handle_element_not_found
    given: Selector error and strategy
    when: Element recovery needed
    then: Returns recovery result

  - name: handle_navigation_error
    given: Navigation error and strategy
    when: Navigation recovery needed
    then: Returns recovery result

  - name: handle_network_error
    given: Network error and strategy
    when: Network recovery needed
    then: Returns recovery result

  - name: retry_with_backoff
    given: Action and retry config
    when: Retry needed
    then: Returns final result

  - name: check_circuit_breaker
    given: Circuit breaker
    When: Breaker check needed
    then: Returns whether to proceed

  - name: record_error
    given: Error details
    when: Error logging needed
    then: Returns recorded error

  - name: get_error_patterns
    given: Time range
    when: Pattern analysis needed
    then: Returns error patterns
