# ═══════════════════════════════════════════════════════════════════════════════
# CODEGEN SQL v1129 - SQL Schema Generator
# ═══════════════════════════════════════════════════════════════════════════════
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════

name: codegen_sql
version: "11.2.9"
language: zig
module: codegen_sql

sacred_constants:
  phi: 1.618033988749895
  trinity: 3.0
  phoenix: 999

creation_pattern:
  source: VIBEESpec
  transformer: SQLCodeGen
  result: SQLSchema

types:
  SQLTable:
    fields:
      name: String
      columns: List<SQLColumn>
      primary_key: List<String>
      indexes: List<SQLIndex>

  SQLColumn:
    fields:
      name: String
      data_type: SQLType
      nullable: Bool
      default_value: Option<String>

  SQLType:
    enum:
      - INTEGER
      - BIGINT
      - TEXT
      - VARCHAR
      - BOOLEAN
      - TIMESTAMP
      - JSON
      - FLOAT
      - DOUBLE

  SQLIndex:
    fields:
      name: String
      columns: List<String>
      unique: Bool

behaviors:
  - name: generate_table
    given: "VIBEE type"
    when: "Table generation"
    then: "CREATE TABLE"
    pas_pattern: PRE
    test_cases:
      - name: test_table
        input: '{"type": {"name": "users"}}'
        expected: '{"code": "CREATE TABLE users"}'

  - name: generate_index
    given: "Index definition"
    when: "Index generation"
    then: "CREATE INDEX"
    pas_pattern: PRE
    test_cases:
      - name: test_index
        input: '{"index": {"name": "idx_email"}}'
        expected: '{"code": "CREATE INDEX"}'

  - name: generate_migration
    given: "Schema diff"
    when: "Migration generation"
    then: "ALTER TABLE"
    pas_pattern: ALG
    test_cases:
      - name: test_migration
        input: '{"diff": {...}}'
        expected: '{"code": "ALTER TABLE"}'

type_mappings:
  String: "TEXT"
  Int: "BIGINT"
  Float: "DOUBLE"
  Bool: "BOOLEAN"
  Timestamp: "TIMESTAMP"
  Object: "JSON"

# ═══════════════════════════════════════════════════════════════════════════════
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════
