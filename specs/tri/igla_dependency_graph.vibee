# VIBEE Specification - IGLA Dependency Graph
# Code dependency analysis
# V = n × 3^k × π^m × φ^p | φ² + 1/φ² = 3 | PHOENIX = 999

name: igla_dependency_graph
version: "1.0.0"
language: zig
module: igla_dependency_graph

types:
  DependencyNode:
    fields:
      id: String
      name: String
      node_type: String
      file_path: String

  DependencyEdge:
    fields:
      from_id: String
      to_id: String
      edge_type: String

  DependencyGraph:
    fields:
      nodes: String
      edges: String
      node_count: Int
      edge_count: Int

  GraphConfig:
    fields:
      include_external: Bool
      max_depth: Int
      group_by_module: Bool

  GraphMetrics:
    fields:
      graphs_built: Int
      avg_nodes: Float
      cycles_detected: Int

behaviors:
  - name: build_graph
    given: Codebase
    when: Graph building
    then: Dependency graph created

  - name: find_dependencies
    given: Module
    when: Dependency search
    then: Dependencies found

  - name: find_dependents
    given: Module
    when: Dependent search
    then: Dependents found

  - name: detect_cycles
    given: Graph
    when: Cycle detection
    then: Cycles identified

  - name: get_impact
    given: Module
    when: Impact analysis
    then: Affected modules returned

  - name: get_metrics
    given: Graph builder
    when: Metrics requested
    then: Graph metrics returned

test_cases:
  - name: test_build
    input: { path: "./src" }
    expected: { has_graph: true }

  - name: test_dependencies
    input: { module: "main" }
    expected: { has_deps: true }

  - name: test_cycles
    input: { graph: "test_graph" }
    expected: { checked: true }

  - name: test_metrics
    input: {}
    expected: { graphs_built: 0 }
