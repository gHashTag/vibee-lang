# ═══════════════════════════════════════════════════════════════════════════════
# CRYPTO BENCHMARK SUITE - PERFORMANCE MEASUREMENT
# ═══════════════════════════════════════════════════════════════════════════════
# Автор: Дмитрий Васильев
# Версия: 1.0.0
# Священная формула: V = n × 3^k × π^m × φ^p × e^q
# Золотая идентичность: φ² + 1/φ² = 3
#
# Комплексный бенчмаркинг криптографических операций:
# - Throughput (MB/s, ops/s)
# - Latency (ns, μs, ms)
# - Memory usage
# - Сравнение с конкурентами
# ═══════════════════════════════════════════════════════════════════════════════

name: crypto_benchmark
version: "1.0.0"
language: zig
module: crypto_benchmark

sacred_constants:
  phi: 1.618033988749895
  psi: 3.0
  golden_identity: "φ² + 1/φ² = 3"

creation_pattern:
  source: CryptographicOperation
  transformer: PerformanceMeasurement
  result: BenchmarkReport

# ═══════════════════════════════════════════════════════════════════════════════
# ТИПЫ
# ═══════════════════════════════════════════════════════════════════════════════

types:
  BenchmarkSample:
    fields:
      duration_ns: Int
      cpu_cycles: Int
      memory_bytes: Int
    description: "Единичное измерение"

  BenchmarkResult:
    fields:
      operation: String
      input_size: Int
      iterations: Int
      mean_ns: Float
      std_dev_ns: Float
      min_ns: Int
      max_ns: Int
      throughput_mbps: Float
      ops_per_second: Float
    description: "Результат бенчмарка"

  ComparisonResult:
    fields:
      operation: String
      implementations: List<String>
      results: List<BenchmarkResult>
      fastest: String
      speedup: Float
    description: "Сравнение реализаций"

  ScalabilityResult:
    fields:
      operation: String
      input_sizes: List<Int>
      throughputs: List<Float>
      complexity: String
    description: "Результат теста масштабируемости"

  BenchmarkConfig:
    fields:
      warmup_iterations: Int
      measurement_iterations: Int
      input_sizes: List<Int>
    description: "Конфигурация бенчмарка"

  BenchmarkReport:
    fields:
      timestamp: Int
      results: List<BenchmarkResult>
      comparisons: List<ComparisonResult>
      scalability: List<ScalabilityResult>
    description: "Полный отчёт"

# ═══════════════════════════════════════════════════════════════════════════════
# АЛГОРИТМЫ
# ═══════════════════════════════════════════════════════════════════════════════

algorithms:
  measure_operation:
    description: "Точное измерение операции"
    complexity: "O(iterations)"
    pattern: "Measurement"
    steps:
      - "Прогрев (warmup)"
      - "Для каждой итерации: измерить время"
      - "Вычислить статистики"

  compute_throughput:
    description: "Вычисление throughput"
    complexity: "O(1)"
    pattern: "Calculation"
    steps:
      - "throughput = bytes / time"

  test_scalability:
    description: "Тест масштабируемости"
    complexity: "O(sizes * iterations)"
    pattern: "Analysis"
    steps:
      - "Для каждого размера: измерить"
      - "Оценить сложность"

# ═══════════════════════════════════════════════════════════════════════════════
# ПОВЕДЕНИЯ
# ═══════════════════════════════════════════════════════════════════════════════

behaviors:
  - name: aes_gcm_throughput
    given: "AES-256-GCM реализация"
    when: "Бенчмарк 1MB"
    then: "Throughput >= 1 GB/s"
    test_cases:
      - name: "aes_1mb"
        input:
          size: 1048576
        expected:
          throughput_mbps: 1000

  - name: ml_kem_latency
    given: "ML-KEM-1024"
    when: "Бенчмарк keygen"
    then: "Latency < 1ms"
    test_cases:
      - name: "keygen"
        input:
          iterations: 1000
        expected:
          mean_ms: 1.0

  - name: sha3_throughput
    given: "SHA3-256"
    when: "Бенчмарк 1MB"
    then: "Throughput >= 100 MB/s"
    test_cases:
      - name: "sha3_1mb"
        input:
          size: 1048576
        expected:
          throughput_mbps: 100

  - name: warmup_stabilizes
    given: "Холодный кэш"
    when: "Warmup выполнен"
    then: "Variance уменьшается"
    test_cases:
      - name: "warmup"
        input:
          warmup: 100
        expected:
          cv: 0.1

  - name: linear_scaling
    given: "O(n) операция"
    when: "Тест масштабируемости"
    then: "Throughput константен"
    test_cases:
      - name: "scaling"
        input:
          sizes: [1024, 1048576]
        expected:
          linear: true

# ═══════════════════════════════════════════════════════════════════════════════
# PAS АНАЛИЗ
# ═══════════════════════════════════════════════════════════════════════════════

pas_analysis:
  module: "crypto_benchmark"

  predictions:
    - target: "AES-GCM throughput"
      current: "5 GB/s"
      predicted: "20 GB/s"
      confidence: 0.90
      patterns: [PRE, D&C]
      timeline: "2026"

    - target: "ML-KEM latency"
      current: "0.5 ms"
      predicted: "0.05 ms"
      confidence: 0.85
      patterns: [PRE, D&C]
      timeline: "2026"

# ═══════════════════════════════════════════════════════════════════════════════
# OUTPUT
# ═══════════════════════════════════════════════════════════════════════════════

output:
  directory: "trinity/output"
  files:
    - "crypto_benchmark.zig"

metadata:
  creation_date: "2026-01-20"
  author: "Dmitrii Vasilev"
  sacred_formula: "V = n × 3^k × π^m × φ^p × e^q"
  golden_identity: "φ² + 1/φ² = 3"
