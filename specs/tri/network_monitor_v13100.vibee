# Network Monitor v13100
# Full network traffic monitoring
# VIBEE v13100 | φ² + 1/φ² = 3 | PHOENIX = 999

name: network_monitor_v13100
version: "13100.0.0"
language: zig
module: network_monitor

types:
  NetworkRequest:
    fields:
      request_id: String
      url: String
      method: String
      headers: String
      post_data: String
      
  NetworkResponse:
    fields:
      request_id: String
      status: Int
      headers: String
      body_size: Int
      
  NetworkTiming:
    fields:
      dns_ms: Float
      connect_ms: Float
      ssl_ms: Float
      ttfb_ms: Float
      download_ms: Float

behaviors:
  - name: capture_requests
    given: "Network monitoring enabled"
    when: "Request made"
    then: "Request captured"
    
  - name: capture_responses
    given: "Response received"
    when: "Response complete"
    then: "Response captured with body"
    
  - name: get_timing
    given: "Request completed"
    when: "Timing requested"
    then: "Detailed timing returned"
    
  - name: block_requests
    given: "Block pattern set"
    when: "Matching request"
    then: "Request blocked"
    
  - name: modify_headers
    given: "Header rules set"
    when: "Request/response"
    then: "Headers modified"
