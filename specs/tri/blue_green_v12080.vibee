name: blue_green_v12080
version: "12080"
language: zig
module: blue_green
types:
  BlueGreenConfig:
    fields:
      switch_strategy: SwitchStrategy
      health_check_interval: Int
      warmup_time: Int
  SwitchStrategy:
    variants:
      - instant
      - gradual
      - scheduled
  Environment:
    fields:
      env_id: String
      color: String
      version: String
      status: EnvStatus
      traffic_percentage: Float
  EnvStatus:
    variants:
      - active
      - standby
      - deploying
      - draining
behaviors:
  - name: deploy_to_standby
    given: New version
    when: Deploying
    then: Returns deployment status
  - name: run_health_checks
    given: Environment
    when: Checking health
    then: Returns health status
  - name: switch_traffic
    given: Target environment
    when: Switching
    then: Returns switch status
  - name: drain_connections
    given: Old environment
    when: Draining
    then: Returns drain status
  - name: rollback_switch
    given: Failed switch
    when: Rolling back
    then: Returns rollback status
  - name: get_active_env
    given: Service
    when: Getting active
    then: Returns active environment
  - name: cleanup_old_env
    given: Drained environment
    when: Cleaning up
    then: Returns cleanup status
  - name: schedule_switch
    given: Time and target
    when: Scheduling
    then: Returns scheduled switch
creation_pattern:
  source: DeploymentRequest
  transformer: BlueGreenManager
  result: Environment
