# instanced_render_v2656.vibee - Instanced Rendering
# Инстансный рендеринг для массовых объектов
# φ² + 1/φ² = 3 | PHOENIX = 999

name: instanced_render_v2656
version: "2656.0.0"
language: zig
module: instanced_render_v2656

types:
  InstanceData:
    fields:
      transform: Object
      color: Object
      custom_data: Object

  InstanceBuffer:
    fields:
      buffer_id: String
      instance_count: Int
      stride: Int
      dynamic: Bool

  InstanceBatch:
    fields:
      mesh_id: String
      material_id: String
      instances: List
      max_instances: Int

  InstanceStats:
    fields:
      total_instances: Int
      draw_calls_saved: Int
      batches_used: Int
      gpu_memory_kb: Int

  InstanceConfig:
    fields:
      max_instances_per_batch: Int
      frustum_cull: Bool
      lod_enabled: Bool
      dynamic_batching: Bool

behaviors:
  - name: create_batch
    given: Mesh and material
    when: Batch creation
    then: Return InstanceBatch

  - name: add_instance
    given: InstanceData
    when: Instance add
    then: Add to batch

  - name: update_instance
    given: Index and data
    when: Instance update
    then: Update buffer

  - name: draw_instanced
    given: InstanceBatch
    when: Render
    then: Single draw call

  - name: get_stats
    given: None
    when: Stats query
    then: Return InstanceStats

sacred_constants:
  phi: 1.618033988749895
  phoenix: 999
