name: multi_model_provider_v22
version: "22.2.0"
language: zig
module: multi_model_provider_v22

types:
  ProviderType:
    fields:
      name: String

  ModelConfig:
    fields:
      provider: String
      model_name: String
      api_key: String
      endpoint: String
      max_tokens: Int
      temperature: Float
      supports_vision: Bool

  ChatMessage:
    fields:
      role: String
      content: String
      image_url: Option<String>

  ChatRequest:
    fields:
      messages: List<String>
      model: String
      max_tokens: Int
      temperature: Float

  ChatResponse:
    fields:
      content: String
      model: String
      tokens_used: Int
      finish_reason: String
      latency_ms: Int

  ProviderStatus:
    fields:
      provider: String
      available: Bool
      models: List<String>
      rate_limit_remaining: Int

  ProviderMetrics:
    fields:
      total_requests: Int
      total_tokens: Int
      avg_latency_ms: Float
      error_count: Int
      cost_usd: Float

behaviors:
  - name: create_provider
    given: ModelConfig
    when: Initialize provider
    then: Provider instance

  - name: chat
    given: Provider and ChatRequest
    when: Send chat request
    then: ChatResponse

  - name: chat_with_vision
    given: Provider, messages, and image
    when: Send vision request
    then: ChatResponse

  - name: list_models
    given: Provider
    when: Get available models
    then: Model list

  - name: check_status
    given: Provider
    when: Check availability
    then: ProviderStatus

  - name: set_model
    given: Provider and model name
    when: Switch model
    then: Updated provider

  - name: get_metrics
    given: Provider
    when: Get usage stats
    then: ProviderMetrics

  - name: estimate_cost
    given: Token count
    when: Calculate cost
    then: Cost in USD

  - name: create_ollama
    given: Endpoint
    when: Create Ollama provider
    then: Ollama provider

  - name: create_openai
    given: API key
    when: Create OpenAI provider
    then: OpenAI provider

  - name: create_anthropic
    given: API key
    when: Create Anthropic provider
    then: Anthropic provider
