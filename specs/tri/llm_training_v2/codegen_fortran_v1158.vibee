# ═══════════════════════════════════════════════════════════════════════════════
# CODEGEN FORTRAN v1158 - Fortran Code Generator
# ═══════════════════════════════════════════════════════════════════════════════
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════

name: codegen_fortran
version: "11.5.8"
language: zig
module: codegen_fortran

sacred_constants:
  phi: 1.618033988749895
  trinity: 3.0
  phoenix: 999

creation_pattern:
  source: VIBEESpec
  transformer: FortranCodeGen
  result: FortranCode

types:
  FortranModule:
    fields:
      name: String
      subroutines: List<FortranSubroutine>
      functions: List<FortranFunction>

  FortranSubroutine:
    fields:
      name: String
      params: List<FortranParam>
      body: String

  FortranFunction:
    fields:
      name: String
      params: List<FortranParam>
      return_type: String
      body: String

  FortranParam:
    fields:
      name: String
      param_type: String
      intent: String

behaviors:
  - name: generate_module
    given: "VIBEE spec"
    when: "Module generation"
    then: "Fortran module"
    pas_pattern: PRE
    test_cases:
      - name: test_module
        input: '{"spec": {...}}'
        expected: '{"code": "MODULE..."}'

  - name: generate_subroutine
    given: "VIBEE behavior"
    when: "Subroutine generation"
    then: "Fortran subroutine"
    pas_pattern: PRE
    test_cases:
      - name: test_sub
        input: '{"behavior": {...}}'
        expected: '{"code": "SUBROUTINE..."}'

  - name: generate_array_ops
    given: "Array operations"
    when: "Array generation"
    then: "Fortran array code"
    pas_pattern: ALG
    test_cases:
      - name: test_array
        input: '{"op": "matmul"}'
        expected: '{"code": "MATMUL(...)"}'

fortran_type_mappings:
  vibee_string: "CHARACTER(LEN=*)"
  vibee_int: "INTEGER(8)"
  vibee_float: "REAL(8)"
  vibee_bool: "LOGICAL"

# ═══════════════════════════════════════════════════════════════════════════════
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════
