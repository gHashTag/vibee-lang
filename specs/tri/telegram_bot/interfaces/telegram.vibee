name: telegram
version: "1.0.0"
language: zig
module: telegram

description: |
  Telegram bot interface definitions for VIBEE.
  Defines context, message types, and callback structures.

types:
  MyContext:
    description: "Extended Telegraf context with session"
    fields:
      chat_id: Int
      from_id: Int
      message_id: Int
      session: UserSession
      scene: Option<SceneContext>
      bot_name: String

  SceneContext:
    description: "Scene context for wizard flows"
    fields:
      current: String
      state: Object
      history: List<String>

  TelegramMessage:
    description: "Telegram message structure"
    fields:
      message_id: Int
      chat_id: Int
      from_id: Int
      text: Option<String>
      photo: Option<List<PhotoSize>>
      video: Option<VideoInfo>
      voice: Option<VoiceInfo>
      document: Option<DocumentInfo>
      date: Timestamp

  PhotoSize:
    description: "Photo size information"
    fields:
      file_id: String
      file_unique_id: String
      width: Int
      height: Int
      file_size: Option<Int>

  VideoInfo:
    description: "Video information"
    fields:
      file_id: String
      file_unique_id: String
      width: Int
      height: Int
      duration: Int
      file_size: Option<Int>

  VoiceInfo:
    description: "Voice message information"
    fields:
      file_id: String
      file_unique_id: String
      duration: Int
      mime_type: Option<String>
      file_size: Option<Int>

  DocumentInfo:
    description: "Document information"
    fields:
      file_id: String
      file_unique_id: String
      file_name: Option<String>
      mime_type: Option<String>
      file_size: Option<Int>

  CallbackQuery:
    description: "Callback query from inline keyboard"
    fields:
      id: String
      from_id: Int
      chat_id: Int
      message_id: Int
      data: String

  InlineKeyboardButton:
    description: "Inline keyboard button"
    fields:
      text: String
      callback_data: Option<String>
      url: Option<String>

  InlineKeyboardMarkup:
    description: "Inline keyboard markup"
    fields:
      inline_keyboard: List<List<InlineKeyboardButton>>

  ReplyKeyboardButton:
    description: "Reply keyboard button"
    fields:
      text: String
      request_contact: Bool
      request_location: Bool

  ReplyKeyboardMarkup:
    description: "Reply keyboard markup"
    fields:
      keyboard: List<List<ReplyKeyboardButton>>
      resize_keyboard: Bool
      one_time_keyboard: Bool

behaviors:
  - name: send_message
    given: Chat ID and text
    when: Sending text message
    then: Returns sent message

  - name: send_photo
    given: Chat ID and photo
    when: Sending photo
    then: Returns sent message

  - name: send_video
    given: Chat ID and video
    when: Sending video
    then: Returns sent message

  - name: send_voice
    given: Chat ID and voice
    when: Sending voice message
    then: Returns sent message

  - name: edit_message_text
    given: Chat ID, message ID, and new text
    when: Editing message
    then: Returns edited message

  - name: answer_callback_query
    given: Callback query ID and text
    when: Answering callback
    then: Returns success status

  - name: send_chat_action
    given: Chat ID and action type
    when: Showing typing indicator
    then: Returns success status

  - name: get_file
    given: File ID
    when: Downloading file
    then: Returns file path
