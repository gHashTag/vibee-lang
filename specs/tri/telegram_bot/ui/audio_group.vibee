name: audio_group
version: "3.0.0"
language: zig
module: audio_group

description: |
  ğŸ¤ AUDIO GROUP - All Audio Functions
  
  Trinity Formula: V = n Ã— 3^k where k=2 (Secondary Level)
  Golden Layout: 3 columns, Ï†-based spacing
  
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ğŸ¤ ĞĞ£Ğ”Ğ˜Ğ / AUDIO                                           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                             â”‚
  â”‚  ğŸ—£ï¸ Ğ“Ğ¾Ğ»Ğ¾Ñ Ğ°Ğ²Ğ°Ñ‚Ğ°Ñ€Ğ°  ğŸ”Š Ğ¢ĞµĞºÑÑ‚â†’Ğ“Ğ¾Ğ»Ğ¾Ñ   ğŸ“ Ğ“Ğ¾Ğ»Ğ¾Ñâ†’Ğ¢ĞµĞºÑÑ‚         â”‚
  â”‚     56â­              8â­               3â­                  â”‚
  â”‚                                                             â”‚
  â”‚  ğŸ™ï¸ ĞšĞ»Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ    ğŸµ ĞœĞ¾Ğ¸ Ğ³Ğ¾Ğ»Ğ¾ÑĞ°     ğŸ”ˆ Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ³Ğ¾Ğ»Ğ¾Ñ      â”‚
  â”‚     100â­             Ğ±ĞµÑĞ¿Ğ»Ğ°Ñ‚Ğ½Ğ¾         Ğ±ĞµÑĞ¿Ğ»Ğ°Ñ‚Ğ½Ğ¾           â”‚
  â”‚                                                             â”‚
  â”‚  ğŸ§ ĞÑƒĞ´Ğ¸Ğ¾ ÑÑ„Ñ„ĞµĞºÑ‚Ñ‹  ğŸ¼ ĞœÑƒĞ·Ñ‹ĞºĞ°â†’Ğ¢ĞµĞºÑÑ‚  ğŸ—‘ï¸ Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ³Ğ¾Ğ»Ğ¾Ñ       â”‚
  â”‚     5â­               3â­               Ğ±ĞµÑĞ¿Ğ»Ğ°Ñ‚Ğ½Ğ¾           â”‚
  â”‚                                                             â”‚
  â”‚  â—€ï¸ ĞĞ°Ğ·Ğ°Ğ´                              ğŸ  ĞœĞµĞ½Ñ              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

imports:
  - trinity_menu_system
  - ux_design_system

types:
  AudioFunction:
    description: "Audio function type"
    variants:
      - VoiceAvatar        # Create voice clone (84 stars)
      - TextToSpeech       # Generate speech (11 stars)
      - FastTTS            # Fast TTS chatterbox-turbo (2 stars/1000 chars) NEW
      - SpeechToText       # Transcribe audio (7 stars)
      - VoiceClone         # Clone voice (84 stars)
      - MusicGeneration    # Generate music (3 stars/30s) NEW
      - MyVoices           # View cloned voices (free)
      - SelectVoice        # Choose active voice (free)
      - AudioEffects       # Apply effects (5 stars)
      - MusicToText        # Transcribe music (3 stars)
      - DeleteVoice        # Remove voice (free)

  VoiceInfo:
    description: "Cloned voice information"
    fields:
      id: String
      name: String
      voice_id: String
      language: String
      created_at: Timestamp
      is_active: Bool
      preview_url: Option<String>

  AudioState:
    description: "User's audio state"
    fields:
      has_voice: Bool
      active_voice_id: Option<String>
      voices_count: Int
      total_generations: Int

  TTSRequest:
    description: "Text-to-speech request"
    fields:
      text: String
      voice_id: String
      language: String
      speed: Float
      telegram_id: String

  STTRequest:
    description: "Speech-to-text request"
    fields:
      audio_url: String
      language: Option<String>
      telegram_id: String

behaviors:
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # GROUP MENU
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - name: show_audio_menu
    given: Context and audio state
    when: User enters audio group
    then: Shows all audio functions with voice status

  - name: handle_audio_selection
    given: Context and function ID
    when: User selects function
    then: Starts appropriate wizard

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # AUDIO FUNCTIONS
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - name: start_voice_avatar
    given: Context
    when: User selects Voice Avatar
    then: Starts voice creation wizard

  - name: start_text_to_speech
    given: Context
    when: User selects Text to Speech
    then: Starts TTS wizard

  - name: start_speech_to_text
    given: Context
    when: User selects Speech to Text
    then: Starts STT wizard

  - name: start_voice_clone
    given: Context
    when: User selects Voice Clone
    then: Starts voice cloning wizard

  - name: show_my_voices
    given: Context
    when: User selects My Voices
    then: Shows list of cloned voices

  - name: show_voice_selection
    given: Context
    when: User selects Select Voice
    then: Shows available voices

  - name: start_audio_effects
    given: Context
    when: User selects Audio Effects
    then: Starts effects wizard

  - name: start_music_to_text
    given: Context
    when: User selects Music to Text
    then: Starts music transcription

  - name: confirm_delete_voice
    given: Context and voice ID
    when: User selects Delete
    then: Shows confirmation dialog

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # VOICE MANAGEMENT
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - name: get_user_voices
    given: User ID
    when: Fetching voices
    then: Returns list of VoiceInfo

  - name: set_active_voice
    given: User ID and voice ID
    when: Changing active voice
    then: Updates active voice

  - name: delete_voice
    given: Voice ID
    when: Deleting voice
    then: Removes voice from system

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # KEYBOARD BUILDER
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - name: build_audio_keyboard
    given: Language and audio state
    when: Building menu keyboard
    then: Returns 3-column audio functions grid

  - name: build_voices_keyboard
    given: Voices list and language
    when: Building voice selection
    then: Returns voices list with active indicator

constants:
  GROUP_ID: "audio"
  GROUP_EMOJI: "ğŸ¤"
  GROUP_NAME_RU: "ĞĞ£Ğ”Ğ˜Ğ"
  GROUP_NAME_EN: "AUDIO"
  GROUP_COLOR: "#F39C12"

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # AUDIO FUNCTIONS (9 items = 3Â² for Trinity)
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  FUNCTIONS:
    VOICE_AVATAR:
      id: "voice_avatar"
      emoji: "ğŸ—£ï¸"
      name_ru: "Ğ“Ğ¾Ğ»Ğ¾Ñ Ğ°Ğ²Ğ°Ñ‚Ğ°Ñ€Ğ°"
      name_en: "Avatar Voice"
      desc_ru: "Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ³Ğ¾Ğ»Ğ¾Ñ Ğ´Ğ»Ñ Ğ°Ğ²Ğ°Ñ‚Ğ°Ñ€Ğ°"
      desc_en: "Create voice for avatar"
      callback: "audio_voice_avatar"
      cost: 56

    TEXT_TO_SPEECH:
      id: "text_to_speech"
      emoji: "ğŸ”Š"
      name_ru: "Ğ¢ĞµĞºÑÑ‚ â†’ Ğ“Ğ¾Ğ»Ğ¾Ñ"
      name_en: "Text â†’ Speech"
      desc_ru: "ĞĞ·Ğ²ÑƒÑ‡ÑŒÑ‚Ğµ Ğ»ÑĞ±Ğ¾Ğ¹ Ñ‚ĞµĞºÑÑ‚ (ElevenLabs)"
      desc_en: "Voice any text (ElevenLabs)"
      callback: "audio_tts"
      cost: 11

    FAST_TTS:
      id: "fast_tts"
      emoji: "âš¡"
      name_ru: "Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ TTS"
      name_en: "Fast TTS"
      desc_ru: "ĞĞ·Ğ²ÑƒÑ‡ĞºĞ° Ğ·Ğ° 1 ÑĞµĞº (Chatterbox)"
      desc_en: "Speech in 1 sec (Chatterbox)"
      callback: "audio_fast_tts"
      cost: 2
      cost_unit: "per_1000_chars"
      is_new: true
      model: "resemble-ai/chatterbox-turbo"

    SPEECH_TO_TEXT:
      id: "speech_to_text"
      emoji: "ğŸ“"
      name_ru: "Ğ“Ğ¾Ğ»Ğ¾Ñ â†’ Ğ¢ĞµĞºÑÑ‚"
      name_en: "Speech â†’ Text"
      desc_ru: "Ğ¢Ñ€Ğ°Ğ½ÑĞºÑ€Ğ¸Ğ±Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ Ğ°ÑƒĞ´Ğ¸Ğ¾"
      desc_en: "Transcribe audio"
      callback: "audio_stt"
      cost: 7

    VOICE_CLONE:
      id: "voice_clone"
      emoji: "ğŸ™ï¸"
      name_ru: "ĞšĞ»Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ³Ğ¾Ğ»Ğ¾Ñ"
      name_en: "Clone Voice"
      desc_ru: "Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ ĞºĞ¾Ğ¿Ğ¸Ñ Ğ³Ğ¾Ğ»Ğ¾ÑĞ°"
      desc_en: "Create voice copy"
      callback: "audio_clone"
      cost: 84

    MUSIC_GENERATION:
      id: "music_generation"
      emoji: "ğŸµ"
      name_ru: "Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¼ÑƒĞ·Ñ‹ĞºĞ¸"
      name_en: "Music Generation"
      desc_ru: "Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ¼ÑƒĞ·Ñ‹ĞºÑƒ Ğ¿Ğ¾ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ"
      desc_en: "Create music from description"
      callback: "audio_music_gen"
      cost: 3
      cost_unit: "per_30_seconds"
      is_new: true
      model: "minimax/music-1.5"

    MY_VOICES:
      id: "my_voices"
      emoji: "ğŸµ"
      name_ru: "ĞœĞ¾Ğ¸ Ğ³Ğ¾Ğ»Ğ¾ÑĞ°"
      name_en: "My Voices"
      desc_ru: "ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ ĞºĞ»Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ³Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²"
      desc_en: "View cloned voices"
      callback: "audio_my_voices"
      cost: 0

    SELECT_VOICE:
      id: "select_voice"
      emoji: "ğŸ”ˆ"
      name_ru: "Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ³Ğ¾Ğ»Ğ¾Ñ"
      name_en: "Select Voice"
      desc_ru: "Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ³Ğ¾Ğ»Ğ¾Ñ"
      desc_en: "Choose active voice"
      callback: "audio_select_voice"
      cost: 0

    AUDIO_EFFECTS:
      id: "audio_effects"
      emoji: "ğŸ§"
      name_ru: "ĞÑƒĞ´Ğ¸Ğ¾ ÑÑ„Ñ„ĞµĞºÑ‚Ñ‹"
      name_en: "Audio Effects"
      desc_ru: "ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ñ‚Ğµ ÑÑ„Ñ„ĞµĞºÑ‚Ñ‹ Ğº Ğ°ÑƒĞ´Ğ¸Ğ¾"
      desc_en: "Apply effects to audio"
      callback: "audio_effects"
      cost: 5

    MUSIC_TO_TEXT:
      id: "music_to_text"
      emoji: "ğŸ¼"
      name_ru: "ĞœÑƒĞ·Ñ‹ĞºĞ° â†’ Ğ¢ĞµĞºÑÑ‚"
      name_en: "Music â†’ Text"
      desc_ru: "Ğ Ğ°ÑĞ¿Ğ¾Ğ·Ğ½Ğ°Ğ¹Ñ‚Ğµ Ñ‚ĞµĞºÑÑ‚ Ğ¿ĞµÑĞ½Ğ¸"
      desc_en: "Recognize song lyrics"
      callback: "audio_music_to_text"
      cost: 3

    DELETE_VOICE:
      id: "delete_voice"
      emoji: "ğŸ—‘ï¸"
      name_ru: "Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ³Ğ¾Ğ»Ğ¾Ñ"
      name_en: "Delete Voice"
      desc_ru: "Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ ĞºĞ»Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ³Ğ¾Ğ»Ğ¾Ñ"
      desc_en: "Delete cloned voice"
      callback: "audio_delete_voice"
      cost: 0

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # VOICE PRESETS
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  DEFAULT_VOICES:
    - id: "rachel"
      name: "Rachel"
      language: "en"
      gender: "female"

    - id: "adam"
      name: "Adam"
      language: "en"
      gender: "male"

    - id: "bella"
      name: "Bella"
      language: "ru"
      gender: "female"

    - id: "anton"
      name: "Anton"
      language: "ru"
      gender: "male"

  # Requirements
  MIN_AUDIO_DURATION_SEC: 30
  MAX_AUDIO_DURATION_SEC: 300
  MAX_TEXT_LENGTH: 5000

  # Layout
  COLUMNS: 3
  ROWS: 3
