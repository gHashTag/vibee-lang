# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# REPLY KEYBOARD - Buttons at BOTTOM of screen
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ: Ğ¢ĞĞ›Ğ¬ĞšĞ ReplyKeyboardMarkup - ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ’ĞĞ˜Ğ—Ğ£ ÑĞºÑ€Ğ°Ğ½Ğ°!
# Ğ—ĞĞŸĞ Ğ•Ğ©Ğ•ĞĞ: InlineKeyboardMarkup
# Ï†Â² + 1/Ï†Â² = 3 | PHOENIX = 999
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

name: reply_keyboard
version: "2.0.0"
language: zig
module: reply_keyboard

description: |
  ReplyKeyboardMarkup generator for Telegram bot.
  
  CRITICAL RULE:
  â›” NEVER use InlineKeyboardMarkup (buttons in message)
  âœ… ALWAYS use ReplyKeyboardMarkup (buttons at BOTTOM)

types:
  KeyboardButton:
    fields:
      text: String
      request_contact: Bool
      request_location: Bool

  ReplyKeyboardMarkup:
    fields:
      keyboard: List<List<KeyboardButton>>
      resize_keyboard: Bool
      one_time_keyboard: Bool
      selective: Bool

  KeyboardRow:
    fields:
      buttons: List<KeyboardButton>

behaviors:
  - name: create_keyboard
    given: List of button rows
    when: Menu needs to be displayed
    then: Return JSON ReplyKeyboardMarkup with resize_keyboard=true

  - name: create_button
    given: Button text
    when: Adding button to keyboard
    then: Return KeyboardButton struct

  - name: create_row
    given: List of button texts
    when: Creating keyboard row
    then: Return array of KeyboardButton

  - name: main_menu_keyboard_ru
    given: Russian language
    when: Main menu requested
    then: |
      Return keyboard:
      [["ğŸ“¸ ĞĞµĞ¹Ñ€Ğ¾Ñ„Ğ¾Ñ‚Ğ¾", "ğŸ¥ Ğ’Ğ¸Ğ´ĞµĞ¾"],
       ["ğŸ¤ ĞÑƒĞ´Ğ¸Ğ¾", "ğŸ¤– ĞĞ²Ğ°Ñ‚Ğ°Ñ€"],
       ["ğŸ›  Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹"],
       ["ğŸ’° Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ", "ğŸ’ ĞŸĞ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ"],
       ["ğŸ’¬ ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ°", "ğŸŒ EN"]]

  - name: main_menu_keyboard_en
    given: English language
    when: Main menu requested
    then: |
      Return keyboard:
      [["ğŸ“¸ NeuroPhoto", "ğŸ¥ Video"],
       ["ğŸ¤ Audio", "ğŸ¤– Avatar"],
       ["ğŸ›  Tools"],
       ["ğŸ’° Balance", "ğŸ’ Top up"],
       ["ğŸ’¬ Support", "ğŸŒ RU"]]

  - name: photo_menu_keyboard
    given: Language preference
    when: Photo submenu requested
    then: |
      Return keyboard with photo functions:
      - âœ¨ ĞĞµĞ¹Ñ€Ğ¾Ñ„Ğ¾Ñ‚Ğ¾ / NeuroPhoto
      - ğŸ” ĞŸÑ€Ğ¾Ğ¼Ğ¿Ñ‚ Ğ¸Ğ· Ñ„Ğ¾Ñ‚Ğ¾ / Photo to Prompt
      - ğŸ­ Ğ—Ğ°Ğ¼ĞµĞ½Ğ° Ğ»Ğ¸Ñ†Ğ° / Face Swap
      - â¬†ï¸ ĞĞ¿ÑĞºĞµĞ¹Ğ» / Upscale
      - â—€ï¸ ĞĞ°Ğ·Ğ°Ğ´ / Back

  - name: video_menu_keyboard
    given: Language preference
    when: Video submenu requested
    then: |
      Return keyboard with video functions:
      - ğŸ¥ Ğ¤Ğ¾Ñ‚Ğ¾ Ğ² Ğ²Ğ¸Ğ´ĞµĞ¾ / Photo to Video
      - ğŸ¬ Ğ¢ĞµĞºÑÑ‚ Ğ² Ğ²Ğ¸Ğ´ĞµĞ¾ / Text to Video
      - ğŸ‘„ Lip Sync
      - â—€ï¸ ĞĞ°Ğ·Ğ°Ğ´ / Back

  - name: audio_menu_keyboard
    given: Language preference
    when: Audio submenu requested
    then: |
      Return keyboard with audio functions:
      - ğŸ¤ Ğ“Ğ¾Ğ»Ğ¾Ñ Ğ°Ğ²Ğ°Ñ‚Ğ°Ñ€Ğ° / Voice Avatar
      - ğŸ™ï¸ Ğ¢ĞµĞºÑÑ‚ Ğ² Ğ³Ğ¾Ğ»Ğ¾Ñ / Text to Speech
      - â—€ï¸ ĞĞ°Ğ·Ğ°Ğ´ / Back

  - name: avatar_menu_keyboard
    given: Language preference
    when: Avatar submenu requested
    then: |
      Return keyboard with avatar functions:
      - ğŸ¤– Ğ¦Ğ¸Ñ„Ñ€Ğ¾Ğ²Ğ¾Ğµ Ñ‚ĞµĞ»Ğ¾ / Digital Body
      - ğŸ§  ĞœĞ¾Ğ·Ğ³ Ğ°Ğ²Ğ°Ñ‚Ğ°Ñ€Ğ° / Avatar Brain
      - ğŸ’¬ Ğ§Ğ°Ñ‚ Ñ Ğ°Ğ²Ğ°Ñ‚Ğ°Ñ€Ğ¾Ğ¼ / Chat with Avatar
      - â—€ï¸ ĞĞ°Ğ·Ğ°Ğ´ / Back

  - name: to_json
    given: ReplyKeyboardMarkup struct
    when: Sending to Telegram API
    then: Return JSON string with proper escaping

test_cases:
  - name: test_main_menu_has_6_categories
    input: {lang: "ru"}
    expected: {row_count: 5}

  - name: test_resize_keyboard_true
    input: {}
    expected: {resize_keyboard: true}

  - name: test_back_button_present
    input: {menu: "photo"}
    expected: {contains: "â—€ï¸"}
