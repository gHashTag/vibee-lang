# Fast Image Generation Service
# Replicate model: prunaai/z-image-turbo
# Cost: $0.01 per image

name: fast_image_gen
version: "1.0.0"
language: zig
module: fast_image_gen

description: |
  –°—É–ø–µ—Ä –±—ã—Å—Ç—Ä–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
  –ú–æ–¥–µ–ª—å: prunaai/z-image-turbo (6B params)
  –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞ 1-2 —Å–µ–∫—É–Ω–¥—ã.
  –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∏—Ç–µ—Ä–∞—Ü–∏–π.

imports:
  - replicate_client
  - pricing_system
  - nsfw_detection

constants:
  MODEL_ID: "prunaai/z-image-turbo"
  # Real prices from Replicate:
  # - Up to 0.5 MP (500,000 pixels): $0.0025
  # - Up to 1 MP (1,000,000 pixels): $0.005
  # - Up to 2 MP (2,000,000 pixels): $0.01
  BASE_COST_USD_05MP: 0.0025
  BASE_COST_USD_1MP: 0.005
  BASE_COST_USD_2MP: 0.01
  # stars = (0.005 / 0.016) * 1.5 = 0.47 -> 1 star (1MP default)
  COST_STARS: 1
  GENERATION_TIME_SECONDS: 1  # Sub-second on enterprise hardware

types:
  ImageSize:
    description: "–†–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"
    variants:
      - Square_1024     # 1024x1024
      - Landscape_1280  # 1280x720
      - Portrait_720    # 720x1280
      - Wide_1920       # 1920x1080

  FastImageRequest:
    description: "–ó–∞–ø—Ä–æ—Å –Ω–∞ –±—ã—Å—Ç—Ä—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é"
    fields:
      prompt: String
      negative_prompt: Option<String>
      size: ImageSize
      seed: Option<Int>
      telegram_id: String
      username: String

  FastImageResponse:
    description: "–†–µ–∑—É–ª—å—Ç–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏"
    fields:
      success: Bool
      image_url: Option<String>
      error: Option<String>
      generation_time_ms: Int
      seed_used: Int
      cost_stars: Int

behaviors:
  - name: generate_fast
    given: –ü—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
    when: –ó–∞–ø—Ä–æ—Å –Ω–∞ –±—ã—Å—Ç—Ä—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
    then: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞ 1-2 —Å–µ–∫—É–Ω–¥—ã
    api_call: |
      replicate.run("prunaai/z-image-turbo", {
        input: {
          prompt: prompt,
          negative_prompt: negative_prompt,
          width: width,
          height: height,
          seed: seed
        }
      })

  - name: generate_batch
    given: –ü—Ä–æ–º–ø—Ç –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
    when: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
    then: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

  - name: enhance_prompt
    given: –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–æ–º–ø—Ç
    when: –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞
    then: –î–æ–±–∞–≤–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã

  - name: get_size_dimensions
    given: ImageSize
    when: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤
    then: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç width –∏ height

# UI Integration
menu_item:
  group: photo
  position: 2
  icon: "‚ö°"
  name:
    ru: "–ë—ã—Å—Ç—Ä–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è"
    en: "Fast Generation"
  description:
    ru: "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞ 2 —Å–µ–∫—É–Ω–¥—ã (1‚≠ê)"
    en: "Generation in 2 seconds (1‚≠ê)"
  cost_stars: 1

# Wizard flow
wizard:
  steps:
    - name: enter_prompt
      prompt:
        ru: |
          ‚ö° –ë—ã—Å—Ç—Ä–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
          
          –û–ø–∏—à–∏—Ç–µ —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å.
          
          –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
          ‚Ä¢ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞ 1-2 —Å–µ–∫—É–Ω–¥—ã
          ‚Ä¢ –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∏–¥–µ–π
          
          üíé –°—Ç–æ–∏–º–æ—Å—Ç—å: 1 ‚≠ê
        en: |
          ‚ö° Fast Image Generation
          
          Describe what you want to create.
          
          Features:
          ‚Ä¢ Generation in 1-2 seconds
          ‚Ä¢ Perfect for quick ideas
          
          üíé Cost: 1 ‚≠ê

    - name: select_size
      prompt:
        ru: "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–º–µ—Ä:"
        en: "Select size:"
      buttons:
        - text: "‚¨ú –ö–≤–∞–¥—Ä–∞—Ç 1024x1024"
          callback: "fast_square"
        - text: "üñºÔ∏è –ê–ª—å–±–æ–º 1280x720"
          callback: "fast_landscape"
        - text: "üì± –ü–æ—Ä—Ç—Ä–µ—Ç 720x1280"
          callback: "fast_portrait"

    - name: processing
      message:
        ru: "‚ö° –ì–µ–Ω–µ—Ä–∏—Ä—É—é..."
        en: "‚ö° Generating..."

    - name: result
      message:
        ru: "‚úÖ –ì–æ—Ç–æ–≤–æ –∑–∞ {time} —Å–µ–∫!\n\nüíé –°—Ç–æ–∏–º–æ—Å—Ç—å: 1 ‚≠ê"
        en: "‚úÖ Done in {time} sec!\n\nüíé Cost: 1 ‚≠ê"

# Quick prompts for one-click generation
quick_prompts:
  - name: "random_art"
    prompt: "abstract digital art, vibrant colors, trending on artstation"
    icon: "üé®"
  - name: "landscape"
    prompt: "beautiful landscape, mountains, sunset, photorealistic"
    icon: "üèîÔ∏è"
  - name: "portrait"
    prompt: "professional portrait photo, studio lighting, high quality"
    icon: "üë§"
  - name: "fantasy"
    prompt: "fantasy scene, magical, epic, detailed illustration"
    icon: "üßô"

# Comparison with other models
comparison:
  z_image_turbo:
    speed: "1-2 sec"
    cost: "1‚≠ê"
    quality: "Good"
  flux_pro:
    speed: "10-15 sec"
    cost: "7‚≠ê"
    quality: "Excellent"
  neuro_photo:
    speed: "5-10 sec"
    cost: "7‚≠ê"
    quality: "Very Good"
