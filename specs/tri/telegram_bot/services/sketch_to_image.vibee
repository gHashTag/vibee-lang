# Sketch to Image Service
# Replicate model: bytedance/seedream-4
# Cost: $0.03 per image

name: sketch_to_image
version: "1.0.0"
language: zig
module: sketch_to_image

description: |
  –ü—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ —Å–∫–µ—Ç—á–µ–π –≤ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
  –ú–æ–¥–µ–ª—å: bytedance/seedream-4
  –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ.
  –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∏—Å—É–Ω–∫–∏ –æ—Ç —Ä—É–∫–∏, —Å—Ö–µ–º—ã, –Ω–∞–±—Ä–æ—Å–∫–∏.

imports:
  - replicate_client
  - pricing_system

constants:
  MODEL_ID: "bytedance/seedream-4"
  BASE_COST_USD: 0.03
  # stars = (0.03 / 0.016) * 1.5 = 2.8 -> 3 stars
  COST_STARS: 3

types:
  SketchType:
    description: "–¢–∏–ø —Å–∫–µ—Ç—á–∞"
    variants:
      - Pencil        # –ö–∞—Ä–∞–Ω–¥–∞—à–Ω—ã–π –Ω–∞–±—Ä–æ—Å–æ–∫
      - Digital       # –¶–∏—Ñ—Ä–æ–≤–æ–π —Ä–∏—Å—É–Ω–æ–∫
      - Wireframe     # –°—Ö–µ–º–∞/–∫–∞—Ä–∫–∞—Å
      - Doodle        # –ö–∞—Ä–∞–∫—É–ª–∏
      - Blueprint     # –ß–µ—Ä—Ç—ë–∂

  OutputStyle:
    description: "–°—Ç–∏–ª—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞"
    variants:
      - Photorealistic  # –§–æ—Ç–æ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π
      - Illustration    # –ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è
      - Painting        # –ñ–∏–≤–æ–ø–∏—Å—å
      - ThreeD          # 3D —Ä–µ–Ω–¥–µ—Ä
      - Anime           # –ê–Ω–∏–º–µ

  SketchToImageRequest:
    description: "–ó–∞–ø—Ä–æ—Å –Ω–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ"
    fields:
      sketch_url: String
      prompt: String
      sketch_type: SketchType
      output_style: OutputStyle
      preserve_lines: Bool  # –°–æ—Ö—Ä–∞–Ω—è—Ç—å –ª–∏–Ω–∏–∏ —Å–∫–µ—Ç—á–∞
      telegram_id: String
      username: String

  SketchToImageResponse:
    description: "–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è"
    fields:
      success: Bool
      image_url: Option<String>
      error: Option<String>
      processing_time_ms: Int
      cost_stars: Int

behaviors:
  - name: convert_sketch
    given: –°–∫–µ—Ç—á –∏ –æ–ø–∏—Å–∞–Ω–∏–µ
    when: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    then: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    api_call: |
      replicate.run("bytedance/seedream-4", {
        input: {
          image: sketch_url,
          prompt: prompt,
          style: output_style
        }
      })

  - name: enhance_sketch
    given: –°–∫–µ—Ç—á
    when: –£–ª—É—á—à–µ–Ω–∏–µ —Å–∫–µ—Ç—á–∞
    then: –î–æ–±–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª–∏ –∏ —É–ª—É—á—à–∞–µ—Ç –ª–∏–Ω–∏–∏

  - name: colorize_sketch
    given: –ß—ë—Ä–Ω–æ-–±–µ–ª—ã–π —Å–∫–µ—Ç—á
    when: –†–∞—Å–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ
    then: –î–æ–±–∞–≤–ª—è–µ—Ç —Ü–≤–µ—Ç–∞ —Å–æ—Ö—Ä–∞–Ω—è—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É

  - name: detect_sketch_type
    given: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    when: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Å–∫–µ—Ç—á–∞
    then: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–π —Ç–∏–ø

# UI Integration
menu_item:
  group: photo
  position: 6
  icon: "‚úçÔ∏è"
  name:
    ru: "–°–∫–µ—Ç—á –≤ —Ñ–æ—Ç–æ"
    en: "Sketch to Image"
  description:
    ru: "–ü—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ —Ä–∏—Å—É–Ω–∫–æ–≤ –≤ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Ñ–æ—Ç–æ"
    en: "Turn sketches into realistic photos"
  cost_stars: 3

# Wizard flow
wizard:
  steps:
    - name: upload_sketch
      prompt:
        ru: |
          ‚úçÔ∏è –°–∫–µ—Ç—á –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
          
          –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤–∞—à —Ä–∏—Å—É–Ω–æ–∫ –∏–ª–∏ –Ω–∞–±—Ä–æ—Å–æ–∫.
          
          –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è:
          ‚Ä¢ –ö–∞—Ä–∞–Ω–¥–∞—à–Ω—ã–µ –Ω–∞–±—Ä–æ—Å–∫–∏
          ‚Ä¢ –¶–∏—Ñ—Ä–æ–≤—ã–µ —Ä–∏—Å—É–Ω–∫–∏
          ‚Ä¢ –°—Ö–µ–º—ã –∏ –∫–∞—Ä–∫–∞—Å—ã
          ‚Ä¢ –ö–∞—Ä–∞–∫—É–ª–∏
          
          üíé –°—Ç–æ–∏–º–æ—Å—Ç—å: 3 ‚≠ê
        en: |
          ‚úçÔ∏è Sketch to Image
          
          Send your drawing or sketch.
          
          Supported:
          ‚Ä¢ Pencil sketches
          ‚Ä¢ Digital drawings
          ‚Ä¢ Wireframes
          ‚Ä¢ Doodles
          
          üíé Cost: 3 ‚≠ê

    - name: enter_description
      prompt:
        ru: |
          –û–ø–∏—à–∏—Ç–µ —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ –Ω–∞ —Å–∫–µ—Ç—á–µ:
          
          –ü—Ä–∏–º–µ—Ä—ã:
          ‚Ä¢ "–ö–æ—Ç —Å–∏–¥–∏—Ç –Ω–∞ –ø–æ–¥–æ–∫–æ–Ω–Ω–∏–∫–µ"
          ‚Ä¢ "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–æ–º —Å –±–∞—Å—Å–µ–π–Ω–æ–º"
          ‚Ä¢ "–ü–æ—Ä—Ç—Ä–µ—Ç –¥–µ–≤—É—à–∫–∏ —Å –¥–ª–∏–Ω–Ω—ã–º–∏ –≤–æ–ª–æ—Å–∞–º–∏"
        en: |
          Describe what's in the sketch:
          
          Examples:
          ‚Ä¢ "Cat sitting on windowsill"
          ‚Ä¢ "Modern house with pool"
          ‚Ä¢ "Portrait of girl with long hair"

    - name: select_style
      prompt:
        ru: "–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–∏–ª—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:"
        en: "Select output style:"
      buttons:
        - text: "üì∑ –§–æ—Ç–æ—Ä–µ–∞–ª–∏–∑–º"
          callback: "sketch_photo"
        - text: "üé® –ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è"
          callback: "sketch_illustration"
        - text: "üñºÔ∏è –ñ–∏–≤–æ–ø–∏—Å—å"
          callback: "sketch_painting"
        - text: "üéå –ê–Ω–∏–º–µ"
          callback: "sketch_anime"
        - text: "üßä 3D —Ä–µ–Ω–¥–µ—Ä"
          callback: "sketch_3d"

    - name: processing
      message:
        ru: "üé® –ü—Ä–µ–æ–±—Ä–∞–∑—É—é —Å–∫–µ—Ç—á –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ..."
        en: "üé® Converting sketch to image..."

    - name: result
      message:
        ru: "‚úÖ –ì–æ—Ç–æ–≤–æ!\n\nüé® –°—Ç–∏–ª—å: {style}\nüíé –°—Ç–æ–∏–º–æ—Å—Ç—å: 3 ‚≠ê"
        en: "‚úÖ Done!\n\nüé® Style: {style}\nüíé Cost: 3 ‚≠ê"

# Example transformations
examples:
  - sketch: "simple_cat_sketch.png"
    result: "realistic_cat.png"
    prompt: "Fluffy orange cat, photorealistic"
  
  - sketch: "house_wireframe.png"
    result: "modern_house.png"
    prompt: "Modern minimalist house, architectural visualization"
  
  - sketch: "face_doodle.png"
    result: "portrait.png"
    prompt: "Professional portrait, studio lighting"
