# Fast Image Edit Service
# Replicate model: prunaai/p-image-edit
# Cost: $0.01 per edit

name: fast_image_edit
version: "1.0.0"
language: zig
module: fast_image_edit

description: |
  –°—É–ø–µ—Ä –±—ã—Å—Ç—Ä–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
  –ú–æ–¥–µ–ª—å: prunaai/p-image-edit
  –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞ 1 —Å–µ–∫—É–Ω–¥—É.
  –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è production use cases.

imports:
  - replicate_client
  - pricing_system

constants:
  MODEL_ID: "prunaai/p-image-edit"
  BASE_COST_USD: 0.01
  # stars = (0.01 / 0.016) * 1.5 = 0.9375 -> 1 star
  COST_STARS: 1
  EDIT_TIME_SECONDS: 1  # –ú–µ–Ω–µ–µ 1 —Å–µ–∫—É–Ω–¥—ã!

types:
  EditType:
    description: "–¢–∏–ø —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"
    variants:
      - Replace       # –ó–∞–º–µ–Ω–∏—Ç—å –æ–±—ä–µ–∫—Ç
      - Remove        # –£–¥–∞–ª–∏—Ç—å –æ–±—ä–µ–∫—Ç
      - Add           # –î–æ–±–∞–≤–∏—Ç—å –æ–±—ä–µ–∫—Ç
      - Style         # –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∏–ª—å
      - Recolor       # –ü–µ—Ä–µ–∫—Ä–∞—Å–∏—Ç—å
      - Enhance       # –£–ª—É—á—à–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ

  FastEditRequest:
    description: "–ó–∞–ø—Ä–æ—Å –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"
    fields:
      image_url: String
      edit_prompt: String
      edit_type: EditType
      mask_url: Option<String>  # –ú–∞—Å–∫–∞ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
      telegram_id: String
      username: String

  FastEditResponse:
    description: "–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"
    fields:
      success: Bool
      result_url: Option<String>
      error: Option<String>
      edit_time_ms: Int
      cost_stars: Int

behaviors:
  - name: edit_image
    given: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
    when: –ó–∞–ø—Ä–æ—Å –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    then: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    api_call: |
      replicate.run("prunaai/p-image-edit", {
        input: {
          image: image_url,
          prompt: edit_prompt,
          mask: mask_url
        }
      })

  - name: remove_object
    given: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
    when: –£–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
    then: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–µ–∑ –æ–±—ä–µ–∫—Ç–∞

  - name: replace_object
    given: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, —á—Ç–æ –∑–∞–º–µ–Ω–∏—Ç—å, –Ω–∞ —á—Ç–æ –∑–∞–º–µ–Ω–∏—Ç—å
    when: –ó–∞–º–µ–Ω–∞ –æ–±—ä–µ–∫—Ç–∞
    then: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –∑–∞–º–µ–Ω—ë–Ω–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º

  - name: change_style
    given: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ —Ü–µ–ª–µ–≤–æ–π —Å—Ç–∏–ª—å
    when: –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∏–ª—è
    then: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –Ω–æ–≤–æ–º —Å—Ç–∏–ª–µ

  - name: recolor
    given: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –æ–±—ä–µ–∫—Ç, –Ω–æ–≤—ã–π —Ü–≤–µ—Ç
    when: –ü–µ—Ä–µ–∫—Ä–∞—Å–∫–∞ –æ–±—ä–µ–∫—Ç–∞
    then: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –ø–µ—Ä–µ–∫—Ä–∞—à–µ–Ω–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º

# UI Integration
menu_item:
  group: photo
  position: 3
  icon: "‚úèÔ∏è"
  name:
    ru: "–ë—ã—Å—Ç—Ä–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"
    en: "Fast Edit"
  description:
    ru: "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞ 1 —Å–µ–∫—É–Ω–¥—É (1‚≠ê)"
    en: "Edit in 1 second (1‚≠ê)"
  cost_stars: 1

# Wizard flow
wizard:
  steps:
    - name: upload_image
      prompt:
        ru: |
          ‚úèÔ∏è –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
          
          –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–æ—Ç–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
          
          –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
          ‚Ä¢ –£–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
          ‚Ä¢ –ó–∞–º–µ–Ω–∞ –æ–±—ä–µ–∫—Ç–æ–≤
          ‚Ä¢ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∏–ª—è
          ‚Ä¢ –ü–µ—Ä–µ–∫—Ä–∞—Å–∫–∞
          
          üíé –°—Ç–æ–∏–º–æ—Å—Ç—å: 1 ‚≠ê
        en: |
          ‚úèÔ∏è Fast Edit
          
          Send a photo to edit.
          
          Features:
          ‚Ä¢ Remove objects
          ‚Ä¢ Replace objects
          ‚Ä¢ Change style
          ‚Ä¢ Recolor
          
          üíé Cost: 1 ‚≠ê

    - name: select_edit_type
      prompt:
        ru: "–ß—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å?"
        en: "What do you want to do?"
      buttons:
        - text: "üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –æ–±—ä–µ–∫—Ç"
          callback: "edit_remove"
        - text: "üîÑ –ó–∞–º–µ–Ω–∏—Ç—å –æ–±—ä–µ–∫—Ç"
          callback: "edit_replace"
        - text: "üé® –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∏–ª—å"
          callback: "edit_style"
        - text: "üñåÔ∏è –ü–µ—Ä–µ–∫—Ä–∞—Å–∏—Ç—å"
          callback: "edit_recolor"

    - name: enter_instruction
      prompt:
        ru: |
          –û–ø–∏—à–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ:
          
          –ü—Ä–∏–º–µ—Ä—ã:
          ‚Ä¢ "–£–¥–∞–ª–∏ —á–µ–ª–æ–≤–µ–∫–∞ –Ω–∞ —Ñ–æ–Ω–µ"
          ‚Ä¢ "–ó–∞–º–µ–Ω–∏ –Ω–µ–±–æ –Ω–∞ –∑–∞–∫–∞—Ç"
          ‚Ä¢ "–°–¥–µ–ª–∞–π –≤ —Å—Ç–∏–ª–µ –∞–Ω–∏–º–µ"
          ‚Ä¢ "–ü–µ—Ä–µ–∫—Ä–∞—Å—å –º–∞—à–∏–Ω—É –≤ –∫—Ä–∞—Å–Ω—ã–π"
        en: |
          Describe the change:
          
          Examples:
          ‚Ä¢ "Remove person in background"
          ‚Ä¢ "Replace sky with sunset"
          ‚Ä¢ "Make it anime style"
          ‚Ä¢ "Recolor car to red"

    - name: processing
      message:
        ru: "‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä—É—é..."
        en: "‚úèÔ∏è Editing..."

    - name: result
      message:
        ru: "‚úÖ –ì–æ—Ç–æ–≤–æ!\n\n‚è± –í—Ä–µ–º—è: {time} –º—Å\nüíé –°—Ç–æ–∏–º–æ—Å—Ç—å: 1 ‚≠ê"
        en: "‚úÖ Done!\n\n‚è± Time: {time} ms\nüíé Cost: 1 ‚≠ê"

# Edit presets
presets:
  remove_background_person:
    ru: "–£–¥–∞–ª–∏ –ª—é–¥–µ–π –Ω–∞ –∑–∞–¥–Ω–µ–º –ø–ª–∞–Ω–µ"
    en: "Remove people in background"
  enhance_lighting:
    ru: "–£–ª—É—á—à–∏ –æ—Å–≤–µ—â–µ–Ω–∏–µ"
    en: "Enhance lighting"
  make_sunny:
    ru: "–°–¥–µ–ª–∞–π —Å–æ–ª–Ω–µ—á–Ω—É—é –ø–æ–≥–æ–¥—É"
    en: "Make it sunny weather"
  add_snow:
    ru: "–î–æ–±–∞–≤—å —Å–Ω–µ–≥"
    en: "Add snow"
  vintage_style:
    ru: "–°–¥–µ–ª–∞–π –≤ –≤–∏–Ω—Ç–∞–∂–Ω–æ–º —Å—Ç–∏–ª–µ"
    en: "Make it vintage style"
