name: image_to_video
version: "1.0.0"
language: zig
module: image_to_video

description: |
  Image-to-video generation service for VIBEE Telegram bot.
  Handles video generation from images using various AI models.

imports:
  - replicate_client
  - user
  - telegram

types:
  ImageToVideoRequest:
    description: "Image-to-video request"
    fields:
      image_url: String
      prompt: String
      video_model: String
      aspect_ratio: Option<String>
      duration: Option<Int>
      telegram_id: String
      username: String
      is_ru: Bool
      bot_name: String

  ImageToVideoResponse:
    description: "Image-to-video response"
    fields:
      success: Bool
      video_url: Option<String>
      job_id: Option<String>
      message: Option<String>
      error: Option<String>

  I2VProvider:
    description: "Image-to-video provider"
    variants:
      - Replicate
      - KieAI
      - Runway
      - Kling

behaviors:
  - name: generate_image_to_video
    given: ImageToVideoRequest
    when: Starting video generation
    then: Returns ImageToVideoResponse

  - name: generate_with_fallback
    given: ImageToVideoRequest
    when: Using fallback providers
    then: Returns ImageToVideoResponse

  - name: validate_image_for_video
    given: Image URL
    when: Validating image
    then: Returns validation result

  - name: get_supported_models
    given: No parameters
    when: Listing models
    then: Returns list of model configs

  - name: notify_admin_server_issue
    given: Error and user info
    when: Server fails
    then: Sends admin notification

constants:
  DEFAULT_DURATION: 8
  MAX_DURATION: 30
  DEFAULT_ASPECT_RATIO: "9:16"
  SERVER_TIMEOUT_MS: 10000
