name: payment_handler
version: "2.0.0"
language: zig
module: payment_handler

description: |
  Payment handler for VIBEE Telegram bot.
  Handles Telegram Stars payments (XTR currency).
  Supports pre-checkout validation and successful payment processing.

imports:
  - ../db/user_repository
  - ../db/payment_repository

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# TYPES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

types:
  PreCheckoutQuery:
    description: "Telegram pre-checkout query"
    fields:
      id: String
      from: UserInfo
      currency: String
      total_amount: Int
      invoice_payload: String
      shipping_option_id: Option<String>
      order_info: Option<OrderInfo>

  SuccessfulPayment:
    description: "Telegram successful payment"
    fields:
      currency: String
      total_amount: Int
      invoice_payload: String
      telegram_payment_charge_id: String
      provider_payment_charge_id: String

  UserInfo:
    description: "User info from payment"
    fields:
      id: Int
      username: Option<String>
      first_name: Option<String>

  OrderInfo:
    description: "Order info if requested"
    fields:
      name: Option<String>
      phone_number: Option<String>
      email: Option<String>

  InvoicePayload:
    description: "Parsed invoice payload"
    fields:
      type: PayloadType
      stars: Int
      user_id: Int
      timestamp: Int
      service: Option<String>

  PayloadType:
    description: "Payment payload type"
    values:
      - topup
      - service_payment
      - subscription

  StarPackage:
    description: "Star package for purchase"
    fields:
      stars: Int
      price_xtr: Int
      price_rub: Float
      bonus_percent: Int
      label: String

  LabeledPrice:
    description: "Telegram labeled price"
    fields:
      label: String
      amount: Int

  InvoiceParams:
    description: "Parameters for creating invoice"
    fields:
      chat_id: Int
      title: String
      description: String
      payload: String
      currency: String
      prices: List<LabeledPrice>
      provider_token: Option<String>
      need_name: Bool
      need_email: Bool
      need_phone_number: Bool
      is_flexible: Bool

  PaymentResult:
    description: "Payment processing result"
    fields:
      success: Bool
      stars_added: Int
      new_balance: Int
      transaction_id: Option<String>
      error: Option<String>

  RefundResult:
    description: "Refund processing result"
    fields:
      success: Bool
      stars_refunded: Int
      new_balance: Int
      error: Option<String>

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STAR PACKAGES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

packages:
  - stars: 50
    price_xtr: 50
    price_rub: 75
    bonus_percent: 0
    label_ru: "50 â­"
    label_en: "50 â­"

  - stars: 100
    price_xtr: 100
    price_rub: 150
    bonus_percent: 0
    label_ru: "100 â­"
    label_en: "100 â­"

  - stars: 250
    price_xtr: 250
    price_rub: 350
    bonus_percent: 5
    label_ru: "250 â­ (+5%)"
    label_en: "250 â­ (+5%)"

  - stars: 500
    price_xtr: 500
    price_rub: 650
    bonus_percent: 10
    label_ru: "500 â­ (+10%)"
    label_en: "500 â­ (+10%)"

  - stars: 1000
    price_xtr: 1000
    price_rub: 1200
    bonus_percent: 15
    label_ru: "1000 â­ (+15%)"
    label_en: "1000 â­ (+15%)"

  - stars: 2500
    price_xtr: 2500
    price_rub: 2800
    bonus_percent: 20
    label_ru: "2500 â­ (+20%)"
    label_en: "2500 â­ (+20%)"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# BEHAVIORS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

behaviors:
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # INVOICE CREATION
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  - name: create_star_invoice
    given: Chat ID, star amount, language
    when: Creating Stars invoice
    then: |
      1. Get package by star amount
      2. Calculate total with bonus
      3. Build invoice payload
      4. Create LabeledPrice
      5. Return InvoiceParams

  - name: send_invoice
    given: InvoiceParams
    when: Sending invoice to user
    then: |
      1. Call sendInvoice API
      2. Return message ID or error

  - name: create_invoice_link
    given: Star amount, user ID
    when: Creating shareable invoice link
    then: |
      1. Build invoice params
      2. Call createInvoiceLink API
      3. Return URL

  - name: build_invoice_payload
    given: PayloadType, stars, user_id
    when: Creating payload string
    then: |
      1. Create JSON object
      2. Add type, stars, user_id
      3. Add timestamp
      4. Encode to string
      5. Return payload

  - name: parse_invoice_payload
    given: Payload string
    when: Parsing payload
    then: |
      1. Decode string
      2. Parse JSON
      3. Validate fields
      4. Return InvoicePayload

  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # PRE-CHECKOUT HANDLING
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  - name: handle_pre_checkout
    given: PreCheckoutQuery
    when: Validating payment before charge
    then: |
      1. Parse invoice payload
      2. Validate payload type
      3. Validate user exists
      4. Validate amount matches
      5. Check for duplicate payment
      6. Answer pre-checkout query
      7. Return success/error

  - name: validate_pre_checkout
    given: PreCheckoutQuery and InvoicePayload
    when: Validating payment details
    then: |
      1. Check currency is XTR
      2. Check amount matches package
      3. Check user_id matches
      4. Check timestamp not expired
      5. Return validation result

  - name: answer_pre_checkout_query
    given: Query ID, ok, error_message
    when: Responding to pre-checkout
    then: |
      1. Call answerPreCheckoutQuery API
      2. If ok=false, include error_message
      3. Return success

  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # SUCCESSFUL PAYMENT HANDLING
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  - name: handle_successful_payment
    given: Chat ID, SuccessfulPayment
    when: Processing completed payment
    then: |
      1. Parse invoice payload
      2. Calculate stars with bonus
      3. Create payment record in DB
      4. Update user balance
      5. Send confirmation message
      6. Return PaymentResult

  - name: process_topup_payment
    given: User ID, stars, payment info
    when: Processing balance top-up
    then: |
      1. Get package bonus
      2. Calculate total stars
      3. Update user balance
      4. Create payment record
      5. Return new balance

  - name: process_service_payment
    given: User ID, stars, service name
    when: Processing service payment
    then: |
      1. Verify balance sufficient
      2. Deduct from balance
      3. Create payment record
      4. Return success

  - name: send_payment_confirmation
    given: Chat ID, stars, new_balance, language
    when: Confirming payment to user
    then: |
      1. Format confirmation message
      2. Include stars added
      3. Include new balance
      4. Send message

  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # REFUND HANDLING
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  - name: refund_payment
    given: User ID, telegram_payment_charge_id
    when: Processing refund
    then: |
      1. Get payment record
      2. Verify payment exists
      3. Call refundStarPayment API
      4. Update payment status
      5. Deduct from user balance
      6. Return RefundResult

  - name: can_refund
    given: Payment record
    when: Checking refund eligibility
    then: |
      1. Check payment status is completed
      2. Check within refund window
      3. Check not already refunded
      4. Return eligibility

  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # BALANCE OPERATIONS
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  - name: check_balance
    given: User ID, required_amount
    when: Checking if balance sufficient
    then: |
      1. Get user balance from DB
      2. Compare with required
      3. Return sufficient/insufficient

  - name: deduct_balance
    given: User ID, amount, service
    when: Deducting for service
    then: |
      1. Verify balance sufficient
      2. Update balance atomically
      3. Create payment record
      4. Return new balance

  - name: add_balance
    given: User ID, amount, reason
    when: Adding to balance
    then: |
      1. Update balance atomically
      2. Create payment record
      3. Return new balance

  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # PACKAGE HELPERS
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  - name: get_package_by_stars
    given: Star amount
    when: Finding package
    then: Return StarPackage or null

  - name: calculate_bonus
    given: StarPackage
    when: Calculating bonus stars
    then: |
      1. Get bonus_percent
      2. Calculate bonus = stars * percent / 100
      3. Return total stars

  - name: get_all_packages
    given: Language
    when: Listing packages
    then: Return list of StarPackage with labels

  - name: format_package_price
    given: StarPackage, language
    when: Formatting price display
    then: Return formatted string

  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # KEYBOARD BUILDERS
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  - name: build_packages_keyboard
    given: Language
    when: Building package selection
    then: |
      1. Get all packages
      2. Create button for each
      3. Add cancel button
      4. Return InlineKeyboardMarkup

  - name: build_payment_keyboard
    given: Selected package, language
    when: Building payment confirmation
    then: |
      1. Create pay button
      2. Create cancel button
      3. Return InlineKeyboardMarkup

  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # HISTORY & ANALYTICS
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  - name: get_payment_history
    given: User ID, limit, offset
    when: Fetching payment history
    then: |
      1. Query payment_repository
      2. Format records
      3. Return list

  - name: get_user_spending
    given: User ID
    when: Getting spending stats
    then: |
      1. Get total spent
      2. Get by service breakdown
      3. Return stats

  - name: get_revenue_stats
    given: Date range
    when: Getting revenue analytics
    then: |
      1. Get total revenue
      2. Get by day breakdown
      3. Get by package breakdown
      4. Return stats

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# CONSTANTS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

constants:
  CURRENCY_XTR: "XTR"
  PROVIDER_TOKEN: ""
  PAYLOAD_EXPIRY_SECONDS: 3600
  REFUND_WINDOW_HOURS: 24
  MIN_STARS_PURCHASE: 50
  MAX_STARS_PURCHASE: 10000

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# MESSAGES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

messages:
  invoice_title:
    ru: "ĞŸĞ¾Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ° VIBEE"
    en: "VIBEE Balance Top Up"

  invoice_description:
    ru: "ĞŸĞ¾ĞºÑƒĞ¿ĞºĞ° {stars} â­ Ğ´Ğ»Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ°"
    en: "Purchase {stars} â­ for content generation"

  payment_success:
    ru: |
      âœ… ĞĞ¿Ğ»Ğ°Ñ‚Ğ° ÑƒÑĞ¿ĞµÑˆĞ½Ğ°!
      
      ğŸ’« Ğ—Ğ°Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¾: {stars} â­
      ğŸ’° ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ: {balance} â­
      
      Ğ¡Ğ¿Ğ°ÑĞ¸Ğ±Ğ¾ Ğ·Ğ° Ğ¿Ğ¾ĞºÑƒĞ¿ĞºÑƒ! ğŸ‰
    en: |
      âœ… Payment successful!
      
      ğŸ’« Added: {stars} â­
      ğŸ’° New balance: {balance} â­
      
      Thank you for your purchase! ğŸ‰

  payment_failed:
    ru: |
      âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñ‹
      
      ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ĞµÑ‰Ñ‘ Ñ€Ğ°Ğ· Ğ¸Ğ»Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ¸Ñ‚ĞµÑÑŒ Ğ² Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºÑƒ.
    en: |
      âŒ Payment failed
      
      Please try again or contact support.

  insufficient_balance:
    ru: |
      âŒ ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ğ·Ğ²Ñ‘Ğ·Ğ´
      
      ğŸ’° Ğ’Ğ°Ñˆ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ: {balance} â­
      ğŸ’ Ğ¢Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ: {required} â­
      
      ĞŸĞ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½Ğ¸Ñ.
    en: |
      âŒ Insufficient stars
      
      ğŸ’° Your balance: {balance} â­
      ğŸ’ Required: {required} â­
      
      Top up to continue.

  select_package:
    ru: |
      ğŸ’ Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¿Ğ°ĞºĞµÑ‚ Ğ·Ğ²Ñ‘Ğ·Ğ´
      
      Ğ§ĞµĞ¼ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ğ¿Ğ°ĞºĞµÑ‚ â€” Ñ‚ĞµĞ¼ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ğ±Ğ¾Ğ½ÑƒÑ!
    en: |
      ğŸ’ Select a star package
      
      Bigger packages have bigger bonuses!

  refund_success:
    ru: |
      âœ… Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½
      
      ğŸ’« Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰ĞµĞ½Ğ¾: {stars} â­
      ğŸ’° Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ: {balance} â­
    en: |
      âœ… Refund completed
      
      ğŸ’« Refunded: {stars} â­
      ğŸ’° Balance: {balance} â­

  refund_failed:
    ru: "âŒ ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚"
    en: "âŒ Refund failed"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ERROR CODES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

errors:
  invalid_payload: "Invalid invoice payload"
  user_not_found: "User not found"
  amount_mismatch: "Amount does not match"
  payload_expired: "Payment request expired"
  duplicate_payment: "Duplicate payment detected"
  insufficient_balance: "Insufficient balance"
  refund_not_allowed: "Refund not allowed"
  payment_not_found: "Payment not found"
