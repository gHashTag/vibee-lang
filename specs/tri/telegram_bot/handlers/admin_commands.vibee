name: admin_commands
version: "1.0.0"
language: zig
module: admin_commands

description: |
  Admin command handlers for VIBEE Telegram bot.
  Handles administrative operations and bot management.

imports:
  - telegram
  - user

types:
  AdminCommand:
    description: "Admin command types"
    variants:
      - Broadcast
      - Stats
      - UserInfo
      - BanUser
      - UnbanUser
      - AddBalance
      - SetLevel
      - RenewSubscription
      - GetLogs
      - RestartBot

  AdminResult:
    description: "Admin command result"
    fields:
      success: Bool
      message: String
      data: Option<Object>

  BroadcastRequest:
    description: "Broadcast message request"
    fields:
      message: String
      target: BroadcastTarget
      media: Option<Object>

  BroadcastTarget:
    description: "Broadcast target"
    variants:
      - All
      - Subscribers
      - ActiveUsers
      - SpecificUsers

  BroadcastResult:
    description: "Broadcast result"
    fields:
      total: Int
      sent: Int
      failed: Int
      errors: List<String>

  BotStats:
    description: "Bot statistics"
    fields:
      total_users: Int
      active_users_24h: Int
      active_users_7d: Int
      total_payments: Int
      total_revenue_stars: Int
      total_generations: Int

behaviors:
  - name: is_admin
    given: Telegram ID
    when: Checking admin status
    then: Returns true if user is admin

  - name: handle_admin_command
    given: Context and command
    when: Processing admin command
    then: Returns AdminResult

  - name: broadcast_message
    given: BroadcastRequest
    when: Sending broadcast
    then: Returns BroadcastResult

  - name: get_bot_stats
    given: No parameters
    when: Fetching statistics
    then: Returns BotStats

  - name: get_user_info_admin
    given: Telegram ID
    when: Fetching user info
    then: Returns detailed user data

  - name: ban_user
    given: Telegram ID and reason
    when: Banning user
    then: Returns success status

  - name: unban_user
    given: Telegram ID
    when: Unbanning user
    then: Returns success status

  - name: add_balance_admin
    given: Telegram ID and amount
    when: Adding balance
    then: Returns new balance

  - name: set_user_level
    given: Telegram ID and level
    when: Setting level
    then: Returns success status

  - name: renew_subscription
    given: Telegram ID and days
    when: Renewing subscription
    then: Returns new expiry date

  - name: get_recent_logs
    given: Log count
    when: Fetching logs
    then: Returns log entries

constants:
  ADMIN_IDS: ["144022504"]
  MAX_BROADCAST_BATCH: 30
  BROADCAST_DELAY_MS: 50
