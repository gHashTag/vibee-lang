# webarena_benchmark_v999.vibee - WebArena Benchmark Runner
# KOSCHEI PATTERN - Official WebArena evaluation framework
# φ² + 1/φ² = 3 | PHOENIX = 999

name: webarena_benchmark_v999
version: "999.0.0"
language: zig
module: webarena_benchmark_v999

types:
  BenchmarkConfig:
    fields:
      name: String
      version: String
      max_tasks: Int
      timeout_per_task_ms: Int
      parallel: Bool

  TaskCategory:
    fields:
      extraction: String
      navigation: String
      search: String
      multi_step: String
      form_filling: String
      shopping: String

  BenchmarkTask:
    fields:
      task_id: Int
      intent: String
      start_url: String
      category: String
      expected_answer: String
      max_steps: Int

  TaskResult:
    fields:
      task_id: Int
      intent: String
      category: String
      success: Bool
      score: Float
      answer: String
      steps: Int
      time_ms: Int
      provider: String

  CategoryStats:
    fields:
      category: String
      total: Int
      success: Int
      partial: Int
      failed: Int
      avg_score: Float
      avg_steps: Float

  BenchmarkReport:
    fields:
      benchmark_name: String
      version: String
      run_id: String
      timestamp: Timestamp
      total_tasks: Int
      completed: Int
      full_success: Int
      partial_success: Int
      failed: Int
      success_rate: Float
      weighted_score: Float
      total_time_ms: Int
      by_category: List<String>
      task_results: List<String>

  LeaderboardEntry:
    fields:
      rank: Int
      agent_name: String
      success_rate: Float
      model: String
      open_source: Bool

behaviors:
  - name: init_benchmark
    given: BenchmarkConfig
    when: Initialize benchmark runner
    then: Return configured benchmark instance

  - name: load_tasks
    given: Task file path or default tasks
    when: Load benchmark tasks
    then: Return list of BenchmarkTask

  - name: run_single_task
    given: BenchmarkTask and agent
    when: Execute task and evaluate
    then: Return TaskResult with score

  - name: run_full_benchmark
    given: List of tasks and agent
    when: Run all tasks sequentially
    then: Return BenchmarkReport

  - name: evaluate_answer
    given: Agent answer and expected answer
    when: Compare answers for correctness
    then: Return score 0.0 to 1.0

  - name: calculate_category_stats
    given: List of TaskResult
    when: Aggregate by category
    then: Return list of CategoryStats

  - name: generate_report
    given: All task results
    when: Compile final report
    then: Return BenchmarkReport

  - name: compare_with_leaderboard
    given: Our score and leaderboard data
    when: Find our position
    then: Return estimated rank

  - name: export_trajectory
    given: Task execution trajectory
    when: Format for submission
    then: Return JSON trajectory string

  - name: validate_task
    given: BenchmarkTask
    when: Check task is valid
    then: Return Bool and error message

sacred_constants:
  phi: 1.618033988749895
  phi_squared_plus_inverse_squared: 3
  phoenix: 999
  webarena_total_tasks: 812
  human_performance: 78.24
  top_agent_score: 71.6

default_tasks:
  - task_id: 1
    intent: "What is the page title?"
    start_url: "https://example.com"
    category: "extraction"
  - task_id: 2
    intent: "What is the main heading?"
    start_url: "https://example.com"
    category: "extraction"
  - task_id: 3
    intent: "What text is in the content area?"
    start_url: "https://example.com"
    category: "extraction"
  - task_id: 4
    intent: "Click the More information link"
    start_url: "https://example.com"
    category: "navigation"
  - task_id: 5
    intent: "Go to wikipedia.org"
    start_url: "https://example.com"
    category: "navigation"
  - task_id: 6
    intent: "Search for Python programming"
    start_url: "https://duckduckgo.com"
    category: "search"
  - task_id: 7
    intent: "Search for Zig language"
    start_url: "https://duckduckgo.com"
    category: "search"
  - task_id: 8
    intent: "Click the link and tell me the new page title"
    start_url: "https://example.com"
    category: "multi_step"
  - task_id: 9
    intent: "Find information about IANA"
    start_url: "https://example.com"
    category: "multi_step"
  - task_id: 10
    intent: "Navigate to IANA and find their contact info"
    start_url: "https://example.com"
    category: "multi_step"
