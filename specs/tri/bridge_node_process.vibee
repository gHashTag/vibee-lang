# Bridge Node Process Manager
# Spawn and manage Node.js subprocess
# Lifecycle management

name: bridge_node_process
version: "1.0.0"
language: zig
module: bridge_node_process

types:
  NodeProcess:
    fields:
      process_id: Int
      stdin_fd: Int
      stdout_fd: Int
      stderr_fd: Int
      is_running: Bool

  ProcessConfig:
    fields:
      node_path: String
      script_path: String
      args: List<String>
      env: Map<String,String>
      cwd: String

  ProcessState:
    fields:
      state: String
      exit_code: Option<Int>
      start_time: Timestamp
      memory_usage: Int

  ProcessOutput:
    fields:
      stdout: String
      stderr: String
      is_complete: Bool

  SpawnOptions:
    fields:
      detached: Bool
      shell: Bool
      timeout_ms: Int

  ProcessSignal:
    fields:
      signal_type: String
      signal_code: Int

behaviors:
  - name: spawn_node
    given: Process config and spawn options
    when: Node.js spawn needed
    then: Returns NodeProcess handle

  - name: write_stdin
    given: Process and data
    when: Stdin write needed
    then: Returns write result

  - name: read_stdout
    given: Process and buffer size
    when: Stdout read needed
    then: Returns read data

  - name: read_stderr
    given: Process and buffer size
    When: Stderr read needed
    then: Returns error data

  - name: wait_for_exit
    given: Process and timeout
    when: Exit wait needed
    then: Returns exit code

  - name: send_signal
    given: Process and signal
    when: Signal send needed
    then: Returns signal result

  - name: kill_process
    given: Process
    when: Process termination needed
    then: Returns kill result

  - name: get_process_state
    given: Process
    when: State query needed
    then: Returns process state

  - name: is_alive
    given: Process
    when: Liveness check needed
    then: Returns alive status
