# temporal_aa_v2658.vibee - Temporal Anti-Aliasing
# Временное сглаживание для качества без затрат
# φ² + 1/φ² = 3 | PHOENIX = 999

name: temporal_aa_v2658
version: "2658.0.0"
language: zig
module: temporal_aa_v2658

types:
  TAAConfig:
    fields:
      jitter_samples: Int
      feedback_weight: Float
      velocity_weight: Float
      clamp_mode: String

  HistoryBuffer:
    fields:
      current: String
      previous: String
      velocity: String
      depth: String

  JitterPattern:
    fields:
      pattern_type: String
      samples: List
      current_index: Int

  TAAStats:
    fields:
      ghosting_factor: Float
      sharpness: Float
      temporal_stability: Float
      rejection_rate: Float

  MotionVector:
    fields:
      x: Float
      y: Float
      confidence: Float

behaviors:
  - name: apply_jitter
    given: Projection matrix
    when: Frame start
    then: Return jittered matrix

  - name: resolve_taa
    given: Current and history
    when: TAA resolve
    then: Return anti-aliased frame

  - name: compute_velocity
    given: Current and previous depth
    when: Motion estimation
    then: Return MotionVector

  - name: reject_history
    given: Color difference
    when: Disocclusion
    then: Clamp or reject

  - name: get_stats
    given: None
    when: Stats query
    then: Return TAAStats

sacred_constants:
  phi: 1.618033988749895
  phoenix: 999
