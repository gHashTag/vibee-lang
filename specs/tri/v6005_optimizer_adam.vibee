# v6005 - Adam Optimizer
# =======================
# Adam с полной поддержкой autograd
# φ² + 1/φ² = 3 | PHOENIX = 999

name: optimizer_adam
version: "6.0.5"
language: zig
module: optimizer_adam

constants:
  PHI: 1.618033988749895
  BETA1: 0.9
  BETA2: 0.999
  EPS: 1e-8

types:
  AdamState:
    fields:
      m: List
      v: List
      step: Int
      
  AdamConfig:
    fields:
      lr: Float
      beta1: Float
      beta2: Float
      eps: Float
      weight_decay: Float

behaviors:
  - name: adam_init
    given: Parameters
    when: Инициализация
    then: Создать m и v буферы
    
  - name: adam_step
    given: Params, grads, state, config
    when: Шаг оптимизации
    then: Обновить params по Adam
    
  - name: adam_reset
    given: State
    when: Сброс состояния
    then: Обнулить m, v, step
