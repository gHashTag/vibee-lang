name: e2e_auth_v298
version: "1.0.0"
language: zig
module: e2e_auth_v298

types:
  AuthCredentials:
    fields:
      username: String
      password: String
      mfa_code: Option<String>
      remember: Bool

  AuthSession:
    fields:
      token: String
      expires_at: Timestamp
      refresh_token: String
      user_id: String

  AuthProvider:
    fields:
      name: String
      type: String
      client_id: String
      redirect_uri: String

  AuthResult:
    fields:
      success: Bool
      session: Option<AuthSession>
      error_message: Option<String>
      mfa_required: Bool

  AuthTestCase:
    fields:
      name: String
      credentials: AuthCredentials
      expected: AuthResult
      duration_ms: Int

behaviors:
  - name: e2e_login_valid
    given: Valid credentials
    when: Login submitted
    then: Session created successfully

  - name: e2e_login_invalid
    given: Invalid credentials
    when: Login submitted
    then: Error message displayed

  - name: e2e_login_mfa
    given: MFA enabled account
    when: Login with MFA
    then: MFA verified and session created

  - name: e2e_oauth_google
    given: Google OAuth configured
    when: Google login clicked
    then: OAuth flow completed

  - name: e2e_oauth_github
    given: GitHub OAuth configured
    when: GitHub login clicked
    then: OAuth flow completed

  - name: e2e_session_refresh
    given: Session expiring
    when: Refresh triggered
    then: New token obtained

  - name: e2e_logout
    given: Active session
    when: Logout clicked
    then: Session invalidated

  - name: e2e_password_reset
    given: Forgot password clicked
    when: Reset email sent
    then: Password reset completed
