# VIBEE E2E Search Flow v252
# End-to-End Testing for Search Functionality

name: e2e_search_v252
version: "252.0.0"
language: zig
module: e2e_search

types:
  SearchQuery:
    fields:
      term: String
      filters: Object
      sort: String
      page: Int

  SearchResult:
    fields:
      total: Int
      items: List<String>
      facets: Object
      time_ms: Int

  SearchFilter:
    fields:
      field: String
      operator: String
      value: String

  Autocomplete:
    fields:
      suggestions: List<String>
      highlighted: String

  SearchMetrics:
    fields:
      query_time_ms: Int
      render_time_ms: Int
      total_time_ms: Int

  Pagination:
    fields:
      current_page: Int
      total_pages: Int
      per_page: Int

  SearchHistory:
    fields:
      queries: List<String>
      timestamps: List<Timestamp>

behaviors:
  - name: e2e_basic_search
    given: "Search term"
    when: "Search submitted"
    then: "Results displayed"
    benchmark:
      vibee_ms: 250
      playwright_ms: 400
      puppeteer_ms: 450
      selenium_ms: 650
    steps:
      - "Enter search term"
      - "Submit search"
      - "Verify results"

  - name: e2e_autocomplete
    given: "Partial term"
    when: "Typing"
    then: "Suggestions shown"
    benchmark:
      vibee_ms: 100
      playwright_ms: 180
      puppeteer_ms: 220
      selenium_ms: 350
    steps:
      - "Type partial term"
      - "Wait for suggestions"
      - "Verify suggestions"

  - name: e2e_filter_results
    given: "Search results"
    when: "Filter applied"
    then: "Results filtered"
    benchmark:
      vibee_ms: 200
      playwright_ms: 320
      puppeteer_ms: 380
      selenium_ms: 550
    steps:
      - "Select filter"
      - "Apply"
      - "Verify filtered results"

  - name: e2e_sort_results
    given: "Search results"
    when: "Sort changed"
    then: "Results sorted"
    benchmark:
      vibee_ms: 180
      playwright_ms: 300
      puppeteer_ms: 350
      selenium_ms: 500
    steps:
      - "Select sort option"
      - "Verify order"

  - name: e2e_paginate
    given: "Multiple pages"
    when: "Page changed"
    then: "New page loaded"
    benchmark:
      vibee_ms: 150
      playwright_ms: 250
      puppeteer_ms: 300
      selenium_ms: 450
    steps:
      - "Click next page"
      - "Verify new results"

  - name: e2e_no_results
    given: "Invalid term"
    when: "Search submitted"
    then: "No results message"
    benchmark:
      vibee_ms: 200
      playwright_ms: 320
      puppeteer_ms: 380
      selenium_ms: 550
    steps:
      - "Enter invalid term"
      - "Submit"
      - "Verify no results"

  - name: e2e_advanced_search
    given: "Complex query"
    when: "Advanced search"
    then: "Precise results"
    benchmark:
      vibee_ms: 350
      playwright_ms: 550
      puppeteer_ms: 620
      selenium_ms: 900
    steps:
      - "Open advanced search"
      - "Fill criteria"
      - "Submit"
      - "Verify results"

test_cases:
  - name: test_basic
    input: { term: "laptop" }
    expected: { results: true }

  - name: test_autocomplete
    input: { partial: "lap" }
    expected: { suggestions: 5 }

  - name: test_filter
    input: { filter: { price: "< 1000" } }
    expected: { filtered: true }

  - name: test_sort
    input: { sort: "price_asc" }
    expected: { sorted: true }

  - name: test_paginate
    input: { page: 2 }
    expected: { loaded: true }

  - name: test_no_results
    input: { term: "xyzabc123" }
    expected: { empty: true }

  - name: test_advanced
    input: { criteria: { brand: "Apple", price: "< 2000" } }
    expected: { precise: true }

benchmark_summary:
  vibee_avg_ms: 204
  playwright_avg_ms: 331
  puppeteer_avg_ms: 386
  selenium_avg_ms: 564
  vibee_speedup: "1.6x-2.8x"
