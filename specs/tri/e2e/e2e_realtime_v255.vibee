# VIBEE E2E Real-time Updates v255

name: e2e_realtime_v255
version: "255.0.0"
language: zig
module: e2e_realtime

types:
  WebSocketMessage:
    fields:
      type: String
      payload: Object
      timestamp: Timestamp

  RealtimeEvent:
    fields:
      event: String
      data: Object
      source: String

  NotificationState:
    fields:
      count: Int
      items: List<String>
      unread: Int

behaviors:
  - name: e2e_websocket_connect
    given: "WebSocket endpoint"
    when: "Connection opened"
    then: "Connected"
    benchmark:
      vibee_ms: 50
      playwright_ms: 100
      puppeteer_ms: 120
      selenium_ms: 200

  - name: e2e_receive_message
    given: "WebSocket connected"
    when: "Message received"
    then: "UI updated"
    benchmark:
      vibee_ms: 30
      playwright_ms: 60
      puppeteer_ms: 80
      selenium_ms: 130

  - name: e2e_send_message
    given: "WebSocket connected"
    when: "Message sent"
    then: "Delivered"
    benchmark:
      vibee_ms: 20
      playwright_ms: 45
      puppeteer_ms: 55
      selenium_ms: 90

  - name: e2e_live_notifications
    given: "Notification system"
    when: "Event occurs"
    then: "Notification shown"
    benchmark:
      vibee_ms: 80
      playwright_ms: 150
      puppeteer_ms: 180
      selenium_ms: 280

  - name: e2e_live_chat
    given: "Chat interface"
    when: "Message sent"
    then: "Message appears"
    benchmark:
      vibee_ms: 100
      playwright_ms: 180
      puppeteer_ms: 220
      selenium_ms: 350

  - name: e2e_presence_indicator
    given: "User list"
    when: "User status changes"
    then: "Indicator updated"
    benchmark:
      vibee_ms: 40
      playwright_ms: 80
      puppeteer_ms: 100
      selenium_ms: 160

  - name: e2e_reconnection
    given: "Connection lost"
    when: "Reconnect attempted"
    then: "Reconnected"
    benchmark:
      vibee_ms: 150
      playwright_ms: 280
      puppeteer_ms: 330
      selenium_ms: 500

test_cases:
  - name: test_connect
    input: { url: "wss://api.example.com" }
    expected: { connected: true }

  - name: test_receive
    input: { message: { type: "update" } }
    expected: { received: true }

  - name: test_send
    input: { message: "hello" }
    expected: { sent: true }

  - name: test_notification
    input: { event: "new_message" }
    expected: { shown: true }

  - name: test_chat
    input: { message: "Hi there" }
    expected: { displayed: true }

  - name: test_presence
    input: { user: "user1", status: "online" }
    expected: { updated: true }

  - name: test_reconnect
    input: { disconnected: true }
    expected: { reconnected: true }

benchmark_summary:
  vibee_avg_ms: 67
  playwright_avg_ms: 128
  puppeteer_avg_ms: 155
  selenium_avg_ms: 244
  vibee_speedup: "1.9x-3.6x"
