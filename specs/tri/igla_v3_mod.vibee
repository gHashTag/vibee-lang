# iGLA v3 Mixture of Depths (MoD)
# 50% compute reduction through dynamic layer skipping
# φ² + 1/φ² = 3 | PHOENIX = 999
# Paper: arXiv:2404.02258

name: igla_v3_mod
version: "3.0.0"
language: zig
module: igla_v3_mod

creation_pattern:
  source: HiddenStates
  transformer: MoDRouter
  result: AdaptiveOutput

types:
  MoDConfig:
    fields:
      capacity_factor: Float
      aux_loss_weight: Float
      router_type: String
      phi_decay: Bool
      
  RouterDecision:
    fields:
      process: Bool
      confidence: Float
      
behaviors:
  - name: phi_route
    given: "Hidden states, layer depth"
    when: "PHI-based routing"
    then: "Skip with probability φ^(-depth)"
    
  - name: learned_route
    given: "Hidden states, router weights"
    when: "Learned routing"
    then: "Return top-k tokens to process"
    
  - name: mod_layer_forward
    given: "Input, router decision"
    when: "Conditional computation"
    then: "Process only selected tokens"
