# VIBEE Specification v13525
# Real-time Chat
# KOSCHEI CYCLE 11 - 1000000x SPEEDUP

name: collab_chat
version: "13525"
language: zig
module: collab_chat

types:
  ChatMessage:
    fields:
      id: String
      sender_id: String
      content: String
      timestamp: Timestamp
      edited: Bool

  ChatRoom:
    fields:
      id: String
      name: String
      participants: List<String>
      messages: List<Object>

  ChatConfig:
    fields:
      max_message_length: Int
      allow_attachments: Bool
      allow_reactions: Bool
      history_limit: Int

  MessageReaction:
    fields:
      message_id: String
      user_id: String
      emoji: String

  ChatMetrics:
    fields:
      messages_sent: Int
      messages_received: Int
      active_rooms: Int

  ChatNotification:
    fields:
      notification_type: String
      room_id: String
      message: String

behaviors:
  - name: send_message
    given: Message content
    When: Send requested
    then: Message sent to room

  - name: edit_message
    given: Message ID and new content
    When: Edit requested
    then: Message edited

  - name: delete_message
    given: Message ID
    When: Delete requested
    then: Message deleted

  - name: add_reaction
    given: Message ID and emoji
    When: Reaction added
    then: Reaction recorded

  - name: get_history
    given: Room ID and limit
    When: History requested
    then: Message history returned

  - name: search_messages
    given: Search query
    When: Search requested
    then: Matching messages returned

creation_pattern:
  source: ChatConfig
  transformer: ChatManager
  result: ChatRoom
