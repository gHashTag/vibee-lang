name: bottleneck_integration_layer
version: "1.0.0"
language: zig
module: bottleneck_integration_layer

# BOTTLENECK: Integration Layer
# Connects all components into working agent
# The "glue" that makes everything work together

types:
  AgentConfig:
    fields:
      llm_provider: String
      llm_model: String
      llm_api_key: String
      browser_type: String
      headless: Bool
      max_steps: Int
      timeout_seconds: Int

  AgentState:
    fields:
      initialized: Bool
      browser_ready: Bool
      llm_ready: Bool
      current_task: Option<String>
      step_count: Int

  Task:
    fields:
      task_id: String
      intent: String
      start_url: String

  StepResult:
    fields:
      step_number: Int
      action: String
      success: Bool
      observation: String
      duration_ms: Int

  TaskCompletion:
    fields:
      task_id: String
      success: Bool
      steps: List<String>
      final_answer: Option<String>
      total_duration_ms: Int

  ComponentHealth:
    fields:
      component: String
      healthy: Bool
      last_check: Timestamp
      error: Option<String>

behaviors:
  - name: initialize_agent
    given: AgentConfig
    when: Starting agent system
    then: Return AgentState

  - name: shutdown_agent
    given: AgentState
    when: Stopping agent system
    then: Return shutdown status

  - name: execute_task
    given: AgentState and Task
    when: Running agent on task
    then: Return TaskCompletion

  - name: execute_step
    given: AgentState
    when: Running single ReAct step
    then: Return StepResult

  - name: health_check
    given: AgentState
    when: Checking component health
    then: Return list of ComponentHealth

  - name: reset_state
    given: AgentState
    when: Resetting for new task
    then: Return fresh AgentState
