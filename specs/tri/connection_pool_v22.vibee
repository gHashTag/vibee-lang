name: connection_pool_v22
version: "22.5.0"
language: zig
module: connection_pool_v22

types:
  PoolConfig:
    fields:
      min_connections: Int
      max_connections: Int
      idle_timeout_ms: Int
      acquire_timeout_ms: Int

  Connection:
    fields:
      id: String
      status: String
      created_at: Timestamp
      last_used_at: Timestamp
      use_count: Int

  PoolStats:
    fields:
      total_connections: Int
      active_connections: Int
      idle_connections: Int
      waiting_requests: Int
      total_acquired: Int
      total_released: Int

  ConnectionPool:
    fields:
      config: Object
      connections: List<String>
      stats: Object

behaviors:
  - name: create_pool
    given: PoolConfig
    when: Initialize pool
    then: ConnectionPool instance

  - name: acquire
    given: ConnectionPool
    when: Acquire connection
    then: Connection

  - name: release
    given: ConnectionPool and connection
    when: Release connection
    then: Released

  - name: get_connection
    given: ConnectionPool and id
    when: Get specific connection
    then: Connection

  - name: close_connection
    given: ConnectionPool and id
    when: Close connection
    then: Closed

  - name: resize
    given: ConnectionPool and new_size
    When: Resize pool
    then: Resized

  - name: get_stats
    given: ConnectionPool
    When: Get pool stats
    then: PoolStats

  - name: health_check
    given: ConnectionPool
    When: Check pool health
    then: Health status

  - name: evict_idle
    given: ConnectionPool
    When: Evict idle connections
    then: Evicted count

  - name: warm_up
    given: ConnectionPool
    When: Warm up pool
    then: Warmed up

  - name: shutdown
    given: ConnectionPool
    When: Shutdown pool
    then: Shutdown complete
