name: v6752_tensor_parallelism
version: "1.0.0"
language: zig
module: v6752_tensor_parallelism

types:
  TPConfig:
    fields:
      world_size: Int
      rank: Int

behaviors:
  - name: shard_weights
    given: Weight matrix
    when: Split across devices
    then: Return local shard

  - name: all_reduce
    given: Local gradients
    when: Synchronize across devices
    then: Return averaged gradients

  - name: phi_shard_size
    given: Total size and world size
    when: Compute shard with PHI balance
    then: Return optimal shard size
