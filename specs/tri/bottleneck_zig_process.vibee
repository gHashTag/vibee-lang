name: bottleneck_zig_process
version: "1.0.0"
language: zig
module: bottleneck_zig_process

# BOTTLENECK: Child Process Management
# Zig process spawning for browser control
# Target: Fast Electron/Chrome process management

types:
  ProcessConfig:
    fields:
      executable: String
      args: List<String>
      env: Map<String,String>
      cwd: Option<String>
      stdin_pipe: Bool
      stdout_pipe: Bool
      stderr_pipe: Bool

  ProcessHandle:
    fields:
      pid: Int
      status: String
      exit_code: Option<Int>

  ProcessOutput:
    fields:
      stdout: String
      stderr: String
      exit_code: Int
      duration_ms: Int

  PipeData:
    fields:
      data: String
      stream: String
      timestamp: Int

behaviors:
  - name: spawn_process
    given: ProcessConfig with executable and args
    when: Need to start browser or helper process
    then: Return ProcessHandle with PID

  - name: spawn_electron
    given: Electron path and app args
    when: Starting Electron browser
    then: Return ProcessHandle for Electron

  - name: spawn_chrome
    given: Chrome path and CDP port
    when: Starting Chrome with remote debugging
    then: Return ProcessHandle for Chrome

  - name: wait_process
    given: ProcessHandle
    when: Need to wait for process completion
    then: Return ProcessOutput with exit code

  - name: kill_process
    given: ProcessHandle and signal
    when: Need to terminate process
    then: Return success status

  - name: write_stdin
    given: ProcessHandle and data
    when: Sending input to process
    then: Return bytes written

  - name: read_stdout
    given: ProcessHandle
    when: Reading process output
    then: Return PipeData with content
