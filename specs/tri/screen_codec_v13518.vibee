# VIBEE Specification v13518
# Video Codecs
# KOSCHEI CYCLE 11 - 1000000x SPEEDUP

name: screen_codec
version: "13518"
language: zig
module: screen_codec

types:
  CodecConfig:
    fields:
      codec_name: String
      profile: String
      level: String
      hardware_accel: Bool

  VideoCodec:
    fields:
      name: String
      mime_type: String
      profiles: List<String>
      max_resolution: Object
      max_bitrate: Int

  EncoderConfig:
    fields:
      codec: String
      width: Int
      height: Int
      bitrate: Int
      frame_rate: Int

  DecoderConfig:
    fields:
      codec: String
      hardware_decode: Bool
      output_format: String

  CodecMetrics:
    fields:
      frames_encoded: Int
      frames_decoded: Int
      avg_encode_time_ms: Float
      avg_decode_time_ms: Float

  CodecCapabilities:
    fields:
      supported_codecs: List<String>
      hardware_encoders: List<String>
      hardware_decoders: List<String>

behaviors:
  - name: get_capabilities
    given: System query
    When: Capabilities requested
    then: Codec capabilities returned

  - name: create_encoder
    given: Encoder configuration
    When: Encoder needed
    then: Encoder created

  - name: create_decoder
    given: Decoder configuration
    When: Decoder needed
    then: Decoder created

  - name: encode_frame
    given: Raw frame
    When: Encoding requested
    then: Frame encoded

  - name: decode_frame
    given: Encoded frame
    When: Decoding requested
    then: Frame decoded

  - name: release_codec
    given: Active codec
    When: Release requested
    then: Codec resources released

creation_pattern:
  source: CodecConfig
  transformer: CodecManager
  result: VideoCodec
