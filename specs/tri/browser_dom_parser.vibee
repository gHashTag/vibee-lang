# DOM Parser Module
# Parse and analyze DOM structure
# Element tree traversal

name: browser_dom_parser
version: "1.0.0"
language: zig
module: browser_dom_parser

types:
  DOMNode:
    fields:
      node_id: String
      node_type: String
      tag_name: Option<String>
      text_content: Option<String>
      attributes: Map<String,String>
      children: List<String>

  DOMTree:
    fields:
      tree_id: String
      root: String
      node_count: Int
      depth: Int

  DOMQuery:
    fields:
      query_type: String
      selector: String
      scope: Option<String>

  DOMDiff:
    fields:
      diff_id: String
      added_nodes: List<String>
      removed_nodes: List<String>
      modified_nodes: List<String>

  DOMSnapshot:
    fields:
      snapshot_id: String
      html: String
      timestamp: Timestamp
      url: String

behaviors:
  - name: parse_html
    given: HTML string
    when: DOM parsing needed
    then: Returns DOM tree

  - name: query_nodes
    given: DOM tree and query
    when: Node query needed
    then: Returns matching nodes

  - name: get_node_path
    given: DOM tree and node
    when: Path extraction needed
    then: Returns XPath or CSS path

  - name: compare_trees
    given: Two DOM trees
    when: Diff needed
    then: Returns DOM diff

  - name: serialize_tree
    given: DOM tree
    when: Serialization needed
    then: Returns HTML string

  - name: find_interactive
    given: DOM tree
    when: Interactive elements needed
    then: Returns clickable/typeable elements

  - name: extract_text_nodes
    given: DOM tree
    when: Text extraction needed
    then: Returns text content

  - name: snapshot_dom
    given: Page
    when: DOM snapshot needed
    then: Returns DOM snapshot
