# VIBEE Specification v13487
# Refactoring Agent
# KOSCHEI CYCLE 11 - 1000000x SPEEDUP

name: agent_refactor
version: "13487"
language: zig
module: agent_refactor

types:
  RefactorAgent:
    fields:
      id: String
      language: String
      preserve_behavior: Bool
      test_after: Bool

  RefactorRequest:
    fields:
      refactor_type: String
      target_file: String
      target_symbol: String
      new_name: String
      options: Object

  RefactorResult:
    fields:
      success: Bool
      files_changed: List<String>
      changes: List<Object>
      tests_passed: Bool

  ExtractMethod:
    fields:
      source_file: String
      start_line: Int
      end_line: Int
      method_name: String
      parameters: List<String>

  RenameSymbol:
    fields:
      old_name: String
      new_name: String
      scope: String
      occurrences: Int

  RefactorMetrics:
    fields:
      refactorings: Int
      successful: Int
      failed: Int
      lines_changed: Int

behaviors:
  - name: extract_method
    given: Code block to extract
    when: Extract method requested
    then: Method extracted with proper signature

  - name: rename_symbol
    given: Symbol and new name
    when: Rename requested
    then: All occurrences renamed

  - name: inline_variable
    given: Variable to inline
    when: Inline requested
    then: Variable inlined at all uses

  - name: extract_variable
    given: Expression to extract
    when: Extract variable requested
    then: Variable created for expression

  - name: move_to_file
    given: Symbol and target file
    when: Move requested
    then: Symbol moved with imports updated

  - name: simplify_conditionals
    given: Complex conditional logic
    when: Simplification requested
    then: Conditionals simplified

creation_pattern:
  source: RefactorRequest
  transformer: RefactorAgent
  result: RefactorResult
