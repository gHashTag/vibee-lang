name: impact_measures_v11530
version: "11530"
language: zig
module: impact_measures

description: |
  TIER 237: Impact Measures
  Minimizes unintended side effects of AI actions
  Based on: Turner et al. AUP, Krakovna side effects

types:
  ImpactConfig:
    fields:
      measure_type: ImpactMeasure
      baseline_policy: BaselinePolicy
      impact_penalty: Float
      reversibility_weight: Float
      scope_limit: Int

  ImpactMeasure:
    variants:
      - attainable_utility_preservation
      - relative_reachability
      - stepwise_inaction
      - future_task_preservation

  BaselinePolicy:
    variants:
      - inaction
      - starting_state
      - stepwise_inaction
      - null_policy

  ImpactAssessment:
    fields:
      total_impact: Float
      reversible_impact: Float
      irreversible_impact: Float
      affected_entities: List<String>
      impact_breakdown: List<Float>

  SideEffect:
    fields:
      effect_type: String
      magnitude: Float
      reversibility: Float
      affected_state: String
      was_intended: Bool

behaviors:
  - name: compute_impact
    given: Action and environment state
    when: Measuring impact
    then: Returns impact assessment

  - name: attainable_utility_preservation
    given: State before and after action
    when: Computing AUP penalty
    then: Returns utility preservation score

  - name: measure_reachability_change
    given: State transition
    when: Computing reachability impact
    then: Returns reachability change

  - name: identify_side_effects
    given: Action outcome
    when: Detecting unintended effects
    then: Returns list of side effects

  - name: compute_reversibility
    given: State change
    when: Assessing reversibility
    then: Returns reversibility score

  - name: penalize_high_impact
    given: Action and impact threshold
    when: Applying impact penalty
    then: Returns penalized action value

  - name: preserve_future_options
    given: Current state
    when: Protecting optionality
    then: Returns option preservation score

  - name: compare_to_baseline
    given: Action outcome and baseline
    when: Computing relative impact
    then: Returns relative impact measure

creation_pattern:
  source: ActionOutcome
  transformer: ImpactMeasurer
  result: ImpactAssessment

test_cases:
  - name: test_aup
    input: { measure: attainable_utility_preservation }
    expected: { computes_aup: true }

  - name: test_reversibility
    input: { reversibility_weight: 0.5 }
    expected: { measures_reversibility: true }

  - name: test_side_effects
    input: { scope_limit: 100 }
    expected: { identifies_effects: true }
