# VIBEE Specification v13530
# Flow Models - Normalizing Flows
name: flow_models_v13530
version: "1.0.0"
language: zig
module: flow_models

types:
  FlowType:
    fields:
      realnvp: String
      glow: String
      continuous_nf: String
      residual_flow: String

  FlowLayer:
    fields:
      forward_fn: String
      inverse_fn: String
      log_det_jacobian: Float

  FlowChain:
    fields:
      layers: String
      num_layers: Int
      base_distribution: String

  FlowOutput:
    fields:
      transformed: String
      log_prob: Float
      log_det: Float

  FlowConfig:
    fields:
      num_layers: Int
      hidden_dim: Int
      coupling_type: String

behaviors:
  - name: forward_flow
    given: Input sample
    when: Forward pass done
    then: Returns flow output

  - name: inverse_flow
    given: Latent sample
    when: Inverse pass done
    then: Returns original space

  - name: compute_log_prob
    given: Sample
    when: Probability computed
    then: Returns log probability

  - name: sample
    given: Num samples
    when: Sampling done
    then: Returns generated samples
