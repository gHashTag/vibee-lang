name: myopia_v11480
version: "11480"
language: zig
module: myopia

description: |
  TIER 232: Myopia - Limited Planning Horizon
  Restricts AI planning to prevent long-term manipulation
  Based on: Krakovna et al., avoiding side effects through myopia

types:
  MyopiaConfig:
    fields:
      horizon_limit: Int
      discount_factor: Float
      temporal_abstraction: Bool
      causal_horizon: Int
      prevent_self_continuation: Bool

  PlanningConstraint:
    fields:
      max_steps: Int
      max_causal_depth: Int
      forbidden_long_term_goals: List<String>
      allowed_planning_scope: Scope

  Scope:
    variants:
      - immediate_only
      - short_term
      - medium_term
      - task_bounded

  MyopicAction:
    fields:
      action: String
      planning_depth: Int
      causal_reach: Int
      side_effect_risk: Float
      approved: Bool

  HorizonViolation:
    fields:
      violation_type: String
      attempted_horizon: Int
      allowed_horizon: Int
      blocked: Bool

behaviors:
  - name: enforce_planning_horizon
    given: Proposed action sequence
    when: Checking planning depth
    then: Returns truncated or blocked plan

  - name: compute_causal_reach
    given: Action and world model
    when: Analyzing causal consequences
    then: Returns causal horizon of action

  - name: apply_temporal_discount
    given: Future reward estimate
    when: Discounting long-term rewards
    then: Returns myopically discounted value

  - name: detect_self_continuation
    given: Agent plan
    when: Checking for self-preservation goals
    then: Returns whether plan extends agent existence

  - name: bound_side_effects
    given: Action and environment
    when: Limiting unintended consequences
    then: Returns bounded action with limited reach

  - name: verify_task_scope
    given: Goal and task definition
    when: Checking goal alignment with task
    then: Returns scope verification result

  - name: truncate_long_horizon_plan
    given: Multi-step plan
    when: Enforcing horizon limit
    then: Returns truncated plan

  - name: compute_myopic_value
    given: State and policy
    when: Evaluating with limited horizon
    then: Returns myopic value estimate

creation_pattern:
  source: AgentPlan
  transformer: MyopiaEnforcer
  result: BoundedPlan

test_cases:
  - name: test_horizon_enforcement
    input: { horizon_limit: 10 }
    expected: { enforces_limit: true }

  - name: test_causal_reach
    input: { max_causal_depth: 5 }
    expected: { computes_reach: true }

  - name: test_self_continuation_detection
    input: { prevent_self_continuation: true }
    expected: { detects_self_preservation: true }
