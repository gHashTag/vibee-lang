name: cache_manager_v22
version: "22.5.0"
language: zig
module: cache_manager_v22

types:
  CacheConfig:
    fields:
      max_size_bytes: Int
      ttl_ms: Int
      eviction_policy: String

  CacheEntry:
    fields:
      key: String
      value: String
      size_bytes: Int
      created_at: Timestamp
      accessed_at: Timestamp
      hit_count: Int

  CacheStats:
    fields:
      total_entries: Int
      total_size_bytes: Int
      hit_count: Int
      miss_count: Int
      hit_rate: Float
      eviction_count: Int

  CacheManager:
    fields:
      config: Object
      entries: Object
      stats: Object

behaviors:
  - name: create_cache
    given: CacheConfig
    when: Initialize cache
    then: CacheManager instance

  - name: get
    given: CacheManager and key
    when: Get cached value
    then: Value or null

  - name: set
    given: CacheManager and key and value
    when: Set cached value
    then: Entry created

  - name: delete
    given: CacheManager and key
    when: Delete entry
    then: Deleted

  - name: has
    given: CacheManager and key
    when: Check if exists
    then: Boolean

  - name: get_or_set
    given: CacheManager and key and factory
    When: Get or create
    then: Value

  - name: clear
    given: CacheManager
    When: Clear all entries
    then: Cleared

  - name: evict_expired
    given: CacheManager
    When: Evict expired entries
    then: Evicted count

  - name: get_stats
    given: CacheManager
    When: Get cache stats
    then: CacheStats

  - name: resize
    given: CacheManager and new_size
    When: Resize cache
    then: Resized

  - name: warm_up
    given: CacheManager and entries
    When: Warm up cache
    then: Warmed up
