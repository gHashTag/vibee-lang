# Interop Arrays v56160 - Array Passing
# Cross-Language Array Handling
# φ² + 1/φ² = 3 | PHOENIX = 999

name: interop_arrays_v56160
version: "56.1.60"
language: zig
module: interop_arrays

creation_pattern:
  source: SourceArray
  transformer: ArrayConverter
  result: TargetArray

types:
  ArrayLayout:
    fields:
      element_type: String
      element_size: Int
      element_alignment: Int
      stride: Int

  ArrayView:
    fields:
      ptr: Int
      len: Int
      layout: ArrayLayout
      is_contiguous: Bool

  OwnedArray:
    fields:
      data: String
      len: Int
      capacity: Int
      layout: ArrayLayout

  MultiDimArray:
    fields:
      data: String
      dimensions: List<Int>
      strides: List<Int>
      layout: String
      element_type: String

  ArraySlice:
    fields:
      array: ArrayView
      start: Int
      end: Int
      step: Int

  ArrayCopy:
    fields:
      source: ArrayView
      target: ArrayView
      element_converter: Option<String>

  ArrayBuffer:
    fields:
      data: String
      byte_length: Int
      element_type: String
      is_detached: Bool

  TypedArrayView:
    fields:
      buffer: ArrayBuffer
      byte_offset: Int
      length: Int
      element_type: String

behaviors:
  - name: create_array_view
    given: Pointer and length
    when: View needed
    then: ArrayView

  - name: copy_array
    given: Source and target arrays
    When: Copy needed
    then: ArrayCopy completed

  - name: convert_array_elements
    given: Array and converter
    when: Element conversion needed
    then: Converted array

  - name: create_multidim_array
    given: Dimensions and data
    when: Multi-dimensional needed
    then: MultiDimArray

  - name: slice_array
    given: Array and range
    when: Slice needed
    then: ArraySlice

  - name: flatten_array
    given: MultiDimArray
    when: Flattening needed
    then: Flat array

  - name: reshape_array
    given: Array and new dimensions
    when: Reshape needed
    then: Reshaped array

  - name: create_typed_array
    given: Buffer and type
    when: Typed view needed
    then: TypedArrayView
