# FFI Rust Bindings v56020 - Rust Language Bindings Generator
# VIBEE → Rust extern "C" / bindgen compatible
# φ² + 1/φ² = 3 | PHOENIX = 999

name: ffi_rust_bindings_v56020
version: "56.0.20"
language: zig
module: ffi_rust_bindings

creation_pattern:
  source: VibeeSpec
  transformer: RustBindingsGenerator
  result: RustFFIModule

types:
  RustType:
    fields:
      name: String
      rust_name: String
      is_repr_c: Bool
      derives: List<String>
      lifetime: Option<String>

  RustExternFn:
    fields:
      name: String
      abi: String
      return_type: String
      parameters: List<RustParam>
      is_unsafe: Bool
      link_name: Option<String>

  RustParam:
    fields:
      name: String
      type_name: String
      is_mut: Bool
      is_ref: Bool

  RustStruct:
    fields:
      name: String
      fields: List<RustField>
      repr: String
      derives: List<String>
      visibility: String

  RustField:
    fields:
      name: String
      type_name: String
      visibility: String

  RustEnum:
    fields:
      name: String
      variants: List<RustVariant>
      repr: String
      derives: List<String>

  RustVariant:
    fields:
      name: String
      discriminant: Option<Int>
      fields: Option<List<RustField>>

  RustModule:
    fields:
      name: String
      extern_block: List<RustExternFn>
      types: List<RustType>
      structs: List<RustStruct>
      enums: List<RustEnum>
      impls: List<String>

  RustCrate:
    fields:
      name: String
      modules: List<RustModule>
      dependencies: List<String>
      features: List<String>

behaviors:
  - name: generate_extern_block
    given: VibeeSpec functions
    when: Rust FFI needed
    then: extern "C" block with functions

  - name: generate_repr_c_struct
    given: Vibee struct
    when: C-compatible struct needed
    then: #[repr(C)] Rust struct

  - name: generate_repr_c_enum
    given: Vibee enum
    when: C-compatible enum needed
    then: #[repr(C)] or #[repr(i32)] enum

  - name: map_vibee_to_rust_type
    given: Vibee type
    when: Type mapping needed
    then: Equivalent Rust type with lifetime

  - name: generate_safe_wrapper
    given: Unsafe extern fn
    when: Safe API needed
    then: Safe Rust wrapper function

  - name: generate_drop_impl
    given: FFI resource type
    when: RAII cleanup needed
    then: Drop trait implementation

  - name: generate_from_raw
    given: FFI pointer type
    when: Conversion needed
    then: From/Into implementations

  - name: generate_cargo_toml
    given: Crate configuration
    when: Build config needed
    then: Cargo.toml with libc dependency
