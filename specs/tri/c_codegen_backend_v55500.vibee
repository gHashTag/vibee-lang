name: c_codegen_backend_v55500
version: "55500.0.0"
language: zig
module: c_codegen_backend

# C CODEGEN BACKEND
# Генерация C кода из VIBEE AST

types:
  CConfig:
    fields:
      c_standard: String
      emit_header: Bool
      use_stdint: Bool
      use_stdbool: Bool
      emit_comments: Bool

  CModule:
    fields:
      name: String
      includes_count: Int
      typedefs_count: Int
      structs_count: Int
      functions_count: Int

  CStruct:
    fields:
      name: String
      is_typedef: Bool
      fields_count: Int
      is_packed: Bool

  CField:
    fields:
      name: String
      field_type: String
      is_pointer: Bool
      array_size: Int

  CFunction:
    fields:
      name: String
      ret_type: String
      params: String
      is_static: Bool
      is_inline: Bool

  CHeader:
    fields:
      name: String
      guard_name: String
      includes: String

  CTest:
    fields:
      name: String
      assert_count: Int

  COutput:
    fields:
      source_code: String
      header_code: String
      size_bytes: Int
      structs_generated: Int

behaviors:
  - name: emit_c_header_guard
    given: CConfig
    when: Header guard generation triggered
    then: C header guard

  - name: emit_c_includes
    given: CConfig
    when: Includes generation triggered
    then: C include statements

  - name: emit_c_struct
    given: VIBEE type definition
    when: Struct generation triggered
    then: C struct typedef

  - name: emit_c_field
    given: VIBEE field definition
    when: Field generation triggered
    then: C struct field

  - name: emit_c_function
    given: VIBEE behavior
    when: Function generation triggered
    then: C function

  - name: emit_c_function_decl
    given: VIBEE behavior
    when: Declaration generation triggered
    then: C function declaration

  - name: map_type_to_c
    given: VIBEE type name
    when: Type mapping requested
    then: C type returned

  - name: generate_c_module
    given: Complete VIBEE spec
    when: Full generation triggered
    then: Complete C source and header
