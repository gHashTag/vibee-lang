# VIBEE Specification v13594
# CDP Page Management
# Page-level CDP Operations
# φ² + 1/φ² = 3 | PHOENIX = 999

name: cdp_page
version: "13594"
language: zig
module: cdp_page

types:
  Page:
    fields:
      id: String
      target_id: String
      session_id: String
      url: String
      title: String
      frames: List<Object>

  PageConfig:
    fields:
      viewport: Object
      user_agent: String
      javascript_enabled: Bool
      cache_enabled: Bool

  Viewport:
    fields:
      width: Int
      height: Int
      device_scale_factor: Float
      is_mobile: Bool
      has_touch: Bool
      is_landscape: Bool

  NavigationEntry:
    fields:
      id: Int
      url: String
      user_typed_url: String
      title: String
      transition_type: String

  FrameTree:
    fields:
      frame: Object
      child_frames: List<Object>

  LayoutMetrics:
    fields:
      layout_viewport: Object
      visual_viewport: Object
      content_size: Object

  PageMetrics:
    fields:
      navigations: Int
      load_time_ms: Float
      dom_content_loaded_ms: Float

  DialogInfo:
    fields:
      dialog_type: String
      message: String
      default_prompt: String
      has_browser_handler: Bool

behaviors:
  - name: navigate
    given: URL to navigate
    when: Navigation requested
    then: Page navigated and load event fired

  - name: reload
    given: Current page
    when: Reload requested
    then: Page reloaded

  - name: go_back
    given: Navigation history
    when: Back requested
    then: Previous page loaded

  - name: go_forward
    given: Navigation history
    when: Forward requested
    then: Next page loaded

  - name: get_content
    given: Loaded page
    when: Content requested
    then: HTML content returned

  - name: set_content
    given: HTML content
    when: Set content requested
    then: Page content replaced

  - name: wait_for_load
    given: Navigating page
    when: Load wait requested
    then: Waits until load complete

  - name: close
    given: Open page
    when: Close requested
    then: Page closed

creation_pattern:
  source: PageConfig
  transformer: PageFactory
  result: Page
