# v6013 - Loss Functions
# =======================
# Функции потерь с backward
# φ² + 1/φ² = 3 | PHOENIX = 999

name: loss_functions
version: "6.0.13"
language: zig
module: loss_functions

constants:
  PHI: 1.618033988749895
  EPSILON: 1e-10

types:
  LossResult:
    fields:
      value: Float
      grad: List
      
  LossConfig:
    fields:
      reduction: String
      label_smoothing: Float

behaviors:
  - name: cross_entropy
    given: Logits и targets
    when: CrossEntropy loss
    then: Вернуть loss и grad
    
  - name: mse_loss
    given: Predictions и targets
    when: MSE loss
    then: Вернуть mean squared error
    
  - name: kl_divergence
    given: P и Q distributions
    when: KL divergence
    then: Вернуть KL(P||Q)
    
  - name: focal_loss
    given: Logits, targets, gamma
    when: Focal loss
    then: Вернуть focal loss для imbalanced data
