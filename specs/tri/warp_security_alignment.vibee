name: warp_security_alignment
version: "1.0.0"
language: zig
module: warp_security_alignment

description: |
  WARP Security Alignment - проверка безопасности действий
  Научные основы: Constitutional AI (Anthropic, 2023)
  Alignment checker для каждого действия агента
  φ² + 1/φ² = 3 | PHOENIX = 999

types:
  AlignmentCheck:
    fields:
      action: String
      target: String
      risk_level: Int
      approved: Bool
      reason: String

  AlignmentRule:
    fields:
      rule_id: String
      description: String
      pattern: String
      action_on_match: String
      priority: Int

  AlignmentConfig:
    fields:
      strict_mode: Bool
      require_confirmation: List<String>
      blocked_actions: List<String>
      trusted_domains: List<String>

  AlignmentResult:
    fields:
      allowed: Bool
      risk_score: Float
      warnings: List<String>
      required_confirmation: Bool

  AlignmentMetrics:
    fields:
      total_checks: Int
      blocked_count: Int
      confirmed_count: Int
      auto_approved_count: Int

behaviors:
  - name: check_action
    given: Действие агента для проверки
    when: Проверка alignment
    then: AlignmentResult с решением

  - name: classify_risk
    given: Действие и контекст
    when: Классификация риска
    then: Int уровень риска (0-10)

  - name: require_confirmation
    given: Действие высокого риска
    when: Запрос подтверждения
    then: Bool подтверждено пользователем

  - name: add_rule
    given: AlignmentRule новое правило
    when: Добавление правила
    then: Правило активировано

  - name: check_domain_trust
    given: URL домена
    when: Проверка доверия к домену
    then: Int уровень доверия

  - name: get_alignment_metrics
    given: Текущая сессия
    when: Запрос метрик
    then: AlignmentMetrics статистика
