# iGLA ANN Benchmark
# Benchmarking suite for ANN algorithms
# Scientific basis: Aumüller et al. 2020 (ANN-Benchmarks)
# φ² + 1/φ² = 3 | V = n × 3^k × π^m × φ^p

name: igla_ann_benchmark
version: "1.0.0"
language: zig
module: igla_ann_benchmark

sacred_constants:
  phi: 1.618033988749895
  trinity: 3.0
  phoenix: 999

scientific_references:
  - "Aumüller et al. 2020: ANN-Benchmarks"
  - "Simhadri et al. 2022: Results of the NeurIPS'21 Challenge"
  - "Douze et al. 2024: The FAISS library"

types:
  BenchmarkConfig:
    fields:
      dataset: String
      num_queries: Int
      k_values: String
      num_runs: Int

  RecallMetric:
    fields:
      k: Int
      recall: Float
      ground_truth_size: Int

  LatencyMetric:
    fields:
      p50_us: Float
      p95_us: Float
      p99_us: Float
      qps: Float

  MemoryMetric:
    fields:
      index_bytes: Int
      peak_bytes: Int
      bytes_per_vector: Float

  BenchmarkResult:
    fields:
      algorithm: String
      recall: Float
      qps: Float
      memory_mb: Float

  ParetoCurve:
    fields:
      points: String
      pareto_optimal: String

behaviors:
  - name: compute_recall
    given: "Results, ground_truth, k"
    when: "Recall computation"
    then: "Recall@K metric"

  - name: measure_latency
    given: "Search function, queries"
    when: "Latency measurement"
    then: "Latency percentiles"

  - name: measure_throughput
    given: "Search function, queries, duration"
    when: "Throughput measurement"
    then: "Queries per second"

  - name: measure_memory
    given: "Index"
    when: "Memory measurement"
    then: "Memory usage metrics"

  - name: run_benchmark
    given: "Algorithm, config"
    when: "Full benchmark"
    then: "Complete benchmark results"

  - name: compute_pareto
    given: "Results list"
    when: "Pareto analysis"
    then: "Pareto-optimal configurations"

  - name: compare_algorithms
    given: "Results A, Results B"
    when: "Comparison"
    then: "Relative performance metrics"

  - name: phi_benchmark_scaling
    given: "Dataset sizes"
    when: "Sacred scaling"
    then: "φ-ratio scaling analysis"
