# VIBEE Specification v12260
# Secrets Management - Secure storage and rotation of secrets
name: secrets_management_v12260
version: "1.0.0"
language: zig
module: secrets_management

types:
  SecretType:
    fields:
      api_key: String
      password: String
      certificate: String
      token: String

  Secret:
    fields:
      id: String
      name: String
      type: String
      version: Int
      created_at: Timestamp
      expires_at: Timestamp

  SecretValue:
    fields:
      secret_id: String
      encrypted_value: String
      encryption_key_id: String

  RotationPolicy:
    fields:
      secret_id: String
      interval_days: Int
      auto_rotate: Bool
      notify_before_days: Int

  SecretAccess:
    fields:
      secret_id: String
      accessor: String
      accessed_at: Timestamp
      action: String

behaviors:
  - name: create_secret
    given: Secret configuration
    when: Secret created
    then: Returns encrypted secret

  - name: get_secret
    given: Secret ID and accessor
    when: Secret retrieved
    then: Returns decrypted value with audit

  - name: rotate_secret
    given: Secret and new value
    when: Rotation performed
    then: Returns new version

  - name: set_rotation_policy
    given: Secret and policy
    when: Policy set
    then: Returns active rotation policy
