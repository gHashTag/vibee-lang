name: zig_websocket_client
version: "14.0.0"
language: zig
module: zig_websocket_client

# IMPLEMENTATION: WebSocket Client
# TCP + TLS + WebSocket handshake
# For CDP communication
# φ² + 1/φ² = 3

types:
  WebSocketConfig:
    fields:
      url: String
      protocols: List<String>
      headers: Map<String,String>

  WebSocketState:
    fields:
      connected: Bool
      protocol: Option<String>
      extensions: List<String>

  WebSocketMessage:
    fields:
      msg_type: String
      data: String

  WebSocketError:
    fields:
      error_type: String
      message: String

behaviors:
  - name: connect
    given: WebSocket URL (ws:// or wss://)
    when: Establishing WebSocket connection
    then: Return connected client

  - name: handshake
    given: TCP connection and URL
    when: Performing HTTP upgrade handshake
    then: Return WebSocketState

  - name: send_text
    given: Text message
    when: Sending text frame
    then: Return send status

  - name: send_binary
    given: Binary data
    when: Sending binary frame
    then: Return send status

  - name: receive
    given: Nothing
    when: Receiving next message
    then: Return WebSocketMessage

  - name: close
    given: Optional close code and reason
    when: Closing connection gracefully
    then: Return close status

  - name: ping
    given: Nothing
    when: Sending ping
    then: Return pong received
