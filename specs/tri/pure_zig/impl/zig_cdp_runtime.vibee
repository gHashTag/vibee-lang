name: zig_cdp_runtime
version: "14.0.0"
language: zig
module: zig_cdp_runtime

# IMPLEMENTATION: CDP Runtime Domain
# JavaScript execution
# φ² + 1/φ² = 3

types:
  EvalOptions:
    fields:
      expression: String
      return_by_value: Bool
      await_promise: Bool
      timeout_ms: Int

  EvalResult:
    fields:
      success: Bool
      value: Option<String>
      value_type: String
      exception: Option<String>

  RemoteObject:
    fields:
      object_type: String
      subtype: Option<String>
      value: Option<String>
      object_id: Option<String>

  CallFunctionParams:
    fields:
      function_declaration: String
      object_id: Option<String>
      arguments: List<String>

behaviors:
  - name: evaluate
    given: EvalOptions
    when: Evaluating JavaScript expression
    then: Return EvalResult

  - name: evaluate_simple
    given: Expression string
    when: Quick JS evaluation
    then: Return value string

  - name: call_function
    given: CallFunctionParams
    when: Calling function on object
    then: Return EvalResult

  - name: get_properties
    given: Object ID
    when: Getting object properties
    then: Return properties list

  - name: release_object
    given: Object ID
    when: Releasing remote object
    then: Return release status

  - name: run_script
    given: Script source
    when: Running script in page context
    then: Return EvalResult
