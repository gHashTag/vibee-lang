name: zig_http_client
version: "12.0.0"
language: zig
module: zig_http_client

# IMPLEMENTATION: Real Zig HTTP Client
# Uses std.http.Client for HTTPS requests
# Target: OpenAI/Anthropic API calls
# φ² + 1/φ² = 3

types:
  HttpMethod:
    fields:
      method: String

  HttpHeaders:
    fields:
      headers: Map<String,String>

  HttpRequest:
    fields:
      method: String
      uri: String
      headers: Map<String,String>
      body: Option<String>

  HttpResponse:
    fields:
      status: Int
      headers: Map<String,String>
      body: String
      latency_ns: Int

  ClientConfig:
    fields:
      timeout_ms: Int
      max_redirects: Int
      keep_alive: Bool

  ConnectionInfo:
    fields:
      host: String
      port: Int
      tls: Bool
      connected: Bool

behaviors:
  - name: create_client
    given: ClientConfig
    when: Initializing HTTP client with std.http.Client
    then: Return client handle ready for requests

  - name: request
    given: HttpRequest
    when: Making HTTP request using std.http.Client.fetch
    then: Return HttpResponse with body and timing

  - name: get
    given: URI string
    when: Making GET request
    then: Return HttpResponse

  - name: post_json
    given: URI and JSON body string
    when: Making POST with Content-Type application/json
    then: Return HttpResponse

  - name: set_header
    given: Header name and value
    when: Adding header to request
    then: Return updated headers

  - name: close
    given: Client handle
    when: Closing client and connections
    then: Return close status
