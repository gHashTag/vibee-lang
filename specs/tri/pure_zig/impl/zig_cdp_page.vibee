name: zig_cdp_page
version: "14.0.0"
language: zig
module: zig_cdp_page

# IMPLEMENTATION: CDP Page Domain
# Navigation, screenshots, lifecycle
# φ² + 1/φ² = 3

types:
  NavigateOptions:
    fields:
      url: String
      wait_until: String
      timeout_ms: Int

  NavigateResult:
    fields:
      success: Bool
      final_url: String
      load_time_ms: Int

  ScreenshotOptions:
    fields:
      format: String
      quality: Int
      full_page: Bool
      clip: Option<String>

  ScreenshotResult:
    fields:
      data: String
      width: Int
      height: Int

  PageMetrics:
    fields:
      url: String
      title: String
      dom_content_loaded_ms: Int
      load_ms: Int

behaviors:
  - name: navigate
    given: NavigateOptions
    when: Navigating and waiting for load
    then: Return NavigateResult

  - name: reload
    given: Ignore cache flag
    when: Reloading page
    then: Return reload status

  - name: go_back
    given: Nothing
    when: Going to previous page
    then: Return navigation status

  - name: go_forward
    given: Nothing
    when: Going to next page
    then: Return navigation status

  - name: screenshot
    given: ScreenshotOptions
    when: Capturing page screenshot
    then: Return ScreenshotResult (base64)

  - name: get_metrics
    given: Nothing
    when: Getting page metrics
    then: Return PageMetrics

  - name: wait_for_load
    given: Timeout ms
    when: Waiting for page load
    then: Return load status
