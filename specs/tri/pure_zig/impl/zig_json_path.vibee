name: zig_json_path
version: "12.0.0"
language: zig
module: zig_json_path

# IMPLEMENTATION: JSONPath Query
# Extract values from JSON by path
# $.choices[0].message.content
# φ² + 1/φ² = 3

types:
  PathSegment:
    fields:
      segment_type: String
      key: Option<String>
      index: Option<Int>

  JsonPath:
    fields:
      segments: List<String>
      raw_path: String

  PathResult:
    fields:
      found: Bool
      value: Option<String>
      value_type: String

  PathError:
    fields:
      error_type: String
      position: Int
      message: String

behaviors:
  - name: parse_path
    given: Path string like $.foo.bar[0]
    when: Parsing JSONPath expression
    then: Return JsonPath with segments

  - name: query
    given: JSON value and JsonPath
    when: Extracting value by path
    then: Return PathResult

  - name: query_string
    given: JSON and path string
    when: Quick string extraction
    then: Return string or null

  - name: query_number
    given: JSON and path string
    when: Quick number extraction
    then: Return number or null

  - name: query_array
    given: JSON and path string
    when: Extracting array
    then: Return array iterator

  - name: exists
    given: JSON and path string
    when: Checking if path exists
    then: Return bool
