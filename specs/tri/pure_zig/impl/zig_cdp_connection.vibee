name: zig_cdp_connection
version: "14.0.0"
language: zig
module: zig_cdp_connection

# IMPLEMENTATION: CDP Connection
# Chrome DevTools Protocol over WebSocket
# JSON-RPC style communication
# φ² + 1/φ² = 3

types:
  CDPConfig:
    fields:
      host: String
      port: Int
      target_id: Option<String>

  CDPTarget:
    fields:
      id: String
      target_type: String
      title: String
      url: String
      ws_url: String

  CDPMessage:
    fields:
      id: Int
      method: String
      params: Option<String>

  CDPResponse:
    fields:
      id: Int
      result: Option<String>
      error: Option<String>

  CDPEvent:
    fields:
      method: String
      params: String

behaviors:
  - name: discover_targets
    given: CDPConfig host and port
    when: Getting available targets via HTTP
    then: Return list of CDPTargets

  - name: connect
    given: CDPTarget ws_url
    when: Connecting to target via WebSocket
    then: Return CDP session

  - name: send_command
    given: Method and params
    when: Sending CDP command
    then: Return CDPResponse

  - name: wait_event
    given: Event method name
    when: Waiting for specific event
    then: Return CDPEvent

  - name: subscribe
    given: Event domain (e.g. Page, DOM)
    when: Enabling event notifications
    then: Return subscription status

  - name: close
    given: Nothing
    when: Closing CDP connection
    then: Return close status
