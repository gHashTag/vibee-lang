name: zig_response_parser
version: "12.0.0"
language: zig
module: zig_response_parser

# IMPLEMENTATION: HTTP Response Parser
# Parse HTTP responses efficiently
# Extract headers, body, status
# φ² + 1/φ² = 3

types:
  ParsedResponse:
    fields:
      status_code: Int
      status_text: String
      headers: Map<String,String>
      body: String
      content_length: Int

  ChunkedBody:
    fields:
      chunks: List<String>
      total_size: Int
      complete: Bool

  ResponseError:
    fields:
      error_type: String
      message: String
      partial_body: Option<String>

  HeaderValue:
    fields:
      name: String
      value: String
      parameters: Map<String,String>

behaviors:
  - name: parse_status_line
    given: First line of response
    when: Parsing HTTP/1.1 200 OK
    then: Return status code and text

  - name: parse_headers
    given: Header lines
    when: Parsing response headers
    then: Return headers map

  - name: parse_body
    given: Body bytes and content-length
    when: Parsing response body
    then: Return body string

  - name: parse_chunked
    given: Chunked transfer encoding body
    when: Parsing chunked response
    then: Return ChunkedBody

  - name: get_header
    given: ParsedResponse and header name
    when: Getting specific header
    then: Return header value or null

  - name: is_json
    given: ParsedResponse
    when: Checking Content-Type
    then: Return bool
