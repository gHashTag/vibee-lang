name: zig_websocket_frame
version: "14.0.0"
language: zig
module: zig_websocket_frame

# IMPLEMENTATION: WebSocket Frame (RFC 6455)
# Binary frame encoding/decoding
# φ² + 1/φ² = 3

types:
  Opcode:
    fields:
      code: Int

  FrameHeader:
    fields:
      fin: Bool
      opcode: Int
      masked: Bool
      payload_len: Int
      mask_key: Option<List<Int>>

  Frame:
    fields:
      header: String
      payload: String

  CloseCode:
    fields:
      code: Int
      reason: String

behaviors:
  - name: encode_frame
    given: Payload bytes and opcode
    when: Creating WebSocket frame
    then: Return encoded frame bytes

  - name: decode_frame
    given: Raw frame bytes
    when: Parsing WebSocket frame
    then: Return Frame with header and payload

  - name: encode_text
    given: Text string
    when: Creating text frame (opcode 1)
    then: Return encoded frame

  - name: encode_binary
    given: Binary data
    when: Creating binary frame (opcode 2)
    then: Return encoded frame

  - name: encode_close
    given: CloseCode
    when: Creating close frame (opcode 8)
    then: Return encoded frame

  - name: encode_ping
    given: Optional payload
    when: Creating ping frame (opcode 9)
    then: Return encoded frame

  - name: encode_pong
    given: Ping payload
    when: Creating pong frame (opcode 10)
    then: Return encoded frame

  - name: apply_mask
    given: Payload and mask key
    when: Masking client-to-server data
    then: Return masked payload
