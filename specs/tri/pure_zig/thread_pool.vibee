name: thread_pool
version: "11.0.0"
language: zig
module: thread_pool

# INFRA: Thread Pool
# Worker thread management

types:
  ThreadPool:
    fields:
      num_threads: Int
      active_threads: Int
      queue_size: Int

  WorkItem:
    fields:
      work_id: String
      priority: Int
      status: String

  WorkResult:
    fields:
      work_id: String
      success: Bool
      result: Option<String>
      duration_ns: Int

  PoolConfig:
    fields:
      min_threads: Int
      max_threads: Int
      queue_capacity: Int
      idle_timeout_ms: Int

behaviors:
  - name: create_pool
    given: PoolConfig
    when: Creating thread pool
    then: Return ThreadPool

  - name: submit
    given: Work function
    when: Submitting work
    then: Return WorkItem

  - name: submit_priority
    given: Work function and priority
    when: Submitting priority work
    then: Return WorkItem

  - name: wait_result
    given: WorkItem
    when: Waiting for result
    then: Return WorkResult

  - name: resize
    given: ThreadPool and new_size
    when: Resizing pool
    then: Return resize status

  - name: shutdown
    given: ThreadPool
    when: Shutting down pool
    then: Return shutdown status
