name: async_runtime
version: "11.0.0"
language: zig
module: async_runtime

# INFRA: Async Runtime
# Event loop and async execution

types:
  EventLoop:
    fields:
      running: Bool
      pending_tasks: Int
      completed_tasks: Int

  AsyncTask:
    fields:
      task_id: String
      status: String
      result: Option<String>

  Future:
    fields:
      future_id: String
      ready: Bool
      value: Option<String>

  RuntimeConfig:
    fields:
      num_workers: Int
      task_queue_size: Int
      io_threads: Int

behaviors:
  - name: create_runtime
    given: RuntimeConfig
    when: Creating async runtime
    then: Return EventLoop

  - name: spawn_task
    given: Task function
    when: Spawning async task
    then: Return AsyncTask

  - name: await_task
    given: AsyncTask
    when: Waiting for task
    then: Return task result

  - name: run_until_complete
    given: EventLoop
    when: Running event loop
    then: Return when all complete

  - name: cancel_task
    given: AsyncTask
    when: Cancelling task
    then: Return cancel status

  - name: shutdown
    given: EventLoop
    when: Shutting down runtime
    then: Return shutdown status
