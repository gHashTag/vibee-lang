name: planning_backtrack
version: "11.0.0"
language: zig
module: planning_backtrack

# PLANNING: Backtracking
# Recovery from failed paths
# Alternative path exploration

types:
  Checkpoint:
    fields:
      checkpoint_id: String
      state: String
      timestamp: Timestamp
      path_taken: List<String>

  BacktrackDecision:
    fields:
      should_backtrack: Bool
      target_checkpoint: Option<String>
      reason: String
      alternative_paths: List<String>

  PathHistory:
    fields:
      checkpoints: List<String>
      current_path: List<String>
      failed_paths: List<String>
      success_paths: List<String>

  BacktrackConfig:
    fields:
      max_backtracks: Int
      checkpoint_interval: Int
      preserve_learning: Bool

behaviors:
  - name: create_checkpoint
    given: Current state
    when: Saving state for potential backtrack
    then: Return Checkpoint

  - name: should_backtrack
    given: Current state and error
    when: Deciding if backtrack needed
    then: Return BacktrackDecision

  - name: backtrack_to
    given: Checkpoint ID
    when: Reverting to checkpoint
    then: Return restored state

  - name: find_alternative
    given: Failed path
    when: Finding different approach
    then: Return alternative path

  - name: prune_checkpoints
    given: PathHistory and max_checkpoints
    when: Cleaning old checkpoints
    then: Return pruned PathHistory

  - name: learn_from_backtrack
    given: Failed path and successful path
    when: Learning from recovery
    then: Update path preferences
