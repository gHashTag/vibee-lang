name: planning_subgoal
version: "11.0.0"
language: zig
module: planning_subgoal

# PLANNING: Subgoal Management
# Tracking and executing subgoals
# Progress monitoring

types:
  SubgoalState:
    fields:
      subgoal_id: String
      status: String
      progress: Float
      attempts: Int
      last_error: Option<String>

  SubgoalExecution:
    fields:
      subgoal_id: String
      start_time: Timestamp
      end_time: Option<Timestamp>
      steps_taken: Int
      result: Option<String>

  SubgoalQueue:
    fields:
      pending: List<String>
      in_progress: Option<String>
      completed: List<String>
      failed: List<String>

  SubgoalConfig:
    fields:
      max_attempts: Int
      timeout_ms: Int
      retry_delay_ms: Int

behaviors:
  - name: start_subgoal
    given: Subgoal
    when: Beginning execution
    then: Return SubgoalExecution

  - name: update_progress
    given: SubgoalState and progress
    when: Progress made
    then: Return updated SubgoalState

  - name: complete_subgoal
    given: SubgoalExecution and result
    when: Subgoal achieved
    then: Return completion status

  - name: fail_subgoal
    given: SubgoalExecution and error
    when: Subgoal failed
    then: Return failure status

  - name: retry_subgoal
    given: Failed SubgoalState
    when: Attempting retry
    then: Return new SubgoalExecution

  - name: get_next_subgoal
    given: SubgoalQueue
    when: Selecting next to execute
    then: Return next Subgoal
