name: core_react_loop
version: "11.0.0"
language: zig
module: core_react_loop

# CORE: ReAct Loop (Reasoning + Acting)
# Based on arXiv:2210.03629
# Synergizes reasoning traces with task-specific actions
# φ² + 1/φ² = 3

types:
  Thought:
    fields:
      content: String
      reasoning_type: String
      confidence: Float
      timestamp: Timestamp

  Action:
    fields:
      action_type: String
      target: Option<String>
      parameters: Map<String,String>
      thought_id: Int

  Observation:
    fields:
      content: String
      source: String
      success: Bool
      timestamp: Timestamp

  ReActStep:
    fields:
      step_number: Int
      thought: String
      action: String
      observation: String
      duration_ms: Int

  ReActState:
    fields:
      task: String
      steps: List<String>
      current_step: Int
      max_steps: Int
      done: Bool
      final_answer: Option<String>

  ReActConfig:
    fields:
      max_steps: Int
      thought_budget_tokens: Int
      action_timeout_ms: Int
      enable_backtrack: Bool

behaviors:
  - name: think
    given: Current observation and task context
    when: Agent needs to reason about next action
    then: Return Thought with reasoning trace

  - name: act
    given: Thought and available tools
    when: Agent decides on action
    then: Return Action to execute

  - name: observe
    given: Action execution result
    when: Environment returns feedback
    then: Return Observation with structured data

  - name: step
    given: ReActState
    when: Executing one think-act-observe cycle
    then: Return updated ReActState

  - name: run
    given: Task and ReActConfig
    when: Running full ReAct loop
    then: Return final answer or failure

  - name: should_stop
    given: ReActState and Observation
    when: Checking termination condition
    then: Return bool indicating if task complete
