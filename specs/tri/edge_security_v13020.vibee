# VIBEE Specification v13020
# Edge Security - Security for edge and IoT devices
name: edge_security_v13020
version: "1.0.0"
language: zig
module: edge_security

types:
  SecurityLevel:
    fields:
      basic: String
      standard: String
      high: String
      critical: String

  DeviceCredential:
    fields:
      device_id: String
      certificate: String
      private_key: String
      expiry: Timestamp

  SecureElement:
    fields:
      id: String
      type: String
      key_slots: Int
      tamper_resistant: Bool

  AttestationResult:
    fields:
      device_id: String
      firmware_hash: String
      config_hash: String
      trusted: Bool
      timestamp: Timestamp

  SecurityEvent:
    fields:
      device_id: String
      event_type: String
      severity: String
      details: String
      timestamp: Timestamp

behaviors:
  - name: provision_credentials
    given: Device and CA
    When: Provisioning done
    then: Returns device credential

  - name: attest_device
    given: Device
    When: Attestation done
    then: Returns attestation result

  - name: rotate_keys
    given: Device credential
    When: Rotation done
    then: Returns new credential

  - name: detect_anomaly
    given: Device behavior
    When: Detection done
    then: Returns security event
