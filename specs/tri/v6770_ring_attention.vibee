name: v6770_ring_attention
version: "1.0.0"
language: zig
module: v6770_ring_attention

types:
  RingConfig:
    fields:
      ring_size: Int
      block_size: Int

behaviors:
  - name: ring_forward
    given: Local QKV
    when: Compute distributed attention
    then: Return attention via ring communication

  - name: blockwise_attention
    given: Q block and KV blocks
    when: Compute block attention
    then: Return block output

  - name: ring_communication
    given: Local KV
    when: Send to next receive from prev
    then: Return received KV
