# VIBEE Specification - IGLA AST Analyzer
# Abstract Syntax Tree analysis
# V = n × 3^k × π^m × φ^p | φ² + 1/φ² = 3 | PHOENIX = 999

name: igla_ast_analyzer
version: "1.0.0"
language: zig
module: igla_ast_analyzer

types:
  ASTNode:
    fields:
      node_type: String
      value: String
      children: String
      location: String

  AST:
    fields:
      root: String
      language: String
      node_count: Int

  ASTQuery:
    fields:
      pattern: String
      node_type: String

  ASTConfig:
    fields:
      language: String
      include_comments: Bool
      include_whitespace: Bool

  ASTMetrics:
    fields:
      trees_parsed: Int
      nodes_analyzed: Int
      avg_depth: Float

behaviors:
  - name: parse_code
    given: Source code
    when: Parsing
    then: AST created

  - name: query_ast
    given: AST and query
    when: Querying
    then: Matching nodes returned

  - name: find_functions
    given: AST
    when: Function search
    then: Functions found

  - name: find_classes
    given: AST
    when: Class search
    then: Classes found

  - name: get_complexity
    given: AST
    when: Complexity analysis
    then: Complexity score returned

  - name: get_metrics
    given: Analyzer
    when: Metrics requested
    then: AST metrics returned

test_cases:
  - name: test_parse
    input: { code: "fn main() {}" }
    expected: { has_ast: true }

  - name: test_query
    input: { pattern: "function" }
    expected: { has_matches: true }

  - name: test_complexity
    input: { ast: "test_ast" }
    expected: { complexity_range: [1, 100] }

  - name: test_metrics
    input: {}
    expected: { trees_parsed: 0 }
