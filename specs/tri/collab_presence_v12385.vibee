# collab_presence_v12385.vibee - User Presence
# Присутствие пользователей
# φ² + 1/φ² = 3 | PHOENIX = 999

name: collab_presence_v12385
version: "12385.0.0"
language: zig
module: collab_presence_v12385

types:
  UserPresence:
    fields:
      user_id: String
      name: String
      avatar: String
      status: String
      color: String
      last_active: Timestamp

  PresenceUpdate:
    fields:
      user_id: String
      status: String
      location: Object
      metadata: Object

  PresenceRoom:
    fields:
      room_id: String
      users: List
      max_users: Int

  PresenceEvent:
    fields:
      event_type: String
      user: Object
      timestamp: Timestamp

  PresenceConfig:
    fields:
      heartbeat_interval: Int
      timeout_ms: Int
      show_typing: Bool

behaviors:
  - name: join_room
    given: Room ID and user
    when: Join
    then: Return PresenceRoom

  - name: leave_room
    given: Room ID and user
    when: Leave
    then: Return success

  - name: update_presence
    given: PresenceUpdate
    when: Update
    then: Return success

  - name: get_users
    given: Room ID
    when: Users request
    then: Return UserPresence list

  - name: subscribe_events
    given: Room ID
    when: Subscription
    then: Return subscription_id

sacred_constants:
  phi: 1.618033988749895
  phoenix: 999
