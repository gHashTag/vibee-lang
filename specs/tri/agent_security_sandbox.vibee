name: agent_security_sandbox
version: "1.0.0"
language: zig
module: agent_security_sandbox

description: |
  Agent Security Sandbox - sandbox изоляция
  Научные основы: Claude Computer Use isolated VM
  Brave Leo: изолированный профиль
  φ² + 1/φ² = 3 | PHOENIX = 999

types:
  SandboxConfig:
    fields:
      isolation_level: Int
      network_access: Bool
      filesystem_access: Bool
      clipboard_access: Bool
      max_memory_mb: Int

  SandboxState:
    fields:
      sandbox_id: String
      running: Bool
      memory_used_mb: Float
      network_requests: Int
      blocked_actions: Int

  SandboxViolation:
    fields:
      violation_type: String
      action_attempted: String
      timestamp: Timestamp
      blocked: Bool

  SandboxMetrics:
    fields:
      total_actions: Int
      blocked_actions: Int
      violations: List<String>
      uptime_ms: Float

behaviors:
  - name: create_sandbox
    given: SandboxConfig конфигурация
    when: Создание sandbox
    then: SandboxState

  - name: execute_in_sandbox
    given: Действие для выполнения
    when: Выполнение в sandbox
    then: Результат или SandboxViolation

  - name: check_permission
    given: Действие для проверки
    when: Проверка разрешения
    then: Bool разрешено

  - name: log_violation
    given: SandboxViolation нарушение
    when: Логирование нарушения
    then: Нарушение записано

  - name: get_metrics
    given: SandboxState текущий sandbox
    when: Получение метрик
    then: SandboxMetrics

  - name: destroy_sandbox
    given: SandboxState для уничтожения
    when: Уничтожение sandbox
    then: Все данные удалены
