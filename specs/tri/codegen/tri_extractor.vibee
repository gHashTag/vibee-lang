# ═══════════════════════════════════════════════════════════════════════════════
# TRI EXTRACTOR - Extract .zig from .tri files
# ═══════════════════════════════════════════════════════════════════════════════
# Extracts ⲍⲓⲅ_ⲟⲩⲧⲡⲩⲧ: block from .tri files to .zig
# Sacred Formula: V = n × 3^k × π^m × φ^p × e^q
# Golden Identity: φ² + 1/φ² = 3
# ═══════════════════════════════════════════════════════════════════════════════

name: tri_extractor
version: "1.0.0"
language: zig
module: extractor

sacred_constants:
  phi: 1.618033988749895
  trinity: 3.0
  phoenix: 999

creation_pattern:
  source: TriFile
  transformer: Extractor
  result: ZigFile

# ═══════════════════════════════════════════════════════════════════════════════
# TYPES
# ═══════════════════════════════════════════════════════════════════════════════

types:
  ExtractResult:
    fields:
      success: Bool
      input_path: String
      output_path: String
      bytes_extracted: Int
      
  TriFile:
    fields:
      path: String
      content: String
      has_zig_output: Bool

# ═══════════════════════════════════════════════════════════════════════════════
# BEHAVIORS
# ═══════════════════════════════════════════════════════════════════════════════

behaviors:
  - name: extract_zig_block
    given: .tri file with ⲍⲓⲅ_ⲟⲩⲧⲡⲩⲧ block
    when: Run extractor on file
    then: Extract content between triple quotes to .zig file
    algorithm: |
      1. Read .tri file
      2. Find "ⲍⲓⲅ_ⲟⲩⲧⲡⲩⲧ: \"\"\""
      3. Extract content until closing "\"\"\""
      4. Write to trinity/output/<name>.zig
    test_cases:
      - name: extract_success
        input:
          tri_path: "trinity/ЦАРСТВО/.../file.tri"
        expected:
          success: true
          output_exists: true

  - name: derive_output_path
    given: Input .tri path
    when: Need output path
    then: Convert to trinity/output/<name>.zig
    test_cases:
      - name: path_derivation
        input:
          tri_path: "trinity/ЦАРСТВО/ⲘⲈⲆⲚⲞⲈ/ⲧⲣⲓ/ⲧⲉⲥⲧ.tri"
        expected:
          output_path: "trinity/output/test.zig"

  - name: validate_extraction
    given: Extracted .zig file
    when: Run zig test
    then: All tests should pass
    test_cases:
      - name: tests_pass
        input:
          zig_path: "trinity/output/test.zig"
        expected:
          tests_pass: true

# ═══════════════════════════════════════════════════════════════════════════════
# COMMAND
# ═══════════════════════════════════════════════════════════════════════════════

command:
  name: extract
  usage: "vibee extract <input.tri> [output.zig]"
  description: "Extract ⲍⲓⲅ_ⲟⲩⲧⲡⲩⲧ block from .tri to .zig"
  examples:
    - "vibee extract trinity/ЦАРСТВО/.../file.tri"
    - "vibee extract trinity/ЦАРСТВО/.../file.tri trinity/output/file.zig"

# ═══════════════════════════════════════════════════════════════════════════════
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════
