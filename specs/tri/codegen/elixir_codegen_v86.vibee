# Elixir Codegen V86 - BEAM Target
name: elixir_codegen_v86
version: "86.0.0"
language: zig
module: elixir_codegen

creation_pattern:
  source: VibeeSpec
  transformer: ElixirCodeGenerator
  result: ElixirSourceCode

types:
  ElixirModule:
    fields:
      name: String
      functions: List<ElixirFunction>
      structs: List<ElixirStruct>
      uses: List<String>

  ElixirStruct:
    fields:
      name: String
      fields: List<ElixirField>
      enforce_keys: List<String>

  ElixirField:
    fields:
      name: String
      default_value: String

  ElixirFunction:
    fields:
      name: String
      params: List<String>
      guards: List<String>
      body: String
      is_public: Bool

  ElixirTypespec:
    fields:
      name: String
      params: List<String>
      return_type: String

behaviors:
  - name: map_vibee_type_to_elixir
    given: "VIBEE type"
    when: "Type mapping"
    then: "Elixir typespec"
    test_cases:
      - name: map_string
        input: "String"
        expected: "String.t()"
      - name: map_int
        input: "Int"
        expected: "integer()"
      - name: map_list
        input: "List<String>"
        expected: "[String.t()]"

  - name: generate_struct
    given: "VIBEE type"
    when: "Struct generation"
    then: "Elixir defstruct"
    test_cases:
      - name: user_struct
        input: "User { name: String }"
        expected: "defstruct [:name]"

  - name: generate_genserver
    given: "Stateful behavior"
    when: "GenServer generation"
    then: "GenServer module"
    test_cases:
      - name: cache_genserver
        input: "Cache with state"
        expected: "use GenServer"

  - name: generate_supervisor
    given: "Service tree"
    when: "Supervisor generation"
    then: "Supervisor module"
    test_cases:
      - name: app_supervisor
        input: "Application services"
        expected: "use Supervisor"

  - name: generate_tests
    given: "VIBEE test_cases"
    when: "Test generation"
    then: "ExUnit tests"
    test_cases:
      - name: exunit
        input: "test: create_user"
        expected: "test creates user"

# φ² + 1/φ² = 3 | PHOENIX = 999
