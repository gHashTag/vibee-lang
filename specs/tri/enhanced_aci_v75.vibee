# Enhanced Agent-Computer Interface (ACI) V75
# Based on SWE-agent paper (Yang et al. 2024)
# VibeeSpec → AutoCodeGenerator → GeneratedZigCode

name: enhanced_aci_v75
version: "75.0.0"
language: zig
module: enhanced_aci_v75

# ═══════════════════════════════════════════════════════════════
# ACI DESIGN PRINCIPLES (from SWE-agent paper)
# ═══════════════════════════════════════════════════════════════

design_principles:
  principle_1:
    name: "Actions should be simple and easy to understand"
    description: "Minimize cognitive load on the agent"
    implementation: "Single-purpose commands with clear semantics"
    
  principle_2:
    name: "Actions should be compact and efficient"
    description: "Reduce token usage for better context utilization"
    implementation: "Concise output formats, pagination"
    
  principle_3:
    name: "Environment should provide informative feedback"
    description: "Help agent understand state and errors"
    implementation: "Structured error messages, state summaries"
    
  principle_4:
    name: "Guardrails should prevent common mistakes"
    description: "Protect against destructive operations"
    implementation: "Confirmation prompts, undo capability"

# ═══════════════════════════════════════════════════════════════
# ACI COMMANDS (25 commands in 5 categories)
# ═══════════════════════════════════════════════════════════════

commands:
  file_navigation:
    - name: "open"
      syntax: "open <path> [line_number]"
      description: "Open file at optional line number"
      output: "File content with line numbers"
      
    - name: "goto"
      syntax: "goto <line_number>"
      description: "Jump to specific line in current file"
      output: "Context around target line"
      
    - name: "scroll_up"
      syntax: "scroll_up [lines]"
      description: "Scroll up in current file"
      output: "Previous lines with context"
      
    - name: "scroll_down"
      syntax: "scroll_down [lines]"
      description: "Scroll down in current file"
      output: "Next lines with context"
      
    - name: "find_file"
      syntax: "find_file <pattern>"
      description: "Find files matching pattern"
      output: "List of matching file paths"

  file_editing:
    - name: "edit"
      syntax: "edit <start_line>:<end_line>\n<new_content>\nend_of_edit"
      description: "Replace lines with new content"
      output: "Diff preview and confirmation"
      
    - name: "insert"
      syntax: "insert <line_number>\n<content>\nend_of_insert"
      description: "Insert content after line"
      output: "Updated file section"
      
    - name: "delete"
      syntax: "delete <start_line>:<end_line>"
      description: "Delete lines from file"
      output: "Confirmation with deleted content"
      
    - name: "undo"
      syntax: "undo"
      description: "Undo last edit operation"
      output: "Restored content"
      
    - name: "create"
      syntax: "create <path>\n<content>\nend_of_create"
      description: "Create new file with content"
      output: "File creation confirmation"

  search:
    - name: "search_file"
      syntax: "search_file <pattern> [file]"
      description: "Search for pattern in file"
      output: "Matching lines with numbers"
      
    - name: "search_dir"
      syntax: "search_dir <pattern> [directory]"
      description: "Search for pattern in directory"
      output: "Matching files and lines"
      
    - name: "find_definition"
      syntax: "find_definition <symbol>"
      description: "Find symbol definition using LSP"
      output: "Definition location and context"
      
    - name: "find_references"
      syntax: "find_references <symbol>"
      description: "Find all references to symbol"
      output: "List of reference locations"
      
    - name: "search_replace"
      syntax: "search_replace <pattern> <replacement> [file]"
      description: "Search and replace in file"
      output: "Preview of changes"

  execution:
    - name: "run"
      syntax: "run <command>"
      description: "Execute shell command"
      output: "Command output (truncated if long)"
      timeout: 120
      
    - name: "test"
      syntax: "test [test_file] [test_name]"
      description: "Run tests"
      output: "Test results with failures highlighted"
      
    - name: "lint"
      syntax: "lint [file]"
      description: "Run linter on file"
      output: "Lint errors and warnings"
      
    - name: "build"
      syntax: "build"
      description: "Build the project"
      output: "Build output with errors"
      
    - name: "format"
      syntax: "format [file]"
      description: "Format code"
      output: "Formatting changes"

  context:
    - name: "state"
      syntax: "state"
      description: "Show current state summary"
      output: "Current file, line, recent actions"
      
    - name: "history"
      syntax: "history [n]"
      description: "Show last n actions"
      output: "Action history with results"
      
    - name: "diff"
      syntax: "diff"
      description: "Show all changes made"
      output: "Unified diff of all edits"
      
    - name: "submit"
      syntax: "submit"
      description: "Submit solution"
      output: "Final diff and confirmation"
      
    - name: "reset"
      syntax: "reset"
      description: "Reset to initial state"
      output: "Confirmation of reset"

# ═══════════════════════════════════════════════════════════════
# OUTPUT FORMATTING
# ═══════════════════════════════════════════════════════════════

output_formatting:
  file_viewer:
    window_size: 100
    context_lines: 5
    line_numbers: true
    syntax_highlighting: true
    
  search_results:
    max_results: 50
    context_lines: 2
    truncate_long_lines: true
    
  command_output:
    max_lines: 200
    truncate_message: "... (output truncated, use 'scroll_down' to see more)"
    
  error_messages:
    include_suggestion: true
    include_similar_commands: true
    include_documentation_link: true

# ═══════════════════════════════════════════════════════════════
# GUARDRAILS
# ═══════════════════════════════════════════════════════════════

guardrails:
  edit_protection:
    - "Require confirmation for edits > 50 lines"
    - "Prevent editing binary files"
    - "Warn on editing generated files"
    - "Auto-backup before destructive operations"
    
  execution_protection:
    - "Sandbox dangerous commands (rm -rf, etc.)"
    - "Timeout long-running commands"
    - "Limit resource usage"
    - "Log all executed commands"
    
  context_protection:
    - "Warn when context window is 80% full"
    - "Auto-summarize old context"
    - "Prioritize recent and relevant information"

# ═══════════════════════════════════════════════════════════════
# COMPARISON WITH COMPETITORS
# ═══════════════════════════════════════════════════════════════

comparison:
  vibee_aci:
    commands: 25
    categories: 5
    guardrails: 12
    lsp_integration: true
    undo_support: true
    
  swe_agent:
    commands: 15
    categories: 4
    guardrails: 8
    lsp_integration: false
    undo_support: false
    
  claude_code:
    commands: 10
    categories: 3
    guardrails: 5
    lsp_integration: false
    undo_support: false
    
  aider:
    commands: 8
    categories: 2
    guardrails: 3
    lsp_integration: false
    undo_support: true

types:
  ACICommand:
    fields:
      name: String
      syntax: String
      description: String
      category: String

  OutputFormat:
    fields:
      window_size: Int
      context_lines: Int
      line_numbers: Bool

  Guardrail:
    fields:
      name: String
      category: String
      description: String

  ACIComparison:
    fields:
      tool: String
      commands: Int
      guardrails: Int
      lsp: Bool

behaviors:
  - name: execute_command
    given: "ACI command string"
    when: "Command executed"
    then: "Returns formatted output"

  - name: validate_command
    given: "Command input"
    when: "Validation requested"
    then: "Returns validation result with suggestions"

  - name: apply_guardrail
    given: "Operation and context"
    when: "Guardrail check"
    then: "Returns allow/deny with reason"

  - name: format_output
    given: "Raw output"
    when: "Formatting requested"
    then: "Returns formatted output within limits"
