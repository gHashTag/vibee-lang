# vibee_wasm_events.vibee - WASM Event Handling
# Minimal event system for WASM-JS bridge
# V = n × 3^k × π^m × φ^p × e^q

name: vibee_wasm_events
version: "1.0.0"
language: zig
module: vibee_wasm_events

creation_pattern:
  source: EventSpec
  transformer: EventDispatcher
  result: EventSystem

constants:
  EVENT_NONE: 0
  EVENT_MOUSE_DOWN: 1
  EVENT_MOUSE_UP: 2
  EVENT_MOUSE_MOVE: 3
  EVENT_KEY_DOWN: 4
  EVENT_KEY_UP: 5
  EVENT_RESIZE: 6
  EVENT_DBLCLICK: 7
  MAX_EVENTS: 64

types:
  EventType:
    fields:
      code: Int

  MouseEvent:
    fields:
      event_type: Int
      x: Float
      y: Float
      button: Int
      timestamp: Int

  KeyEvent:
    fields:
      event_type: Int
      key_code: Int
      shift: Bool
      ctrl: Bool
      alt: Bool

  ResizeEvent:
    fields:
      width: Float
      height: Float

  EventQueue:
    fields:
      head: Int
      tail: Int
      count: Int

behaviors:
  - name: init_events
    given: Nothing
    when: Initialize
    then: Event queue ready

  - name: push_mouse_event
    given: Type, x, y, button
    when: Mouse action
    then: Event queued

  - name: push_key_event
    given: Type, keycode, modifiers
    when: Key action
    then: Event queued

  - name: push_resize_event
    given: Width, height
    when: Window resize
    then: Event queued

  - name: pop_event
    given: Nothing
    when: Process
    then: Next event or none

  - name: peek_event
    given: Nothing
    when: Check
    then: Next event without removing

  - name: clear_events
    given: Nothing
    when: Reset
    then: Queue emptied

  - name: get_event_count
    given: Nothing
    when: Query
    then: Number of pending events
