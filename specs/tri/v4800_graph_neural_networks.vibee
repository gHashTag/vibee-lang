# v4800 - Graph Neural Networks
# ==============================
# Нейросети на графах - структурные данные
# φ² + 1/φ² = 3 | PHOENIX = 999

name: graph_neural_networks
version: "4.8.0"
language: zig
module: graph_neural_networks

constants:
  PHI: 1.618033988749895
  MAX_NODES: 100000
  HIDDEN_DIM: 256
  NUM_LAYERS: 3

types:
  GraphData:
    fields:
      x: List
      edge_index: List
      edge_attr: List
      num_nodes: Int
      
  GNNConfig:
    fields:
      hidden_dim: Int
      num_layers: Int
      aggregation: String
      
  NodeEmbedding:
    fields:
      node_id: Int
      embedding: List
      
  EdgeEmbedding:
    fields:
      src: Int
      dst: Int
      embedding: List
      
  GraphEmbedding:
    fields:
      graph_embedding: List
      node_embeddings: List
      
  NeighborSample:
    fields:
      center_nodes: List
      sampled_neighbors: List
      edge_indices: List
      
  Batch:
    fields:
      graphs: List
      batch_vector: List
      
  GNNOutput:
    fields:
      node_out: List
      edge_out: List
      graph_out: List

behaviors:
  - name: aggregate_neighbors
    given: Node features и edge_index
    when: Агрегация соседей
    then: Вернуть aggregated features
    
  - name: update_node_features
    given: Aggregated и node features
    when: Обновление узлов
    then: Вернуть updated features
    
  - name: gnn_layer_forward
    given: Graph data и layer params
    when: Один слой GNN
    then: Вернуть updated graph
    
  - name: readout
    given: Node embeddings и batch
    when: Graph-level pooling
    then: Вернуть graph embedding
    
  - name: neighbor_sampling
    given: Graph и target nodes
    when: Mini-batch sampling
    then: Вернуть sampled subgraph
    
  - name: batch_graphs
    given: List of graphs
    when: Batching
    then: Вернуть batched graph
    
  - name: node_classification
    given: Node embeddings и classifier
    when: Node-level prediction
    then: Вернуть node predictions
    
  - name: link_prediction
    given: Node pairs и embeddings
    when: Edge prediction
    then: Вернуть link scores
