# VIBEE Specification v13524
# Shared Selection
# KOSCHEI CYCLE 11 - 1000000x SPEEDUP

name: collab_selection
version: "13524"
language: zig
module: collab_selection

types:
  SelectionState:
    fields:
      user_id: String
      ranges: List<Object>
      color: String

  SelectionRange:
    fields:
      start: Object
      end: Object
      is_reversed: Bool

  SelectionUpdate:
    fields:
      user_id: String
      ranges: List<Object>
      timestamp: Timestamp

  SelectionConfig:
    fields:
      show_selections: Bool
      highlight_style: String
      opacity: Float

  SelectionMetrics:
    fields:
      selections_active: Int
      updates_sent: Int
      conflicts_resolved: Int

  SelectionHighlight:
    fields:
      user_id: String
      color: String
      background_color: String
      border_style: String

behaviors:
  - name: update_selection
    given: New selection ranges
    When: Selection changed
    then: Selection broadcast

  - name: get_selections
    given: Session ID
    When: Selections requested
    then: All selections returned

  - name: clear_selection
    given: User ID
    When: Clear requested
    then: Selection cleared

  - name: merge_selections
    given: Overlapping selections
    When: Merge needed
    then: Selections merged

  - name: highlight_selection
    given: Selection to highlight
    When: Highlight requested
    then: Selection highlighted

  - name: copy_selection
    given: Selected content
    When: Copy requested
    then: Content copied

creation_pattern:
  source: SelectionConfig
  transformer: SelectionManager
  result: SelectionState
