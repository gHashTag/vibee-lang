# omniscient_dpo_v13374.vibee
# KOSCHEI CYCLE 9 - DPO Browser Learning
# Direct Preference Optimization | arXiv:2305.18290

name: omniscient_dpo
version: "13374.0.0"
language: zig
module: omniscient_dpo

types:
  DPOConfig:
    fields:
      beta: Float
      learning_rate: Float
      kl_penalty: Float

  PreferencePair:
    fields:
      prompt: String
      chosen: String
      rejected: String

  DPOLoss:
    fields:
      loss_value: Float
      chosen_reward: Float
      rejected_reward: Float

  DPOResult:
    fields:
      model_updated: Bool
      loss_history: String
      preference_accuracy: Float

behaviors:
  - name: create_dpo_config
    given: DPO parameters
    when: Config creation
    then: Returns DPOConfig

  - name: create_preference_pair
    given: Prompt and responses
    when: Pair creation
    then: Returns PreferencePair

  - name: compute_dpo_loss
    given: PreferencePair
    when: Loss computation
    then: Returns DPOLoss

  - name: update_model
    given: DPOLoss
    when: Model update
    then: Returns DPOResult

  - name: evaluate_preferences
    given: Test pairs
    When: Evaluation
    then: Returns accuracy

  - name: learn_from_feedback
    given: User feedback
    When: Learning
    then: Returns DPOResult
