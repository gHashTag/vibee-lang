# VIBEE Specification v12210
# Anomaly Detection - ML-based anomaly detection for metrics
name: anomaly_detection_v12210
version: "1.0.0"
language: zig
module: anomaly_detection

types:
  AnomalyType:
    fields:
      spike: String
      drop: String
      trend: String
      seasonal: String

  Anomaly:
    fields:
      id: String
      type: String
      metric_name: String
      expected_value: Float
      actual_value: Float
      confidence: Float
      detected_at: Timestamp

  AnomalyDetector:
    fields:
      id: String
      metric: String
      algorithm: String
      sensitivity: Float
      trained: Bool

  DetectionResult:
    fields:
      detector_id: String
      anomalies: String
      normal_count: Int
      anomaly_count: Int
      analyzed_at: Timestamp

  TrainingData:
    fields:
      metric_name: String
      values: String
      timestamps: String
      window_size: Int

behaviors:
  - name: create_detector
    given: Detector configuration
    when: Detector created
    then: Returns untrained detector

  - name: train_detector
    given: Detector and training data
    when: Training completed
    then: Returns trained detector

  - name: detect_anomalies
    given: Trained detector and metric values
    when: Detection run
    then: Returns detection result

  - name: classify_anomaly
    given: Detected anomaly
    when: Classification requested
    then: Returns anomaly type and confidence
