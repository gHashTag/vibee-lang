# VIBEE Specification v13565
# Network Isolation
# KOSCHEI CYCLE 11 - 1000000x SPEEDUP

name: sandbox_network
version: "13565"
language: zig
module: sandbox_network

types:
  NetworkIsolation:
    fields:
      id: String
      policy: Object
      allowed_hosts: List<String>

  NetworkPolicy:
    fields:
      policy_id: String
      ingress_rules: List<Object>
      egress_rules: List<Object>

  NetworkRule:
    fields:
      rule_type: String
      protocol: String
      port: Int
      host: String
      action: String

  NetworkState:
    fields:
      isolation_id: String
      connections_active: Int
      bytes_in: Int
      bytes_out: Int

  NetworkMetrics:
    fields:
      connections_blocked: Int
      connections_allowed: Int
      bytes_transferred: Int

  NetworkViolation:
    fields:
      violation_type: String
      source: String
      destination: String
      timestamp: Timestamp

behaviors:
  - name: apply_isolation
    given: Network policy
    When: Isolation requested
    then: Network isolated

  - name: allow_host
    given: Host address
    When: Allow requested
    then: Host allowed

  - name: block_host
    given: Host address
    When: Block requested
    then: Host blocked

  - name: monitor_traffic
    given: Isolated network
    When: Monitoring enabled
    then: Traffic monitored

  - name: log_violation
    given: Policy violation
    When: Violation detected
    then: Violation logged

  - name: remove_isolation
    given: Isolation ID
    When: Removal requested
    then: Isolation removed

creation_pattern:
  source: NetworkPolicy
  transformer: NetworkIsolator
  result: NetworkIsolation
