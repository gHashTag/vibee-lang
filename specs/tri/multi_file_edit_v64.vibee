# ═══════════════════════════════════════════════════════════════════════════════
# MULTI-FILE EDIT v64 - Atomic Multi-file Operations (HIGH Priority, D&C Pattern)
# ═══════════════════════════════════════════════════════════════════════════════
#
# PRIORITY: HIGH
# PAS PATTERN: D&C (Divide-and-Conquer) - 31% success rate
# COMPETITORS: Claude Code, Cursor, Aider, Cline, OpenHands
#
# SCIENTIFIC REFERENCES:
# 1. Yao (2022) "ReAct" - Reasoning and Acting
# 2. Yang (2024) "SWE-agent" - Multi-file GitHub issues
# 3. Jimenez (2024) "SWE-bench" - Multi-file benchmark
#
# ═══════════════════════════════════════════════════════════════════════════════

name: multi_file_edit_v64
version: "64.0.0"
language: zig
module: multi_file_edit_v64
author: "Dmitrii Vasilev"

sacred_constants:
  phi: 1.618033988749895
  trinity: 3.0
  phoenix: 999

creation_pattern:
  source: EditRequest
  transformer: MultiFileEditor
  result: AtomicEditResult

types:
  - name: EditOperation
    enum:
      - Create
      - Modify
      - Delete
      - Rename
      - Move

  - name: FileEdit
    fields:
      - name: path
        type: String
      - name: operation
        type: EditOperation
      - name: old_content
        type: Option<String>
      - name: new_content
        type: Option<String>

  - name: EditBatch
    fields:
      - name: edits
        type: List<FileEdit>
      - name: atomic
        type: Bool
      - name: dry_run
        type: Bool

  - name: EditResult
    fields:
      - name: success
        type: Bool
      - name: files_modified
        type: Int
      - name: rollback_available
        type: Bool

  - name: DiffHunk
    fields:
      - name: old_start
        type: Int
      - name: old_count
        type: Int
      - name: new_start
        type: Int
      - name: new_count
        type: Int
      - name: content
        type: String

  - name: Benchmark
    fields:
      - name: version
        type: String
      - name: speed
        type: Float
      - name: tests
        type: Int
      - name: memory_kb
        type: Int
      - name: max_files
        type: Int
      - name: atomic
        type: Bool

behaviors:
  - name: edit_files
    given: "Batch of file edits"
    when: "Edit requested"
    then: "Apply all edits atomically"
    pas_pattern: D&C
    complexity: O(n)
    test_cases:
      - name: edit_single
        input: "1 file"
        expected: "Success"
      - name: edit_multiple
        input: "5 files"
        expected: "All modified"
      - name: rollback_on_error
        input: "Invalid edit"
        expected: "Rolled back"

  - name: generate_diff
    given: "Old and new content"
    when: "Diff requested"
    then: "Return unified diff"
    pas_pattern: D&C
    complexity: O(n*m)
    test_cases:
      - name: simple_diff
        input: "a → b"
        expected: "-a\n+b"

  - name: apply_diff
    given: "File and diff"
    when: "Apply requested"
    then: "Return modified content"
    pas_pattern: D&C
    complexity: O(n)
    test_cases:
      - name: apply_add
        input: "+new line"
        expected: "Line added"

  - name: validate_batch
    given: "Edit batch"
    when: "Validation requested"
    then: "Return validation result"
    pas_pattern: D&C
    complexity: O(n)
    test_cases:
      - name: valid_batch
        input: "All valid"
        expected: "Valid"

competitors:
  - name: Claude Code
    multi_file: true
    max_files: 50
    atomic: true

  - name: Cursor
    multi_file: true
    max_files: 20
    atomic: true

  - name: Aider
    multi_file: true
    max_files: 100
    atomic: true

  - name: Copilot
    multi_file: false
    max_files: 1
    atomic: false

  - name: VIBEE v64
    multi_file: true
    max_files: 100
    atomic: true

metadata:
  priority: HIGH
  pas_pattern: D&C
  types: 6
  behaviors: 4
  test_cases: 10
