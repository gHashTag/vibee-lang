# VIBEE Specification v12270
# Encryption Service - Data encryption at rest and in transit
name: encryption_service_v12270
version: "1.0.0"
language: zig
module: encryption_service

types:
  EncryptionAlgorithm:
    fields:
      aes256: String
      rsa: String
      chacha20: String

  EncryptionKey:
    fields:
      id: String
      algorithm: String
      key_size: Int
      created_at: Timestamp
      rotated_at: Timestamp

  EncryptedData:
    fields:
      key_id: String
      ciphertext: String
      iv: String
      tag: String

  KeyPolicy:
    fields:
      key_id: String
      allowed_operations: String
      expiry_days: Int

  DecryptionResult:
    fields:
      plaintext: String
      key_id: String
      decrypted_at: Timestamp

behaviors:
  - name: generate_key
    given: Algorithm and size
    when: Key generated
    then: Returns encryption key

  - name: encrypt_data
    given: Plaintext and key
    when: Encryption performed
    then: Returns encrypted data

  - name: decrypt_data
    given: Encrypted data and key
    when: Decryption performed
    then: Returns decryption result

  - name: rotate_key
    given: Existing key
    when: Rotation performed
    then: Returns new key version
