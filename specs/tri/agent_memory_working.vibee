# Working Memory Module
# Short-term active memory for current task
# Manus insight: todo.md for attention manipulation

name: agent_memory_working
version: "1.0.0"
language: zig
module: agent_memory_working

types:
  WorkingMemory:
    fields:
      memory_id: String
      current_goal: String
      active_plan: List<String>
      scratchpad: String
      attention_focus: List<String>

  AttentionItem:
    fields:
      item_id: String
      content: String
      priority: Float
      recency: Int
      relevance: Float

  PlanCheckpoint:
    fields:
      checkpoint_id: String
      completed_steps: List<String>
      pending_steps: List<String>
      current_step: String

  ScratchpadEntry:
    fields:
      entry_id: String
      entry_type: String
      content: String
      timestamp: Timestamp

  MemoryRefresh:
    fields:
      refresh_id: String
      items_refreshed: List<String>
      items_decayed: List<String>

behaviors:
  - name: initialize_working_memory
    given: Task and initial plan
    when: Task begins
    then: Returns initialized working memory

  - name: update_plan_progress
    given: Completed step
    when: Step completion
    then: Returns updated checkpoint

  - name: write_to_scratchpad
    given: Content and type
    when: Intermediate result available
    then: Returns updated scratchpad

  - name: focus_attention
    given: Items to focus on
    when: Attention manipulation needed
    then: Returns reordered attention items

  - name: recite_goals
    given: Current working memory
    when: Goal reinforcement needed
    then: Returns goal recitation for context end

  - name: refresh_memory
    given: Working memory and decay rate
    when: Memory refresh needed
    then: Returns refreshed memory with decayed items

  - name: extract_for_context
    given: Working memory and token budget
    when: Context compilation needed
    then: Returns optimized context string
