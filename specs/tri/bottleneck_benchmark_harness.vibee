name: bottleneck_benchmark_harness
version: "1.0.0"
language: zig
module: bottleneck_benchmark_harness

# BOTTLENECK: Benchmark Harness
# Performance measurement and comparison framework
# Tracks metrics across iterations

types:
  BenchmarkRun:
    fields:
      run_id: String
      timestamp: Timestamp
      version: String
      config: String

  Metric:
    fields:
      name: String
      value: Float
      unit: String
      timestamp: Timestamp

  BenchmarkResult:
    fields:
      run_id: String
      task_count: Int
      success_count: Int
      success_rate: Float
      avg_steps: Float
      avg_duration_ms: Float
      p50_duration_ms: Float
      p95_duration_ms: Float

  Comparison:
    fields:
      baseline_run: String
      current_run: String
      delta_success_rate: Float
      delta_avg_duration: Float
      improved: Bool

  PerformanceProfile:
    fields:
      component: String
      total_time_ms: Int
      call_count: Int
      avg_time_ms: Float

behaviors:
  - name: start_run
    given: Version and config
    when: Beginning benchmark run
    then: Return BenchmarkRun handle

  - name: record_metric
    given: BenchmarkRun and Metric
    when: Recording performance data
    then: Return record status

  - name: finish_run
    given: BenchmarkRun
    when: Completing benchmark run
    then: Return BenchmarkResult

  - name: compare_runs
    given: Baseline run ID and current run ID
    when: Comparing performance
    then: Return Comparison with deltas

  - name: profile_component
    given: Component name and duration
    when: Profiling specific component
    then: Update PerformanceProfile

  - name: export_results
    given: BenchmarkRun and format
    when: Exporting results
    then: Return formatted results string
