# VIBEE Specification v12170
# Tracing System - Distributed tracing for request flows
name: tracing_system_v12170
version: "1.0.0"
language: zig
module: tracing_system

types:
  Span:
    fields:
      trace_id: String
      span_id: String
      parent_id: String
      name: String
      start_time: Timestamp
      end_time: Timestamp
      status: String

  Trace:
    fields:
      id: String
      root_span_id: String
      spans: String
      service: String
      duration_ms: Int

  SpanContext:
    fields:
      trace_id: String
      span_id: String
      baggage: String
      sampled: Bool

  TracingConfig:
    fields:
      service_name: String
      sample_rate: Float
      exporter: String
      enabled: Bool

  TraceQuery:
    fields:
      service: String
      operation: String
      min_duration_ms: Int
      start_time: Timestamp
      end_time: Timestamp

behaviors:
  - name: start_span
    given: Span context and name
    when: Span started
    then: Returns active span

  - name: end_span
    given: Active span
    when: Span ended
    then: Returns completed span with duration

  - name: create_trace
    given: Root span
    when: Trace created
    then: Returns trace with spans

  - name: query_traces
    given: Trace query
    when: Query executed
    then: Returns matching traces
