# ═══════════════════════════════════════════════════════════════════════════════
# CPP CODEGEN v1086 - Real C++ Code Generator
# ═══════════════════════════════════════════════════════════════════════════════
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════

name: cpp_codegen
version: "10.8.6"
language: zig
module: cpp_codegen

sacred_constants:
  phi: 1.618033988749895
  trinity: 3.0
  phoenix: 999

creation_pattern:
  source: VIBEESpec
  transformer: CppCodegen
  result: CppSourceCode

types:
  CppOutput:
    fields:
      header: String
      source: String
      cmake: String
      tests: String

  CppClass:
    fields:
      name: String
      members: List<CppMember>
      methods: List<CppMethod>
      namespace: String

  CppMember:
    fields:
      name: String
      cpp_type: String
      access: String

  CppMethod:
    fields:
      name: String
      params: List<String>
      return_type: String
      is_const: Bool
      body: String

behaviors:
  - name: generate_cpp_header
    given: "VIBEE type definition"
    when: "Header generation requested"
    then: "C++ header generated"
    pas_pattern: ALG
    test_cases:
      - name: test_header
        input: '{"name": "User", "fields": [{"name": "id", "type": "Int"}]}'
        expected: '{"code": "#pragma once\\n\\nclass User {\\npublic:\\n    int64_t id;\\n};"}'

  - name: generate_cpp_source
    given: "VIBEE behaviors"
    when: "Source generation requested"
    then: "C++ source generated"
    pas_pattern: ALG
    test_cases:
      - name: test_source
        input: '{"class": "User"}'
        expected: '{"code": "#include \\"User.hpp\\"\\n..."}'

  - name: generate_cpp_tests
    given: "VIBEE test cases"
    when: "Test generation requested"
    then: "Google Test tests generated"
    pas_pattern: ALG
    test_cases:
      - name: test_gtest
        input: '{"test_name": "Create"}'
        expected: '{"code": "TEST(UserTest, Create) { ... }"}'

  - name: map_type_to_cpp
    given: "VIBEE type"
    when: "Type mapping"
    then: "C++ type"
    pas_pattern: PRE
    test_cases:
      - name: test_string
        input: '{"vibee_type": "String"}'
        expected: '{"cpp_type": "std::string"}'
      - name: test_int
        input: '{"vibee_type": "Int"}'
        expected: '{"cpp_type": "int64_t"}'

  - name: generate_cmake
    given: "Project config"
    when: "CMakeLists.txt generation"
    then: "CMake content"
    pas_pattern: PRE
    test_cases:
      - name: test_cmake
        input: '{"project": "vibee_user"}'
        expected: '{"cmake": "cmake_minimum_required(VERSION 3.20)\\nproject(vibee_user)"}'

type_mappings:
  String: "std::string"
  Int: "int64_t"
  Float: "double"
  Bool: "bool"
  List: "std::vector"
  Option: "std::optional"
  Object: "std::unordered_map<std::string, std::any>"
  Timestamp: "std::chrono::time_point<std::chrono::system_clock>"

# ═══════════════════════════════════════════════════════════════════════════════
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════
