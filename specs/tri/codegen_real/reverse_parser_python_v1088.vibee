# ═══════════════════════════════════════════════════════════════════════════════
# REVERSE PARSER PYTHON v1088 - Python to VIBEE Reverse Parser
# ═══════════════════════════════════════════════════════════════════════════════
# φ² + 1/φ² = 3 | PHOENIX = 999
# This parses Python code and generates VIBEE specifications
# ═══════════════════════════════════════════════════════════════════════════════

name: reverse_parser_python
version: "10.8.8"
language: zig
module: reverse_parser_python

sacred_constants:
  phi: 1.618033988749895
  trinity: 3.0
  phoenix: 999

creation_pattern:
  source: PythonSourceCode
  transformer: PythonReverseParser
  result: VIBEESpec

types:
  PythonParseResult:
    fields:
      classes: List<ParsedClass>
      functions: List<ParsedFunction>
      imports: List<String>

  ParsedClass:
    fields:
      name: String
      fields: List<ParsedField>
      methods: List<ParsedMethod>
      decorators: List<String>

  ParsedField:
    fields:
      name: String
      type_hint: String
      default_value: String

  ParsedMethod:
    fields:
      name: String
      params: List<String>
      return_type: String
      docstring: String

behaviors:
  - name: parse_python_class
    given: "Python class source"
    when: "Class parsing"
    then: "Parsed class structure"
    pas_pattern: ALG
    test_cases:
      - name: test_dataclass
        input: '{"code": "@dataclass\\nclass User:\\n    id: int\\n    name: str"}'
        expected: '{"name": "User", "fields": [{"name": "id", "type": "int"}, {"name": "name", "type": "str"}]}'

  - name: parse_python_function
    given: "Python function source"
    when: "Function parsing"
    then: "Parsed function structure"
    pas_pattern: ALG
    test_cases:
      - name: test_function
        input: '{"code": "def create_user(name: str) -> User:\\n    pass"}'
        expected: '{"name": "create_user", "params": [{"name": "name", "type": "str"}], "return": "User"}'

  - name: infer_vibee_type
    given: "Python type hint"
    when: "Type inference"
    then: "VIBEE type"
    pas_pattern: PRE
    test_cases:
      - name: test_str
        input: '{"python_type": "str"}'
        expected: '{"vibee_type": "String"}'
      - name: test_int
        input: '{"python_type": "int"}'
        expected: '{"vibee_type": "Int"}'
      - name: test_list
        input: '{"python_type": "List[str]"}'
        expected: '{"vibee_type": "List<String>"}'

  - name: generate_vibee_spec
    given: "Parsed Python code"
    when: "Spec generation"
    then: "VIBEE specification"
    pas_pattern: ALG
    test_cases:
      - name: test_spec
        input: '{"classes": [...], "functions": [...]}'
        expected: '{"spec": "name: user\\nversion: 1.0.0\\ntypes:\\n  User:\\n    fields:\\n      id: Int"}'

  - name: extract_docstrings
    given: "Python source"
    when: "Docstring extraction"
    then: "Behavior descriptions"
    pas_pattern: ALG
    test_cases:
      - name: test_docstring
        input: '{"code": "def create():\\n    \\"\\"\\"Creates a user.\\"\\"\\"\\n    pass"}'
        expected: '{"description": "Creates a user."}'

type_reverse_mappings:
  str: "String"
  int: "Int"
  float: "Float"
  bool: "Bool"
  list: "List"
  dict: "Object"
  Optional: "Option"

# ═══════════════════════════════════════════════════════════════════════════════
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════
