# VIBEE Specification v13531
# ONNX Runtime Core
# KOSCHEI CYCLE 11 - 1000000x SPEEDUP

name: onnx_core
version: "13531"
language: zig
module: onnx_core

types:
  ONNXRuntime:
    fields:
      id: String
      version: String
      execution_providers: List<String>
      session_options: Object

  ONNXSession:
    fields:
      session_id: String
      model_path: String
      inputs: List<Object>
      outputs: List<Object>
      status: String

  ONNXConfig:
    fields:
      execution_provider: String
      graph_optimization_level: String
      intra_op_threads: Int
      inter_op_threads: Int

  InferenceResult:
    fields:
      outputs: List<Object>
      inference_time_ms: Float
      memory_used_mb: Int

  ONNXMetrics:
    fields:
      inferences_total: Int
      avg_inference_ms: Float
      models_loaded: Int
      memory_usage_mb: Int

  ExecutionProvider:
    fields:
      name: String
      device_type: String
      device_id: Int
      available: Bool

behaviors:
  - name: initialize_runtime
    given: Runtime configuration
    When: Initialization requested
    then: ONNX runtime initialized

  - name: create_session
    given: Model path and options
    When: Session creation requested
    then: Inference session created

  - name: run_inference
    given: Session and inputs
    When: Inference requested
    then: Inference executed

  - name: get_providers
    given: Runtime instance
    When: Providers requested
    then: Available providers returned

  - name: release_session
    given: Active session
    When: Release requested
    then: Session resources released

  - name: shutdown_runtime
    given: Active runtime
    When: Shutdown requested
    then: Runtime shut down

creation_pattern:
  source: ONNXConfig
  transformer: ONNXCore
  result: ONNXRuntime
