# VULNERABILITY RESEARCH V138 - Legal Research Methodology
# VIBEE AMPLIFICATION MODE: Professional Security Research
name: vuln_research_v138
version: "138.0.0"
language: zig
module: vuln_research

creation_pattern:
  source: SecurityKnowledge
  transformer: MethodologyBuilder
  result: ResearchFramework

# МЕТОДОЛОГИЯ ПОИСКА УЯЗВИМОСТЕЙ
# Легальный и этичный подход к security research

types:
  ResearchPhase:
    fields:
      phase_id: String
      name: String
      duration: String
      activities: List<String>
      tools: List<String>
      outputs: List<String>

  VulnerabilityType:
    fields:
      vuln_id: String
      name: String
      owasp_category: String
      cwe_id: String
      detection_method: String
      exploitation: String
      remediation: String

  ReconTechnique:
    fields:
      technique: String
      purpose: String
      tools: List<String>
      legal_notes: String

  TestingChecklist:
    fields:
      category: String
      checks: List<String>
      priority: String

  FindingTemplate:
    fields:
      field: String
      description: String
      example: String

  SkillPath:
    fields:
      skill: String
      resources: List<String>
      practice: List<String>
      time_to_learn: String

  AutomationScript:
    fields:
      name: String
      purpose: String
      language: String
      legal_use: String

  ResearchFramework:
    fields:
      phases: List<ResearchPhase>
      vulnerabilities: List<VulnerabilityType>
      techniques: List<ReconTechnique>
      checklists: List<TestingChecklist>

behaviors:
  - name: plan_research
    given: "Target scope"
    when: "Planning"
    then: "Research plan"
    test_cases:
      - name: plan
        input: "scope"
        expected: "plan created"

  - name: execute_recon
    given: "Research plan"
    when: "Reconnaissance"
    then: "Target information"
    test_cases:
      - name: recon
        input: "plan"
        expected: "info gathered"

  - name: identify_vulns
    given: "Target information"
    when: "Testing"
    then: "Vulnerabilities found"
    test_cases:
      - name: identify
        input: "info"
        expected: "vulns found"

  - name: validate_finding
    given: "Potential vulnerability"
    when: "Validation"
    then: "Confirmed vulnerability"
    test_cases:
      - name: validate
        input: "potential"
        expected: "confirmed"

  - name: document_finding
    given: "Confirmed vulnerability"
    when: "Documentation"
    then: "Report ready"
    test_cases:
      - name: document
        input: "vuln"
        expected: "report"

  - name: assess_impact
    given: "Vulnerability details"
    when: "Impact assessment"
    then: "CVSS score"
    test_cases:
      - name: assess
        input: "details"
        expected: "cvss"

# ФАЗА 1: РАЗВЕДКА (RECONNAISSANCE)

phase_reconnaissance:
  name: "Reconnaissance"
  duration: "1-3 дня"
  goal: "Собрать информацию о цели в рамках scope"
  
  passive_recon:
    description: "Сбор информации без прямого взаимодействия"
    techniques:
      subdomain_enum:
        purpose: "Найти все поддомены"
        tools: ["Subfinder", "Amass", "crt.sh"]
        command: "subfinder -d target.com -o subdomains.txt"
        legal: "Публичная информация, всегда легально"
        
      dns_records:
        purpose: "Изучить DNS записи"
        tools: ["dig", "nslookup", "dnsx"]
        command: "dig target.com ANY"
        legal: "Публичная информация"
        
      whois:
        purpose: "Информация о домене"
        tools: ["whois"]
        command: "whois target.com"
        legal: "Публичная информация"
        
      google_dorking:
        purpose: "Найти утечки через Google"
        examples:
          - "site:target.com filetype:pdf"
          - "site:target.com inurl:admin"
          - "site:target.com ext:sql"
        legal: "Публичная информация"
        
      github_search:
        purpose: "Найти утечки в коде"
        examples:
          - "org:target password"
          - "target.com api_key"
        legal: "Публичная информация"
        
      wayback_machine:
        purpose: "Исторические версии сайта"
        tools: ["waybackurls", "gau"]
        legal: "Публичная информация"

  active_recon:
    description: "Прямое взаимодействие с целью"
    warning: "ТОЛЬКО в рамках scope!"
    techniques:
      port_scan:
        purpose: "Найти открытые порты"
        tools: ["Nmap", "Masscan"]
        command: "nmap -sV -sC target.com"
        legal: "Только в scope, может быть заблокировано"
        
      tech_detection:
        purpose: "Определить технологии"
        tools: ["Wappalyzer", "WhatWeb", "Nuclei"]
        legal: "В рамках scope"
        
      directory_bruteforce:
        purpose: "Найти скрытые директории"
        tools: ["Gobuster", "Feroxbuster", "Dirsearch"]
        command: "gobuster dir -u https://target.com -w wordlist.txt"
        legal: "В рамках scope, осторожно с rate limiting"

# ФАЗА 2: ТЕСТИРОВАНИЕ

phase_testing:
  name: "Vulnerability Testing"
  duration: "3-14 дней"
  
  owasp_top_10:
    A01_broken_access:
      name: "Broken Access Control"
      tests:
        - "IDOR - изменить ID в запросе"
        - "Privilege escalation"
        - "Forced browsing"
        - "Missing function level access control"
      tools: ["Burp Suite", "Manual testing"]
      
    A02_crypto_failures:
      name: "Cryptographic Failures"
      tests:
        - "Sensitive data in URL"
        - "Weak encryption"
        - "Missing HTTPS"
        - "Sensitive data in logs"
      tools: ["Burp Suite", "SSLyze"]
      
    A03_injection:
      name: "Injection"
      tests:
        - "SQL Injection"
        - "NoSQL Injection"
        - "Command Injection"
        - "LDAP Injection"
      tools: ["SQLMap", "Burp Suite"]
      warning: "Осторожно! Не повредите данные"
      
    A04_insecure_design:
      name: "Insecure Design"
      tests:
        - "Business logic flaws"
        - "Race conditions"
        - "Missing rate limiting"
      tools: ["Manual testing", "Burp Intruder"]
      
    A05_security_misconfig:
      name: "Security Misconfiguration"
      tests:
        - "Default credentials"
        - "Unnecessary features enabled"
        - "Verbose error messages"
        - "Missing security headers"
      tools: ["Nuclei", "Nikto"]
      
    A06_vulnerable_components:
      name: "Vulnerable Components"
      tests:
        - "Outdated libraries"
        - "Known CVEs"
      tools: ["Retire.js", "Snyk", "npm audit"]
      
    A07_auth_failures:
      name: "Authentication Failures"
      tests:
        - "Weak passwords allowed"
        - "Credential stuffing"
        - "Session fixation"
        - "Missing 2FA"
      tools: ["Burp Suite", "Hydra"]
      
    A08_integrity_failures:
      name: "Software and Data Integrity Failures"
      tests:
        - "Insecure deserialization"
        - "CI/CD vulnerabilities"
      tools: ["ysoserial", "Manual testing"]
      
    A09_logging_failures:
      name: "Security Logging Failures"
      tests:
        - "Missing audit logs"
        - "Logs exposed"
      tools: ["Manual testing"]
      
    A10_ssrf:
      name: "Server-Side Request Forgery"
      tests:
        - "Internal service access"
        - "Cloud metadata access"
      tools: ["Burp Suite", "SSRFmap"]

# ФАЗА 3: ЭКСПЛУАТАЦИЯ (PoC)

phase_exploitation:
  name: "Proof of Concept"
  warning: "МИНИМАЛЬНОЕ воздействие!"
  
  principles:
    - "Только доказать уязвимость"
    - "Не читать чужие данные"
    - "Не модифицировать данные"
    - "Не нарушать работу сервиса"
    - "Документировать каждый шаг"
    
  poc_examples:
    xss:
      payload: "alert(document.domain)"
      not_allowed: "Кража cookies реальных пользователей"
      
    sqli:
      payload: "' OR '1'='1"
      allowed: "Показать что запрос изменяется"
      not_allowed: "Дамп всей базы данных"
      
    idor:
      allowed: "Показать доступ к своим данным через чужой ID"
      not_allowed: "Массовый сбор чужих данных"

# ЧЕКЛИСТЫ ПО ТИПАМ УЯЗВИМОСТЕЙ

checklists:
  authentication:
    priority: "High"
    checks:
      - "Проверить password policy"
      - "Тест на brute force"
      - "Проверить reset password flow"
      - "Тест на session management"
      - "Проверить remember me"
      - "Тест на logout"
      
  authorization:
    priority: "High"
    checks:
      - "IDOR на всех endpoints"
      - "Horizontal privilege escalation"
      - "Vertical privilege escalation"
      - "Missing function level access"
      
  input_validation:
    priority: "High"
    checks:
      - "XSS во всех input полях"
      - "SQL injection"
      - "Command injection"
      - "Path traversal"
      - "File upload"
      
  api_security:
    priority: "Medium"
    checks:
      - "Rate limiting"
      - "API key exposure"
      - "Mass assignment"
      - "Excessive data exposure"
      
  configuration:
    priority: "Medium"
    checks:
      - "Security headers"
      - "CORS policy"
      - "Cookie flags"
      - "Error handling"

# ИНСТРУМЕНТЫ

tools_by_phase:
  recon:
    - name: "Subfinder"
      install: "go install github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest"
      
    - name: "Amass"
      install: "go install github.com/owasp-amass/amass/v4/...@master"
      
    - name: "httpx"
      install: "go install github.com/projectdiscovery/httpx/cmd/httpx@latest"
      
  scanning:
    - name: "Nuclei"
      install: "go install github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest"
      purpose: "Vulnerability scanning with templates"
      
    - name: "Nmap"
      install: "apt install nmap"
      
  testing:
    - name: "Burp Suite"
      type: "Web proxy"
      essential: true
      
    - name: "OWASP ZAP"
      type: "Web proxy (free)"
      
  exploitation:
    - name: "SQLMap"
      warning: "Только в scope!"
      
    - name: "XSStrike"
      purpose: "XSS detection"

# АВТОМАТИЗАЦИЯ

automation_workflow:
  step_1:
    name: "Subdomain enumeration"
    script: |
      subfinder -d $TARGET -o subs.txt
      cat subs.txt | httpx -o live.txt
      
  step_2:
    name: "Technology detection"
    script: |
      cat live.txt | httpx -tech-detect -o tech.txt
      
  step_3:
    name: "Vulnerability scanning"
    script: |
      nuclei -l live.txt -t nuclei-templates/ -o vulns.txt
      
  step_4:
    name: "Manual testing"
    note: "Автоматизация не заменяет ручное тестирование!"

# ДОКУМЕНТИРОВАНИЕ

documentation:
  during_testing:
    - "Записывать все запросы в Burp"
    - "Делать скриншоты"
    - "Записывать видео для сложных багов"
    - "Сохранять HTTP requests/responses"
    
  report_structure:
    - "Title - краткое описание"
    - "Summary - что нашли"
    - "Steps to Reproduce - пошагово"
    - "Impact - влияние"
    - "Remediation - как исправить"
    - "References - ссылки"

# ЭТИКА ИССЛЕДОВАНИЯ

research_ethics:
  always_do:
    - "Читать правила программы"
    - "Оставаться в scope"
    - "Минимизировать воздействие"
    - "Сообщать сразу"
    - "Быть профессиональным"
    
  never_do:
    - "Тестировать вне scope"
    - "Читать чужие данные"
    - "Использовать уязвимость"
    - "Публиковать до фикса"
    - "Шантажировать компанию"

# φ² + 1/φ² = 3 | PHOENIX = 999
