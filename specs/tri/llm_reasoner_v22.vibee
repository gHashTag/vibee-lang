name: llm_reasoner_v22
version: "22.3.0"
language: zig
module: llm_reasoner_v22

types:
  ReasonerConfig:
    fields:
      model: String
      max_tokens: Int
      temperature: Float
      system_prompt: String
      use_cot: Bool

  ReasoningInput:
    fields:
      goal: String
      observation: String
      history: List<String>
      available_actions: List<String>

  ReasoningOutput:
    fields:
      thought: String
      action: String
      action_params: Object
      confidence: Float
      reasoning_steps: List<String>

  ReasonerMetrics:
    fields:
      total_calls: Int
      avg_latency_ms: Float
      total_tokens: Int
      error_count: Int

  Reasoner:
    fields:
      config: Object
      llm_client: Object
      metrics: Object

behaviors:
  - name: create_reasoner
    given: ReasonerConfig and LLM client
    when: Initialize reasoner
    then: Reasoner instance

  - name: reason
    given: Reasoner and ReasoningInput
    when: Generate reasoning
    then: ReasoningOutput

  - name: reason_with_cot
    given: Reasoner and input
    when: Chain of thought reasoning
    then: ReasoningOutput

  - name: parse_action
    given: LLM response
    when: Extract action
    then: Parsed action

  - name: validate_action
    given: Action and available actions
    when: Validate action
    then: Validation result

  - name: get_system_prompt
    given: Reasoner
    when: Get system prompt
    then: Prompt string

  - name: set_system_prompt
    given: Reasoner and prompt
    when: Update system prompt
    then: Updated reasoner

  - name: get_metrics
    given: Reasoner
    when: Get usage metrics
    then: ReasonerMetrics

  - name: reset_metrics
    given: Reasoner
    when: Reset metrics
    then: Reset complete

  - name: format_history
    given: History list
    when: Format for prompt
    then: Formatted string

  - name: build_prompt
    given: ReasoningInput
    when: Build full prompt
    then: Prompt string
