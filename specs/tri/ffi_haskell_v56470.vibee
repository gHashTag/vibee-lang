# FFI Haskell v56470 - Haskell Foreign Import
# VIBEE → Haskell Native Bindings
# φ² + 1/φ² = 3 | PHOENIX = 999

name: ffi_haskell_v56470
version: "56.4.70"
language: zig
module: ffi_haskell

creation_pattern:
  source: VibeeSpec
  transformer: HaskellBindingsGenerator
  result: HaskellPackage

types:
  HaskellType:
    fields:
      name: String
      haskell_type: String
      c_type: String
      is_storable: Bool

  ForeignImport:
    fields:
      name: String
      c_name: String
      safety: String
      type_sig: String

  ForeignExport:
    fields:
      name: String
      c_name: String
      type_sig: String

  HaskellData:
    fields:
      name: String
      constructors: List<String>
      deriving: List<String>

  HaskellNewtype:
    fields:
      name: String
      wrapped_type: String
      deriving: List<String>

  HaskellModule:
    fields:
      name: String
      exports: List<String>
      imports: List<String>
      foreign_imports: List<ForeignImport>
      foreign_exports: List<ForeignExport>

  CabalConfig:
    fields:
      name: String
      version: String
      build_depends: List<String>
      extra_libraries: List<String>
      c_sources: List<String>

  StorableInstance:
    fields:
      type_name: String
      size_of: Int
      alignment: Int
      peek: String
      poke: String

behaviors:
  - name: generate_haskell_module
    given: VibeeSpec
    when: Haskell module needed
    then: Haskell module file

  - name: generate_foreign_import
    given: C function
    when: foreign import needed
    then: ForeignImport declaration

  - name: map_vibee_to_haskell_type
    given: Vibee type
    when: Type mapping needed
    then: Haskell type

  - name: generate_storable
    given: C struct
    when: Storable instance needed
    then: StorableInstance

  - name: generate_cabal
    given: Package config
    when: .cabal file needed
    then: CabalConfig

  - name: handle_ptr
    given: C pointer
    when: Ptr wrapper needed
    then: Ptr a type

  - name: handle_funptr
    given: C callback
    when: FunPtr needed
    then: FunPtr type

  - name: handle_io
    given: Foreign call
    when: IO monad needed
    then: IO a wrapper
