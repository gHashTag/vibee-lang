name: differentiable_programming_v16710
version: "1.0.0"
language: zig
module: differentiable_programming

types:
  DifferentiableModule:
    fields:
      forward: String
      parameters: String

  ComputationGraph:
    fields:
      nodes: String
      edges: String

  Gradient:
    fields:
      parameter: String
      value: Float

  DiffProgResult:
    fields:
      output: String
      gradients: String

behaviors:
  - name: forward_pass
    given: Input and module
    when: Compute output
    then: Return output and tape

  - name: backward_pass
    given: Loss and tape
    when: Backpropagation
    then: Return gradients

  - name: optimize_step
    given: Gradients and optimizer
    when: Parameter update
    then: Return updated parameters
