name: browser_performance_v335
version: "1.0.0"
language: zig
module: browser_performance_v335

types:
  PerformanceTiming:
    fields:
      navigation_start: Int
      dom_loading: Int
      dom_interactive: Int
      dom_complete: Int
      load_event_end: Int

  PerformanceEntry:
    fields:
      name: String
      entry_type: String
      start_time: Float
      duration: Float

  WebVitals:
    fields:
      lcp: Float
      fid: Float
      cls: Float
      ttfb: Float
      fcp: Float

  ResourceTiming:
    fields:
      name: String
      initiator_type: String
      transfer_size: Int
      duration: Float

  PerformanceProfile:
    fields:
      timing: PerformanceTiming
      vitals: WebVitals
      resources: List<ResourceTiming>
      marks: List<PerformanceEntry>

behaviors:
  - name: measure_timing
    given: Page loaded
    When: Measurement runs
    then: Navigation timing captured

  - name: measure_vitals
    given: Page interactive
    When: Vitals measured
    then: Core Web Vitals captured

  - name: measure_resources
    given: Resources loaded
    When: Resource timing runs
    then: Resource metrics captured

  - name: create_mark
    given: Mark name
    When: Mark created
    then: Performance mark recorded

  - name: create_measure
    given: Start and end marks
    When: Measure created
    then: Duration calculated

  - name: profile_javascript
    given: JS execution
    When: Profiling enabled
    then: JS performance captured

  - name: analyze_bottlenecks
    given: Performance data
    When: Analysis runs
    then: Bottlenecks identified

  - name: compare_baseline
    given: Baseline metrics
    When: Comparison runs
    then: Regression detected
