name: browser_cdp_v330
version: "1.0.0"
language: zig
module: browser_cdp_v330

types:
  CDPSession:
    fields:
      session_id: String
      target_id: String
      connected: Bool
      protocol_version: String

  CDPCommand:
    fields:
      id: Int
      method: String
      params: Object
      session_id: Option<String>

  CDPResponse:
    fields:
      id: Int
      result: Option<Object>
      error_obj: Option<Object>

  CDPEvent:
    fields:
      method: String
      params: Object
      session_id: Option<String>

  CDPDomain:
    fields:
      name: String
      enabled: Bool
      events: List<String>

behaviors:
  - name: connect_cdp
    given: Browser endpoint
    when: Connection requested
    then: CDP session established

  - name: send_command
    given: CDP command
    when: Send called
    then: Command sent and response received

  - name: enable_domain
    given: Domain name
    when: Enable called
    then: Domain events activated

  - name: handle_event
    given: CDP event received
    when: Event handler runs
    then: Event processed correctly

  - name: attach_target
    given: Target ID
    when: Attach called
    then: Session attached to target

  - name: detach_target
    given: Attached session
    when: Detach called
    then: Session detached cleanly

  - name: execute_runtime
    given: JavaScript code
    when: Runtime.evaluate called
    then: Code executed in page

  - name: intercept_network
    given: Interception enabled
    when: Request made
    then: Request intercepted via CDP
