name: browser_extensions_v332
version: "1.0.0"
language: zig
module: browser_extensions_v332

types:
  Extension:
    fields:
      id: String
      name: String
      version: String
      path: String
      enabled: Bool

  ExtensionManifest:
    fields:
      manifest_version: Int
      permissions: List<String>
      content_scripts: List<Object>
      background: Option<Object>

  ExtensionMessage:
    fields:
      from: String
      to: String
      type: String
      payload: Object

  ContentScript:
    fields:
      matches: List<String>
      js: List<String>
      css: List<String>
      run_at: String

  ExtensionStorage:
    fields:
      local: Object
      sync: Object
      managed: Object

behaviors:
  - name: load_extension
    given: Extension path
    when: Load requested
    then: Extension loaded unpacked

  - name: inject_content_script
    given: Matching URL
    when: Page loads
    then: Content script injected

  - name: send_message
    given: Message payload
    when: Send called
    then: Message delivered to extension

  - name: receive_message
    given: Message sent
    when: Handler registered
    then: Message received and processed

  - name: access_storage
    given: Storage API call
    when: Access runs
    then: Storage read or written

  - name: intercept_web_request
    given: webRequest permission
    when: Request made
    then: Request intercepted by extension

  - name: modify_headers
    given: Header modification
    when: Request/response
    then: Headers modified

  - name: execute_background
    given: Background script
    when: Event triggers
    then: Background code executes
