# iGLA v3 Medusa - Multi-head Decoding
# 2-3x speedup through parallel prediction
# φ² + 1/φ² = 3 | PHOENIX = 999
# Paper: arXiv:2401.10774

name: igla_v3_medusa
version: "3.0.0"
language: zig
module: igla_v3_medusa

creation_pattern:
  source: BaseModelOutput
  transformer: MedusaHeads
  result: MultiTokenPrediction

types:
  MedusaConfig:
    fields:
      num_heads: Int
      hidden_size: Int
      vocab_size: Int
      tree_depth: Int
      
behaviors:
  - name: predict_multiple
    given: "Hidden state from base model"
    when: "Medusa forward"
    then: "Return k future token logits"
    
  - name: build_tree
    given: "Medusa logits, top_k"
    when: "Candidate generation"
    then: "Return candidate tree"
    
  - name: verify_tree
    given: "Candidates, base model"
    when: "Single forward verification"
    then: "Return accepted sequence"
