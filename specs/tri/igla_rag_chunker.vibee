# iGLA RAG Chunker
# Split documents into chunks for indexing
# φ² + 1/φ² = 3 | V = n × 3^k × π^m × φ^p

name: igla_rag_chunker
version: "1.0.0"
language: zig
module: igla_rag_chunker

sacred_constants:
  phi: 1.618033988749895
  trinity: 3.0
  phoenix: 999

types:
  ChunkerConfig:
    fields:
      chunk_size: Int
      chunk_overlap: Int
      separator: String
      strategy: String

  Chunk:
    fields:
      id: String
      text: String
      start_index: Int
      end_index: Int
      metadata: String

  Document:
    fields:
      id: String
      text: String
      source: String
      metadata: String

  ChunkResult:
    fields:
      chunks: String
      count: Int
      avg_size: Int
      source_id: String

  ChunkerMetrics:
    fields:
      documents_processed: Int
      chunks_created: Int
      avg_chunk_size: Float
      total_tokens: Int

  SplitStrategy:
    fields:
      name: String
      separators: String
      keep_separator: Bool

behaviors:
  - name: chunk_text
    given: "Text string"
    when: "Chunking"
    then: "List of chunks returned"

  - name: chunk_document
    given: "Document"
    when: "Document chunking"
    then: "Chunks with metadata"

  - name: chunk_by_tokens
    given: "Text, max_tokens"
    when: "Token chunking"
    then: "Token-based chunks"

  - name: chunk_by_sentences
    given: "Text"
    when: "Sentence chunking"
    then: "Sentence-based chunks"

  - name: chunk_by_paragraphs
    given: "Text"
    when: "Paragraph chunking"
    then: "Paragraph-based chunks"

  - name: recursive_chunk
    given: "Text, separators"
    when: "Recursive chunking"
    then: "Hierarchical chunks"

  - name: merge_small_chunks
    given: "Chunks, min_size"
    when: "Merging"
    then: "Merged chunks"

  - name: phi_chunker_harmony
    given: "Chunker"
    when: "Harmony"
    then: "φ-optimal chunk sizes"
