# v4902 - Autoregressive Models
# ==============================
# AR, ARIMA, DeepAR - классика и нейросети
# φ² + 1/φ² = 3 | PHOENIX = 999

name: autoregressive_models
version: "4.9.2"
language: zig
module: autoregressive_models

constants:
  PHI: 1.618033988749895
  MAX_LAG: 30
  NUM_SAMPLES: 100

types:
  ARConfig:
    fields:
      order: Int
      include_intercept: Bool
      
  ARIMAConfig:
    fields:
      p: Int
      d: Int
      q: Int
      seasonal: Bool
      
  DeepARConfig:
    fields:
      hidden_size: Int
      num_layers: Int
      distribution: String
      
  ARCoefficients:
    fields:
      phi: List
      intercept: Float
      
  MACoefficients:
    fields:
      theta: List
      
  DeepAROutput:
    fields:
      mu: List
      sigma: List
      samples: List
      
  LikelihoodParams:
    fields:
      distribution: String
      params: List
      
  ProbabilisticForecast:
    fields:
      samples: List
      mean: List
      std: List

behaviors:
  - name: fit_ar
    given: Time series и order
    when: Fitting AR model
    then: Вернуть AR coefficients
    
  - name: fit_arima
    given: Time series и (p,d,q)
    when: Fitting ARIMA
    then: Вернуть ARIMA params
    
  - name: ar_forecast
    given: AR model и horizon
    when: AR forecasting
    then: Вернуть point forecast
    
  - name: deepar_forward
    given: Context и model
    when: DeepAR forward
    then: Вернуть distribution params
    
  - name: sample_forecast
    given: Distribution params
    when: Sampling predictions
    then: Вернуть samples
    
  - name: negative_log_likelihood
    given: Predictions и targets
    when: NLL loss
    then: Вернуть loss
    
  - name: difference_series
    given: Series и d
    when: Differencing
    then: Вернуть differenced series
    
  - name: inverse_difference
    given: Differenced и original
    when: Inverse transform
    then: Вернуть original scale
