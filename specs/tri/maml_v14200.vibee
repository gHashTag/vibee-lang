# VIBEE Specification v14200
# MAML - Model-Agnostic Meta-Learning
name: maml_v14200
version: "1.0.0"
language: zig
module: maml

types:
  MAMLConfig:
    fields:
      inner_lr: Float
      outer_lr: Float
      inner_steps: Int
      meta_batch_size: Int

  Task:
    fields:
      support_set: String
      query_set: String
      task_id: String

  Adaptation:
    fields:
      adapted_params: String
      task_loss: Float
      steps_taken: Int

  MetaGradient:
    fields:
      gradients: String
      task_losses: String
      mean_loss: Float

behaviors:
  - name: inner_loop
    given: Task and initial params
    when: Adaptation done
    then: Returns adaptation

  - name: outer_loop
    given: Task batch
    when: Meta-update done
    then: Returns meta gradient

  - name: meta_train
    given: Task distribution
    when: Training done
    then: Returns meta-learned params

  - name: fast_adapt
    given: New task
    when: Few-shot adaptation done
    then: Returns task-specific model
