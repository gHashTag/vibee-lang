# VIBEE YOLO MODE IX - browser_webusb_permissions v949
name: browser_webusb_permissions_v949
version: "9.0.0"
language: zig
module: browser_webusb_permissions

sacred_constants:
  phi: 1.618033988749895
  phoenix: 999

types:
  USBDevice:
    fields:
      vendor_id: Int
      product_id: Int
      device_class: Int
      opened: Bool
      configuration: Int

  USBInterface:
    fields:
      interface_number: Int
      alternate: Int
      claimed: Bool

  USBEndpoint:
    fields:
      endpoint_number: Int
      direction: String
      type: String
      packet_size: Int

  USBTransferResult:
    fields:
      status: String
      data: String
      bytes_transferred: Int

behaviors:
  - name: request_device
    given: Device filters
    when: Request
    then: permissions device obtained
  - name: open_device
    given: USBDevice
    when: Open
    then: Device opened
  - name: claim_interface
    given: USBInterface
    when: Claim
    then: Interface claimed
  - name: transfer_in
    given: USBEndpoint
    when: Transfer
    then: Data received
  - name: transfer_out
    given: USBEndpoint and data
    when: Transfer
    then: Data sent

test_cases:
  - name: test_browser_webusb_permissions_request
    input: {filters: valid}
    expected: {device: obtained}
  - name: test_browser_webusb_permissions_open
    input: {device: valid}
    expected: {opened: true}
  - name: test_browser_webusb_permissions_claim
    input: {interface: valid}
    expected: {claimed: true}
  - name: test_browser_webusb_permissions_transfer
    input: {endpoint: valid}
    expected: {transferred: true}
  - name: test_phi_browser_webusb_permissions
    input: {phi: 1.618033988749895}
    expected: {golden: true}
