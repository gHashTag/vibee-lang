name: agent_plugin_v326
version: "1.0.0"
language: zig
module: agent_plugin_v326

types:
  Plugin:
    fields:
      id: String
      name: String
      version: String
      entry_point: String
      dependencies: List<String>

  PluginManifest:
    fields:
      plugin: Plugin
      permissions: List<String>
      hooks: List<String>
      config_schema: Object

  PluginRegistry:
    fields:
      plugins: List<Plugin>
      enabled: List<String>
      disabled: List<String>

  PluginHook:
    fields:
      name: String
      phase: String
      handler: String
      priority: Int

  PluginContext:
    fields:
      plugin_id: String
      config: Object
      api: Object
      sandbox: Bool

behaviors:
  - name: load_plugin
    given: Plugin path
    when: Load requested
    then: Plugin loaded and validated

  - name: enable_plugin
    given: Plugin loaded
    when: Enable called
    then: Plugin activated with hooks

  - name: disable_plugin
    given: Plugin enabled
    when: Disable called
    then: Plugin deactivated cleanly

  - name: execute_hook
    given: Hook point reached
    when: Hook execution runs
    then: All registered handlers called

  - name: validate_permissions
    given: Plugin action
    when: Permission check runs
    then: Action allowed or denied

  - name: isolate_plugin
    given: Sandbox enabled
    when: Plugin runs
    then: Plugin isolated from core

  - name: update_plugin
    given: New version available
    when: Update requested
    then: Plugin updated atomically

  - name: resolve_dependencies
    given: Plugin dependencies
    when: Resolution runs
    then: Dependencies loaded in order
