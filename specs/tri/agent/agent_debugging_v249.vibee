# VIBEE Agent Debugging v249
# Advanced Debugging for Browser Agents

name: agent_debugging_v249
version: "249.0.0"
language: zig
module: agent_debugging

types:
  DebugSession:
    fields:
      id: String
      agent_id: String
      breakpoints: List<String>
      state: String

  Breakpoint:
    fields:
      id: String
      type: String
      condition: String
      enabled: Bool

  DebugEvent:
    fields:
      type: String
      timestamp: Timestamp
      data: Object

  TraceLog:
    fields:
      entries: List<String>
      level: String
      filters: List<String>

  StateInspector:
    fields:
      memory: Object
      plan: Object
      actions: List<String>

  DebugMetrics:
    fields:
      breakpoints_hit: Int
      traces_captured: Int
      replay_count: Int

  ReplaySession:
    fields:
      id: String
      events: List<String>
      position: Int

behaviors:
  - name: set_breakpoint
    given: "Breakpoint location"
    when: "Debugging enabled"
    then: "Register breakpoint"
    benchmark:
      vibee_us: 10
      playwright_us: 50
      puppeteer_us: 60
      selenium_us: 100
    deliverables:
      - "Breakpoint registration"
      - "Condition evaluation"
      - "Hit counting"

  - name: inspect_state
    given: "Agent paused"
    when: "Inspection requested"
    then: "Return state"
    benchmark:
      vibee_us: 50
      playwright_us: 200
      puppeteer_us: 250
      selenium_us: 400
    deliverables:
      - "Memory dump"
      - "Plan state"
      - "Action history"

  - name: step_execution
    given: "Paused agent"
    when: "Step requested"
    then: "Execute one step"
    benchmark:
      vibee_us: 100
      playwright_us: 400
      puppeteer_us: 500
      selenium_us: 800
    deliverables:
      - "Single step"
      - "Step over"
      - "Step into"

  - name: capture_trace
    given: "Execution running"
    when: "Tracing enabled"
    then: "Record events"
    benchmark:
      vibee_us: 5
      playwright_us: 20
      puppeteer_us: 25
      selenium_us: 40
    deliverables:
      - "Event capture"
      - "Timestamp"
      - "Context"

  - name: replay_execution
    given: "Captured trace"
    when: "Replay requested"
    then: "Reproduce execution"
    benchmark:
      vibee_ms: 10
      playwright_ms: 40
      puppeteer_ms: 50
      selenium_ms: 80
    deliverables:
      - "Event replay"
      - "State verification"
      - "Diff detection"

  - name: analyze_failure
    given: "Failed execution"
    when: "Analysis requested"
    then: "Identify root cause"
    benchmark:
      vibee_ms: 20
      playwright_ms: 80
      puppeteer_ms: 100
      selenium_ms: 150
    deliverables:
      - "Stack trace"
      - "State diff"
      - "Suggestion"

  - name: export_debug_data
    given: "Debug session"
    when: "Export requested"
    then: "Generate report"
    benchmark:
      vibee_ms: 5
      playwright_ms: 20
      puppeteer_ms: 25
      selenium_ms: 40
    deliverables:
      - "JSON export"
      - "HTML report"
      - "Video recording"

test_cases:
  - name: test_breakpoint
    input: { action: "click", condition: "selector == '#submit'" }
    expected: { set: true }

  - name: test_inspect
    input: { agent_id: "agent1" }
    expected: { state: true }

  - name: test_step
    input: { type: "step_over" }
    expected: { stepped: true }

  - name: test_trace
    input: { enabled: true }
    expected: { capturing: true }

  - name: test_replay
    input: { trace_id: "t1" }
    expected: { replayed: true }

  - name: test_analyze
    input: { failure_id: "f1" }
    expected: { root_cause: true }

  - name: test_export
    input: { format: "json" }
    expected: { exported: true }

benchmark_summary:
  vibee_avg_us: 29
  playwright_avg_us: 116
  puppeteer_avg_us: 144
  selenium_avg_us: 230
  vibee_speedup: "4x-8x"
