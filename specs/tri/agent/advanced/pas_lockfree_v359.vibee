name: pas_lockfree_v359
version: "1.0.0"
language: zig
module: pas_lockfree_v359

types:
  AtomicCounter:
    fields:
      value: Int
      memory_order: String

  LockFreeQueue:
    fields:
      head: Int
      tail: Int
      buffer: List<Object>
      capacity: Int

  LockFreeStack:
    fields:
      top: Int
      buffer: List<Object>
      capacity: Int

  CASOperation:
    fields:
      expected: Object
      desired: Object
      success: Bool

  LockFreeMetrics:
    fields:
      cas_successes: Int
      cas_failures: Int
      contention_rate: Float

behaviors:
  - name: atomic_increment
    given: Counter
    When: Increment called
    then: Value atomically incremented

  - name: atomic_compare_swap
    given: Expected and desired
    When: CAS called
    then: Swap if expected matches

  - name: enqueue_lockfree
    given: Item
    When: Enqueue called
    then: Item added without lock

  - name: dequeue_lockfree
    given: Queue not empty
    When: Dequeue called
    then: Item removed without lock

  - name: push_lockfree
    given: Item
    When: Push called
    then: Item pushed without lock

  - name: pop_lockfree
    given: Stack not empty
    When: Pop called
    then: Item popped without lock

  - name: measure_contention
    given: Concurrent access
    When: Measurement runs
    then: Contention rate computed

  - name: benchmark_vs_locked
    given: Same operations
    When: Benchmark runs
    then: Lock-free speedup measured
