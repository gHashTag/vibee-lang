# VIBEE Agent Memory System v243
# Long-term and Short-term Memory for Browser Agents

name: agent_memory_v243
version: "243.0.0"
language: zig
module: agent_memory

types:
  MemoryStore:
    fields:
      short_term: Object
      long_term: Object
      episodic: List<String>
      semantic: Object

  MemoryEntry:
    fields:
      id: String
      type: String
      content: Object
      timestamp: Timestamp
      importance: Float
      access_count: Int

  ShortTermMemory:
    fields:
      capacity: Int
      entries: List<String>
      decay_rate: Float

  LongTermMemory:
    fields:
      entries: Int
      index: Object
      compression: Bool

  EpisodicMemory:
    fields:
      episode_id: String
      actions: List<String>
      outcome: String
      reward: Float

  SemanticMemory:
    fields:
      concepts: Object
      relationships: Object
      embeddings: List<Float>

  MemoryMetrics:
    fields:
      total_entries: Int
      retrieval_time_us: Float
      hit_rate: Float
      compression_ratio: Float

behaviors:
  - name: store_observation
    given: "New observation"
    when: "Storage needed"
    then: "Store in appropriate memory"
    benchmark:
      vibee_us: 50
      playwright_us: 200
      puppeteer_us: 250
      selenium_us: 500
    deliverables:
      - "Memory classification"
      - "Importance scoring"
      - "Index update"

  - name: retrieve_relevant
    given: "Query context"
    when: "Retrieval needed"
    then: "Return relevant memories"
    benchmark:
      vibee_us: 100
      playwright_us: 500
      puppeteer_us: 600
      selenium_us: 1000
    deliverables:
      - "Similarity search"
      - "Relevance ranking"
      - "Context assembly"

  - name: consolidate_memory
    given: "Short-term memories"
    when: "Consolidation triggered"
    then: "Move to long-term"
    benchmark:
      vibee_ms: 10
      playwright_ms: 50
      puppeteer_ms: 60
      selenium_ms: 100
    deliverables:
      - "Memory selection"
      - "Compression"
      - "Index rebuild"

  - name: forget_irrelevant
    given: "Memory pressure"
    when: "Cleanup needed"
    then: "Remove low-importance"
    benchmark:
      vibee_ms: 5
      playwright_ms: 20
      puppeteer_ms: 25
      selenium_ms: 40
    deliverables:
      - "Importance decay"
      - "Garbage collection"
      - "Space reclaim"

  - name: associate_memories
    given: "Related memories"
    when: "Association detected"
    then: "Create links"
    benchmark:
      vibee_us: 200
      playwright_us: 800
      puppeteer_us: 1000
      selenium_us: 1500
    deliverables:
      - "Relationship detection"
      - "Link creation"
      - "Graph update"

  - name: embed_memory
    given: "Memory content"
    when: "Embedding needed"
    then: "Generate vector"
    benchmark:
      vibee_ms: 2
      playwright_ms: 10
      puppeteer_ms: 15
      selenium_ms: 25
    deliverables:
      - "Text encoding"
      - "Vector generation"
      - "Index insertion"

  - name: query_semantic
    given: "Semantic query"
    when: "Knowledge needed"
    then: "Return concepts"
    benchmark:
      vibee_us: 150
      playwright_us: 600
      puppeteer_us: 750
      selenium_us: 1200
    deliverables:
      - "Concept lookup"
      - "Relationship traversal"
      - "Knowledge assembly"

test_cases:
  - name: test_store
    input: { observation: { dom: "...", screenshot: "..." } }
    expected: { stored: true }

  - name: test_retrieve
    input: { query: "login form" }
    expected: { memories: true }

  - name: test_consolidate
    input: { short_term_count: 100 }
    expected: { consolidated: true }

  - name: test_forget
    input: { memory_pressure: true }
    expected: { cleaned: true }

  - name: test_associate
    input: { memory1: "m1", memory2: "m2" }
    expected: { linked: true }

  - name: test_embed
    input: { content: "click submit button" }
    expected: { vector: true }

  - name: test_semantic
    input: { concept: "authentication" }
    expected: { knowledge: true }

benchmark_summary:
  vibee_avg_us: 73
  playwright_avg_us: 311
  puppeteer_avg_us: 386
  selenium_avg_us: 623
  vibee_speedup: "4.3x avg"
