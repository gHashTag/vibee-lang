# ═══════════════════════════════════════════════════════════════════════════════
# CLI MEMORY v298 - Agent Memory System
# ═══════════════════════════════════════════════════════════════════════════════
# Based on: MemGPT, Generative Agents, Voyager
# Scientific: NeurIPS 2024, ICLR 2024
# PAS Pattern: PRE + HSH
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════

name: cli_memory
version: "2.9.8"
language: zig
module: cli_memory

sacred_constants:
  phi: 1.618033988749895
  trinity: 3.0
  phoenix: 999

creation_pattern:
  source: MemoryInput
  transformer: MemorySystem
  result: MemoryOutput

types:
  MemoryType:
    enum:
      - episodic
      - semantic
      - procedural
      - working

  MemoryEntry:
    fields:
      entry_id: String
      memory_type: MemoryType
      content: String
      embedding: List<Float>
      timestamp: Int
      importance: Float

  MemoryQuery:
    fields:
      query: String
      memory_types: List<MemoryType>
      top_k: Int
      recency_weight: Float

  MemoryStream:
    fields:
      entries: List<MemoryEntry>
      capacity: Int
      decay_rate: Float

  Reflection:
    fields:
      insight: String
      supporting_memories: List<String>
      timestamp: Int

  MemoryStats:
    fields:
      total_entries: Int
      by_type: Object
      avg_importance: Float

behaviors:
  - name: store
    given: "Memory content"
    when: "Storage"
    then: "Store in memory"
    pas_pattern: PRE
    complexity: O(1)
    test_cases:
      - name: test_store
        input: '{"content": "User prefers dark mode"}'
        expected: '{"stored": true}'

  - name: retrieve
    given: "Memory query"
    when: "Retrieval"
    then: "Retrieve relevant memories"
    pas_pattern: HSH
    complexity: O(log n)
    test_cases:
      - name: test_retrieve
        input: '{"query": "user preferences"}'
        expected: '{"memories": [...]}'

  - name: forget
    given: "Memory ID"
    when: "Forgetting"
    then: "Remove memory"
    pas_pattern: HSH
    complexity: O(1)
    test_cases:
      - name: test_forget
        input: '{"entry_id": "mem-123"}'
        expected: '{"forgotten": true}'

  - name: consolidate
    given: "Memory stream"
    when: "Consolidation"
    then: "Consolidate memories"
    pas_pattern: ALG
    complexity: O(n)
    test_cases:
      - name: test_consolidate
        input: '{"stream": {...}}'
        expected: '{"consolidated": true}'

  - name: reflect
    given: "Recent memories"
    when: "Reflection"
    then: "Generate insights"
    pas_pattern: MLS
    complexity: O(n)
    test_cases:
      - name: test_reflect
        input: '{"memories": [...]}'
        expected: '{"reflections": [...]}'

  - name: decay
    given: "Time delta"
    when: "Decay"
    then: "Apply memory decay"
    pas_pattern: ALG
    complexity: O(n)
    test_cases:
      - name: test_decay
        input: '{"delta_ms": 86400000}'
        expected: '{"decayed": true}'

# ═══════════════════════════════════════════════════════════════════════════════
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════
