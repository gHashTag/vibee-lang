# ═══════════════════════════════════════════════════════════════════════════════
# CLI CONFIG v285 - Configuration Management
# ═══════════════════════════════════════════════════════════════════════════════
# Based on: Viper, dotenv, toml
# Scientific: ICSE 2024, FSE 2024
# PAS Pattern: PRE + HSH
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════

name: cli_config
version: "2.8.5"
language: zig
module: cli_config

sacred_constants:
  phi: 1.618033988749895
  trinity: 3.0
  phoenix: 999

creation_pattern:
  source: ConfigSource
  transformer: CLIConfig
  result: Configuration

types:
  ConfigFormat:
    enum:
      - json
      - yaml
      - toml
      - env

  ConfigSource:
    enum:
      - file
      - env
      - cli
      - default

  ConfigValue:
    fields:
      key: String
      value: String
      source: ConfigSource

  ConfigSchema:
    fields:
      key: String
      value_type: String
      required: Bool
      default: Option<String>

  Configuration:
    fields:
      values: List<ConfigValue>
      schema: List<ConfigSchema>
      loaded_from: List<String>

  ConfigError:
    fields:
      key: String
      message: String
      expected_type: String

behaviors:
  - name: load_file
    given: "Config file path"
    when: "File loading"
    then: "Load configuration"
    pas_pattern: PRE
    complexity: O(n)
    test_cases:
      - name: test_load
        input: '{"path": "config.json"}'
        expected: '{"loaded": true}'

  - name: load_env
    given: "Env prefix"
    when: "Env loading"
    then: "Load from environment"
    pas_pattern: PRE
    complexity: O(n)
    test_cases:
      - name: test_env
        input: '{"prefix": "VIBEE_"}'
        expected: '{"loaded": true}'

  - name: get_value
    given: "Config key"
    when: "Value retrieval"
    then: "Return config value"
    pas_pattern: HSH
    complexity: O(1)
    test_cases:
      - name: test_get
        input: '{"key": "verbose"}'
        expected: '{"value": "true"}'

  - name: set_value
    given: "Key and value"
    when: "Value setting"
    then: "Set config value"
    pas_pattern: HSH
    complexity: O(1)
    test_cases:
      - name: test_set
        input: '{"key": "verbose", "value": "false"}'
        expected: '{"set": true}'

  - name: validate
    given: "Configuration"
    when: "Validation"
    then: "Validate against schema"
    pas_pattern: ALG
    complexity: O(n)
    test_cases:
      - name: test_validate
        input: '{"config": {...}}'
        expected: '{"valid": true}'

  - name: save
    given: "Config and path"
    when: "Saving"
    then: "Save to file"
    pas_pattern: PRE
    complexity: O(n)
    test_cases:
      - name: test_save
        input: '{"path": "config.json"}'
        expected: '{"saved": true}'

# ═══════════════════════════════════════════════════════════════════════════════
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════
