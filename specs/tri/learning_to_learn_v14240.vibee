# VIBEE Specification v14240
# Learning to Learn - Meta-optimization
name: learning_to_learn_v14240
version: "1.0.0"
language: zig
module: learning_to_learn

types:
  MetaOptimizer:
    fields:
      lstm_optimizer: String
      learned_lr: String
      meta_sgd: String

  OptimizationState:
    fields:
      params: String
      hidden_state: String
      step: Int

  LearningSignal:
    fields:
      loss: Float
      gradients: String
      features: String

  L2LResult:
    fields:
      final_params: String
      convergence_steps: Int
      meta_loss: Float

behaviors:
  - name: initialize_meta_opt
    given: Config
    when: Initialization done
    then: Returns meta optimizer

  - name: compute_update
    given: Learning signal
    when: Computation done
    then: Returns param update

  - name: meta_train_optimizer
    given: Task distribution
    When: Training done
    then: Returns trained optimizer

  - name: apply_learned_opt
    given: New task
    when: Application done
    then: Returns L2L result
