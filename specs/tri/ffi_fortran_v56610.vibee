# FFI Fortran v56610 - Fortran ISO_C_BINDING
# VIBEE → Fortran Native Bindings
# φ² + 1/φ² = 3 | PHOENIX = 999

name: ffi_fortran_v56610
version: "56.6.10"
language: zig
module: ffi_fortran

creation_pattern:
  source: VibeeSpec
  transformer: FortranBindingsGenerator
  result: FortranModule

types:
  FortranType:
    fields:
      name: String
      fortran_type: String
      c_type: String
      kind: Option<String>

  FortranInterface:
    fields:
      name: String
      bind_c_name: String
      args: List<String>
      result_type: Option<String>

  FortranDerivedType:
    fields:
      name: String
      components: List<String>
      bind_c: Bool
      sequence: Bool

  FortranModule:
    fields:
      name: String
      use_statements: List<String>
      interfaces: List<FortranInterface>
      derived_types: List<FortranDerivedType>
      contains: List<String>

  FortranSubroutine:
    fields:
      name: String
      args: List<String>
      bind_c: Option<String>

  FortranFunction:
    fields:
      name: String
      args: List<String>
      result_type: String
      bind_c: Option<String>

  CMakeConfig:
    fields:
      project_name: String
      fortran_sources: List<String>
      c_sources: List<String>
      libraries: List<String>

  FortranPointer:
    fields:
      type_name: String
      is_c_ptr: Bool
      is_c_funptr: Bool

behaviors:
  - name: generate_fortran_module
    given: VibeeSpec
    when: Fortran module needed
    then: Fortran source files

  - name: generate_interface
    given: C function
    when: BIND(C) interface needed
    then: FortranInterface

  - name: map_vibee_to_fortran_type
    given: Vibee type
    when: Type mapping needed
    then: Fortran type with kind

  - name: generate_derived_type
    given: C struct
    when: Derived type needed
    then: FortranDerivedType

  - name: generate_cmake
    given: Build config
    when: CMakeLists.txt needed
    then: CMakeConfig

  - name: handle_c_ptr
    given: C pointer
    when: C_PTR needed
    then: FortranPointer

  - name: handle_c_funptr
    given: C callback
    when: C_FUNPTR needed
    then: FortranPointer

  - name: handle_string
    given: C string
    when: Character array needed
    then: CHARACTER(KIND=C_CHAR)
