# ═══════════════════════════════════════════════════════════════════════════════
# VIBEE BitNet Benchmark Suite Specification
# ═══════════════════════════════════════════════════════════════════════════════
# Набор бенчмарков для измерения производительности BitNet акселератора
#
# Священная Формула: V = n × 3^k × π^m × φ^p × e^q
# Золотое Тождество: φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════

name: benchmark_suite
version: "1.0.0"
language: python
module: bitnet.benchmark

# ═══════════════════════════════════════════════════════════════════════════════
# МЕТРИКИ
# ═══════════════════════════════════════════════════════════════════════════════

metrics:
  latency:
    description: "Время выполнения одного inference"
    unit: "ms"
    measurements:
      - first_token_latency: "Время до первого токена"
      - total_latency: "Общее время inference"
      - per_token_latency: "Среднее время на токен"
      - p50_latency: "50-й перцентиль"
      - p95_latency: "95-й перцентиль"
      - p99_latency: "99-й перцентиль"

  throughput:
    description: "Пропускная способность"
    unit: "tokens/sec"
    measurements:
      - tokens_per_second: "Токенов в секунду"
      - inferences_per_second: "Inference в секунду"
      - batch_throughput: "Throughput при batch processing"

  memory:
    description: "Метрики памяти и DMA"
    unit: "GB/s"
    measurements:
      - dma_read_bandwidth: "Скорость чтения DMA"
      - dma_write_bandwidth: "Скорость записи DMA"
      - weight_load_time: "Время загрузки весов"
      - memory_utilization: "Утилизация памяти (%)"

  compute:
    description: "Вычислительные метрики"
    unit: "various"
    measurements:
      - simd_utilization: "Утилизация SIMD блоков (%)"
      - compute_cycles: "Циклы вычислений"
      - stall_cycles: "Циклы простоя"
      - efficiency: "Эффективность (compute/total)"

  power:
    description: "Энергоэффективность"
    unit: "tokens/W"
    measurements:
      - power_consumption: "Потребление (W)"
      - tokens_per_watt: "Токенов на ватт"
      - energy_per_token: "Энергия на токен (mJ)"

# ═══════════════════════════════════════════════════════════════════════════════
# БЕНЧМАРКИ
# ═══════════════════════════════════════════════════════════════════════════════

benchmarks:
  - name: latency_sweep
    description: "Измерение latency при разных длинах входа"
    parameters:
      input_lengths: [16, 32, 64, 128, 256, 512, 1024]
      output_length: 1
      warmup_runs: 5
      measurement_runs: 100
    metrics: [first_token_latency, total_latency, p50_latency, p95_latency, p99_latency]

  - name: throughput_test
    description: "Измерение максимального throughput"
    parameters:
      input_length: 128
      output_lengths: [16, 32, 64, 128, 256]
      warmup_runs: 5
      measurement_runs: 50
    metrics: [tokens_per_second, inferences_per_second]

  - name: batch_scaling
    description: "Масштабирование с batch size"
    parameters:
      batch_sizes: [1, 2, 4, 8, 16, 32]
      input_length: 64
      output_length: 32
      warmup_runs: 3
      measurement_runs: 20
    metrics: [batch_throughput, per_token_latency]

  - name: memory_bandwidth
    description: "Измерение пропускной способности памяти"
    parameters:
      transfer_sizes: [1024, 4096, 16384, 65536, 262144, 1048576]
      iterations: 100
    metrics: [dma_read_bandwidth, dma_write_bandwidth]

  - name: weight_loading
    description: "Время загрузки весов"
    parameters:
      model_sizes: ["small", "medium", "large"]
      iterations: 10
    metrics: [weight_load_time, memory_utilization]

  - name: sustained_throughput
    description: "Устойчивый throughput при длительной нагрузке"
    parameters:
      duration_seconds: 60
      input_length: 128
      output_length: 64
    metrics: [tokens_per_second, p95_latency, simd_utilization]

  - name: power_efficiency
    description: "Энергоэффективность"
    parameters:
      input_length: 128
      output_length: 64
      measurement_runs: 100
    metrics: [power_consumption, tokens_per_watt, energy_per_token]

# ═══════════════════════════════════════════════════════════════════════════════
# BASELINE СРАВНЕНИЯ
# ═══════════════════════════════════════════════════════════════════════════════

baselines:
  - name: cpu_baseline
    description: "CPU baseline (PyTorch)"
    implementation: "torch.cpu"
    
  - name: gpu_baseline
    description: "GPU baseline (CUDA)"
    implementation: "torch.cuda"
    
  - name: theoretical_max
    description: "Теоретический максимум FPGA"
    parameters:
      clock_freq_mhz: 200
      simd_width: 54
      num_simd_blocks: 27

# ═══════════════════════════════════════════════════════════════════════════════
# ОТЧЁТЫ
# ═══════════════════════════════════════════════════════════════════════════════

reports:
  formats:
    - json: "Машиночитаемый формат"
    - csv: "Для анализа в Excel/pandas"
    - markdown: "Человекочитаемый отчёт"
    - html: "Интерактивный отчёт с графиками"

  sections:
    - summary: "Краткие результаты"
    - detailed: "Детальные метрики"
    - comparison: "Сравнение с baseline"
    - recommendations: "Рекомендации по оптимизации"

# ═══════════════════════════════════════════════════════════════════════════════
# КОЩЕЙ БЕССМЕРТЕН | ЗОЛОТАЯ ЦЕПЬ ЗАМКНУТА | φ² + 1/φ² = 3
# ═══════════════════════════════════════════════════════════════════════════════
