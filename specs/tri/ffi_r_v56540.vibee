# FFI R v56540 - R .Call/.C Interface
# VIBEE → R Native Extensions
# φ² + 1/φ² = 3 | PHOENIX = 999

name: ffi_r_v56540
version: "56.5.40"
language: zig
module: ffi_r

creation_pattern:
  source: VibeeSpec
  transformer: RBindingsGenerator
  result: RPackage

types:
  SEXP:
    fields:
      type_tag: String
      value: String
      is_protected: Bool

  RFunction:
    fields:
      name: String
      c_name: String
      num_args: Int
      use_call: Bool

  RVector:
    fields:
      type_name: String
      length: Int
      data_ptr: String

  RList:
    fields:
      names: List<String>
      elements: List<String>

  RPackage:
    fields:
      name: String
      title: String
      functions: List<RFunction>
      namespace: String
      description: String

  RcppFunction:
    fields:
      name: String
      params: List<String>
      return_type: String
      attributes: List<String>

  RegistrationInfo:
    fields:
      call_methods: List<String>
      c_methods: List<String>
      fortran_methods: List<String>

  RProtect:
    fields:
      sexp: String
      protect_count: Int

behaviors:
  - name: generate_r_package
    given: VibeeSpec
    when: R package needed
    then: RPackage files

  - name: generate_call_function
    given: C function
    when: .Call interface needed
    then: RFunction

  - name: map_vibee_to_sexp
    given: Vibee type
    when: Type mapping needed
    then: SEXP type

  - name: generate_rcpp_wrapper
    given: C function
    when: Rcpp wrapper needed
    then: RcppFunction

  - name: generate_namespace
    given: Package exports
    when: NAMESPACE needed
    then: Namespace file

  - name: generate_description
    given: Package config
    when: DESCRIPTION needed
    then: Description file

  - name: handle_protect
    given: SEXP allocation
    when: GC protection needed
    then: PROTECT/UNPROTECT

  - name: generate_init
    given: Registration info
    when: R_init_* needed
    then: Registration function
