# Few-Shot Adaptation V97 - Rapid Learning
name: few_shot_adaptation_v97
version: "97.0.0"
language: zig
module: few_shot_adaptation

creation_pattern:
  source: FewExamples
  transformer: AdaptationEngine
  result: SpecializedModel

types:
  FewShotTask:
    fields:
      examples: List<LabeledExample>
      num_classes: Int
      shots_per_class: Int

  LabeledExample:
    fields:
      features: List<Float>
      label: Int

  PrototypeNetwork:
    fields:
      encoder: String
      prototypes: List<Prototype>
      distance_metric: String

  Prototype:
    fields:
      class_id: Int
      embedding: List<Float>

  MatchingNetwork:
    fields:
      encoder: String
      attention: String
      memory: List<LabeledExample>

  RelationNetwork:
    fields:
      encoder: String
      relation_module: String

  AdaptationStrategy:
    variants:
      - Prototypical
      - Matching
      - Relation
      - MAML
      - ProtoMAML

  FewShotResult:
    fields:
      predictions: List<Int>
      confidences: List<Float>
      accuracy: Float

behaviors:
  - name: compute_prototypes
    given: "Support examples"
    when: "Prototype computation"
    then: "Class prototypes"
    test_cases:
      - name: mean_prototype
        input: "5 examples per class"
        expected: "class centroids"

  - name: encode_query
    given: "Query example"
    when: "Encoding"
    then: "Query embedding"
    test_cases:
      - name: encode
        input: "query image"
        expected: "embedding vector"

  - name: compute_distances
    given: "Query and prototypes"
    when: "Distance computation"
    then: "Distance to each class"
    test_cases:
      - name: euclidean_dist
        input: "query, 5 prototypes"
        expected: "5 distances"

  - name: classify_query
    given: "Distances"
    when: "Classification"
    then: "Predicted class"
    test_cases:
      - name: nearest_prototype
        input: "distances"
        expected: "closest class"

  - name: adapt_to_task
    given: "New task"
    when: "Rapid adaptation"
    then: "Task-specific model"
    test_cases:
      - name: quick_adapt
        input: "5-shot task"
        expected: "adapted in <1s"

  - name: transfer_knowledge
    given: "Source and target"
    when: "Transfer"
    then: "Transferred model"
    test_cases:
      - name: domain_transfer
        input: "ImageNet -> medical"
        expected: "transferred features"

  - name: calibrate_confidence
    given: "Raw predictions"
    when: "Calibration"
    then: "Calibrated confidences"
    test_cases:
      - name: temperature_scaling
        input: "logits"
        expected: "calibrated probs"

# φ² + 1/φ² = 3 | PHOENIX = 999
