# Meta-Learning V97 - Learning to Learn
name: meta_learning_v97
version: "97.0.0"
language: zig
module: meta_learning

creation_pattern:
  source: TaskDistribution
  transformer: MetaLearner
  result: AdaptiveModel

types:
  Task:
    fields:
      support_set: List<Example>
      query_set: List<Example>
      task_id: String

  Example:
    fields:
      input_data: String
      label: String

  MetaModel:
    fields:
      base_params: List<Float>
      adaptation_rate: Float
      num_inner_steps: Int

  TaskEmbedding:
    fields:
      vector: List<Float>
      dimension: Int

  AdaptationResult:
    fields:
      adapted_params: List<Float>
      query_accuracy: Float
      adaptation_loss: Float

  MetaTrainConfig:
    fields:
      meta_lr: Float
      inner_lr: Float
      num_tasks: Int
      shots: Int
      ways: Int

  MetaTestResult:
    fields:
      mean_accuracy: Float
      confidence_interval: Float
      tasks_evaluated: Int

behaviors:
  - name: sample_task
    given: "Task distribution"
    when: "Task sampling"
    then: "N-way K-shot task"
    test_cases:
      - name: sample_5way_5shot
        input: "Omniglot distribution"
        expected: "5-way 5-shot task"

  - name: inner_loop_adapt
    given: "Support set"
    when: "Inner loop"
    then: "Task-adapted params"
    test_cases:
      - name: maml_inner
        input: "5 examples"
        expected: "adapted weights"

  - name: compute_meta_gradient
    given: "Query loss"
    when: "Meta gradient"
    then: "Gradient through adaptation"
    test_cases:
      - name: second_order
        input: "query predictions"
        expected: "meta gradients"

  - name: meta_update
    given: "Meta gradients"
    when: "Outer loop update"
    then: "Updated meta-params"
    test_cases:
      - name: meta_step
        input: "batch of gradients"
        expected: "improved meta-model"

  - name: embed_task
    given: "Task examples"
    when: "Task embedding"
    then: "Task representation"
    test_cases:
      - name: task_encoder
        input: "support set"
        expected: "task vector"

  - name: few_shot_predict
    given: "Adapted model and query"
    when: "Prediction"
    then: "Class prediction"
    test_cases:
      - name: predict_query
        input: "query example"
        expected: "class label"

  - name: evaluate_meta
    given: "Test tasks"
    when: "Meta-evaluation"
    then: "Few-shot accuracy"
    test_cases:
      - name: eval_1000_tasks
        input: "1000 test tasks"
        expected: "accuracy with CI"

# φ² + 1/φ² = 3 | PHOENIX = 999
