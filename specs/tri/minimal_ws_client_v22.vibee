name: minimal_ws_client_v22
version: "22.6.0"
language: zig
module: minimal_ws_client_v22

types:
  WsState:
    fields:
      name: String

  WsMessage:
    fields:
      data: String
      is_binary: Bool

  WsConfig:
    fields:
      url: String
      timeout_ms: Int
      auto_reconnect: Bool

  WsClient:
    fields:
      config: Object
      state: String
      message_id: Int

behaviors:
  - name: create_client
    given: WsConfig
    when: Initialize client
    then: WsClient instance

  - name: connect
    given: WsClient
    when: Connect to server
    then: Connection result

  - name: disconnect
    given: WsClient
    when: Disconnect
    then: Disconnected

  - name: send
    given: WsClient and message
    when: Send message
    then: Send result

  - name: send_json
    given: WsClient and json
    when: Send JSON message
    then: Send result

  - name: receive
    given: WsClient
    when: Receive message
    then: WsMessage

  - name: is_connected
    given: WsClient
    when: Check connection
    then: Boolean

  - name: on_message
    given: WsClient and handler
    when: Set message handler
    then: Handler set

  - name: on_error
    given: WsClient and handler
    when: Set error handler
    then: Handler set

  - name: get_state
    given: WsClient
    when: Get state
    then: WsState
