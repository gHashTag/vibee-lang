# Hierarchical Planning Module
# Multi-level task decomposition and planning
# Supports complex multi-step tasks

name: agent_planning_hierarchical
version: "1.0.0"
language: zig
module: agent_planning_hierarchical

types:
  Plan:
    fields:
      plan_id: String
      goal: String
      subgoals: List<String>
      actions: List<String>
      dependencies: Map<String,String>

  PlanLevel:
    fields:
      level_id: String
      level_number: Int
      abstraction: String
      items: List<String>

  Subgoal:
    fields:
      subgoal_id: String
      description: String
      parent_goal: String
      preconditions: List<String>
      effects: List<String>

  PlanExecution:
    fields:
      execution_id: String
      plan_id: String
      current_subgoal: String
      completed_subgoals: List<String>
      status: String

  PlanAdaptation:
    fields:
      adaptation_id: String
      original_plan: String
      trigger: String
      adapted_plan: String

behaviors:
  - name: decompose_goal
    given: High-level goal
    when: Goal decomposition needed
    then: Returns hierarchical subgoals

  - name: create_action_plan
    given: Subgoals and action space
    when: Action planning needed
    then: Returns executable action sequence

  - name: validate_plan
    given: Plan and preconditions
    when: Plan validation needed
    then: Returns validation result

  - name: execute_plan_step
    given: Current plan state
    when: Step execution needed
    then: Returns next action to execute

  - name: adapt_plan
    given: Plan and unexpected observation
    when: Plan adaptation needed
    then: Returns adapted plan

  - name: monitor_progress
    given: Plan execution state
    when: Progress check needed
    then: Returns progress metrics

  - name: replan_from_failure
    given: Failed plan and error
    when: Replanning needed
    then: Returns new plan from current state
