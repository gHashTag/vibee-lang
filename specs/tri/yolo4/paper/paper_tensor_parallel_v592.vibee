name: paper_tensor_parallel_v592
version: "592.0.0"
language: zig
module: paper_tensor_parallel_v592

types:
  TensorParallel:
    fields:
      tp_id: String
      world_size: Int
      rank: Int
      communication_backend: String
      phi_partitioning: Bool

  ShardedTensor:
    fields:
      tensor_id: String
      shard_dim: Int
      local_shard: Object
      global_shape: List<Int>

  AllReduceOp:
    fields:
      op_id: String
      operation: String
      tensors: List<String>
      async_op: Bool

  TensorParallelMetrics:
    fields:
      compute_time_ms: Float
      communication_time_ms: Float
      overlap_efficiency: Float
      phi_scaling: Float

behaviors:
  - name: create_tp
    given: TP config
    when: Creation
    then: Initialize tensor parallel

  - name: shard_tensor
    given: Tensor and dim
    when: Sharding needed
    then: Distribute across ranks

  - name: all_reduce
    given: Partial results
    when: Reduction needed
    then: Aggregate across ranks

  - name: all_gather
    given: Sharded tensor
    When: Gathering needed
    then: Collect all shards

  - name: overlap_compute
    given: Compute and comm
    When: Overlap possible
    then: Pipeline operations

  - name: phi_partition
    given: Tensor
    When: Partitioning needed
    then: Partition by phi ratio

  - name: synchronize
    given: Async operations
    When: Sync needed
    then: Wait for completion

  - name: get_metrics
    given: TP state
    When: Metrics query
    then: Return TP metrics
