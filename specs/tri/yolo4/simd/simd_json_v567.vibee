name: simd_json_v567
version: "567.0.0"
language: zig
module: simd_json_v567

types:
  SIMDJson:
    fields:
      parser_id: String
      input: String
      tape: List<Object>
      simd_width: Int

  JsonToken:
    fields:
      token_type: String
      start: Int
      end: Int
      depth: Int

  JsonValue:
    fields:
      value_type: String
      string_value: Option<String>
      number_value: Option<Float>
      bool_value: Option<Bool>

  JsonMetrics:
    fields:
      bytes_parsed: Int
      tokens_found: Int
      parse_time_us: Int
      simd_speedup: Float

  JsonConfig:
    fields:
      max_depth: Int
      allow_comments: Bool
      phi_buffering: Bool

behaviors:
  - name: parse_simd
    given: JSON string
    when: Parsing requested
    then: SIMD JSON parse

  - name: find_structural
    given: JSON bytes
    when: Structure scan
    then: Find brackets and quotes

  - name: validate_utf8
    given: Input bytes
    when: Validation needed
    then: SIMD UTF-8 check

  - name: parse_number
    given: Number string
    when: Number parsing
    then: SIMD number parse

  - name: parse_string
    given: String token
    When: String parsing
    then: SIMD string unescape

  - name: build_tape
    given: Structural chars
    When: Tape building
    then: Create JSON tape

  - name: query_path
    given: JSON path
    When: Query needed
    then: Navigate to value

  - name: serialize_simd
    given: JSON value
    When: Serialization needed
    then: SIMD JSON serialize

  - name: get_metrics
    given: Parser state
    When: Metrics query
    then: Return JSON metrics
