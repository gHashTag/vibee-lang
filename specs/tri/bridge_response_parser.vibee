# Bridge Response Parser
# Parse and validate responses
# Type-safe deserialization

name: bridge_response_parser
version: "1.0.0"
language: zig
module: bridge_response_parser

types:
  ParseResult:
    fields:
      success: Bool
      parsed_type: String
      data: Option<String>
      error: Option<String>

  ResponseSchema:
    fields:
      schema_id: String
      expected_fields: List<String>
      required_fields: List<String>

  ValidationResult:
    fields:
      is_valid: Bool
      missing_fields: List<String>
      type_errors: List<String>

  ParsedValue:
    fields:
      value_type: String
      string_value: Option<String>
      int_value: Option<Int>
      bool_value: Option<Bool>
      array_value: Option<String>

  JsonPath:
    fields:
      path: String
      segments: List<String>

  ParserConfig:
    fields:
      strict_mode: Bool
      allow_unknown_fields: Bool
      max_depth: Int

behaviors:
  - name: parse_json
    given: JSON string
    when: JSON parsing needed
    then: Returns parse result

  - name: extract_field
    given: Parsed JSON and field path
    when: Field extraction needed
    then: Returns extracted value

  - name: validate_schema
    given: Parsed JSON and schema
    when: Schema validation needed
    then: Returns validation result

  - name: parse_browser_response
    given: JSON and response type
    when: Browser response parsing needed
    then: Returns typed response

  - name: parse_error_response
    given: JSON
    When: Error parsing needed
    then: Returns parsed error

  - name: extract_array
    given: Parsed JSON and path
    when: Array extraction needed
    then: Returns array elements

  - name: to_string
    given: Parsed value
    when: String conversion needed
    then: Returns string representation

  - name: to_int
    given: Parsed value
    when: Int conversion needed
    then: Returns integer value
