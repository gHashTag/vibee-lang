# iGLA Semantic Chunker
# Semantic-aware text chunking
# Scientific basis: Ainslie et al. 2023, Chen et al. 2023
# φ² + 1/φ² = 3 | V = n × 3^k × π^m × φ^p

name: igla_semantic_chunker
version: "1.0.0"
language: zig
module: igla_semantic_chunker

sacred_constants:
  phi: 1.618033988749895
  trinity: 3.0
  phoenix: 999
  default_chunk_size: 512

scientific_references:
  - "Ainslie et al. 2023: CoLT5"
  - "Chen et al. 2023: Walking Down the Long Tail"
  - "Kamradt 2023: Semantic Chunking"
  - "LangChain 2023: Text Splitters"

types:
  ChunkerConfig:
    fields:
      chunk_size: Int
      chunk_overlap: Int
      strategy: String
      separator: String

  SemanticChunk:
    fields:
      id: Int
      text: String
      start_idx: Int
      end_idx: Int
      embedding: String

  ChunkBoundary:
    fields:
      position: Int
      confidence: Float
      boundary_type: String

  DocumentStructure:
    fields:
      sections: String
      paragraphs: String
      sentences: String

  ChunkMetadata:
    fields:
      chunk_id: Int
      source: String
      page: Int
      section: String

  SimilarityBreakpoint:
    fields:
      position: Int
      similarity_drop: Float
      is_boundary: Bool

behaviors:
  - name: split_by_sentence
    given: "Text"
    when: "Sentence splitting"
    then: "List of sentences"

  - name: split_by_paragraph
    given: "Text"
    when: "Paragraph splitting"
    then: "List of paragraphs"

  - name: recursive_split
    given: "Text, separators"
    when: "Recursive splitting"
    then: "Hierarchically split chunks"

  - name: semantic_split
    given: "Text, embeddings"
    when: "Semantic boundary detection"
    then: "Semantically coherent chunks"

  - name: detect_breakpoints
    given: "Sentence embeddings"
    when: "Similarity analysis"
    then: "List of SimilarityBreakpoints"

  - name: merge_small_chunks
    given: "Chunks, min_size"
    when: "Chunk merging"
    then: "Merged chunks above min_size"

  - name: add_overlap
    given: "Chunks, overlap_size"
    when: "Overlap addition"
    then: "Chunks with context overlap"

  - name: phi_optimal_chunking
    given: "Text"
    when: "Sacred chunking"
    then: "φ-ratio optimized chunks"
