# e2e_simple_task_v21.vibee
# KOSCHEI CYCLE 21 - Simple E2E Task: Navigate + Get Title
# Minimal test case for browser automation
# φ² + 1/φ² = 3 | PHOENIX = 999

name: e2e_simple_task_v21
version: "21.0.0"
language: zig
module: e2e_simple_task_v21

types:
  SimpleTaskConfig:
    fields:
      target_url: String
      expected_title_contains: String
      timeout_ms: Int

  SimpleTaskResult:
    fields:
      success: Bool
      actual_title: String
      matched: Bool
      latency_ms: Int
      error: Option<String>

  NavigateStep:
    fields:
      url: String
      start_time: Timestamp
      end_time: Timestamp
      status_code: Int

  GetTitleStep:
    fields:
      title: String
      extraction_time_ms: Int

  TaskMetrics:
    fields:
      navigate_ms: Int
      get_title_ms: Int
      total_ms: Int
      cdp_commands_sent: Int

behaviors:
  - name: run_simple_task
    given: SimpleTaskConfig with URL and expected title
    when: Executing navigate then get title
    then: Return SimpleTaskResult

  - name: step_navigate
    given: Target URL
    when: Browser navigates to URL
    then: Return NavigateStep with timing

  - name: step_get_title
    given: Loaded page
    when: Extracting page title via CDP
    then: Return GetTitleStep

  - name: verify_title
    given: Actual title and expected substring
    when: Checking title contains expected
    then: Return match result

  - name: collect_metrics
    given: All step timings
    when: Aggregating metrics
    then: Return TaskMetrics

test_cases:
  - name: example_com_title
    input: https://example.com
    expected: title contains "Example Domain"

  - name: google_title
    input: https://www.google.com
    expected: title contains "Google"

sacred_constants:
  phi: 1.618033988749895
  phi_squared_plus_inverse_squared: 3
  phoenix: 999
