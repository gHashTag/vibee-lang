name: warp_input_dispatch
version: "1.0.0"
language: zig
module: warp_input_dispatch

description: |
  WARP Input Dispatch - быстрый ввод < 5ms/символ
  CDP Input.dispatchKeyEvent и Input.insertText
  Human-like fingerprint для anti-bot
  φ² + 1/φ² = 3 | PHOENIX = 999

types:
  InputConfig:
    fields:
      human_like: Bool
      delay_min_ms: Int
      delay_max_ms: Int
      typo_rate: Float

  KeyEvent:
    fields:
      event_type: String
      key: String
      code: String
      modifiers: Int
      timestamp: Timestamp

  MouseEvent:
    fields:
      event_type: String
      x: Int
      y: Int
      button: String
      click_count: Int

  InputResult:
    fields:
      success: Bool
      chars_typed: Int
      total_time_ms: Float
      avg_char_time_ms: Float

  InputMetrics:
    fields:
      total_inputs: Int
      total_chars: Int
      avg_speed_cps: Float
      error_rate: Float

behaviors:
  - name: type_text
    given: Текст и InputConfig
    when: Ввод текста в активный элемент
    then: InputResult за < 5ms/символ (fast mode)

  - name: type_instant
    given: Текст для мгновенного ввода
    when: Использование Input.insertText
    then: Весь текст введён за < 10ms

  - name: press_key
    given: KeyEvent событие клавиши
    when: Нажатие клавиши
    then: Событие отправлено за < 1ms

  - name: click
    given: MouseEvent координаты клика
    when: Клик мышью
    then: Клик выполнен за < 5ms

  - name: move_mouse
    given: Целевые координаты x, y
    when: Перемещение мыши
    then: Мышь перемещена (human-like траектория)

  - name: scroll
    given: Направление и величина скролла
    when: Прокрутка страницы
    then: Скролл выполнен за < 10ms
