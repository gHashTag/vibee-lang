# cdp_console_bridge_v12358.vibee - Console Bridge
# Мост к консоли браузера
# φ² + 1/φ² = 3 | PHOENIX = 999

name: cdp_console_bridge_v12358
version: "12358.0.0"
language: zig
module: cdp_console_bridge_v12358

types:
  ConsoleMessage:
    fields:
      level: String
      text: String
      url: String
      line: Int
      column: Int
      timestamp: Timestamp

  ConsoleFilter:
    fields:
      levels: List
      url_pattern: String
      text_pattern: String

  EvalRequest:
    fields:
      expression: String
      context_id: Int
      await_promise: Bool
      return_by_value: Bool

  EvalResult:
    fields:
      result: Object
      exception: Object
      execution_time_ms: Int

  ConsoleHistory:
    fields:
      messages: List
      total_count: Int
      filtered_count: Int

behaviors:
  - name: get_messages
    given: ConsoleFilter
    when: Message fetch
    then: Return ConsoleHistory

  - name: evaluate
    given: EvalRequest
    when: Evaluation
    then: Return EvalResult

  - name: clear_console
    given: Page target
    when: Clear
    then: Return success

  - name: subscribe_console
    given: ConsoleFilter
    when: Subscription
    then: Return subscription_id

  - name: inject_script
    given: Script source
    when: Injection
    then: Return success

sacred_constants:
  phi: 1.618033988749895
  phoenix: 999
