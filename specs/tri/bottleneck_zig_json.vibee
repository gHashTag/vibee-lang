name: bottleneck_zig_json
version: "1.0.0"
language: zig
module: bottleneck_zig_json

# BOTTLENECK: JSON Parsing Performance
# Zig SIMD JSON parser for LLM response processing
# Target: 10x faster than JS JSON.parse for large responses

types:
  JsonValue:
    fields:
      value_type: String
      string_value: Option<String>
      number_value: Option<Float>
      bool_value: Option<Bool>
      array_length: Option<Int>
      object_keys: Option<List<String>>

  ParseResult:
    fields:
      success: Bool
      value: Option<String>
      error_message: Option<String>
      parse_time_ns: Int
      bytes_processed: Int

  JsonPath:
    fields:
      path: String
      segments: List<String>

  ExtractResult:
    fields:
      found: Bool
      value: Option<String>
      value_type: String

behaviors:
  - name: parse_json
    given: Raw JSON string from LLM response
    when: Need to parse into structured data
    then: Return ParseResult with timing metrics

  - name: extract_path
    given: Parsed JSON and JSONPath expression
    when: Need specific value from nested structure
    then: Return ExtractResult with value or not found

  - name: validate_json
    given: Raw JSON string
    when: Need to check if valid before full parse
    then: Return bool indicating validity

  - name: stream_parse
    given: JSON stream (chunked LLM response)
    when: Processing streaming API response
    then: Yield parsed objects as they complete

  - name: extract_action
    given: LLM response JSON
    when: Agent needs action and parameters
    then: Return action name and params map

  - name: benchmark_parse
    given: JSON string and iteration count
    when: Measuring parse performance
    then: Return average parse time in nanoseconds
