# FFI Racket v56660 - Racket ffi/unsafe
# VIBEE → Racket Native Bindings
# φ² + 1/φ² = 3 | PHOENIX = 999

name: ffi_racket_v56660
version: "56.6.60"
language: zig
module: ffi_racket

creation_pattern:
  source: VibeeSpec
  transformer: RacketBindingsGenerator
  result: RacketPackage

types:
  RacketCType:
    fields:
      name: String
      racket_type: String
      c_type: String

  RacketFFIFunction:
    fields:
      name: String
      c_name: String
      arg_types: List<String>
      result_type: String
      abi: Option<String>

  RacketCStruct:
    fields:
      name: String
      fields: List<String>
      alignment: Option<Int>

  RacketModule:
    fields:
      name: String
      requires: List<String>
      provides: List<String>
      ffi_lib: String
      functions: List<RacketFFIFunction>

  RacketPackage:
    fields:
      name: String
      modules: List<RacketModule>
      info_rkt: String
      deps: List<String>

  RacketCallback:
    fields:
      name: String
      arg_types: List<String>
      result_type: String

  RacketPointer:
    fields:
      type_name: String
      is_cpointer: Bool

  RacketContract:
    fields:
      name: String
      contract_expr: String

behaviors:
  - name: generate_racket_module
    given: VibeeSpec
    when: Racket module needed
    then: Racket source files

  - name: generate_ffi_function
    given: C function
    when: get-ffi-obj needed
    then: RacketFFIFunction

  - name: map_vibee_to_racket_ctype
    given: Vibee type
    when: Type mapping needed
    then: Racket ctype

  - name: generate_cstruct
    given: C struct
    when: define-cstruct needed
    then: RacketCStruct

  - name: generate_info_rkt
    given: Package config
    when: info.rkt needed
    then: Package info

  - name: handle_callback
    given: C callback
    when: _fun callback needed
    then: RacketCallback

  - name: handle_pointer
    given: C pointer
    when: _pointer needed
    then: RacketPointer

  - name: generate_contract
    given: Function signature
    when: Contract needed
    then: RacketContract
