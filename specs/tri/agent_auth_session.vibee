name: agent_auth_session
version: "1.0.0"
language: zig
module: agent_auth_session

description: |
  Agent Auth Session - управление сессиями
  Cookies, localStorage, sessionStorage
  φ² + 1/φ² = 3 | PHOENIX = 999

types:
  SessionInfo:
    fields:
      session_id: String
      domain: String
      created_at: Timestamp
      expires_at: Option<Timestamp>
      is_valid: Bool

  CookieInfo:
    fields:
      name: String
      value: String
      domain: String
      path: String
      expires: Option<Timestamp>
      secure: Bool
      http_only: Bool

  StorageItem:
    fields:
      key: String
      value: String
      storage_type: String

  SessionState:
    fields:
      cookies: List<String>
      local_storage: List<String>
      session_storage: List<String>

behaviors:
  - name: get_cookies
    given: Домен или все
    when: Получение cookies
    then: Список CookieInfo

  - name: set_cookie
    given: CookieInfo для установки
    when: Установка cookie
    then: Cookie установлен

  - name: delete_cookie
    given: Имя и домен cookie
    when: Удаление cookie
    then: Cookie удалён

  - name: get_storage
    given: Тип storage и ключ
    when: Получение из storage
    then: StorageItem или null

  - name: set_storage
    given: StorageItem для установки
    when: Установка в storage
    then: Значение установлено

  - name: export_session
    given: Текущая сессия
    when: Экспорт состояния сессии
    then: SessionState для восстановления

  - name: import_session
    given: SessionState для импорта
    when: Восстановление сессии
    then: Сессия восстановлена
