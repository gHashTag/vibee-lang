# Context Template System
# Reusable prompt templates for rapid behavior modification
# Key insight: Templates enable hours-not-weeks iteration

name: context_templates
version: "1.0.0"
language: zig
module: context_templates

types:
  Template:
    fields:
      template_id: String
      name: String
      description: String
      content: String
      placeholders: List<String>
      version: String

  TemplateCategory:
    fields:
      category_id: String
      name: String
      templates: List<String>
      default_template: String

  TemplateSlot:
    fields:
      slot_name: String
      slot_type: String
      required: Bool
      default_value: Option<String>
      validation_regex: Option<String>

  ComposedTemplate:
    fields:
      composed_id: String
      base_template: String
      overrides: Map<String,String>
      final_content: String
      token_count: Int

  TemplateLibrary:
    fields:
      library_id: String
      categories: List<String>
      total_templates: Int
      last_updated: Timestamp

  TemplateInheritance:
    fields:
      child_id: String
      parent_id: String
      overridden_slots: List<String>
      inherited_slots: List<String>

behaviors:
  - name: create_template
    given: Template name, content, and placeholders
    when: New template is registered
    then: Returns template ID with validation

  - name: fill_template
    given: Template ID and variable values
    when: Template instantiation requested
    then: Returns filled template with all placeholders resolved

  - name: validate_template
    given: Template content and slot definitions
    when: Validation is triggered
    then: Returns validation result with errors if any

  - name: inherit_template
    given: Parent template and override values
    when: Child template is created
    then: Returns new template inheriting parent structure

  - name: compose_templates
    given: List of template IDs and composition rules
    when: Multi-template composition requested
    then: Returns single composed template

  - name: list_by_category
    given: Category ID
    when: Category listing requested
    then: Returns all templates in category

  - name: search_templates
    given: Search query and filters
    when: Template search requested
    then: Returns matching templates ranked by relevance

  - name: export_template
    given: Template ID and format
    when: Export requested
    then: Returns template in specified format
