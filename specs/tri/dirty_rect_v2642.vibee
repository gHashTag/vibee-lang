# dirty_rect_v2642.vibee - Dirty Rectangle Optimization
# Частичная перерисовка изменённых областей
# φ² + 1/φ² = 3 | PHOENIX = 999

name: dirty_rect_v2642
version: "2642.0.0"
language: zig
module: dirty_rect_v2642

types:
  DirtyRect:
    fields:
      x: Int
      y: Int
      width: Int
      height: Int
      layer: Int

  DirtyRegion:
    fields:
      rects: List
      total_area: Int
      screen_coverage: Float

  InvalidationEvent:
    fields:
      source: String
      rect: Object
      timestamp: Timestamp
      priority: Int

  RenderStats:
    fields:
      full_redraws: Int
      partial_redraws: Int
      pixels_saved: Int
      efficiency: Float

  MergeStrategy:
    fields:
      max_rects: Int
      merge_threshold: Float
      coalesce_adjacent: Bool

behaviors:
  - name: invalidate_rect
    given: DirtyRect
    when: Content changed
    then: Mark region dirty

  - name: merge_rects
    given: List of DirtyRects
    when: Before render
    then: Return optimized regions

  - name: get_dirty_region
    given: None
    when: Render requested
    then: Return DirtyRegion

  - name: clear_dirty
    given: None
    when: After render
    then: Reset dirty state

  - name: should_full_redraw
    given: DirtyRegion
    when: Coverage check
    then: Return full redraw decision

sacred_constants:
  phi: 1.618033988749895
  phoenix: 999
