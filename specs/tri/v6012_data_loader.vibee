# v6012 - Data Loader
# ====================
# Загрузчик данных для тренировки
# φ² + 1/φ² = 3 | PHOENIX = 999

name: data_loader
version: "6.0.12"
language: zig
module: data_loader

constants:
  PHI: 1.618033988749895

types:
  DataLoader:
    fields:
      data: List
      batch_size: Int
      shuffle: Bool
      current_idx: Int
      
  Batch:
    fields:
      inputs: List
      targets: List
      mask: List
      
  DataConfig:
    fields:
      path: String
      batch_size: Int
      max_seq_len: Int
      shuffle: Bool

behaviors:
  - name: loader_init
    given: Data и config
    when: Инициализация
    then: Создать DataLoader
    
  - name: next_batch
    given: DataLoader
    when: Получение батча
    then: Вернуть следующий Batch
    
  - name: reset_loader
    given: DataLoader
    when: Сброс итератора
    then: Вернуться к началу
    
  - name: shuffle_data
    given: DataLoader и seed
    when: Перемешивание
    then: Shuffle данные
