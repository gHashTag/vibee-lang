name: agent_security_audit
version: "1.0.0"
language: zig
module: agent_security_audit

description: |
  Agent Security Audit - аудит действий агента
  Полная прозрачность всех действий
  φ² + 1/φ² = 3 | PHOENIX = 999

types:
  AuditEntry:
    fields:
      entry_id: String
      timestamp: Timestamp
      action_type: String
      target: String
      result: String
      risk_level: Int

  AuditLog:
    fields:
      entries: List<String>
      session_id: String
      start_time: Timestamp
      end_time: Option<Timestamp>

  AuditReport:
    fields:
      session_id: String
      total_actions: Int
      high_risk_actions: Int
      blocked_actions: Int
      summary: String

  AuditFilter:
    fields:
      time_range: Option<String>
      action_types: List<String>
      min_risk_level: Option<Int>

behaviors:
  - name: log_action
    given: Действие агента
    when: Логирование действия
    then: AuditEntry создан

  - name: get_audit_log
    given: AuditFilter фильтр
    when: Получение лога
    then: AuditLog

  - name: generate_report
    given: AuditLog лог сессии
    when: Генерация отчёта
    then: AuditReport

  - name: export_audit
    given: AuditLog для экспорта
    when: Экспорт в файл
    then: Файл аудита

  - name: alert_high_risk
    given: AuditEntry высокого риска
    when: Обнаружение высокого риска
    then: Алерт отправлен

  - name: review_session
    given: session_id для review
    when: Просмотр сессии
    then: Детальный AuditLog
