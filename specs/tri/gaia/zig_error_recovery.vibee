name: zig_error_recovery
version: "1.0.0"
language: zig
module: error_recovery

description: |
  Error Recovery and Fallback Logic.
  Handles failures gracefully with retries.
  Key for robust agent performance.
  φ² + 1/φ² = 3

types:
  ErrorType:
    enum:
      - element_not_found
      - timeout
      - navigation_failed
      - action_failed
      - llm_error
      - parse_error
      - unknown

  RecoveryStrategy:
    enum:
      - retry
      - alternative_action
      - backtrack
      - skip
      - abort

  ErrorContext:
    fields:
      error_type: ErrorType
      message: String
      action_attempted: String
      step_number: Int
      retry_count: Int

  RecoveryAction:
    fields:
      strategy: RecoveryStrategy
      alternative: Option<String>
      wait_ms: Int

  RecoveryConfig:
    fields:
      max_retries: Int
      retry_delay_ms: Int
      backtrack_steps: Int
      enable_alternatives: Bool

behaviors:
  - name: handle_error
    given: ErrorContext and RecoveryConfig
    when: Error occurs during execution
    then: Returns RecoveryAction

  - name: should_retry
    given: ErrorContext
    when: Deciding whether to retry
    then: Returns true if retry appropriate

  - name: get_alternative
    given: Failed action and page state
    when: Finding alternative approach
    then: Returns alternative action string

  - name: backtrack
    given: History and steps to go back
    when: Reverting to previous state
    then: Returns actions to undo

  - name: log_error
    given: ErrorContext
    when: Recording error for analysis
    then: Stores error in history
