name: zig_accessibility_tree
version: "1.0.0"
language: zig
module: accessibility_tree

description: |
  Accessibility Tree Extraction via CDP.
  Key technique from top WebArena solutions.
  Provides structured view of interactable elements.
  φ² + 1/φ² = 3

types:
  A11yRole:
    enum:
      - button
      - link
      - textbox
      - checkbox
      - radio
      - combobox
      - listbox
      - menu
      - menuitem
      - heading
      - image
      - table
      - row
      - cell
      - generic

  A11yNode:
    fields:
      node_id: Int
      role: A11yRole
      name: String
      value: Option<String>
      description: Option<String>
      focused: Bool
      disabled: Bool
      bounds_x: Int
      bounds_y: Int
      bounds_width: Int
      bounds_height: Int
      children_ids: List<Int>

  A11yTree:
    fields:
      root_id: Int
      nodes: List<A11yNode>
      focused_node_id: Option<Int>

  A11yConfig:
    fields:
      include_ignored: Bool
      max_depth: Int
      filter_roles: List<A11yRole>

behaviors:
  - name: get_tree
    given: CDP client connection
    when: Requesting accessibility tree
    then: Returns A11yTree structure

  - name: find_by_role
    given: A11yTree and role
    when: Searching for elements by role
    then: Returns list of matching A11yNode

  - name: find_by_name
    given: A11yTree and name pattern
    when: Searching for elements by name
    then: Returns list of matching A11yNode

  - name: get_focusable
    given: A11yTree
    when: Finding all focusable elements
    then: Returns list of focusable A11yNode

  - name: to_text
    given: A11yTree
    when: Converting to text representation
    then: Returns formatted string for LLM
