name: zig_browser_agent
version: "1.0.0"
language: zig
module: browser_agent

description: |
  Browser Agent - Connects LLM Agent with Browser.
  Full ReAct loop: Observe → Think → Act.
  For WebArena benchmark execution.
  φ² + 1/φ² = 3

constants:
  MAX_STEPS: 30
  OBSERVATION_MAX_LENGTH: 4000
  DEFAULT_TIMEOUT_MS: 120000

types:
  BrowserAgentConfig:
    fields:
      llm_api_key: String
      llm_provider: String
      llm_model: String
      browser_host: String
      browser_port: Int
      max_steps: Int
      timeout_ms: Int
      verbose: Bool

  StepResult:
    fields:
      step_number: Int
      observation: String
      thought: String
      action: String
      action_input: String
      success: Bool

  BrowserAgentResult:
    fields:
      task_id: Int
      success: Bool
      final_answer: Option<String>
      steps: List<StepResult>
      total_tokens: Int
      elapsed_ms: Int

behaviors:
  - name: init
    given: BrowserAgentConfig
    when: Creating browser agent
    then: Returns initialized agent with LLM and Browser

  - name: run_task
    given: WebArena task
    when: Executing full ReAct loop
    then: Returns BrowserAgentResult

  - name: observe
    given: Browser state
    when: Extracting page observation
    then: Returns observation string for LLM

  - name: think
    given: Observation and task context
    when: Calling LLM for next action
    then: Returns thought and action

  - name: act
    given: Action string
    when: Executing action in browser
    then: Returns action result

  - name: evaluate
    given: Task and current state
    when: Checking if task complete
    then: Returns true if evaluation passes
