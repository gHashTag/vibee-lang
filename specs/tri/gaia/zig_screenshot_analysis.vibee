name: zig_screenshot_analysis
version: "1.0.0"
language: zig
module: screenshot_analysis

description: |
  Screenshot Analysis for Visual Understanding.
  Enables vision-based element detection.
  For multimodal LLM integration.
  φ² + 1/φ² = 3

types:
  ImageFormat:
    enum:
      - png
      - jpeg
      - webp

  BoundingBox:
    fields:
      x: Int
      y: Int
      width: Int
      height: Int

  VisualElement:
    fields:
      element_type: String
      bounds: BoundingBox
      confidence: Float
      label: Option<String>

  Screenshot:
    fields:
      data_base64: String
      format: ImageFormat
      width: Int
      height: Int
      timestamp_ms: Int

  ScreenshotConfig:
    fields:
      format: ImageFormat
      quality: Int
      full_page: Bool
      clip: Option<BoundingBox>

behaviors:
  - name: capture
    given: Browser and ScreenshotConfig
    when: Taking screenshot
    then: Returns Screenshot

  - name: annotate
    given: Screenshot and elements
    when: Drawing bounding boxes
    then: Returns annotated Screenshot

  - name: crop
    given: Screenshot and BoundingBox
    when: Cropping region
    then: Returns cropped Screenshot

  - name: encode_for_llm
    given: Screenshot and max_size
    when: Preparing for vision LLM
    then: Returns base64 string

  - name: compare
    given: Two Screenshots
    when: Detecting changes
    then: Returns list of changed regions
