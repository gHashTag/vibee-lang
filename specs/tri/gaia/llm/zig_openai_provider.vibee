name: zig_openai_provider
version: "1.0.0"
language: zig
module: openai_provider

description: |
  OpenAI Provider - GPT-4, GPT-4o API integration.
  Implements LLM client interface for OpenAI.
  φ² + 1/φ² = 3

constants:
  OPENAI_API_URL: "https://api.openai.com/v1/chat/completions"
  DEFAULT_MODEL: "gpt-4o-mini"
  GPT4O_MODEL: "gpt-4o"
  GPT4_MODEL: "gpt-4"

types:
  OpenAIConfig:
    fields:
      api_key: String
      model: String
      max_tokens: Int
      temperature: Float
      organization: Option<String>

  OpenAIUsage:
    fields:
      prompt_tokens: Int
      completion_tokens: Int
      total_tokens: Int

  OpenAIChoice:
    fields:
      index: Int
      message_content: String
      message_role: String
      finish_reason: String

behaviors:
  - name: init
    given: OpenAIConfig
    when: Creating OpenAI provider
    then: Returns initialized provider

  - name: complete
    given: Messages array
    when: Calling chat completions API
    then: Returns response with content

  - name: build_request
    given: Messages and config
    when: Building JSON request body
    then: Returns JSON string

  - name: parse_response
    given: API response JSON
    when: Extracting content and usage
    then: Returns parsed response

  - name: handle_error
    given: HTTP status code
    when: Processing API error
    then: Returns appropriate error type
