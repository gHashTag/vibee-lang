name: zig_react_executor
version: "1.0.0"
language: zig
module: react_executor

description: |
  Full ReAct Execution Loop for WebArena.
  Connects LLM → Browser → Evaluation.
  Main entry point for task execution.
  φ² + 1/φ² = 3

constants:
  MAX_STEPS: 30
  DEFAULT_TIMEOUT_MS: 120000
  OBSERVATION_MAX_TOKENS: 4000

types:
  ExecutorState:
    enum:
      - idle
      - observing
      - thinking
      - acting
      - evaluating
      - success
      - failure
      - timeout

  ExecutorConfig:
    fields:
      max_steps: Int
      timeout_ms: Int
      llm_provider: String
      model: String
      verbose: Bool
      save_trajectory: Bool

  StepResult:
    fields:
      step_number: Int
      thought: String
      action: String
      observation: String
      success: Bool
      duration_ms: Int

  ExecutionResult:
    fields:
      task_id: Int
      success: Bool
      final_answer: Option<String>
      steps: List<StepResult>
      total_tokens: Int
      total_time_ms: Int
      error_message: Option<String>

behaviors:
  - name: execute
    given: WebArena task and browser instance
    when: Running full ReAct loop
    then: Returns ExecutionResult

  - name: observe
    given: Browser state
    when: Extracting page observation
    then: Returns observation string

  - name: think
    given: Observation and context
    when: Calling LLM for next action
    then: Returns thought and action

  - name: act
    given: Parsed action
    when: Executing action in browser
    then: Returns action result

  - name: evaluate
    given: Current state and task
    when: Checking task completion
    then: Returns true if task complete

  - name: should_stop
    given: Current state
    when: Checking termination conditions
    then: Returns true if should stop
