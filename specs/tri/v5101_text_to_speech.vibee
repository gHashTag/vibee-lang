# v5101 - Text-to-Speech
# =======================
# TTS - синтез речи нового поколения
# φ² + 1/φ² = 3 | PHOENIX = 999

name: text_to_speech
version: "5.1.1"
language: zig
module: text_to_speech

constants:
  PHI: 1.618033988749895
  MAX_TEXT_LENGTH: 500
  NUM_SPEAKERS: 1000
  PROSODY_DIM: 256

types:
  TTSConfig:
    fields:
      model_type: String
      sample_rate: Int
      use_prosody: Bool
      
  TextInput:
    fields:
      text: String
      language: String
      phonemes: List
      
  SpeakerEmbedding:
    fields:
      speaker_id: Int
      embedding: List
      
  ProsodyFeatures:
    fields:
      pitch: List
      energy: List
      duration: List
      
  AcousticFeatures:
    fields:
      mel: List
      f0: List
      voiced: List
      
  DurationPrediction:
    fields:
      durations: List
      total_frames: Int
      
  TTSOutput:
    fields:
      waveform: List
      mel: List
      alignment: List
      
  VoiceCloning:
    fields:
      reference_audio: List
      extracted_embedding: List

behaviors:
  - name: text_to_phonemes
    given: Text и language
    when: G2P conversion
    then: Вернуть phoneme sequence
    
  - name: encode_text
    given: Phonemes и encoder
    when: Text encoding
    then: Вернуть text embeddings
    
  - name: predict_duration
    given: Text embeddings
    when: Duration prediction
    then: Вернуть durations
    
  - name: predict_prosody
    given: Text и speaker
    when: Prosody prediction
    then: Вернуть prosody features
    
  - name: acoustic_model_forward
    given: Text, duration, prosody
    when: Acoustic generation
    then: Вернуть mel spectrogram
    
  - name: synthesize_speech
    given: Text и TTS model
    when: Full synthesis
    then: Вернуть TTS output
    
  - name: clone_voice
    given: Reference audio
    when: Voice cloning
    then: Вернуть speaker embedding
    
  - name: style_transfer
    given: Text, content voice, style voice
    when: Style transfer
    then: Вернуть styled speech
