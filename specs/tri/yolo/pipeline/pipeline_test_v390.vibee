name: pipeline_test_v390
version: "1.0.0"
language: zig
module: pipeline_test_v390

types:
  PipelineConfig:
    fields:
      name: String
      stages: List<String>
      triggers: List<String>
      timeout_ms: Int

  PipelineRun:
    fields:
      id: String
      status: String
      current_stage: String
      started_at: Timestamp

  PipelineStage:
    fields:
      name: String
      jobs: List<String>
      parallel: Bool
      required: Bool

  PipelineResult:
    fields:
      run_id: String
      success: Bool
      stages_passed: Int
      duration_ms: Int

behaviors:
  - name: trigger_pipeline
    given: Trigger event
    when: Pipeline triggered
    then: Pipeline run starts

  - name: execute_stage
    given: Stage ready
    when: Stage execution runs
    then: Stage completed

  - name: parallel_stages
    given: Independent stages
    when: Parallel mode enabled
    then: Stages run concurrently

  - name: gate_stage
    given: Gate condition
    when: Gate check runs
    then: Stage allowed or blocked

  - name: retry_stage
    given: Stage failed
    when: Retry triggered
    then: Stage retried

  - name: skip_stage
    given: Skip condition
    when: Skip check runs
    then: Stage skipped

  - name: abort_pipeline
    given: Abort requested
    when: Abort runs
    then: Pipeline aborted

  - name: report_status
    given: Pipeline running
    when: Status check runs
    then: Status reported
