# Interop Strings v56150 - String Encoding
# Cross-Language String Handling
# φ² + 1/φ² = 3 | PHOENIX = 999

name: interop_strings_v56150
version: "56.1.50"
language: zig
module: interop_strings

creation_pattern:
  source: SourceString
  transformer: StringConverter
  result: TargetString

types:
  StringEncoding:
    fields:
      name: String
      bytes_per_unit: Int
      is_variable_width: Bool
      bom: Option<String>

  StringView:
    fields:
      ptr: Int
      len: Int
      encoding: StringEncoding
      is_null_terminated: Bool

  OwnedString:
    fields:
      data: String
      len: Int
      capacity: Int
      encoding: StringEncoding

  StringConversion:
    fields:
      source_encoding: StringEncoding
      target_encoding: StringEncoding
      lossy: Bool
      replacement_char: Option<String>

  StringBuffer:
    fields:
      data: String
      len: Int
      capacity: Int
      growth_factor: Float

  CodePoint:
    fields:
      value: Int
      utf8_bytes: Int
      utf16_units: Int

  StringIterator:
    fields:
      string: StringView
      position: Int
      current_codepoint: Option<CodePoint>

  StringError:
    fields:
      code: Int
      message: String
      position: Option<Int>
      invalid_bytes: Option<String>

behaviors:
  - name: convert_utf8_to_utf16
    given: UTF-8 string
    when: UTF-16 needed
    then: UTF-16 string

  - name: convert_utf16_to_utf8
    given: UTF-16 string
    When: UTF-8 needed
    then: UTF-8 string

  - name: create_c_string
    given: Managed string
    when: Null-terminated needed
    then: C string with null terminator

  - name: create_pascal_string
    given: Managed string
    when: Length-prefixed needed
    then: Pascal string

  - name: validate_encoding
    given: String and encoding
    when: Validation needed
    then: Validation result

  - name: iterate_codepoints
    given: String
    when: Codepoint iteration needed
    then: StringIterator

  - name: normalize_string
    given: String and form
    when: Unicode normalization needed
    then: Normalized string

  - name: compare_strings
    given: Two strings
    when: Comparison needed
    then: Comparison result
