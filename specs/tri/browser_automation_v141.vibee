# BROWSER AUTOMATION FRAMEWORK V141 - Legal Automation Guide
# VIBEE AMPLIFICATION MODE: Ethical Browser Automation
name: browser_automation_v141
version: "141.0.0"
language: zig
module: browser_automation

creation_pattern:
  source: AutomationKnowledge
  transformer: FrameworkBuilder
  result: AutomationFramework

# BROWSER AUTOMATION - ЛЕГАЛЬНОЕ ИСПОЛЬЗОВАНИЕ
# Автоматизация браузера для тестирования, мониторинга и разработки

types:
  AutomationTool:
    fields:
      name: String
      tool_type: String
      language: String
      license: String
      use_cases: List<String>
      limitations: List<String>

  LegalUseCase:
    fields:
      use_case: String
      description: String
      tools: List<String>
      legal_status: String
      best_practices: List<String>

  EthicalGuideline:
    fields:
      guideline: String
      rationale: String
      violation_risk: String

  AutomationArchitecture:
    fields:
      component: String
      purpose: String
      implementation: String

  RateLimiting:
    fields:
      strategy: String
      requests_per_second: Float
      delay_between: Int
      respect_robots: Bool

  DetectionAvoidance:
    fields:
      technique: String
      ethical_use: String
      unethical_use: String

  TestingFramework:
    fields:
      name: String
      purpose: String
      integration: String

  AutomationFramework:
    fields:
      tools: List<AutomationTool>
      use_cases: List<LegalUseCase>
      guidelines: List<EthicalGuideline>
      architecture: List<AutomationArchitecture>

behaviors:
  - name: select_tool
    given: "Use case requirements"
    when: "Tool selection"
    then: "Appropriate tool"
    test_cases:
      - name: select
        input: "testing"
        expected: "Playwright/Puppeteer"

  - name: configure_automation
    given: "Selected tool"
    when: "Configuration"
    then: "Configured automation"
    test_cases:
      - name: configure
        input: "tool"
        expected: "configured"

  - name: implement_rate_limiting
    given: "Target site"
    when: "Rate limit setup"
    then: "Respectful automation"
    test_cases:
      - name: rate_limit
        input: "site"
        expected: "limited"

  - name: check_robots_txt
    given: "Target URL"
    when: "Robots check"
    then: "Compliance status"
    test_cases:
      - name: robots
        input: "url"
        expected: "compliant"

  - name: handle_errors
    given: "Automation error"
    when: "Error handling"
    then: "Graceful recovery"
    test_cases:
      - name: errors
        input: "error"
        expected: "handled"

  - name: generate_report
    given: "Automation results"
    when: "Reporting"
    then: "Detailed report"
    test_cases:
      - name: report
        input: "results"
        expected: "report"

# HEADLESS BROWSER TOOLS

headless_tools:
  playwright:
    name: "Playwright"
    developer: "Microsoft"
    languages: ["JavaScript", "Python", "Java", "C#"]
    license: "Apache 2.0"
    browsers: ["Chromium", "Firefox", "WebKit"]
    features:
      - "Auto-wait"
      - "Network interception"
      - "Mobile emulation"
      - "Screenshots/Video"
      - "PDF generation"
    install: "npm install playwright"
    best_for: ["E2E testing", "Web scraping (legal)", "Screenshots"]
    
  puppeteer:
    name: "Puppeteer"
    developer: "Google"
    languages: ["JavaScript", "TypeScript"]
    license: "Apache 2.0"
    browsers: ["Chrome", "Chromium"]
    features:
      - "Chrome DevTools Protocol"
      - "PDF generation"
      - "Screenshots"
      - "Form automation"
    install: "npm install puppeteer"
    best_for: ["Chrome automation", "PDF generation"]
    
  selenium:
    name: "Selenium WebDriver"
    developer: "Selenium Project"
    languages: ["Java", "Python", "C#", "Ruby", "JavaScript"]
    license: "Apache 2.0"
    browsers: ["All major browsers"]
    features:
      - "Cross-browser testing"
      - "Grid for parallel execution"
      - "Mature ecosystem"
    install: "pip install selenium"
    best_for: ["Cross-browser testing", "Legacy systems"]
    
  cypress:
    name: "Cypress"
    developer: "Cypress.io"
    languages: ["JavaScript", "TypeScript"]
    license: "MIT"
    browsers: ["Chrome", "Firefox", "Edge"]
    features:
      - "Time travel debugging"
      - "Automatic waiting"
      - "Real-time reloads"
    install: "npm install cypress"
    best_for: ["Frontend testing", "CI/CD integration"]

# ЛЕГАЛЬНЫЕ СЛУЧАИ ИСПОЛЬЗОВАНИЯ

legal_use_cases:
  testing:
    name: "Automated Testing"
    description: "Тестирование собственных приложений"
    legal_status: "ПОЛНОСТЬЮ ЛЕГАЛЬНО"
    examples:
      - "E2E тесты"
      - "Regression тесты"
      - "Visual regression"
      - "Performance testing"
    tools: ["Playwright", "Cypress", "Selenium"]
    
  monitoring:
    name: "Website Monitoring"
    description: "Мониторинг собственных сайтов"
    legal_status: "ЛЕГАЛЬНО"
    examples:
      - "Uptime monitoring"
      - "Performance monitoring"
      - "Content verification"
    tools: ["Puppeteer", "Playwright"]
    
  screenshots:
    name: "Screenshot Services"
    description: "Генерация скриншотов"
    legal_status: "ЛЕГАЛЬНО (с ограничениями)"
    examples:
      - "Thumbnail generation"
      - "Social media previews"
      - "Documentation"
    tools: ["Puppeteer", "Playwright"]
    
  pdf_generation:
    name: "PDF Generation"
    description: "Конвертация HTML в PDF"
    legal_status: "ЛЕГАЛЬНО"
    examples:
      - "Invoice generation"
      - "Report generation"
      - "Document archiving"
    tools: ["Puppeteer", "Playwright"]
    
  scraping_own:
    name: "Scraping Own Data"
    description: "Извлечение данных с собственных сайтов"
    legal_status: "ЛЕГАЛЬНО"
    examples:
      - "Data migration"
      - "Backup"
      - "Analytics"
    tools: ["Any"]
    
  scraping_public_api:
    name: "Public API Access"
    description: "Доступ к публичным API"
    legal_status: "ЛЕГАЛЬНО (с rate limiting)"
    examples:
      - "API integration"
      - "Data aggregation"
    requirements:
      - "Соблюдать rate limits"
      - "Использовать API ключи"
      - "Читать ToS"

# СЕРАЯ ЗОНА И ЗАПРЕЩЁННОЕ

gray_zone:
  scraping_public:
    name: "Scraping Public Websites"
    legal_status: "СЕРАЯ ЗОНА"
    factors:
      - "robots.txt compliance"
      - "Rate limiting"
      - "ToS agreement"
      - "Data usage"
    risks:
      - "IP ban"
      - "Legal action"
      - "ToS violation"
    best_practices:
      - "Проверять robots.txt"
      - "Соблюдать rate limits"
      - "Не собирать личные данные"
      - "Указывать User-Agent"

prohibited:
  credential_stuffing:
    name: "Credential Stuffing"
    legal_status: "НЕЗАКОННО"
    description: "Автоматизированный перебор паролей"
    
  ddos:
    name: "DDoS Attacks"
    legal_status: "НЕЗАКОННО"
    description: "Перегрузка серверов запросами"
    
  bypassing_auth:
    name: "Bypassing Authentication"
    legal_status: "НЕЗАКОННО"
    description: "Обход систем авторизации"
    
  scraping_private:
    name: "Scraping Private Data"
    legal_status: "НЕЗАКОННО"
    description: "Сбор личных данных без согласия"

# ЭТИЧЕСКИЕ ПРИНЦИПЫ

ethical_guidelines:
  respect_robots:
    guideline: "Соблюдать robots.txt"
    rationale: "Владелец сайта указывает что можно/нельзя"
    implementation: "Проверять перед каждым запросом"
    
  rate_limiting:
    guideline: "Ограничивать частоту запросов"
    rationale: "Не перегружать серверы"
    implementation: "1-2 запроса в секунду максимум"
    
  identify_yourself:
    guideline: "Указывать User-Agent"
    rationale: "Прозрачность для владельца"
    implementation: "Уникальный User-Agent с контактом"
    
  respect_tos:
    guideline: "Читать Terms of Service"
    rationale: "Юридическая защита"
    implementation: "Проверять ToS перед автоматизацией"
    
  no_personal_data:
    guideline: "Не собирать личные данные"
    rationale: "GDPR, CCPA и другие законы"
    implementation: "Фильтровать PII"

# АРХИТЕКТУРА АВТОМАТИЗАЦИИ

automation_architecture:
  browser_layer:
    component: "Browser Engine"
    options: ["Chromium", "Firefox", "WebKit"]
    purpose: "Рендеринг страниц"
    
  protocol_layer:
    component: "DevTools Protocol"
    options: ["CDP", "WebDriver"]
    purpose: "Управление браузером"
    
  api_layer:
    component: "Automation API"
    options: ["Playwright", "Puppeteer", "Selenium"]
    purpose: "Высокоуровневый интерфейс"
    
  test_layer:
    component: "Test Framework"
    options: ["Jest", "Mocha", "pytest"]
    purpose: "Организация тестов"

# ПРИМЕР ЛЕГАЛЬНОЙ АВТОМАТИЗАЦИИ

example_legal_automation:
  purpose: "E2E тестирование собственного приложения"
  tool: "Playwright"
  code_example: |
    // Тестирование СОБСТВЕННОГО приложения
    const { test, expect } = require('@playwright/test');
    
    test('login flow', async ({ page }) => {
      // Тестируем СВОЙ сайт
      await page.goto('https://my-own-app.com/login');
      await page.fill('#email', 'test@example.com');
      await page.fill('#password', 'testpassword');
      await page.click('button[type="submit"]');
      await expect(page).toHaveURL('/dashboard');
    });

# RATE LIMITING СТРАТЕГИИ

rate_limiting_strategies:
  fixed_delay:
    strategy: "Фиксированная задержка"
    implementation: "await page.waitForTimeout(1000)"
    requests_per_second: 1.0
    
  random_delay:
    strategy: "Случайная задержка"
    implementation: "await page.waitForTimeout(1000 + Math.random() * 2000)"
    requests_per_second: 0.5
    
  exponential_backoff:
    strategy: "Экспоненциальный откат"
    implementation: "При ошибке увеличивать задержку"
    use_case: "При rate limiting от сервера"

# φ² + 1/φ² = 3 | PHOENIX = 999
