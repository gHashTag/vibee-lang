# VIBEE Specification v13440
# Contrastive Learning - CLIP-style contrastive alignment
name: contrastive_learning_v13440
version: "1.0.0"
language: zig
module: contrastive_learning

types:
  ContrastiveLoss:
    fields:
      infonce: String
      ntxent: String
      triplet: String
      cosine: String

  EmbeddingPair:
    fields:
      anchor: String
      positive: String
      negative: String

  SimilarityMatrix:
    fields:
      scores: String
      batch_size: Int
      temperature: Float

  ContrastiveConfig:
    fields:
      loss_type: String
      temperature: Float
      margin: Float
      hard_negative_mining: Bool

  ContrastiveOutput:
    fields:
      loss: Float
      accuracy: Float
      similarity_matrix: String

behaviors:
  - name: compute_similarity
    given: Two embeddings
    when: Similarity computed
    then: Returns similarity score

  - name: build_similarity_matrix
    given: Batch of pairs
    when: Matrix built
    then: Returns similarity matrix

  - name: compute_contrastive_loss
    given: Matrix and config
    when: Loss computed
    then: Returns contrastive output

  - name: mine_hard_negatives
    given: Similarity matrix
    when: Mining done
    then: Returns hard negatives
