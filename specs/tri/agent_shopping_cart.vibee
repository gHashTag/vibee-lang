name: agent_shopping_cart
version: "1.0.0"
language: zig
module: agent_shopping_cart

description: |
  Agent Shopping Cart - корзина покупок
  OpenAI Operator: онлайн-покупки
  φ² + 1/φ² = 3 | PHOENIX = 999

types:
  CartItem:
    fields:
      product_id: String
      name: String
      price: Float
      quantity: Int
      options: Option<String>

  Cart:
    fields:
      items: List<String>
      subtotal: Float
      tax: Float
      shipping: Float
      total: Float

  AddToCartResult:
    fields:
      success: Bool
      cart_count: Int
      item_added: String
      error: Option<String>

  PromoCode:
    fields:
      code: String
      discount_type: String
      discount_value: Float
      valid: Bool

behaviors:
  - name: add_to_cart
    given: Продукт и количество
    when: Добавление в корзину
    then: AddToCartResult

  - name: remove_from_cart
    given: CartItem для удаления
    when: Удаление из корзины
    then: Обновлённая Cart

  - name: update_quantity
    given: CartItem и новое количество
    when: Изменение количества
    then: Обновлённая Cart

  - name: get_cart
    given: Текущая сессия
    when: Получение корзины
    then: Cart со всеми товарами

  - name: apply_promo
    given: PromoCode код
    when: Применение промокода
    then: Cart с discount

  - name: clear_cart
    given: Текущая корзина
    when: Очистка корзины
    then: Пустая Cart
