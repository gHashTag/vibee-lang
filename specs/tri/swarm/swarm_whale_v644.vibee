# VIBEE YOLO MODE V - Swarm Whale v644
# φ² + 1/φ² = 3 | PHOENIX = 999
# Whale Optimization Algorithm (WOA)

name: swarm_whale_v644
version: "5.0.0"
language: zig
module: swarm_whale

sacred_constants:
  phi: 1.618033988749895
  phi_squared_plus_inverse_squared: 3
  phoenix: 999

creation_pattern:
  source: PreyProblem
  transformer: WhaleOptimizer
  result: BestPrey

types:
  Whale:
    fields:
      position: String
      fitness: Float
      a_coefficient: Float

  WhaleConfig:
    fields:
      population: Int
      max_iterations: Int
      a_decrease: Float
      b_constant: Float

  WhaleState:
    fields:
      best_whale: String
      best_fitness: Float
      iteration: Int

  WhaleMetrics:
    fields:
      encircling_moves: Int
      spiral_moves: Int
      search_moves: Int
      convergence: Float

behaviors:
  - name: initialize_whales
    given: WhaleConfig
    when: Initialization
    then: Whales randomly positioned

  - name: encircle_prey
    given: Best whale position
    when: Encircling
    then: Whale moves toward best position

  - name: spiral_update
    given: Best whale position
    when: Spiral movement
    then: Whale spirals toward prey

  - name: search_prey
    given: Random whale
    when: Exploration
    then: Whale searches using random whale

  - name: update_a_coefficient
    given: Iteration
    when: Coefficient update
    then: a linearly decreased from 2 to 0

  - name: choose_mechanism
    given: Random probability
    when: Mechanism selection
    then: Encircling or spiral chosen

  - name: update_best
    given: All whales
    when: Best update
    then: Best whale tracked

  - name: bubble_net_attack
    given: Prey located
    when: Attack phase
    then: Coordinated bubble-net attack

test_cases:
  - name: test_whales_init
    input:
      population: 30
    expected:
      initialized: true

  - name: test_encircle_prey
    input:
      best_position: valid
    expected:
      encircled: true

  - name: test_spiral_update
    input:
      best_position: valid
    expected:
      spiraled: true

  - name: test_search_prey
    input:
      random_whale: selected
    expected:
      searched: true

  - name: test_a_update
    input:
      iteration: 50
      max_iterations: 100
    expected:
      a_value: 1.0

  - name: test_mechanism_choose
    input:
      probability: 0.3
    expected:
      mechanism_chosen: true

  - name: test_best_update
    input:
      whales: evaluated
    expected:
      best_tracked: true

  - name: test_bubble_net
    input:
      prey_located: true
    expected:
      attack_executed: true

  - name: test_phi_whale
    input:
      phi: 1.618033988749895
    expected:
      golden_b: 1.618033988749895
