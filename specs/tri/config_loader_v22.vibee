name: config_loader_v22
version: "22.5.0"
language: zig
module: config_loader_v22

types:
  ConfigFormat:
    fields:
      name: String

  AgentConfig:
    fields:
      name: String
      cdp_host: String
      cdp_port: Int
      ollama_endpoint: String
      ollama_model: String
      max_steps: Int
      timeout_ms: Int
      verbose: Bool

  ConfigSource:
    fields:
      path: String
      format: String
      priority: Int

  ConfigValidation:
    fields:
      valid: Bool
      errors: List<String>
      warnings: List<String>

  ConfigLoader:
    fields:
      sources: List<String>
      config: Object
      defaults: Object

behaviors:
  - name: create_loader
    given: Default config
    when: Initialize loader
    then: ConfigLoader instance

  - name: load_from_file
    given: ConfigLoader and file path
    when: Load config file
    then: Loaded config

  - name: load_from_json
    given: ConfigLoader and JSON string
    when: Parse JSON config
    then: Loaded config

  - name: load_from_yaml
    given: ConfigLoader and YAML string
    when: Parse YAML config
    then: Loaded config

  - name: load_from_env
    given: ConfigLoader
    when: Load from environment
    then: Loaded config

  - name: merge_configs
    given: ConfigLoader and configs
    When: Merge multiple configs
    then: Merged config

  - name: validate
    given: ConfigLoader
    When: Validate config
    then: ConfigValidation

  - name: get_config
    given: ConfigLoader
    When: Get final config
    then: AgentConfig

  - name: get_value
    given: ConfigLoader and key
    When: Get config value
    then: Value

  - name: set_value
    given: ConfigLoader and key and value
    When: Set config value
    then: Updated config

  - name: save_to_file
    given: ConfigLoader and path
    When: Save config
    then: Save result
