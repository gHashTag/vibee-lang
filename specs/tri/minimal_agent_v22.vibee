name: minimal_agent_v22
version: "22.6.0"
language: zig
module: minimal_agent_v22

types:
  AgentConfig:
    fields:
      ollama_url: String
      cdp_url: String
      model: String
      max_steps: Int

  AgentStep:
    fields:
      step: Int
      observation: String
      action: String
      result: String

  AgentResult:
    fields:
      success: Bool
      steps: List<String>
      final_answer: String
      duration_ms: Int

  MinimalAgent:
    fields:
      config: Object
      http: Object
      ws: Object
      step_count: Int

behaviors:
  - name: create_agent
    given: AgentConfig
    when: Initialize agent
    then: MinimalAgent instance

  - name: run
    given: MinimalAgent and goal
    when: Run agent loop
    then: AgentResult

  - name: observe
    given: MinimalAgent
    when: Get page observation
    then: Observation string

  - name: think
    given: MinimalAgent and observation
    when: Query Ollama
    then: Action string

  - name: act
    given: MinimalAgent and action
    when: Execute via CDP
    then: Action result

  - name: is_done
    given: MinimalAgent and observation
    when: Check completion
    then: Boolean

  - name: connect_cdp
    given: MinimalAgent
    when: Connect to Chrome
    then: Connection result

  - name: query_ollama
    given: MinimalAgent and prompt
    when: Query LLM
    then: LLM response

  - name: execute_cdp
    given: MinimalAgent and command
    when: Send CDP command
    then: CDP response

  - name: get_steps
    given: MinimalAgent
    when: Get step history
    then: Step list
