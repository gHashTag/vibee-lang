# ═══════════════════════════════════════════════════════════════════════════════
# BENCHMARK VERSION COMPARISON - Сравнение производительности версий
# ═══════════════════════════════════════════════════════════════════════════════
# Автоматическое сравнение производительности между версиями с историей
#
# Sacred Formula: V = n × 3^k × π^m × φ^p × e^q
# Golden Identity: φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════

name: benchmark_version_comparison
version: "1.0.0"
language: zig
module: benchmark_version_comparison
author: "VIBEE Team"

# ═══════════════════════════════════════════════════════════════════════════════
# TYPES
# ═══════════════════════════════════════════════════════════════════════════════

types:
  VersionMetrics:
    description: "Performance metrics for a version"
    fields:
      version: String
      timestamp: Int
      timing: TimingReport
      resources: ResourceReport
      power: PowerReport
      throughput: Float
      latency: Float
      
  ComparisonReport:
    description: "Comparison between versions"
    fields:
      version_a: String
      version_b: String
      timing_delta: TimingDelta
      resources_delta: ResourceDelta
      power_delta: PowerDelta
      throughput_delta: Float
      latency_delta: Float
      regression_detected: Bool
      
  TimingDelta:
    description: "Timing comparison delta"
    fields:
      wns_delta: Float
      tns_delta: Float
      max_freq_delta: Float
      
  ResourceDelta:
    description: "Resource comparison delta"
    fields:
      lut_delta: Int
      ff_delta: Int
      bram_delta: Int
      dsp_delta: Int

# ═══════════════════════════════════════════════════════════════════════════════
# BEHAVIORS
# ═══════════════════════════════════════════════════════════════════════════════

behaviors:
  - name: run_benchmark
    given: Version and test configuration
    when: Benchmark requested
    then: Run benchmark and store metrics
    params:
      - name: version
        type: String
      - name: config
        type: BenchmarkConfig
    returns: VersionMetrics
    
  - name: compare_versions
    given: Two version metrics
    when: Comparison requested
    then: Compare metrics and detect regressions
    params:
      - name: metrics_a
        type: VersionMetrics
      - name: metrics_b
        type: VersionMetrics
    returns: ComparisonReport
    
  - name: store_metrics
    given: Version metrics
    when: Storage requested
    then: Store metrics in version history database
    params:
      - name: metrics
        type: VersionMetrics
    
  - name: load_metrics
    given: Version identifier
    when: Load requested
    then: Load metrics from version history
    params:
      - name: version
        type: String
    returns: VersionMetrics
    
  - name: detect_regression
    given: Comparison report
    when: Regression detection requested
    then: Detect performance regressions
    params:
      - name: comparison
        type: ComparisonReport
    returns: Bool
    
  - name: generate_comparison_report
    given: Comparison report
    when: Report generation requested
    then: Generate human-readable comparison report
    params:
      - name: comparison
        type: ComparisonReport
      - name: format
        type: String
    returns: String

test_cases:
  - name: test_version_comparison
    given: Two versions with metrics
    when: Comparison executed
    then: Comparison report generated with deltas
    
  - name: test_regression_detection
    given: Comparison with performance degradation
    when: Regression detection executed
    then: Regression detected and reported
