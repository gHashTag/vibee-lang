# ═══════════════════════════════════════════════════════════════════════════════
# CODE GENERATOR v185 - Multi-Target Code Generation Engine
# ═══════════════════════════════════════════════════════════════════════════════
# Targets: Zig, Python, TypeScript, Go, Rust
# PAS Pattern: D&C + PRE + MLS
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════

name: code_generator
version: "1.8.5"
language: zig
module: code_generator

sacred_constants:
  phi: 1.618033988749895
  phi_inv: 0.618033988749895
  phi_sq: 2.618033988749895
  trinity: 3.0
  phoenix: 999

creation_pattern:
  source: ParsedSpec
  transformer: CodeGenerator
  result: GeneratedCode

# ═══════════════════════════════════════════════════════════════════════════════
# TYPES
# ═══════════════════════════════════════════════════════════════════════════════

types:
  TargetLanguage:
    enum:
      - zig
      - python
      - typescript
      - go
      - rust
      - gleam
      - wasm

  GeneratorConfig:
    fields:
      target: TargetLanguage
      output_dir: String
      include_tests: Bool = true
      include_docs: Bool = true
      optimize: Bool = false

  GeneratedCode:
    fields:
      language: TargetLanguage
      filename: String
      content: String
      size_bytes: Int
      test_count: Int

  GenerationResult:
    fields:
      success: Bool
      files: List<GeneratedCode>
      errors: List<String>
      stats: GenerationStats

  GenerationStats:
    fields:
      total_files: Int
      total_bytes: Int
      total_tests: Int
      generation_time_ms: Int

  Template:
    fields:
      name: String
      language: TargetLanguage
      content: String
      placeholders: List<String>

# ═══════════════════════════════════════════════════════════════════════════════
# BEHAVIORS
# ═══════════════════════════════════════════════════════════════════════════════

behaviors:
  - name: select_generator
    given: "Target language"
    when: "Generator selection needed"
    then: "Return appropriate code generator"
    pas_pattern: PRE
    complexity: O(1)
    test_cases:
      - name: test_zig
        input: '{"target": "zig"}'
        expected: '{"generator": "ZigGenerator"}'
      - name: test_python
        input: '{"target": "python"}'
        expected: '{"generator": "PythonGenerator"}'

  - name: generate_zig
    given: "Parsed spec"
    when: "Zig generation requested"
    then: "Return generated Zig code"
    pas_pattern: D&C
    complexity: O(n)
    test_cases:
      - name: test_zig_struct
        input: '{"type": "struct", "name": "User"}'
        expected: '{"contains": "pub const User = struct"}'

  - name: generate_python
    given: "Parsed spec"
    when: "Python generation requested"
    then: "Return generated Python code"
    pas_pattern: D&C
    complexity: O(n)
    test_cases:
      - name: test_python_class
        input: '{"type": "struct", "name": "User"}'
        expected: '{"contains": "class User:"}'

  - name: generate_typescript
    given: "Parsed spec"
    when: "TypeScript generation requested"
    then: "Return generated TypeScript code"
    pas_pattern: D&C
    complexity: O(n)
    test_cases:
      - name: test_ts_interface
        input: '{"type": "struct", "name": "User"}'
        expected: '{"contains": "interface User"}'

  - name: apply_template
    given: "Template and values"
    when: "Template application needed"
    then: "Return filled template"
    pas_pattern: PRE
    complexity: O(n)
    test_cases:
      - name: test_template
        input: '{"template": "const {name} = {value};", "values": {"name": "x", "value": "1"}}'
        expected: '{"result": "const x = 1;"}'

  - name: optimize_output
    given: "Generated code"
    when: "Optimization enabled"
    then: "Return optimized code"
    pas_pattern: MLS
    complexity: O(n)
    test_cases:
      - name: test_optimize
        input: '{"code": "const x = 1; const y = 2;"}'
        expected: '{"optimized": true}'

# ═══════════════════════════════════════════════════════════════════════════════
# TYPE MAPPINGS
# ═══════════════════════════════════════════════════════════════════════════════

type_mappings:
  zig:
    String: "[]const u8"
    Int: "i64"
    Float: "f64"
    Bool: "bool"
    List: "[]const u8"
    Map: "std.StringHashMap"
    Option: "?"
    Timestamp: "i64"

  python:
    String: "str"
    Int: "int"
    Float: "float"
    Bool: "bool"
    List: "list"
    Map: "dict"
    Option: "Optional"
    Timestamp: "int"

  typescript:
    String: "string"
    Int: "number"
    Float: "number"
    Bool: "boolean"
    List: "Array"
    Map: "Record"
    Option: "| null"
    Timestamp: "number"

  go:
    String: "string"
    Int: "int64"
    Float: "float64"
    Bool: "bool"
    List: "[]"
    Map: "map"
    Option: "*"
    Timestamp: "int64"

  rust:
    String: "&str"
    Int: "i64"
    Float: "f64"
    Bool: "bool"
    List: "Vec"
    Map: "HashMap"
    Option: "Option"
    Timestamp: "i64"

# ═══════════════════════════════════════════════════════════════════════════════
# TEMPLATES BY LANGUAGE
# ═══════════════════════════════════════════════════════════════════════════════

templates:
  zig:
    struct: |
      pub const {name} = struct {
          {fields}
      };
    
    enum: |
      pub const {name} = enum {
          {variants}
      };
    
    function: |
      pub fn {name}({params}) {return_type} {
          {body}
      }
    
    test: |
      test "{name}" {
          {body}
      }

  python:
    class: |
      @dataclass
      class {name}:
          {fields}
    
    enum: |
      class {name}(Enum):
          {variants}
    
    function: |
      def {name}({params}) -> {return_type}:
          {body}
    
    test: |
      def test_{name}():
          {body}

  typescript:
    interface: |
      export interface {name} {
          {fields}
      }
    
    enum: |
      export enum {name} {
          {variants}
      }
    
    function: |
      export function {name}({params}): {return_type} {
          {body}
      }
    
    test: |
      test('{name}', () => {
          {body}
      });

# ═══════════════════════════════════════════════════════════════════════════════
# PERFORMANCE TARGETS
# ═══════════════════════════════════════════════════════════════════════════════

performance:
  targets:
    zig_generation_ms: 2
    python_generation_ms: 3
    typescript_generation_ms: 3
    go_generation_ms: 3
    rust_generation_ms: 4

  benchmarks:
    - name: "Generate 10 types"
      target_ms: 5
    - name: "Generate 50 behaviors"
      target_ms: 10
    - name: "Generate 100 tests"
      target_ms: 15

# ═══════════════════════════════════════════════════════════════════════════════
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════
