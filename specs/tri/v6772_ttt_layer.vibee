name: v6772_ttt_layer
version: "1.0.0"
language: zig
module: v6772_ttt_layer

types:
  TTTConfig:
    fields:
      inner_dim: Int
      num_steps: Int
      learning_rate: Float

behaviors:
  - name: test_time_train
    given: Input sequence
    when: Train inner model on context
    then: Return adapted weights

  - name: inner_forward
    given: Input and adapted weights
    when: Forward with adapted model
    then: Return output

  - name: gradient_step
    given: Loss and weights
    when: Take gradient step
    then: Return updated weights
