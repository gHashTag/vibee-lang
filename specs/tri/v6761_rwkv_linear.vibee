name: v6761_rwkv_linear
version: "1.0.0"
language: zig
module: v6761_rwkv_linear

types:
  RWKVConfig:
    fields:
      hidden_dim: Int
      num_layers: Int
      time_decay: Float

behaviors:
  - name: wkv_computation
    given: Keys values weights
    when: Compute weighted key-value
    then: Return receptance-weighted output

  - name: time_mixing
    given: Current and previous state
    when: Apply time mixing
    then: Return mixed representation

  - name: channel_mixing
    given: Input features
    when: Apply channel mixing FFN
    then: Return transformed features
