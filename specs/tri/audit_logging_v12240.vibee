# VIBEE Specification v12240
# Audit Logging - Compliance and security audit trails
name: audit_logging_v12240
version: "1.0.0"
language: zig
module: audit_logging

types:
  AuditAction:
    fields:
      create: String
      read: String
      update: String
      delete: String
      access: String

  AuditEntry:
    fields:
      id: String
      action: String
      actor: String
      resource: String
      details: String
      ip_address: String
      timestamp: Timestamp

  AuditPolicy:
    fields:
      id: String
      name: String
      actions: String
      resources: String
      retention_days: Int
      enabled: Bool

  AuditQuery:
    fields:
      actor: String
      action: String
      resource: String
      start_time: Timestamp
      end_time: Timestamp

  AuditReport:
    fields:
      policy_id: String
      entries: String
      total_count: Int
      period_start: Timestamp
      period_end: Timestamp

behaviors:
  - name: log_audit_entry
    given: Audit event data
    when: Entry logged
    then: Returns immutable audit entry

  - name: create_policy
    given: Policy configuration
    when: Policy created
    then: Returns active audit policy

  - name: query_audit_log
    given: Audit query
    when: Query executed
    then: Returns matching entries

  - name: generate_audit_report
    given: Policy and time range
    when: Report generated
    then: Returns compliance report
