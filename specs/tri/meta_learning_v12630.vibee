# VIBEE Specification v12630
# Meta Learning - Learning to learn algorithms
name: meta_learning_v12630
version: "1.0.0"
language: zig
module: meta_learning

types:
  MetaAlgorithm:
    fields:
      maml: String
      prototypical: String
      matching: String
      reptile: String

  MetaTask:
    fields:
      id: String
      support_set: String
      query_set: String
      n_way: Int
      k_shot: Int

  MetaLearner:
    fields:
      id: String
      algorithm: String
      inner_lr: Float
      outer_lr: Float
      inner_steps: Int

  Adaptation:
    fields:
      task_id: String
      adapted_params: String
      support_loss: Float
      query_accuracy: Float

  MetaTrainingState:
    fields:
      learner_id: String
      meta_iterations: Int
      avg_query_accuracy: Float
      tasks_seen: Int

behaviors:
  - name: create_meta_learner
    given: Algorithm and config
    When: Learner created
    then: Returns meta learner

  - name: sample_task
    given: Task distribution
    When: Task sampled
    then: Returns meta task

  - name: adapt_to_task
    given: Learner and task
    When: Adaptation done
    then: Returns adaptation result

  - name: meta_update
    given: Adaptations batch
    When: Meta update applied
    then: Returns updated learner
