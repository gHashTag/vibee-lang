name: real_cdp_client_v22
version: "22.4.0"
language: zig
module: real_cdp_client_v22

types:
  CDPConfig:
    fields:
      host: String
      port: Int
      timeout_ms: Int
      auto_reconnect: Bool

  CDPMessage:
    fields:
      id: Int
      method: String
      params: Object
      session_id: Option<String>

  CDPResponse:
    fields:
      id: Int
      result: Object
      error: Option<String>

  CDPEvent:
    fields:
      method: String
      params: Object
      session_id: Option<String>

  ConnectionState:
    fields:
      connected: Bool
      url: String
      last_error: Option<String>

  CDPClient:
    fields:
      config: Object
      state: Object
      message_id: Int
      pending: Object

behaviors:
  - name: create_client
    given: CDPConfig
    when: Initialize client
    then: CDPClient instance

  - name: connect
    given: CDPClient
    when: Connect to Chrome
    then: Connection result

  - name: disconnect
    given: CDPClient
    when: Close connection
    then: Disconnected

  - name: send_command
    given: CDPClient and method and params
    when: Send CDP command
    then: CDPResponse

  - name: navigate
    given: CDPClient and URL
    when: Navigate to page
    then: Navigation result

  - name: get_dom
    given: CDPClient
    when: Get DOM tree
    then: DOM snapshot

  - name: click_element
    given: CDPClient and selector
    when: Click element
    then: Click result

  - name: type_text
    given: CDPClient and selector and text
    when: Type into element
    then: Type result

  - name: take_screenshot
    given: CDPClient
    when: Capture screenshot
    then: Base64 image

  - name: evaluate_js
    given: CDPClient and expression
    when: Execute JavaScript
    then: Evaluation result

  - name: wait_for_selector
    given: CDPClient and selector and timeout
    when: Wait for element
    then: Element found or timeout
