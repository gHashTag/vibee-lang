name: homomorphic_encryption_v11830
version: "11830"
language: zig
module: homomorphic_encryption

description: |
  TIER 267: Homomorphic Encryption
  Computes on encrypted data
  Based on: BFV, CKKS, TFHE schemes

types:
  HEConfig:
    fields:
      scheme: HEScheme
      security_level: Int
      poly_modulus_degree: Int
      scale: Float

  HEScheme:
    variants:
      - bfv
      - ckks
      - tfhe
      - bgv

  Ciphertext:
    fields:
      data: List<Int>
      noise_budget: Int
      scale: Float
      level: Int

  HEContext:
    fields:
      public_key: String
      secret_key: String
      relin_keys: String
      galois_keys: String

behaviors:
  - name: generate_keys
    given: HE parameters
    When: Generating keys
    then: Returns key context

  - name: encrypt
    given: Plaintext
    When: Encrypting
    then: Returns ciphertext

  - name: decrypt
    given: Ciphertext
    When: Decrypting
    then: Returns plaintext

  - name: add_encrypted
    given: Two ciphertexts
    When: Adding
    then: Returns sum ciphertext

  - name: multiply_encrypted
    given: Two ciphertexts
    When: Multiplying
    then: Returns product ciphertext

  - name: relinearize
    given: Ciphertext
    When: Relinearizing
    then: Returns relinearized ciphertext

  - name: rescale
    given: Ciphertext
    When: Rescaling
    then: Returns rescaled ciphertext

  - name: bootstrap
    given: Noisy ciphertext
    When: Bootstrapping
    then: Returns refreshed ciphertext

creation_pattern:
  source: Plaintext
  transformer: HEEngine
  result: EncryptedComputation
