# VIBEE YOLO MODE XII - browser_perf_workers v1183
# Web Workers - Parallel Processing
name: browser_perf_workers_v1183
version: "12.0.0"
language: zig
module: browser_perf_workers

sacred_constants:
  phi: 1.618033988749895
  phi_identity: 3
  phoenix: 999
  yolo_mode: 12

types:
  WorkerConfig:
    fields:
      type: String
      name: String
      script_url: String

  WorkerPool:
    fields:
      size: Int
      workers: List<String>
      task_queue: List<String>

  WorkerMessage:
    fields:
      type: String
      payload: String
      transferables: List<String>

  SharedBuffer:
    fields:
      size: Int
      buffer: String
      atomics_enabled: Bool

behaviors:
  - name: create_worker
    given: WorkerConfig
    when: Create
    then: Web Worker created
  - name: create_pool
    given: WorkerPool
    when: Pool
    then: Worker pool created
  - name: post_message
    given: WorkerMessage
    when: Post
    then: Message posted to worker
  - name: transfer_buffer
    given: SharedBuffer
    when: Transfer
    then: Buffer transferred
  - name: terminate_worker
    given: Worker id
    when: Terminate
    then: Worker terminated

test_cases:
  - name: test_worker_create
    input: {type: "dedicated"}
    expected: {created: true}
  - name: test_worker_pool
    input: {size: 4}
    expected: {pooled: true}
  - name: test_worker_message
    input: {type: "task"}
    expected: {posted: true}
  - name: test_worker_transfer
    input: {size: 1024}
    expected: {transferred: true}
  - name: test_phi_workers
    input: {phi: 1.618033988749895}
    expected: {identity: 3}
