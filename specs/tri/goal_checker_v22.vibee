name: goal_checker_v22
version: "22.3.0"
language: zig
module: goal_checker_v22

types:
  GoalType:
    fields:
      name: String

  Goal:
    fields:
      description: String
      goal_type: String
      success_criteria: List<String>
      timeout_ms: Int

  CheckResult:
    fields:
      is_complete: Bool
      confidence: Float
      matched_criteria: List<String>
      missing_criteria: List<String>
      explanation: String

  GoalChecker:
    fields:
      goal: Object
      llm_client: Object
      use_llm_check: Bool

behaviors:
  - name: create_checker
    given: Goal and LLM client
    when: Initialize checker
    then: GoalChecker instance

  - name: check
    given: GoalChecker and observation
    when: Check goal completion
    then: CheckResult

  - name: check_with_llm
    given: GoalChecker and observation
    when: LLM-based check
    then: CheckResult

  - name: check_criteria
    given: Criteria and observation
    when: Check single criterion
    then: Boolean

  - name: check_url_match
    given: Expected URL and current URL
    when: Check URL match
    then: Boolean

  - name: check_text_present
    given: Text and observation
    when: Check text presence
    then: Boolean

  - name: check_element_exists
    given: Selector and observation
    when: Check element
    then: Boolean

  - name: get_progress
    given: GoalChecker and observation
    when: Calculate progress
    then: Progress percentage

  - name: set_goal
    given: GoalChecker and new goal
    when: Update goal
    then: Updated checker

  - name: get_goal
    given: GoalChecker
    when: Get current goal
    then: Goal

  - name: explain_status
    given: CheckResult
    when: Generate explanation
    then: Explanation string
