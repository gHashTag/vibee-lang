# Bridge Async Executor
# Async request execution
# Promise-like patterns

name: bridge_async_executor
version: "1.0.0"
language: zig
module: bridge_async_executor

types:
  AsyncTask:
    fields:
      task_id: String
      state: String
      result: Option<String>
      error: Option<String>

  TaskState:
    fields:
      state_name: String
      is_terminal: Bool

  Executor:
    fields:
      executor_id: String
      pending_tasks: List<String>
      completed_tasks: List<String>
      max_concurrent: Int

  ExecutionResult:
    fields:
      task_id: String
      success: Bool
      value: Option<String>
      duration_ms: Int

  TaskCallback:
    fields:
      callback_id: String
      task_id: String
      callback_type: String

  ExecutorConfig:
    fields:
      max_concurrent: Int
      default_timeout_ms: Int
      enable_callbacks: Bool

behaviors:
  - name: submit_task
    given: Executor and request
    when: Task submission needed
    then: Returns async task

  - name: await_task
    given: Task and timeout
    when: Task await needed
    then: Returns execution result

  - name: cancel_task
    given: Task
    When: Task cancellation needed
    then: Returns cancellation result

  - name: get_task_state
    given: Task
    when: State query needed
    then: Returns task state

  - name: await_all
    given: List of tasks
    when: Multiple await needed
    then: Returns all results

  - name: await_any
    given: List of tasks
    when: First completion needed
    then: Returns first result

  - name: on_complete
    given: Task and callback
    when: Callback registration needed
    then: Returns callback registration

  - name: poll_tasks
    given: Executor
    when: Task polling needed
    then: Returns completed tasks
