# cdp_dom_v2540.vibee - CDP DOM Domain
# DOM инспекция и манипуляция
# YOLO MODE + AMPLIFICATION + MATRYOSHKA
# φ² + 1/φ² = 3 | PHOENIX = 999

name: cdp_dom_v2540
version: "2540.0.0"
language: zig
module: cdp_dom_v2540

types:
  DOMNode:
    fields:
      node_id: Int
      backend_node_id: Int
      node_type: Int
      node_name: String
      local_name: String
      node_value: String
      child_node_count: Int
      children: Object
      attributes: Object

  BoxModel:
    fields:
      content: Object
      padding: Object
      border: Object
      margin: Object
      width: Int
      height: Int

  DOMRect:
    fields:
      x: Float
      y: Float
      width: Float
      height: Float

  RemoteObject:
    fields:
      type: String
      subtype: String
      class_name: String
      value: Object
      object_id: String
      description: String

behaviors:
  - name: dom_enable
    given: CDPConnection
    when: DOM domain enabled
    then: Start tracking DOM changes

  - name: dom_get_document
    given: CDPConnection
    when: Document requested
    then: Return root DOMNode

  - name: dom_query_selector
    given: CDPConnection, node_id, selector
    when: Query requested
    then: Return matching node_id

  - name: dom_query_selector_all
    given: CDPConnection, node_id, selector
    when: Query all requested
    then: Return array of node_ids

  - name: dom_get_outer_html
    given: CDPConnection and node_id
    when: HTML requested
    then: Return outer HTML string

  - name: dom_set_outer_html
    given: CDPConnection, node_id, html
    when: HTML modification requested
    then: Replace node HTML

  - name: dom_get_box_model
    given: CDPConnection and node_id
    when: Box model requested
    then: Return BoxModel with coordinates

  - name: dom_get_content_quads
    given: CDPConnection and node_id
    when: Quads requested
    then: Return element coordinates for clicking

  - name: dom_focus
    given: CDPConnection and node_id
    when: Focus requested
    then: Focus element

  - name: dom_scroll_into_view
    given: CDPConnection and node_id
    when: Scroll requested
    then: Scroll element into viewport

sacred_constants:
  phi: 1.618033988749895
  phi_squared_plus_inverse_squared: 3
  phoenix: 999
