# VIBEE Specification - IGLA SWE Coder
# Code generation agent
# V = n × 3^k × π^m × φ^p | φ² + 1/φ² = 3 | PHOENIX = 999

name: igla_swe_coder
version: "1.0.0"
language: zig
module: igla_swe_coder

types:
  CodeGenRequest:
    fields:
      description: String
      language: String
      context: String
      constraints: String

  GeneratedCode:
    fields:
      code: String
      language: String
      imports: String
      tests: String

  CodePatch:
    fields:
      file_path: String
      old_code: String
      new_code: String
      line_start: Int
      line_end: Int

  CoderConfig:
    fields:
      model: String
      temperature: Float
      max_tokens: Int
      include_tests: Bool

  CoderMetrics:
    fields:
      code_generated: Int
      patches_created: Int
      avg_quality_score: Float

behaviors:
  - name: generate_code
    given: Code request
    when: Generation
    then: Code generated

  - name: generate_patch
    given: Bug description and file
    when: Patch generation
    then: Code patch created

  - name: complete_function
    given: Function signature
    When: Completion
    then: Function body generated

  - name: implement_interface
    given: Interface definition
    when: Implementation
    then: Implementation generated

  - name: refactor_code
    given: Code and instructions
    when: Refactoring
    then: Refactored code returned

  - name: get_metrics
    given: Coder
    when: Metrics requested
    then: Coder metrics returned

test_cases:
  - name: test_generate
    input: { description: "hello world", language: "zig" }
    expected: { has_code: true }

  - name: test_patch
    input: { file: "main.zig", bug: "null pointer" }
    expected: { has_patch: true }

  - name: test_complete
    input: { signature: "fn add(a: i32, b: i32) i32" }
    expected: { has_body: true }

  - name: test_metrics
    input: {}
    expected: { code_generated: 0 }
