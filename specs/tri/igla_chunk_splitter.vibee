# IGLA Chunk Splitter
# Semantic code chunking with boundary detection
# φ² + 1/φ² = 3 | PHOENIX = 999

name: igla_chunk_splitter
version: "1.0.0"
language: zig
module: igla_chunk_splitter

sacred_constants:
  phi: 1.618033988749895
  phoenix: 999
  trinity: 3

types:
  ChunkStrategy:
    enum: [FixedSize, Semantic, Function, Class, Hybrid]

  CodeChunk:
    fields:
      id: String
      file_path: String
      start_line: Int
      end_line: Int
      content: String
      chunk_type: String

  SplitConfig:
    fields:
      strategy: String
      max_chunk_size: Int
      min_chunk_size: Int
      overlap: Int

  ChunkResult:
    fields:
      chunks: List<CodeChunk>
      total_chunks: Int
      avg_chunk_size: Int

behaviors:
  - name: split_file
    given: File content and SplitConfig
    when: Splitting requested
    then: Returns ChunkResult

  - name: split_by_functions
    given: File content
    when: Function-based split requested
    then: Returns chunks at function boundaries

  - name: split_by_classes
    given: File content
    when: Class-based split requested
    then: Returns chunks at class boundaries

  - name: split_fixed_size
    given: Content and size
    when: Fixed size split requested
    then: Returns equal-sized chunks

  - name: detect_boundaries
    given: File content
    when: Boundary detection requested
    then: Returns list of line numbers

  - name: merge_small_chunks
    given: Chunks and min_size
    when: Merge requested
    then: Returns merged chunks

test_cases:
  - name: test_function_split
    expected: functions_separated
  - name: test_class_split
    expected: classes_separated
  - name: test_fixed_split
    expected: chunks_equal_size
  - name: test_boundary_detection
    expected: boundaries_found
  - name: test_chunk_merge
    expected: small_chunks_merged
