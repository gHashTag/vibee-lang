# v5401 - Tool Agents
# ====================
# Агенты с инструментами - function calling
# φ² + 1/φ² = 3 | PHOENIX = 999

name: tool_agents
version: "5.4.1"
language: zig
module: tool_agents

constants:
  PHI: 1.618033988749895
  MAX_TOOLS: 50
  RETRY_LIMIT: 3

types:
  Tool:
    fields:
      name: String
      description: String
      parameters: Object
      
  ToolCall:
    fields:
      tool_name: String
      arguments: Map
      
  ToolResult:
    fields:
      output: String
      success: Bool
      error_message: String
      
  ToolRegistry:
    fields:
      tools: List
      categories: List
      
  FunctionSchema:
    fields:
      name: String
      parameters: Object
      returns: String
      
  ToolChain:
    fields:
      tools: List
      execution_order: List
      
  ToolSelection:
    fields:
      selected_tool: String
      confidence: Float
      reasoning: String
      
  APIIntegration:
    fields:
      endpoint: String
      auth_type: String
      rate_limit: Int

behaviors:
  - name: register_tool
    given: Tool definition
    when: Tool registration
    then: Вернуть updated registry
    
  - name: select_tool
    given: Task и available tools
    when: Tool selection
    then: Вернуть tool selection
    
  - name: execute_tool
    given: Tool call
    when: Tool execution
    then: Вернуть tool result
    
  - name: parse_tool_call
    given: LLM output
    when: Parsing function call
    then: Вернуть parsed tool call
    
  - name: validate_arguments
    given: Arguments и schema
    when: Argument validation
    then: Вернуть validation result
    
  - name: chain_tools
    given: Tools и task
    when: Tool chaining
    then: Вернуть tool chain
    
  - name: handle_tool_error
    given: Error и context
    when: Error handling
    then: Вернуть recovery action
    
  - name: format_tool_output
    given: Raw output
    when: Output formatting
    then: Вернуть formatted output
