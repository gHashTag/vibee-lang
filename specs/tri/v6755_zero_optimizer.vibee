name: v6755_zero_optimizer
version: "1.0.0"
language: zig
module: v6755_zero_optimizer

types:
  ZeROConfig:
    fields:
      stage: Int
      offload_optimizer: Bool
      offload_params: Bool

behaviors:
  - name: partition_optimizer_state
    given: Optimizer states
    when: Apply ZeRO stage 1
    then: Shard optimizer states

  - name: partition_gradients
    given: Gradients
    when: Apply ZeRO stage 2
    then: Shard gradients

  - name: partition_parameters
    given: Model parameters
    when: Apply ZeRO stage 3
    then: Shard parameters
