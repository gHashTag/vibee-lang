# RESPONSIBLE DISCLOSURE V139 - Professional Vulnerability Reporting
# VIBEE AMPLIFICATION MODE: From Finding to Reward
name: responsible_disclosure_v139
version: "139.0.0"
language: zig
module: responsible_disclosure

creation_pattern:
  source: VulnerabilityFinding
  transformer: DisclosureProcess
  result: SuccessfulReport

# RESPONSIBLE DISCLOSURE
# Профессиональный процесс сообщения об уязвимостях

types:
  DisclosureStep:
    fields:
      step_number: Int
      name: String
      description: String
      duration: String
      tips: List<String>

  ReportSection:
    fields:
      section: String
      required: Bool
      content_guide: String
      example: String

  CVSSCalculation:
    fields:
      metric: String
      options: List<String>
      description: String

  CommunicationTemplate:
    fields:
      situation: String
      template: String
      tone: String

  DisputeResolution:
    fields:
      issue: String
      resolution: String
      escalation: String

  PaymentProcess:
    fields:
      platform: String
      methods: List<String>
      timeline: String
      tax_notes: String

  ReputationBuilding:
    fields:
      action: String
      impact: String
      frequency: String

  SuccessfulReport:
    fields:
      steps: List<DisclosureStep>
      report: List<ReportSection>
      communication: List<CommunicationTemplate>
      payment: PaymentProcess

behaviors:
  - name: prepare_report
    given: "Vulnerability finding"
    when: "Report preparation"
    then: "Complete report"
    test_cases:
      - name: prepare
        input: "finding"
        expected: "report ready"

  - name: calculate_severity
    given: "Vulnerability details"
    when: "CVSS calculation"
    then: "Severity score"
    test_cases:
      - name: cvss
        input: "details"
        expected: "score"

  - name: submit_report
    given: "Complete report"
    when: "Submission"
    then: "Report submitted"
    test_cases:
      - name: submit
        input: "report"
        expected: "submitted"

  - name: handle_response
    given: "Company response"
    when: "Communication"
    then: "Appropriate reply"
    test_cases:
      - name: respond
        input: "response"
        expected: "reply sent"

  - name: resolve_dispute
    given: "Disagreement"
    when: "Dispute resolution"
    then: "Resolution"
    test_cases:
      - name: dispute
        input: "disagreement"
        expected: "resolved"

  - name: receive_bounty
    given: "Accepted report"
    when: "Payment"
    then: "Bounty received"
    test_cases:
      - name: bounty
        input: "accepted"
        expected: "paid"

# ПРОЦЕСС РАСКРЫТИЯ

disclosure_process:
  step_1:
    name: "Подготовка отчёта"
    duration: "1-4 часа"
    actions:
      - "Собрать все доказательства"
      - "Написать чёткие шаги воспроизведения"
      - "Оценить severity"
      - "Подготовить скриншоты/видео"
    tips:
      - "Чем подробнее, тем лучше"
      - "Один баг = один отчёт"
      - "Проверьте воспроизводимость"
      
  step_2:
    name: "Отправка отчёта"
    duration: "15 минут"
    actions:
      - "Выбрать правильную программу"
      - "Заполнить все поля"
      - "Прикрепить доказательства"
      - "Отправить"
    tips:
      - "Перечитайте перед отправкой"
      - "Проверьте scope ещё раз"
      
  step_3:
    name: "Ожидание ответа"
    duration: "1-14 дней"
    actions:
      - "Ждать первичный ответ"
      - "Не спамить"
    tips:
      - "Терпение - ключ к успеху"
      - "Один follow-up через 7 дней OK"
      
  step_4:
    name: "Триаж"
    duration: "1-30 дней"
    actions:
      - "Отвечать на вопросы"
      - "Предоставлять дополнительную информацию"
    tips:
      - "Быстрые ответы ускоряют процесс"
      - "Будьте вежливы"
      
  step_5:
    name: "Валидация"
    duration: "1-60 дней"
    actions:
      - "Компания проверяет баг"
      - "Возможны дополнительные вопросы"
    outcomes:
      - "Valid - баг подтверждён"
      - "Duplicate - уже сообщали"
      - "Informative - не уязвимость"
      - "Not Applicable - вне scope"
      
  step_6:
    name: "Награда"
    duration: "1-30 дней после валидации"
    actions:
      - "Получить bounty"
      - "Оставить feedback"
    tips:
      - "Настройте payment method заранее"

# СТРУКТУРА ОТЧЁТА

report_structure:
  title:
    required: true
    format: "[Severity] Vulnerability Type in Component"
    examples:
      - "[Critical] RCE via File Upload in /api/upload"
      - "[High] Stored XSS in User Profile Bio"
      - "[Medium] IDOR in Order History API"
    bad_examples:
      - "Bug found"
      - "XSS"
      - "Security issue"
      
  summary:
    required: true
    content: |
      Краткое описание уязвимости в 2-3 предложениях.
      Что это, где находится, какое влияние.
    example: |
      A stored XSS vulnerability exists in the user profile
      bio field at https://example.com/profile. An attacker
      can inject malicious JavaScript that executes when
      other users view the profile, potentially stealing
      session cookies or performing actions on their behalf.
      
  steps_to_reproduce:
    required: true
    format: "Numbered list"
    example: |
      1. Create an account at https://example.com/register
      2. Login with your credentials
      3. Navigate to Profile Settings (/settings/profile)
      4. In the "Bio" field, enter the following payload:
         <img src=x onerror=alert(document.domain)>
      5. Click "Save Profile"
      6. Navigate to your public profile (/user/yourname)
      7. Observe the JavaScript alert executing
    tips:
      - "Каждый шаг отдельно"
      - "Включите точные URL"
      - "Укажите payload"
      - "Должно быть 100% воспроизводимо"
      
  impact:
    required: true
    content: "Реальное влияние на бизнес и пользователей"
    example: |
      Impact: HIGH
      
      An attacker could:
      - Steal session cookies of any user who views the profile
      - Perform actions on behalf of victims (change email, password)
      - Redirect users to phishing sites
      - Deface the profile page
      
      This affects all authenticated users who view the
      attacker's profile. Given the social nature of the
      platform, this could impact thousands of users.
      
  severity:
    required: true
    method: "CVSS 3.1"
    calculator: "https://www.first.org/cvss/calculator/3.1"
    
  supporting_materials:
    required: false
    types: "Screenshots, Video PoC, HTTP requests, Code snippets"
    tips: "Видео лучше для сложных багов. Размывайте чужие данные."
      
  remediation_section:
    required: false
    content: "Рекомендации по исправлению"
    example: |
      Recommendations:
      1. Sanitize user input using a whitelist approach
      2. Encode output when rendering user-generated content
      3. Implement Content Security Policy (CSP) headers
      4. Consider using a library like DOMPurify for sanitization

# CVSS КАЛЬКУЛЯТОР

cvss_guide:
  attack_vector:
    network: "Атака через сеть (большинство веб-багов)"
    adjacent: "Атака из локальной сети"
    local: "Требуется локальный доступ"
    physical: "Требуется физический доступ"
    
  attack_complexity:
    low: "Легко эксплуатировать"
    high: "Требуются специальные условия"
    
  privileges_required:
    none: "Не нужна авторизация"
    low: "Нужен обычный аккаунт"
    high: "Нужен админ аккаунт"
    
  user_interaction:
    none: "Жертве не нужно ничего делать"
    required: "Жертва должна кликнуть/посетить"
    
  scope:
    unchanged: "Влияет только на уязвимый компонент"
    changed: "Влияет на другие компоненты"
    
  impact:
    confidentiality: "Утечка данных"
    integrity: "Изменение данных"
    availability: "Нарушение работы"

# КОММУНИКАЦИЯ

communication_templates:
  initial_submission:
    situation: "Отправка отчёта"
    tone: "Профессиональный, вежливый"
    
  follow_up:
    situation: "Нет ответа 7+ дней"
    template: |
      Hi,
      
      I wanted to follow up on my report submitted on [DATE]
      regarding [VULNERABILITY TYPE] in [COMPONENT].
      
      Please let me know if you need any additional information.
      
      Best regards,
      [Your name]
    tone: "Вежливый, не агрессивный"
    
  additional_info:
    situation: "Запрос дополнительной информации"
    template: |
      Hi,
      
      Thank you for reviewing my report. Here is the
      additional information you requested:
      
      [INFORMATION]
      
      Please let me know if you need anything else.
      
      Best regards,
      [Your name]
    tone: "Helpful, responsive"
    
  disagreement:
    situation: "Не согласны с severity/решением"
    template: |
      Hi,
      
      Thank you for your assessment. I respectfully disagree
      with the severity rating because:
      
      [REASONING]
      
      I believe this should be rated as [SEVERITY] because
      [IMPACT EXPLANATION].
      
      I'm happy to discuss this further.
      
      Best regards,
      [Your name]
    tone: "Respectful, factual"

# ТИПИЧНЫЕ ПРОБЛЕМЫ

common_issues:
  duplicate:
    situation: "Баг уже сообщали"
    response: "Это нормально, продолжайте искать"
    prevention: "Ищите уникальные баги, не очевидные"
    
  not_applicable:
    situation: "Вне scope"
    response: "Внимательнее читайте правила"
    prevention: "Всегда проверяйте scope перед тестированием"
    
  informative:
    situation: "Не считается уязвимостью"
    response: "Учитесь на этом опыте"
    prevention: "Изучайте что считается уязвимостью"
    
  low_severity:
    situation: "Severity понижена"
    response: "Можно оспорить с аргументами"
    prevention: "Лучше описывайте impact"

# ПОЛУЧЕНИЕ НАГРАДЫ

payment_info:
  hackerone:
    methods: ["PayPal", "Bank Transfer", "Bitcoin", "Coinbase"]
    minimum: "$25"
    timeline: "7-14 дней после bounty award"
    tax: "Форма W-8BEN для не-US"
    
  bugcrowd:
    methods: ["PayPal", "Bank Transfer"]
    minimum: "$100"
    timeline: "14-30 дней"
    
  intigriti:
    methods: ["PayPal", "Bank Transfer", "SEPA"]
    minimum: "EUR 50"
    timeline: "14 дней"

# ПОСТРОЕНИЕ РЕПУТАЦИИ

reputation_building:
  quality_reports:
    action: "Писать качественные отчёты"
    impact: "Выше reputation, доступ к приватным программам"
    
  quick_response:
    action: "Быстро отвечать на вопросы"
    impact: "Лучшие отношения с командами"
    
  no_spam:
    action: "Не отправлять мусорные отчёты"
    impact: "Сохранение репутации"
    
  public_disclosure:
    action: "Публиковать write-ups (с разрешения)"
    impact: "Известность в сообществе"
    
  ctf_participation:
    action: "Участвовать в CTF"
    impact: "Навыки + networking"

# ЮРИДИЧЕСКИЕ АСПЕКТЫ

legal_aspects:
  safe_harbor:
    description: "Защита от преследования"
    check: "Всегда проверяйте наличие в программе"
    
  scope_compliance:
    description: "Соблюдение границ тестирования"
    importance: "Критически важно"
    
  data_handling:
    description: "Обращение с найденными данными"
    rules:
      - "Не сохранять чужие данные"
      - "Не использовать найденную информацию"
      - "Удалить после отчёта"
      
  nda:
    description: "Соглашение о неразглашении"
    note: "Некоторые программы требуют NDA"

# φ² + 1/φ² = 3 | PHOENIX = 999
