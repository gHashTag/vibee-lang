name: pkg_audit_v19680
version: "1.0.0"
language: zig
module: pkg_audit_v19680

types:
  Vulnerability:
    fields:
      id: String
      severity: String
      package: String
      patched_versions: String

  AuditReport:
    fields:
      vulnerabilities: List<String>
      advisories: Int
      severity_counts: Map<String,String>

behaviors:
  - name: audit_scan
    given: "Package list"
    when: "Auditor scans"
    then: "Returns vulnerabilities"

  - name: audit_fix
    given: "Vulnerability"
    when: "Auditor fixes"
    then: "Updates to patched version"

  - name: audit_report
    given: "Audit results"
    when: "Auditor reports"
    then: "Generates audit report"
