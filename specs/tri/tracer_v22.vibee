name: tracer_v22
version: "22.6.0"
language: zig
module: tracer_v22

types:
  Span:
    fields:
      trace_id: String
      span_id: String
      name: String
      start_time: Timestamp
      end_time: Option<Timestamp>
      tags: Object

  TraceContext:
    fields:
      trace_id: String
      span_id: String
      parent_id: Option<String>

  TracerConfig:
    fields:
      service_name: String
      sample_rate: Float
      export_endpoint: Option<String>

  Tracer:
    fields:
      config: Object
      active_spans: Object

behaviors:
  - name: create_tracer
    given: TracerConfig
    when: Initialize tracer
    then: Tracer instance

  - name: start_span
    given: Tracer and name
    when: Start span
    then: Span

  - name: end_span
    given: Tracer and span
    when: End span
    then: Ended span

  - name: add_tag
    given: Span and key and value
    when: Add tag
    then: Updated span

  - name: add_event
    given: Span and event
    when: Add event
    then: Updated span

  - name: get_context
    given: Tracer
    when: Get trace context
    then: TraceContext

  - name: inject_context
    given: Tracer and headers
    When: Inject context
    then: Headers with context

  - name: extract_context
    given: Tracer and headers
    When: Extract context
    then: TraceContext

  - name: export_spans
    given: Tracer
    When: Export spans
    then: Exported

  - name: flush
    given: Tracer
    When: Flush tracer
    then: Flushed
