# VIBEE Specification v12310
# Vulnerability Scanner - Security vulnerability detection
name: vulnerability_scanner_v12310
version: "1.0.0"
language: zig
module: vulnerability_scanner

types:
  VulnerabilitySeverity:
    fields:
      low: String
      medium: String
      high: String
      critical: String

  Vulnerability:
    fields:
      id: String
      cve_id: String
      severity: String
      description: String
      affected_component: String
      fix_available: Bool

  ScanTarget:
    fields:
      id: String
      type: String
      path: String
      last_scanned: Timestamp

  ScanResult:
    fields:
      target_id: String
      vulnerabilities: String
      total_count: Int
      critical_count: Int
      scanned_at: Timestamp

  ScanPolicy:
    fields:
      id: String
      schedule: String
      fail_on_severity: String
      auto_remediate: Bool

behaviors:
  - name: register_target
    given: Target configuration
    when: Target registered
    then: Returns scan target

  - name: run_scan
    given: Target
    when: Scan executed
    then: Returns scan result

  - name: get_vulnerabilities
    given: Scan result
    when: Vulnerabilities requested
    then: Returns vulnerability list

  - name: create_scan_policy
    given: Policy configuration
    when: Policy created
    then: Returns scan policy
