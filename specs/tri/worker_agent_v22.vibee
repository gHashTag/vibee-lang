name: worker_agent_v22
version: "22.4.0"
language: zig
module: worker_agent_v22

types:
  WorkerConfig:
    fields:
      id: String
      coordinator_url: String
      capabilities: List<String>
      max_concurrent_tasks: Int

  WorkerTask:
    fields:
      task_id: String
      task_type: String
      payload: Object
      deadline: Option<Timestamp>

  WorkerResult:
    fields:
      task_id: String
      success: Bool
      result: Option<String>
      error: Option<String>
      duration_ms: Int

  WorkerStatus:
    fields:
      id: String
      state: String
      current_tasks: Int
      total_completed: Int
      total_errors: Int
      uptime_ms: Int

  WorkerCapability:
    fields:
      name: String
      version: String
      enabled: Bool

  WorkerAgent:
    fields:
      config: Object
      status: Object
      browser: Object
      llm_client: Object

behaviors:
  - name: create_worker
    given: WorkerConfig
    when: Initialize worker
    then: WorkerAgent instance

  - name: connect_to_coordinator
    given: WorkerAgent
    when: Connect to coordinator
    then: Connection result

  - name: receive_task
    given: WorkerAgent
    when: Receive task from coordinator
    then: WorkerTask

  - name: execute_task
    given: WorkerAgent and WorkerTask
    When: Execute task
    then: WorkerResult

  - name: report_result
    given: WorkerAgent and WorkerResult
    When: Report to coordinator
    then: Report result

  - name: report_status
    given: WorkerAgent
    When: Send status update
    then: Status sent

  - name: get_status
    given: WorkerAgent
    When: Get current status
    then: WorkerStatus

  - name: add_capability
    given: WorkerAgent and capability
    When: Add capability
    then: Capability added

  - name: remove_capability
    given: WorkerAgent and capability name
    When: Remove capability
    then: Capability removed

  - name: pause
    given: WorkerAgent
    When: Pause worker
    then: Paused

  - name: resume
    given: WorkerAgent
    When: Resume worker
    then: Resumed
