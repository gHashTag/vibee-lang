# ═══════════════════════════════════════════════════════════════════════════════
# FEATURE MATRIX v182 - Comprehensive Feature Comparison
# ═══════════════════════════════════════════════════════════════════════════════
# 70+ tools, 20+ features
# PAS Pattern: PRE + ALG
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════

name: feature_matrix
version: "1.8.2"
language: zig
module: feature_matrix

sacred_constants:
  phi: 1.618033988749895
  phi_inv: 0.618033988749895
  phi_sq: 2.618033988749895
  trinity: 3.0
  phoenix: 999

creation_pattern:
  source: ToolList
  transformer: FeatureExtractor
  result: ComparisonMatrix

# ═══════════════════════════════════════════════════════════════════════════════
# TYPES
# ═══════════════════════════════════════════════════════════════════════════════

types:
  FeatureCategory:
    enum:
      - core_generation     # Code generation capabilities
      - agent_capabilities  # Agentic features
      - integration         # IDE/tool integration
      - intelligence        # AI/ML features
      - workflow            # Development workflow
      - performance         # Speed/efficiency

  Feature:
    fields:
      name: String
      category: FeatureCategory
      description: String
      weight: Float  # Importance 0-1

  ToolFeatureScore:
    fields:
      tool: String
      feature: String
      has_feature: Bool
      quality: Float  # 0-1 if has feature

  MatrixCell:
    fields:
      tool: String
      feature: String
      value: String  # ✅, ❌, ⚠️, or score

  ComparisonMatrix:
    fields:
      tools: List<String>
      features: List<Feature>
      cells: List<MatrixCell>
      summary: MatrixSummary

  MatrixSummary:
    fields:
      total_tools: Int
      total_features: Int
      leader: String
      leader_score: Float

# ═══════════════════════════════════════════════════════════════════════════════
# BEHAVIORS
# ═══════════════════════════════════════════════════════════════════════════════

behaviors:
  - name: build_matrix
    given: "List of tools and features"
    when: "Matrix construction requested"
    then: "Return complete comparison matrix"
    pas_pattern: PRE
    complexity: O(n*m)
    test_cases:
      - name: test_build
        input: '{"tools": ["VIBEE", "Cursor"], "features": ["streaming"]}'
        expected: '{"cells": 2}'

  - name: get_tool_score
    given: "Tool name"
    when: "Score calculation requested"
    then: "Return weighted feature score"
    pas_pattern: ALG
    complexity: O(m)
    test_cases:
      - name: test_vibee_score
        input: '{"tool": "VIBEE"}'
        expected: '{"score": ">0.8"}'

  - name: find_leader
    given: "Feature category"
    when: "Leader identification requested"
    then: "Return tool with highest score in category"
    pas_pattern: ALG
    complexity: O(n)
    test_cases:
      - name: test_agent_leader
        input: '{"category": "agent_capabilities"}'
        expected: '{"leader": "VIBEE"}'

  - name: get_feature_coverage
    given: "Tool name"
    when: "Coverage analysis requested"
    then: "Return percentage of features supported"
    pas_pattern: ALG
    complexity: O(m)
    test_cases:
      - name: test_coverage
        input: '{"tool": "VIBEE"}'
        expected: '{"coverage": ">0.7"}'

  - name: compare_category
    given: "Two tools and category"
    when: "Category comparison requested"
    then: "Return detailed category comparison"
    pas_pattern: ALG
    complexity: O(m)
    test_cases:
      - name: test_compare
        input: '{"tool_a": "VIBEE", "tool_b": "Cursor", "category": "core_generation"}'
        expected: '{"winner": "VIBEE"}'

  - name: export_markdown
    given: "Comparison matrix"
    when: "Export requested"
    then: "Return markdown table"
    pas_pattern: PRE
    complexity: O(n*m)
    test_cases:
      - name: test_export
        input: '{"matrix": {...}}'
        expected: '{"markdown": "|Tool|Feature|..."}'

# ═══════════════════════════════════════════════════════════════════════════════
# FEATURE DEFINITIONS
# ═══════════════════════════════════════════════════════════════════════════════

features:
  core_generation:
    - name: "code_completion"
      weight: 0.9
      description: "Inline code suggestions"
    - name: "code_generation"
      weight: 1.0
      description: "Generate code from description"
    - name: "multi_file_edit"
      weight: 0.8
      description: "Edit multiple files at once"
    - name: "refactoring"
      weight: 0.7
      description: "Automated refactoring"

  agent_capabilities:
    - name: "streaming"
      weight: 0.8
      description: "Real-time token streaming"
    - name: "agentic_mode"
      weight: 1.0
      description: "Autonomous task execution"
    - name: "tool_use"
      weight: 0.9
      description: "Execute external tools"
    - name: "self_correction"
      weight: 0.7
      description: "Fix own mistakes"

  integration:
    - name: "vscode"
      weight: 0.9
      description: "VSCode integration"
    - name: "jetbrains"
      weight: 0.7
      description: "JetBrains IDE support"
    - name: "neovim"
      weight: 0.5
      description: "Neovim plugin"
    - name: "terminal"
      weight: 0.8
      description: "Terminal/CLI interface"
    - name: "lsp"
      weight: 0.9
      description: "Language Server Protocol"

  intelligence:
    - name: "context_awareness"
      weight: 0.9
      description: "Understand project context"
    - name: "spec_first"
      weight: 1.0
      description: "Specification-first development"
    - name: "pas_daemons"
      weight: 0.8
      description: "Algorithm prediction"
    - name: "self_evolution"
      weight: 0.7
      description: "Self-improving capabilities"

  workflow:
    - name: "git_integration"
      weight: 0.8
      description: "Git operations"
    - name: "pr_review"
      weight: 0.7
      description: "Pull request review"
    - name: "testing"
      weight: 0.9
      description: "Test generation/execution"
    - name: "documentation"
      weight: 0.6
      description: "Doc generation"

  performance:
    - name: "offline"
      weight: 0.8
      description: "Works without internet"
    - name: "fast_generation"
      weight: 0.9
      description: "<100ms generation"
    - name: "deterministic"
      weight: 0.7
      description: "Same input = same output"

# ═══════════════════════════════════════════════════════════════════════════════
# TOOL SCORES (Precomputed)
# ═══════════════════════════════════════════════════════════════════════════════

tool_scores:
  VIBEE:
    streaming: true
    agentic_mode: true
    tool_use: true
    terminal: true
    spec_first: true
    pas_daemons: true
    offline: true
    fast_generation: true
    deterministic: true
    testing: true
    git_integration: true
    # Missing
    vscode: false
    lsp: false
    pr_review: false

  Cursor:
    streaming: true
    agentic_mode: true
    tool_use: true
    vscode: true
    lsp: true
    context_awareness: true
    multi_file_edit: true
    # Missing
    spec_first: false
    offline: false
    deterministic: false

  "GitHub Copilot":
    streaming: true
    code_completion: true
    vscode: true
    jetbrains: true
    neovim: true
    lsp: true
    # Missing
    agentic_mode: false
    spec_first: false
    offline: false

# ═══════════════════════════════════════════════════════════════════════════════
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════
