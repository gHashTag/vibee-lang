name: agent_captcha_v498
version: "498.0.0"
language: zig
module: agent_captcha_v498

types:
  CaptchaAgent:
    fields:
      agent_id: String
      solver_type: String
      api_key: Option<String>
      timeout_ms: Int

  CaptchaChallenge:
    fields:
      challenge_id: String
      captcha_type: String
      site_key: Option<String>
      image_data: Option<String>
      audio_data: Option<String>

  CaptchaSolution:
    fields:
      solution_id: String
      token: String
      solved_at: Timestamp
      confidence: Float

  CaptchaConfig:
    fields:
      auto_solve: Bool
      fallback_manual: Bool
      max_retries: Int
      solver_priority: List<String>

  CaptchaStats:
    fields:
      total_challenges: Int
      solved_count: Int
      failed_count: Int
      avg_solve_time_ms: Int

behaviors:
  - name: detect_captcha
    given: Page content
    when: Captcha check
    then: Return captcha type if found

  - name: solve_recaptcha_v2
    given: Site key and URL
    when: reCAPTCHA v2 found
    then: Return solution token

  - name: solve_recaptcha_v3
    given: Site key and action
    when: reCAPTCHA v3 found
    then: Return solution token

  - name: solve_hcaptcha
    given: Site key and URL
    when: hCaptcha found
    then: Return solution token

  - name: solve_image_captcha
    given: Image data
    when: Image captcha found
    then: Return text solution

  - name: solve_audio_captcha
    given: Audio data
    when: Audio captcha found
    then: Return text solution

  - name: inject_solution
    given: Solution token
    when: Solution ready
    then: Inject into page

  - name: verify_solution
    given: Submitted solution
    when: Verification needed
    then: Check if accepted

  - name: report_failure
    given: Failed solution
    when: Solution rejected
    then: Report to solver service
