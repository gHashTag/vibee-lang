name: agent_session_v500
version: "500.0.0"
language: zig
module: agent_session_v500

types:
  SessionManager:
    fields:
      manager_id: String
      active_sessions: List<String>
      storage_backend: String
      encryption_enabled: Bool

  BrowserSession:
    fields:
      session_id: String
      cookies: List<Object>
      local_storage: Map<String,String>
      session_storage: Map<String,String>
      created_at: Timestamp

  SessionCookie:
    fields:
      name: String
      value: String
      domain: String
      path: String
      expires: Option<Timestamp>
      secure: Bool
      http_only: Bool

  SessionSnapshot:
    fields:
      snapshot_id: String
      session_id: String
      timestamp: Timestamp
      data: Object

  SessionConfig:
    fields:
      persist_cookies: Bool
      persist_storage: Bool
      auto_restore: Bool
      encryption_key: Option<String>

behaviors:
  - name: create_session
    given: Session config
    when: New session needed
    then: Initialize session

  - name: save_session
    given: Active session
    when: Save requested
    then: Persist session data

  - name: restore_session
    given: Session ID
    when: Restore requested
    then: Load session data

  - name: get_cookies
    given: Domain filter
    when: Cookies requested
    then: Return matching cookies

  - name: set_cookie
    given: Cookie data
    when: Set cookie
    then: Store cookie

  - name: clear_cookies
    given: Domain filter
    when: Clear requested
    then: Remove cookies

  - name: get_storage
    given: Storage type and key
    when: Read storage
    then: Return value

  - name: set_storage
    given: Type, key, value
    when: Write storage
    then: Store value

  - name: destroy_session
    given: Session ID
    when: Destroy requested
    then: Remove all session data
