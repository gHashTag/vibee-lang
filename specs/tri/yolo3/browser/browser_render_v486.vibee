name: browser_render_v486
version: "486.0.0"
language: zig
module: browser_render_v486

types:
  RenderTree:
    fields:
      root_id: Int
      node_count: Int
      layer_count: Int
      needs_repaint: Bool

  RenderLayer:
    fields:
      layer_id: Int
      bounds: Object
      transform: Object
      opacity: Float
      is_composited: Bool

  PaintRecord:
    fields:
      operation: String
      bounds: Object
      color: String
      timestamp: Timestamp

  RenderMetrics:
    fields:
      frame_time_ms: Float
      paint_time_ms: Float
      layout_time_ms: Float
      composite_time_ms: Float
      fps: Float

  VisualViewport:
    fields:
      offset_left: Float
      offset_top: Float
      page_left: Float
      page_top: Float
      width: Float
      height: Float
      scale: Float

behaviors:
  - name: build_render_tree
    given: DOM tree
    when: Layout requested
    then: Construct render tree

  - name: calculate_layout
    given: Render tree
    when: Layout pass
    then: Compute positions and sizes

  - name: paint_layer
    given: Render layer
    when: Paint requested
    then: Generate paint commands

  - name: composite_layers
    given: All layers
    when: Composite pass
    then: Merge into final image

  - name: get_render_metrics
    given: Frame context
    when: Query performance
    then: Return timing metrics

  - name: invalidate_region
    given: Dirty rectangle
    when: Content changed
    then: Mark for repaint

  - name: scroll_to_element
    given: Element reference
    when: Scroll requested
    then: Update viewport

  - name: get_visual_viewport
    given: Current state
    when: Query viewport
    then: Return viewport info

  - name: force_repaint
    given: Region or full
    when: Repaint needed
    then: Trigger paint cycle
