name: yolo_async_v535
version: "535.0.0"
language: zig
module: yolo_async_v535

types:
  AsyncExecutor:
    fields:
      executor_id: String
      event_loop: String
      pending_tasks: Int
      completed_tasks: Int

  AsyncTask:
    fields:
      task_id: String
      coroutine: String
      status: String
      result: Option<Object>
      error: Option<String>

  AsyncFuture:
    fields:
      future_id: String
      task_id: String
      is_ready: Bool
      value: Option<Object>

  AsyncConfig:
    fields:
      max_concurrent: Int
      timeout_ms: Int
      cancel_on_error: Bool

  AsyncMetrics:
    fields:
      tasks_submitted: Int
      tasks_completed: Int
      tasks_cancelled: Int
      avg_completion_ms: Float

behaviors:
  - name: create_executor
    given: Async config
    when: Creation requested
    then: Return async executor

  - name: submit_async
    given: Async task
    when: Submission requested
    then: Return future

  - name: await_future
    given: Future reference
    when: Await requested
    then: Return result when ready

  - name: await_all
    given: Future list
    when: Await all requested
    then: Return all results

  - name: await_any
    given: Future list
    when: Await any requested
    then: Return first result

  - name: cancel_task
    given: Task ID
    when: Cancellation requested
    then: Cancel task

  - name: timeout_task
    given: Task and timeout
    when: Timeout needed
    then: Apply timeout

  - name: get_metrics
    given: Executor state
    when: Metrics query
    then: Return async metrics

  - name: shutdown_executor
    given: Active executor
    when: Shutdown requested
    then: Graceful shutdown
