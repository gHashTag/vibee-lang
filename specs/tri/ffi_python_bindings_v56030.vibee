# FFI Python Bindings v56030 - Python ctypes/cffi Generator
# VIBEE → Python Native Extension
# φ² + 1/φ² = 3 | PHOENIX = 999

name: ffi_python_bindings_v56030
version: "56.0.30"
language: zig
module: ffi_python_bindings

creation_pattern:
  source: VibeeSpec
  transformer: PythonBindingsGenerator
  result: PythonFFIModule

types:
  PythonCType:
    fields:
      vibee_type: String
      ctypes_type: String
      cffi_type: String
      numpy_dtype: Option<String>

  PythonFunction:
    fields:
      name: String
      py_name: String
      argtypes: List<String>
      restype: String
      errcheck: Option<String>
      docstring: String

  PythonStruct:
    fields:
      name: String
      fields: List<PythonField>
      pack: Option<Int>
      base_class: String

  PythonField:
    fields:
      name: String
      ctype: String
      array_size: Option<Int>

  PythonCallback:
    fields:
      name: String
      argtypes: List<String>
      restype: String

  CtypesModule:
    fields:
      name: String
      library_path: String
      functions: List<PythonFunction>
      structures: List<PythonStruct>
      callbacks: List<PythonCallback>
      constants: List<String>

  CFFIModule:
    fields:
      name: String
      cdef: String
      source: String
      libraries: List<String>
      include_dirs: List<String>

  PythonPackage:
    fields:
      name: String
      ctypes_module: CtypesModule
      cffi_module: CFFIModule
      setup_py: String
      pyproject_toml: String

behaviors:
  - name: generate_ctypes_module
    given: VibeeSpec
    when: ctypes bindings needed
    then: Python module with ctypes wrappers

  - name: generate_cffi_module
    given: VibeeSpec
    when: cffi bindings needed
    then: Python module with cffi definitions

  - name: map_vibee_to_ctypes
    given: Vibee type
    when: Type mapping needed
    then: ctypes type (c_int, c_char_p, etc)

  - name: generate_structure_class
    given: Vibee struct
    when: Python struct needed
    then: ctypes.Structure subclass

  - name: generate_callback_type
    given: Vibee callback
    when: Python callback needed
    then: CFUNCTYPE definition

  - name: generate_array_type
    given: Vibee array
    when: Array binding needed
    then: ctypes array or numpy array

  - name: generate_error_handling
    given: FFI function
    when: Error checking needed
    then: errcheck function

  - name: generate_setup_py
    given: Package config
    when: Distribution needed
    then: setup.py with cffi builder
