# ═══════════════════════════════════════════════════════════════════════════════
# DYNAMICS v314 - Robot Dynamics
# ═══════════════════════════════════════════════════════════════════════════════
# Based on: Pinocchio, RBDL, Drake
# Scientific: IJRR 2024, RSS 2024
# PAS Pattern: ALG + TEN
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════

name: dynamics
version: "3.1.4"
language: zig
module: dynamics

sacred_constants:
  phi: 1.618033988749895
  trinity: 3.0
  phoenix: 999

creation_pattern:
  source: RobotState
  transformer: DynamicsSolver
  result: DynamicsResult

types:
  LinkInertia:
    fields:
      mass: Float
      com: List<Float>
      inertia_tensor: List<Float>

  RobotState:
    fields:
      positions: List<Float>
      velocities: List<Float>
      accelerations: List<Float>

  Wrench:
    fields:
      force: List<Float>
      torque: List<Float>

  MassMatrix:
    fields:
      matrix: List<Float>
      dimension: Int

  DynamicsResult:
    fields:
      torques: List<Float>
      energy: Float

  ContactForce:
    fields:
      point: List<Float>
      normal: List<Float>
      magnitude: Float

behaviors:
  - name: inverse_dynamics
    given: "State and accelerations"
    when: "ID computation"
    then: "Compute required torques"
    pas_pattern: ALG
    complexity: O(n)
    test_cases:
      - name: test_id
        input: '{"state": {...}, "accel": [...]}'
        expected: '{"torques": [...]}'

  - name: forward_dynamics
    given: "State and torques"
    when: "FD computation"
    then: "Compute accelerations"
    pas_pattern: ALG
    complexity: O(n^3)
    test_cases:
      - name: test_fd
        input: '{"state": {...}, "torques": [...]}'
        expected: '{"accelerations": [...]}'

  - name: compute_mass_matrix
    given: "Joint positions"
    when: "Mass matrix"
    then: "Compute M(q)"
    pas_pattern: TEN
    complexity: O(n^2)
    test_cases:
      - name: test_mass
        input: '{"positions": [...]}'
        expected: '{"M": {...}}'

  - name: compute_coriolis
    given: "State"
    when: "Coriolis computation"
    then: "Compute C(q,dq)"
    pas_pattern: TEN
    complexity: O(n^2)
    test_cases:
      - name: test_coriolis
        input: '{"state": {...}}'
        expected: '{"C": {...}}'

  - name: compute_gravity
    given: "Joint positions"
    when: "Gravity computation"
    then: "Compute g(q)"
    pas_pattern: ALG
    complexity: O(n)
    test_cases:
      - name: test_gravity
        input: '{"positions": [...]}'
        expected: '{"g": [...]}'

  - name: compute_energy
    given: "State"
    when: "Energy computation"
    then: "Compute kinetic + potential"
    pas_pattern: ALG
    complexity: O(n)
    test_cases:
      - name: test_energy
        input: '{"state": {...}}'
        expected: '{"energy": 10.5}'

# ═══════════════════════════════════════════════════════════════════════════════
# φ² + 1/φ² = 3 | PHOENIX = 999
# ═══════════════════════════════════════════════════════════════════════════════
