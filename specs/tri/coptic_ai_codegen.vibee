# VIBEE ⲦⲢⲒⲚⲒⲦⲨ AI Code Generator (iGLA)
# AI-генератор реализаций из спецификаций
# φ² + 1/φ² = 3 | 27 символов = 3³

name: coptic_ai_codegen
version: "1.0.0"
language: zig
module: coptic_ai_codegen

sacred_formula:
  phi: 1.618033988749895
  identity: "φ² + 1/φ² = 3"
  trinity: 27
  phoenix: 999

creation_patterns:
  impl_from_spec:
    source: BehaviorSpec
    transformer: AIGenerator
    result: ZigImplementation

  prompt_from_behavior:
    source: Behavior
    transformer: PromptBuilder
    result: LLMPrompt

types:
  AIConfig:
    fields:
      model: String
      temperature: Float
      max_tokens: Int
      api_key: String

  LLMPrompt:
    fields:
      system: String
      user: String
      context: String

  LLMResponse:
    fields:
      content: String
      tokens_used: Int
      finish_reason: String

  GenerationRequest:
    fields:
      behavior_name: String
      given: String
      when_clause: String
      then_clause: String
      types_context: List<String>

  GenerationResult:
    fields:
      function_name: String
      implementation: String
      success: Bool
      error_msg: String

  ValidationResult:
    fields:
      compiles: Bool
      tests_pass: Bool
      errors: List<String>

behaviors:
  - name: create_config
    given: API key and model name
    when: Configuration requested
    then: Returns AIConfig

  - name: build_prompt
    given: GenerationRequest with behavior details
    when: Prompt building requested
    then: Returns LLMPrompt for code generation

  - name: call_llm
    given: AIConfig and LLMPrompt
    when: LLM call requested
    then: Returns LLMResponse with generated code

  - name: extract_code
    given: LLMResponse
    when: Code extraction requested
    then: Returns clean Zig code from response

  - name: generate_implementation
    given: Behavior specification
    when: Implementation generation requested
    then: Returns GenerationResult with Zig code

  - name: validate_generated
    given: Generated Zig code
    when: Validation requested
    then: Returns ValidationResult

  - name: batch_generate
    given: List of behaviors
    when: Batch generation requested
    then: Returns list of GenerationResult

  - name: save_implementation
    given: GenerationResult and output path
    when: Save requested
    then: Writes implementation to file

test_cases:
  - name: test_build_prompt
    input: "behavior: add_numbers"
    expected: "prompt contains function signature"

  - name: test_extract_code
    input: "response with ```zig block"
    expected: "clean zig code"

pas_analysis:
  paper_references:
    - "Large Language Models for Code Generation"
    - "Specification-Driven Development"
    - "iGLA: Inference-time Generative Learning Architecture"
  key_insights:
    - "Use behavior specs as prompts"
    - "Validate generated code with zig test"
    - "Iterate on failures"

self_evolution:
  metrics:
    - "Generation success rate"
    - "Compilation success rate"
    - "Test pass rate"
  improvement_targets:
    - "Better prompt engineering"
    - "Context window optimization"
    - "Error recovery"
