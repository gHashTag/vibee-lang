name: codegen_ws_v22
version: "22.6.0"
language: zig
module: codegen_ws_v22

types:
  WsTemplate:
    fields:
      name: String
      message_type: String
      handler_template: String

  GeneratedHandler:
    fields:
      name: String
      code: String
      message_types: List<String>

  WsCodegen:
    fields:
      templates: List<String>
      protocol: String

behaviors:
  - name: create_codegen
    given: Config
    when: Initialize codegen
    then: WsCodegen instance

  - name: generate_client
    given: WsCodegen and spec
    when: Generate WS client
    then: Generated code

  - name: generate_connect
    given: WsCodegen
    when: Generate connect code
    then: Connect code

  - name: generate_send
    given: WsCodegen and message type
    when: Generate send code
    then: Send code

  - name: generate_handler
    given: WsCodegen and WsTemplate
    when: Generate handler
    then: GeneratedHandler

  - name: generate_message_parser
    given: WsCodegen and message type
    when: Generate parser
    then: Parser code

  - name: add_template
    given: WsCodegen and WsTemplate
    when: Add template
    then: Updated codegen

  - name: generate_all
    given: WsCodegen
    When: Generate all handlers
    then: All generated code

  - name: validate_template
    given: WsTemplate
    When: Validate template
    then: Validation result

  - name: export_code
    given: WsCodegen
    When: Export generated code
    then: Exported code
