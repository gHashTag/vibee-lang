# collab_presence_v13337.vibee
# KOSCHEI CYCLE 9 - User Presence
# φ² + 1/φ² = 3 | PHOENIX = 999

name: collab_presence
version: "13337.0.0"
language: zig
module: collab_presence

types:
  PresenceConfig:
    fields:
      heartbeat_ms: Int
      timeout_ms: Int
      max_users: Int

  UserPresence:
    fields:
      user_id: String
      name: String
      color: String
      status: String
      last_seen: Int

  PresenceUpdate:
    fields:
      user_id: String
      cursor_file: String
      cursor_line: Int
      cursor_column: Int
      selection: String

  PresenceState:
    fields:
      users: String
      active_count: Int
      updated_at: Int

behaviors:
  - name: join_presence
    given: User info
    when: Join requested
    then: Returns UserPresence

  - name: update_presence
    given: PresenceUpdate
    when: Update sent
    then: Returns update status

  - name: leave_presence
    given: User ID
    when: Leave requested
    then: Returns leave status

  - name: get_all_presence
    given: Room ID
    when: Presence requested
    then: Returns PresenceState

  - name: subscribe_presence
    given: Room ID
    When: Subscription requested
    then: Returns subscription handle

  - name: broadcast_presence
    given: PresenceUpdate
    When: Broadcast requested
    then: Returns broadcast status
