# VIBEE Specification v12330
# Identity Management - User identity and authentication
name: identity_management_v12330
version: "1.0.0"
language: zig
module: identity_management

types:
  AuthMethod:
    fields:
      password: String
      mfa: String
      sso: String
      api_key: String

  Identity:
    fields:
      id: String
      email: String
      display_name: String
      auth_methods: String
      created_at: Timestamp

  Session:
    fields:
      id: String
      identity_id: String
      token: String
      expires_at: Timestamp
      ip_address: String

  AuthAttempt:
    fields:
      identity_id: String
      method: String
      success: Bool
      ip_address: String
      attempted_at: Timestamp

  MFAConfig:
    fields:
      identity_id: String
      method: String
      secret: String
      verified: Bool

behaviors:
  - name: create_identity
    given: Identity data
    when: Identity created
    then: Returns new identity

  - name: authenticate
    given: Credentials
    when: Authentication attempted
    then: Returns session or error

  - name: setup_mfa
    given: Identity and method
    when: MFA configured
    then: Returns MFA config

  - name: revoke_session
    given: Session ID
    when: Session revoked
    then: Returns revocation status
