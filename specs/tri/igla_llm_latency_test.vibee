# iGLA LLM Latency Test
# Response latency evaluation
# φ² + 1/φ² = 3 | V = n × 3^k × π^m × φ^p

name: igla_llm_latency_test
version: "1.0.0"
language: zig
module: igla_llm_latency_test

sacred_constants:
  phi: 1.618033988749895
  trinity: 3.0
  phoenix: 999

types:
  LatencyConfig:
    fields:
      request_sizes: List<Int>
      response_sizes: List<Int>
      warmup_requests: Int
      measurement_requests: Int

  LatencyTask:
    fields:
      task_id: String
      input_tokens: Int
      output_tokens: Int
      streaming: Bool
      batch_size: Int

  LatencyResult:
    fields:
      task_id: String
      ttft_ms: Float
      tpot_ms: Float
      total_latency_ms: Float
      tokens_per_second: Float

  LatencyMetrics:
    fields:
      avg_ttft: Float
      avg_tpot: Float
      p50_latency: Float
      p95_latency: Float
      p99_latency: Float
      throughput_tps: Float

behaviors:
  - name: warmup
    given: "Cold model"
    when: "Warmup"
    then: "Model warmed up"

  - name: measure_ttft
    given: "Request"
    when: "TTFT measurement"
    then: "Time to first token"

  - name: measure_tpot
    given: "Generation"
    when: "TPOT measurement"
    then: "Time per output token"

  - name: measure_streaming
    given: "Streaming request"
    when: "Streaming"
    then: "Streaming latency measured"

  - name: compute_percentiles
    given: "All measurements"
    when: "Percentiles"
    then: "p50/p95/p99 computed"

  - name: compute_metrics
    given: "All results"
    when: "Metrics"
    then: "iGLA: TTFT<50ms, TPOT<10ms target"

  - name: phi_latency_harmony
    given: "Metrics"
    when: "Harmony"
    then: "φ-weighted latency score"
