# VIBEE Specification v13492
# OpenAI Provider
# KOSCHEI CYCLE 11 - 1000000x SPEEDUP

name: llm_openai
version: "13492"
language: zig
module: llm_openai

types:
  OpenAIConfig:
    fields:
      api_key: String
      organization: String
      base_url: String
      timeout_ms: Int

  OpenAIModel:
    fields:
      id: String
      name: String
      context_length: Int
      cost_per_1k_input: Float
      cost_per_1k_output: Float

  ChatCompletion:
    fields:
      id: String
      model: String
      choices: List<Object>
      usage: Object
      created: Timestamp

  OpenAIMessage:
    fields:
      role: String
      content: String
      name: String
      tool_calls: List<Object>

  FunctionCall:
    fields:
      name: String
      arguments: String

  OpenAIMetrics:
    fields:
      requests: Int
      tokens_input: Int
      tokens_output: Int
      cost_usd: Float

behaviors:
  - name: chat_completion
    given: Messages and model
    when: Completion requested
    then: Chat response generated

  - name: function_calling
    given: Functions and prompt
    When: Function call needed
    then: Appropriate function called

  - name: embeddings
    given: Text to embed
    When: Embedding requested
    then: Vector embedding returned

  - name: vision_analysis
    given: Image and prompt
    When: Vision analysis requested
    then: Image analysis returned

  - name: json_mode
    given: JSON schema
    When: Structured output needed
    then: Valid JSON returned

  - name: handle_errors
    given: API error response
    When: Error received
    then: Error handled gracefully

creation_pattern:
  source: OpenAIConfig
  transformer: OpenAIProvider
  result: ChatCompletion
