# vibee_wasm_splitter.vibee - WASM Draggable Splitter
# φ-snapping splitter for panel resizing
# V = n × 3^k × π^m × φ^p × e^q

name: vibee_wasm_splitter
version: "1.0.0"
language: zig
module: vibee_wasm_splitter

creation_pattern:
  source: SplitterSpec
  transformer: PhiSnapper
  result: Splitter

constants:
  PHI: 1.618033988749895
  PHI_INV: 0.618033988749895
  SNAP_THRESHOLD: 20.0
  MIN_PANEL_SIZE: 100.0

types:
  Splitter:
    fields:
      id: Int
      position: Float
      min_pos: Float
      max_pos: Float
      orientation: Int
      dragging: Bool

  DragState:
    fields:
      active: Bool
      start_pos: Float
      current_pos: Float
      splitter_id: Int

  SnapPoint:
    fields:
      position: Float
      strength: Float
      label: Int

  DragEvent:
    fields:
      splitter_id: Int
      delta: Float
      snapped: Bool
      snap_label: Int

behaviors:
  - name: create_splitter
    given: Min and max bounds
    when: Create
    then: Splitter at φ position

  - name: start_drag
    given: Splitter id and position
    when: Mouse down
    then: Drag state active

  - name: update_drag
    given: New position
    when: Mouse move
    then: Position updated with constraints

  - name: end_drag
    given: Nothing
    when: Mouse up
    then: Drag ended, snap applied

  - name: snap_to_phi
    given: Position and container size
    when: Check snap
    then: Snapped position or original

  - name: get_snap_points
    given: Container size
    when: Calculate
    then: Array of snap points

  - name: reset_to_phi
    given: Splitter id
    when: Double click
    then: Position reset to φ ratio

  - name: keyboard_adjust
    given: Splitter id and delta
    when: Arrow key
    then: Position adjusted
