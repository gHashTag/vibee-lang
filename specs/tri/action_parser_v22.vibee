name: action_parser_v22
version: "22.3.0"
language: zig
module: action_parser_v22

types:
  ActionType:
    fields:
      name: String

  ParsedAction:
    fields:
      action_type: String
      selector: Option<String>
      value: Option<String>
      url: Option<String>
      coordinates: Option<String>
      raw_text: String

  ParseResult:
    fields:
      success: Bool
      action: Object
      error_message: Option<String>
      confidence: Float

  ActionSchema:
    fields:
      name: String
      required_params: List<String>
      optional_params: List<String>
      description: String

  Parser:
    fields:
      schemas: List<String>
      strict_mode: Bool

behaviors:
  - name: create_parser
    given: Action schemas
    when: Initialize parser
    then: Parser instance

  - name: parse
    given: Parser and LLM output
    when: Parse action
    then: ParseResult

  - name: parse_json
    given: JSON string
    when: Parse JSON action
    then: ParsedAction

  - name: parse_text
    given: Text string
    when: Parse text action
    then: ParsedAction

  - name: validate_action
    given: ParsedAction
    when: Validate against schema
    then: Validation result

  - name: get_action_type
    given: Raw text
    when: Extract action type
    then: Action type string

  - name: extract_selector
    given: Raw text
    when: Extract CSS selector
    then: Selector string

  - name: extract_value
    given: Raw text
    when: Extract input value
    then: Value string

  - name: extract_url
    given: Raw text
    when: Extract URL
    then: URL string

  - name: normalize_action
    given: ParsedAction
    when: Normalize format
    then: Normalized action

  - name: to_cdp_command
    given: ParsedAction
    when: Convert to CDP
    then: CDP command
