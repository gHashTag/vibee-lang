# VIBEE Specification - IGLA Context Manager
# Context window management
# V = n × 3^k × π^m × φ^p | φ² + 1/φ² = 3 | PHOENIX = 999

name: igla_context_manager
version: "1.0.0"
language: zig
module: igla_context_manager

types:
  Context:
    fields:
      id: String
      content: String
      token_count: Int
      priority: Float

  ContextWindow:
    fields:
      items: String
      total_tokens: Int
      max_tokens: Int

  ContextConfig:
    fields:
      max_tokens: Int
      reserve_output: Int
      compression_enabled: Bool

  ContextMetrics:
    fields:
      contexts_managed: Int
      avg_utilization: Float
      compressions: Int

behaviors:
  - name: add_context
    given: Content
    when: Addition
    then: Context added

  - name: remove_context
    given: Context ID
    when: Removal
    then: Context removed

  - name: prioritize
    given: Contexts
    when: Prioritization
    then: Contexts reordered

  - name: compress
    given: Context
    when: Compression
    then: Context compressed

  - name: get_window
    given: Max tokens
    when: Window request
    then: Fitted context returned

  - name: get_metrics
    given: Manager
    when: Metrics requested
    then: Context metrics returned

test_cases:
  - name: test_add
    input: { content: "new context" }
    expected: { added: true }

  - name: test_prioritize
    input: { contexts: ["a", "b", "c"] }
    expected: { ordered: true }

  - name: test_compress
    input: { context: "long text" }
    expected: { compressed: true }

  - name: test_metrics
    input: {}
    expected: { contexts_managed: 0 }
