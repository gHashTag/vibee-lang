# IGLA Code Indexer
# File scanning and metadata extraction for code repositories
# φ² + 1/φ² = 3 | PHOENIX = 999

name: igla_code_indexer
version: "1.0.0"
language: zig
module: igla_code_indexer

sacred_constants:
  phi: 1.618033988749895
  phoenix: 999
  trinity: 3

types:
  FileType:
    enum: [Source, Test, Config, Doc, Binary, Unknown]

  FileMetadata:
    fields:
      path: String
      size: Int
      lines: Int
      language: String
      file_type: String
      last_modified: Timestamp

  IndexEntry:
    fields:
      file_path: String
      content_hash: String
      metadata: FileMetadata
      symbols: List<String>

  IndexConfig:
    fields:
      root_path: String
      include_patterns: List<String>
      exclude_patterns: List<String>
      max_file_size: Int

  CodeIndex:
    fields:
      entries: List<IndexEntry>
      total_files: Int
      total_lines: Int
      languages: List<String>

behaviors:
  - name: create_index
    given: IndexConfig
    when: Index creation requested
    then: Returns CodeIndex with all files

  - name: scan_directory
    given: Directory path
    when: Scanning requested
    then: Returns list of file paths

  - name: extract_metadata
    given: File path
    when: Metadata extraction requested
    then: Returns FileMetadata

  - name: detect_language
    given: File path
    when: Language detection requested
    then: Returns language string

  - name: compute_hash
    given: File content
    when: Hash computation requested
    then: Returns content hash

  - name: update_index
    given: CodeIndex and changed files
    when: Incremental update requested
    then: Returns updated CodeIndex

test_cases:
  - name: test_scan_directory
    expected: files_found
  - name: test_detect_language
    expected: language_detected
  - name: test_metadata_extraction
    expected: metadata_valid
  - name: test_index_creation
    expected: index_created
  - name: test_incremental_update
    expected: index_updated
