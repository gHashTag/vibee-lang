# Bundler Output v56290 - Output Formats
# Multiple Output Format Support
# φ² + 1/φ² = 3 | PHOENIX = 999

name: bundler_output_v56290
version: "56.2.90"
language: zig
module: bundler_output

creation_pattern:
  source: Bundle
  transformer: OutputFormatter
  result: FormattedOutput

types:
  OutputFormat:
    fields:
      name: String
      extension: String
      module_system: String
      supports_tree_shaking: Bool

  ESMOutput:
    fields:
      code: String
      imports: List<String>
      exports: List<String>
      is_entry: Bool

  CJSOutput:
    fields:
      code: String
      requires: List<String>
      module_exports: String

  IIFEOutput:
    fields:
      code: String
      global_name: String
      dependencies: List<String>

  UMDOutput:
    fields:
      code: String
      amd_name: Option<String>
      global_name: String
      dependencies: List<String>

  SystemOutput:
    fields:
      code: String
      module_id: String
      dependencies: List<String>

  OutputConfig:
    fields:
      format: OutputFormat
      dir: String
      entry_file_names: String
      chunk_file_names: String
      asset_file_names: String

  OutputFile:
    fields:
      path: String
      content: String
      type_name: String
      is_entry: Bool
      source_map: Option<String>

  OutputManifest:
    fields:
      files: List<OutputFile>
      entry_points: List<String>
      format: String

behaviors:
  - name: format_esm
    given: Bundle
    When: ESM output needed
    then: ESMOutput

  - name: format_cjs
    given: Bundle
    when: CommonJS output needed
    then: CJSOutput

  - name: format_iife
    given: Bundle and global name
    when: IIFE output needed
    then: IIFEOutput

  - name: format_umd
    given: Bundle and names
    when: UMD output needed
    then: UMDOutput

  - name: format_system
    given: Bundle
    when: SystemJS output needed
    then: SystemOutput

  - name: write_output
    given: OutputFile and path
    when: File writing needed
    then: File written

  - name: generate_manifest
    given: All outputs
    when: Manifest needed
    then: OutputManifest

  - name: validate_output
    given: OutputFile
    when: Validation needed
    then: Validation result
