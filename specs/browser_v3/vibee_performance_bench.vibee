# VIBEE Performance Benchmark v1.1.0
# Performance comparison and benchmarking

name: vibee_performance_bench
version: "1.1.0"
language: zig
module: vibee_performance_bench

constants:
  V0_CLICK_MS: 50
  V0_TYPE_MS: 30
  V0_SCREENSHOT_MS: 100
  V0_DOM_QUERY_MS: 10
  V1_CLICK_MS: 10
  V1_TYPE_MS: 5
  V1_SCREENSHOT_MS: 20
  V1_DOM_QUERY_MS: 1

types:
  BenchmarkResult:
    fields:
      operation: String
      iterations: Int
      min_ms: Float
      max_ms: Float
      avg_ms: Float
      p50_ms: Float
      p95_ms: Float
      p99_ms: Float

  VersionComparison:
    fields:
      operation: String
      v0_avg_ms: Float
      v1_avg_ms: Float
      improvement_percent: Float
      speedup_factor: Float

  BenchmarkSuite:
    fields:
      name: String
      results: List<BenchmarkResult>
      comparisons: List<VersionComparison>
      total_duration_ms: Int

  BenchmarkConfig:
    fields:
      iterations: Int
      warmup_iterations: Int
      timeout_ms: Int

behaviors:
  - name: run_benchmark
    given: "Operation and config"
    when: "Run"
    then: "Return benchmark result"

  - name: benchmark_click
    given: "Selector and iterations"
    when: "Benchmark"
    then: "Return click timing"

  - name: benchmark_type
    given: "Text and iterations"
    when: "Benchmark"
    then: "Return type timing"

  - name: benchmark_screenshot
    given: "Options and iterations"
    when: "Benchmark"
    then: "Return screenshot timing"

  - name: benchmark_dom_query
    given: "Selector and iterations"
    when: "Benchmark"
    then: "Return query timing"

  - name: benchmark_navigation
    given: "URL and iterations"
    when: "Benchmark"
    then: "Return navigation timing"

  - name: compare_versions
    given: "V0 and V1 results"
    when: "Compare"
    then: "Return comparison"

  - name: calculate_speedup
    given: "Old and new times"
    when: "Calculate"
    then: "Return speedup factor"

  - name: generate_report
    given: "Suite results"
    when: "Generate"
    then: "Return markdown report"

  - name: export_csv
    given: "Results"
    when: "Export"
    then: "Return CSV data"

test_cases:
  - name: bench_click_improvement
    input: { v0: 50, v1: 10 }
    expected: { speedup: 5.0, improvement: 80 }

  - name: bench_type_improvement
    input: { v0: 30, v1: 5 }
    expected: { speedup: 6.0, improvement: 83 }

  - name: bench_screenshot_improvement
    input: { v0: 100, v1: 20 }
    expected: { speedup: 5.0, improvement: 80 }

  - name: bench_dom_query_improvement
    input: { v0: 10, v1: 1 }
    expected: { speedup: 10.0, improvement: 90 }

  - name: bench_overall_improvement
    input: {}
    expected: { avg_speedup_gt: 5.0 }

  - name: bench_report_generation
    input: { results: 5 }
    expected: { report_generated: true }
