# VIBEE Chromium WebView v1.1.0
# Real Chromium browser integration

name: vibee_chromium_webview
version: "1.1.0"
language: zig
module: vibee_chromium_webview

types:
  WebViewConfig:
    fields:
      sandbox: Bool
      context_isolation: Bool
      node_integration: Bool

  NavigationState:
    fields:
      url: String
      title: String
      loading: Bool
      progress: Float
      can_go_back: Bool
      can_go_forward: Bool
      secure: Bool

  PageLoadEvent:
    fields:
      type: String
      url: String
      timestamp: Timestamp
      duration_ms: Int

  SecurityState:
    fields:
      secure: Bool
      protocol: String
      certificate_valid: Bool

  WebViewBounds:
    fields:
      x: Int
      y: Int
      width: Int
      height: Int

behaviors:
  - name: create_webview
    given: "Config"
    when: "Create"
    then: "Return BrowserView instance"

  - name: load_url
    given: "URL string"
    when: "Navigate"
    then: "Load URL and emit events"

  - name: go_back
    given: "History exists"
    when: "Back"
    then: "Navigate to previous page"

  - name: go_forward
    given: "Forward history exists"
    when: "Forward"
    then: "Navigate to next page"

  - name: reload
    given: "Page loaded"
    when: "Reload"
    then: "Refresh current page"

  - name: stop_loading
    given: "Page loading"
    when: "Stop"
    then: "Cancel navigation"

  - name: get_url
    given: "WebView"
    when: "Query"
    then: "Return current URL"

  - name: get_title
    given: "WebView"
    when: "Query"
    then: "Return page title"

  - name: set_bounds
    given: "New bounds"
    when: "Resize"
    then: "Update WebView position/size"

  - name: execute_javascript
    given: "JS code"
    when: "Execute"
    then: "Run in page context"

  - name: capture_page
    given: "Options"
    when: "Screenshot"
    then: "Return image data"

  - name: open_devtools
    given: "WebView"
    when: "Open"
    then: "Show DevTools window"

test_cases:
  - name: test_create_webview
    input: { sandbox: true }
    expected: { created: true }

  - name: test_navigation
    input: { url: "https://google.com" }
    expected: { loaded: true }

  - name: test_back_forward
    input: { history: 3 }
    expected: { can_navigate: true }

  - name: test_js_execution
    input: { code: "1+1" }
    expected: { result: 2 }

  - name: test_screenshot
    input: { format: "png" }
    expected: { data_exists: true }
