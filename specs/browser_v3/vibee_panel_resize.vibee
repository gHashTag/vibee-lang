# VIBEE Panel Resize v1.1.0
# Drag-to-resize panel functionality

name: vibee_panel_resize
version: "1.1.0"
language: zig
module: vibee_panel_resize

constants:
  HANDLE_WIDTH: 6
  MIN_PANEL_WIDTH: 100
  SNAP_THRESHOLD: 20
  ANIMATION_DURATION_MS: 150

types:
  ResizeHandle:
    fields:
      id: String
      position: Int
      left_panel: String
      right_panel: String
      active: Bool

  DragState:
    fields:
      handle_id: String
      start_x: Int
      current_x: Int
      start_left_width: Int
      start_right_width: Int

  PanelConstraints:
    fields:
      min_width: Int
      max_width: Option<Int>
      snap_points: List<Int>

  ResizeEvent:
    fields:
      type: String
      handle_id: String
      delta_x: Int
      timestamp: Timestamp

behaviors:
  - name: create_handle
    given: "Position and panels"
    when: "Create"
    then: "Return resize handle"

  - name: start_drag
    given: "Handle and mouse position"
    when: "Mouse down"
    then: "Initialize drag state"

  - name: update_drag
    given: "Current mouse position"
    when: "Mouse move"
    then: "Update panel widths"

  - name: end_drag
    given: "Final position"
    when: "Mouse up"
    then: "Finalize resize"

  - name: apply_constraints
    given: "New width and constraints"
    when: "Apply"
    then: "Return constrained width"

  - name: snap_to_point
    given: "Position and snap points"
    when: "Check"
    then: "Return snapped position"

  - name: animate_resize
    given: "From and to widths"
    when: "Animate"
    then: "Smooth transition"

  - name: set_cursor
    given: "Handle hover state"
    when: "Set"
    then: "Update cursor style"

  - name: double_click_reset
    given: "Handle"
    when: "Double click"
    then: "Reset to golden ratio"

test_cases:
  - name: test_handle_creation
    input: { position: 500 }
    expected: { created: true }

  - name: test_drag_start
    input: { x: 500 }
    expected: { drag_active: true }

  - name: test_drag_update
    input: { delta_x: 100 }
    expected: { widths_updated: true }

  - name: test_min_width_constraint
    input: { width: 50 }
    expected: { width_ge: 100 }

  - name: test_snap_to_point
    input: { position: 618, snap: 620 }
    expected: { snapped: true }

  - name: test_double_click_reset
    input: { handle: "h1" }
    expected: { reset_to_golden: true }
