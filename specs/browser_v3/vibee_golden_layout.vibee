# VIBEE Golden Layout v1.1.0
# φ-based resizable panel layout

name: vibee_golden_layout
version: "1.1.0"
language: zig
module: vibee_golden_layout

constants:
  PHI: 1.6180339887498949
  PHI_SQUARED: 2.6180339887498949
  PHI_INV_SQUARED: 0.3819660112501051
  TRINITY: 3.0
  DEFAULT_BROWSER_RATIO: 0.618
  DEFAULT_CHAT_RATIO: 0.146
  DEFAULT_EDITOR_RATIO: 0.236
  MIN_PANEL_WIDTH: 100
  RESIZE_HANDLE_WIDTH: 6

types:
  PanelConfig:
    fields:
      id: String
      visible: Bool
      min_width: Int
      ratio: Float

  LayoutState:
    fields:
      total_width: Int
      total_height: Int
      toolbar_height: Int
      browser_ratio: Float
      chat_ratio: Float
      editor_ratio: Float

  PanelBounds:
    fields:
      x: Int
      y: Int
      width: Int
      height: Int

  ResizeHandle:
    fields:
      id: String
      x: Int
      width: Int
      left_panel: String
      right_panel: String

  DragState:
    fields:
      active: Bool
      handle_id: String
      start_x: Int
      current_x: Int

behaviors:
  - name: calculate_layout
    given: "Window size and panel states"
    when: "Calculate"
    then: "Return panel bounds using φ"

  - name: verify_trinity
    given: "φ constants"
    when: "Verify"
    then: "Confirm φ² + 1/φ² = 3"

  - name: toggle_panel
    given: "Panel ID"
    when: "Toggle"
    then: "Show/hide panel and recalculate"

  - name: start_resize
    given: "Handle ID and mouse X"
    when: "Mouse down"
    then: "Begin drag operation"

  - name: update_resize
    given: "Current mouse X"
    when: "Mouse move"
    then: "Update panel widths"

  - name: end_resize
    given: "Final mouse X"
    when: "Mouse up"
    then: "Finalize new ratios"

  - name: get_handle_at_x
    given: "X coordinate"
    when: "Query"
    then: "Return handle if at position"

  - name: apply_layout
    given: "Layout state"
    when: "Apply"
    then: "Set all panel bounds"

  - name: reset_to_golden
    given: "Current layout"
    when: "Reset"
    then: "Restore φ-based ratios"

  - name: save_layout
    given: "Layout state"
    when: "Save"
    then: "Persist to storage"

  - name: restore_layout
    given: "Saved state"
    when: "Restore"
    then: "Apply saved layout"

test_cases:
  - name: test_golden_ratio_1600
    input: { width: 1600 }
    expected: { browser: 989, chat: 234, editor: 377 }

  - name: test_golden_ratio_1920
    input: { width: 1920 }
    expected: { browser: 1187, chat: 280, editor: 453 }

  - name: test_trinity_verification
    input: {}
    expected: { trinity: 3.0 }

  - name: test_panel_toggle
    input: { panel: "chat", visible: false }
    expected: { recalculated: true }

  - name: test_resize_drag
    input: { delta_x: 100 }
    expected: { ratios_updated: true }

  - name: test_min_width_constraint
    input: { width: 50 }
    expected: { width_ge: 100 }
