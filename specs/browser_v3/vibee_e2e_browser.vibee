# VIBEE E2E Browser Tests v1.1.0
# End-to-end testing specification

name: vibee_e2e_browser
version: "1.1.0"
language: zig
module: vibee_e2e_browser

constants:
  PHI: 1.6180339887498949
  TRINITY: 3.0
  PHOENIX: 999

types:
  TestCase:
    fields:
      name: String
      description: String
      steps: List<TestStep>
      expected: Object

  TestStep:
    fields:
      action: String
      params: Object
      assertion: Option<Object>

  TestResult:
    fields:
      name: String
      passed: Bool
      duration_ms: Int
      error: Option<String>
      screenshot: Option<String>

  TestSuite:
    fields:
      name: String
      tests: List<TestResult>
      passed: Int
      failed: Int
      skipped: Int
      total_duration_ms: Int

  E2EConfig:
    fields:
      headless: Bool
      slow_mo: Int
      timeout_ms: Int
      screenshot_on_fail: Bool

behaviors:
  - name: run_test_suite
    given: "Suite config"
    when: "Run"
    then: "Execute all tests"

  - name: run_single_test
    given: "Test case"
    when: "Run"
    then: "Execute and return result"

  - name: test_navigation
    given: "URL"
    when: "Navigate"
    then: "Verify page loaded"

  - name: test_click
    given: "Selector"
    when: "Click"
    then: "Verify element clicked"

  - name: test_type
    given: "Selector and text"
    when: "Type"
    then: "Verify text entered"

  - name: test_golden_layout
    given: "Window size"
    when: "Calculate"
    then: "Verify Ï† ratios"

  - name: test_panel_toggle
    given: "Panel ID"
    when: "Toggle"
    then: "Verify visibility changed"

  - name: test_panel_resize
    given: "Handle and delta"
    when: "Drag"
    then: "Verify widths updated"

  - name: test_chat_send
    given: "Message"
    when: "Send"
    then: "Verify response received"

  - name: test_editor_content
    given: "Content"
    when: "Set"
    then: "Verify content matches"

  - name: test_agent_task
    given: "Goal"
    when: "Run"
    then: "Verify task completed"

  - name: test_performance
    given: "Operation"
    when: "Measure"
    then: "Verify under target"

  - name: generate_report
    given: "Suite results"
    when: "Generate"
    then: "Return HTML report"

test_cases:
  - name: e2e_app_launch
    input: {}
    expected: { window_visible: true }

  - name: e2e_navigation
    input: { url: "https://example.com" }
    expected: { title_contains: "Example" }

  - name: e2e_golden_ratio
    input: { width: 1600 }
    expected: { browser: 989, chat: 234, editor: 377 }

  - name: e2e_trinity
    input: {}
    expected: { phi_sq_plus_inv: 3.0 }

  - name: e2e_panel_toggle
    input: { panel: "chat" }
    expected: { toggled: true }

  - name: e2e_panel_resize
    input: { delta: 100 }
    expected: { resized: true }

  - name: e2e_chat_message
    input: { message: "Hello" }
    expected: { response_received: true }

  - name: e2e_editor_set
    input: { content: "const x = 1" }
    expected: { content_matches: true }

  - name: e2e_click_speed
    input: { selector: "#btn" }
    expected: { duration_lt: 10 }

  - name: e2e_type_speed
    input: { text: "hello" }
    expected: { duration_lt: 25 }

  - name: e2e_screenshot_speed
    input: {}
    expected: { duration_lt: 20 }

  - name: e2e_agent_simple
    input: { goal: "click button" }
    expected: { completed: true }
