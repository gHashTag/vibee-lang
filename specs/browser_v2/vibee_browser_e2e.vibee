# VIBEE Browser E2E Tests v1.0.0
# End-to-end testing specification

name: vibee_browser_e2e
version: "1.0.0"
language: zig
module: vibee_browser_e2e

description: |
  End-to-end tests for VIBEE Browser.
  Tests navigation, automation, AI agent, and UI.

constants:
  PHI: 1.6180339887498949
  TRINITY: 3.0
  PHOENIX: 999
  BROWSER_RATIO: 0.618
  CHAT_RATIO: 0.146
  EDITOR_RATIO: 0.236

types:
  TestResult:
    fields:
      name: String
      passed: Bool
      duration_ms: Int
      error: Option<String>

  TestSuite:
    fields:
      name: String
      tests: List<TestResult>
      passed: Int
      failed: Int
      total_duration_ms: Int

  BrowserState:
    fields:
      url: String
      title: String
      loading: Bool
      can_go_back: Bool
      can_go_forward: Bool

  LayoutMetrics:
    fields:
      total_width: Int
      browser_width: Int
      chat_width: Int
      editor_width: Int
      ratios_valid: Bool

  PerformanceMetrics:
    fields:
      navigation_ms: Float
      click_ms: Float
      type_ms: Float
      screenshot_ms: Float
      dom_query_ms: Float

behaviors:
  - name: test_golden_ratio_layout
    given: "Window with width 1600"
    when: "Calculate layout"
    then: "Browser=989, Chat=234, Editor=377"

  - name: test_trinity_constant
    given: "PHI constant"
    when: "Calculate φ² + 1/φ²"
    then: "Result equals 3.0"

  - name: test_navigation
    given: "Browser view"
    when: "Navigate to google.com"
    then: "URL changes to google.com"

  - name: test_back_forward
    given: "Navigation history"
    when: "Go back then forward"
    then: "Returns to original page"

  - name: test_click_element
    given: "Page with button"
    when: "Click button"
    then: "Button clicked successfully"

  - name: test_type_text
    given: "Page with input"
    when: "Type text"
    then: "Text entered in input"

  - name: test_screenshot
    given: "Loaded page"
    when: "Take screenshot"
    then: "Returns image data"

  - name: test_execute_js
    given: "Browser view"
    when: "Execute JavaScript"
    then: "Returns result"

  - name: test_cdp_connection
    given: "Browser debugger"
    when: "Attach CDP"
    then: "Connection established"

  - name: test_agent_simple_task
    given: "AI agent"
    when: "Run simple task"
    then: "Task completed"

  - name: test_chat_send_message
    given: "Chat panel"
    when: "Send message"
    then: "Response received"

  - name: test_editor_set_content
    given: "Monaco editor"
    when: "Set content"
    then: "Content updated"

  - name: test_performance_click
    given: "Element to click"
    when: "Measure click time"
    then: "Under 10ms"

  - name: test_performance_type
    given: "Input field"
    when: "Measure type time"
    then: "Under 5ms per char"

  - name: test_performance_screenshot
    given: "Page"
    when: "Measure screenshot time"
    then: "Under 20ms"

test_cases:
  - name: e2e_golden_ratio
    input: { width: 1600 }
    expected: { browser: 989, chat: 234, editor: 377 }

  - name: e2e_trinity
    input: {}
    expected: { result: 3.0 }

  - name: e2e_navigation
    input: { url: "https://example.com" }
    expected: { loaded: true }

  - name: e2e_automation
    input: { selector: "#test" }
    expected: { clicked: true }

  - name: e2e_agent
    input: { goal: "click button" }
    expected: { completed: true }

  - name: e2e_performance
    input: {}
    expected: { all_under_target: true }
