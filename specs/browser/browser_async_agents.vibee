# VIBEE Browser Async Agents v0.0.1
name: browser_async_agents
version: "0.0.1"
language: zig
module: browser_async_agents

types:
  AsyncTask:
    fields:
      id: String
      type: String
      params: Object
      status: String
      progress: Float
      result: Option<Object>
      error: Option<String>

  TaskQueue:
    fields:
      id: String
      tasks: List<AsyncTask>
      concurrency: Int
      running: Int

  BackgroundWorker:
    fields:
      id: String
      task_id: String
      started_at: Timestamp
      heartbeat: Timestamp

  ScheduledTask:
    fields:
      id: String
      task: AsyncTask
      schedule: String
      next_run: Timestamp
      enabled: Bool

behaviors:
  - name: create_task
    given: "Task definition"
    when: "Create"
    then: "Return task handle"

  - name: queue_task
    given: "Task"
    when: "Add to queue"
    then: "Return queue position"

  - name: execute_async
    given: "Task"
    when: "Run in background"
    then: "Return immediately with task ID"

  - name: get_task_status
    given: "Task ID"
    when: "Check status"
    then: "Return current status"

  - name: cancel_task
    given: "Task ID"
    when: "Cancel"
    then: "Stop task execution"

  - name: schedule_task
    given: "Task and cron expression"
    when: "Schedule"
    then: "Return scheduled task"

  - name: wait_for_completion
    given: "Task ID"
    when: "Wait"
    then: "Return when task completes"

test_cases:
  - name: test_async_execution
    input: { task: "scrape" }
    expected: { started: true }
  - name: test_scheduling
    input: { cron: "0 * * * *" }
    expected: { scheduled: true }
