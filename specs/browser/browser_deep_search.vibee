# VIBEE Browser Deep Search v0.0.1
# Multi-source parallel research

name: browser_deep_search
version: "0.0.1"
language: zig
module: browser_deep_search

types:
  SearchEngine:
    fields:
      name: String
      url_template: String
      result_selector: String
      enabled: Bool

  SearchQuery:
    fields:
      id: String
      query: String
      engines: List<String>
      filters: Object
      max_results: Int

  SearchResult:
    fields:
      id: String
      title: String
      url: String
      snippet: String
      source: String
      rank: Int
      relevance: Float

  AggregatedResults:
    fields:
      query_id: String
      results: List<SearchResult>
      sources_count: Int
      total_results: Int
      search_time: Int

  ResearchTopic:
    fields:
      id: String
      main_query: String
      sub_queries: List<String>
      depth: Int
      status: String

  SourceCitation:
    fields:
      url: String
      title: String
      author: Option<String>
      date: Option<String>
      accessed: Timestamp

  ResearchReport:
    fields:
      id: String
      topic: String
      summary: String
      sections: List<String>
      citations: List<SourceCitation>
      generated_at: Timestamp

  FactCheck:
    fields:
      claim: String
      verdict: String
      confidence: Float
      sources: List<String>

behaviors:
  - name: search_single
    given: "Query and engine"
    when: "Search"
    then: "Return results from one engine"

  - name: search_parallel
    given: "Query and multiple engines"
    when: "Search parallel"
    then: "Return aggregated results"

  - name: deep_search
    given: "Topic"
    when: "Research deeply"
    then: "Return comprehensive results"

  - name: expand_query
    given: "Main query"
    when: "Generate sub-queries"
    then: "Return related queries"

  - name: rank_results
    given: "Raw results"
    when: "Rank by relevance"
    then: "Return sorted results"

  - name: deduplicate
    given: "Results from multiple sources"
    when: "Remove duplicates"
    then: "Return unique results"

  - name: extract_facts
    given: "Search results"
    when: "Extract key facts"
    then: "Return fact list"

  - name: verify_fact
    given: "Claim"
    when: "Cross-reference"
    then: "Return fact check result"

  - name: generate_report
    given: "Research results"
    when: "Compile report"
    then: "Return formatted report"

  - name: add_citations
    given: "Report and sources"
    when: "Add citations"
    then: "Return cited report"

  - name: compare_sources
    given: "Multiple sources"
    when: "Compare"
    then: "Return comparison analysis"

test_cases:
  - name: test_single_search
    input: { query: "AI browsers", engine: "google" }
    expected: { results_gt: 0 }

  - name: test_parallel_search
    input: { query: "test", engines: 3 }
    expected: { aggregated: true }

  - name: test_deep_search
    input: { topic: "quantum computing" }
    expected: { depth_reached: true }

  - name: test_query_expansion
    input: { query: "machine learning" }
    expected: { sub_queries_gt: 3 }

  - name: test_deduplication
    input: { results: 100 }
    expected: { unique_lt: 100 }

  - name: test_report_generation
    input: { topic: "AI" }
    expected: { report_generated: true }

  - name: test_fact_check
    input: { claim: "Earth is round" }
    expected: { verdict: "true" }
