# PAS UI Gen - Оптимизированная генерация UI
# Паттерны: ULD, ULGNN, GradUI, CAG, MMF
# Автор: Дмитрий Васильев

name: pas_uigen
version: "1.0.0"
language: 999
module: pas_uigen

creation_pattern:
  source: UISpecification
  transformer: PASUIGenerator
  result: OptimizedUI

# ═══════════════════════════════════════════════════════════════════════════
# PAS ПАТТЕРНЫ ДЛЯ ГЕНЕРАЦИИ UI
# ═══════════════════════════════════════════════════════════════════════════

patterns:
  - name: unified_layout_diffusion
    symbol: ULD
    source_paper: "UniLayDiff: A Unified Diffusion Transformer (Liu et al., 2025)"
    confidence: 0.80
    speedup: 4.0
    description: "Унифицированная диффузия для layout"
    applicable_to:
      - layout_generation
      - responsive_design
      - adaptive_ui

  - name: ui_layer_gnn
    symbol: ULGNN
    source_paper: "ULDGNN: UI Layer Detection via GNN (Li et al., 2022)"
    confidence: 0.75
    speedup: 2.0
    description: "GNN для детекции UI слоёв"
    applicable_to:
      - layer_detection
      - hierarchy_analysis
      - component_grouping

  - name: gradient_layout
    symbol: GradUI
    source_paper: "Optimizing UI Layouts via Gradient Descent (Duan et al., 2020)"
    confidence: 0.70
    speedup: 1.5
    description: "Градиентная оптимизация layout"
    applicable_to:
      - layout_optimization
      - fitts_law_optimization
      - usability_improvement

  - name: content_aware
    symbol: CAG
    source_paper: "UniLayDiff (Liu et al., 2025)"
    confidence: 0.78
    speedup: 3.0
    description: "Генерация с учётом контента"
    applicable_to:
      - content_layout
      - adaptive_sizing
      - semantic_layout

  - name: multimodal_fusion
    symbol: MMF
    source_paper: "WorldGen (Wang et al., 2025)"
    confidence: 0.72
    speedup: 2.5
    description: "Мультимодальная фузия"
    applicable_to:
      - text_to_ui
      - image_to_ui
      - voice_to_ui

# ═══════════════════════════════════════════════════════════════════════════
# ТИПЫ UI ЭЛЕМЕНТОВ (999 паттерн)
# ═══════════════════════════════════════════════════════════════════════════

types:
  - name: UIElementType
    description: "27 типов UI элементов (3³ = 999 паттерн)"
    enum:
      # Базовые (3)
      - container
      - text
      - button
      # Расширенные (9)
      - input
      - image
      - list
      - card
      - nav
      - footer
      # Продвинутые (27 - первые 18)
      - modal
      - dropdown
      - tabs
      - accordion
      - carousel
      - table
      - form
      - chart
      - map
      - video
      - audio
      - slider
      - toggle
      - checkbox
      - radio
      - progress
      - badge
      - tooltip

  - name: Bounds
    fields:
      - x: f32
      - y: f32
      - width: f32
      - height: f32

  - name: Style
    fields:
      - background_color: [4]f32  # RGBA
      - border_radius: f32
      - padding: [4]f32  # top, right, bottom, left
      - margin: [4]f32
      - font_size: f32
      - opacity: f32

  - name: UIElement
    fields:
      - id: u32
      - element_type: UIElementType
      - bounds: Bounds
      - style: Style
      - children: list[UIElement]
      - parent: optional[UIElement]

  - name: ContentType
    enum:
      - header
      - paragraph
      - image
      - button
      - form
      - list
      - card
      - nav

  - name: UIGenStats
    fields:
      - layouts_generated: u64
      - denoising_steps: u64
      - layer_detections: u64
      - mode: GenerationMode

  - name: GenerationMode
    enum:
      - diffusion
      - gnn_guided
      - content_aware
      - hybrid

# ═══════════════════════════════════════════════════════════════════════════
# КОМПОНЕНТЫ
# ═══════════════════════════════════════════════════════════════════════════

components:
  - name: UnifiedLayoutDiffusion
    description: "Диффузионный генератор layout (ULD)"
    fields:
      - timesteps: u32
      - noise_schedule: list[f32]
      - layouts_generated: u64
      - denoising_steps: u64
    methods:
      - name: generateLayout
        params: [num_elements: u32, canvas_width: f32, canvas_height: f32]
        returns: list[Bounds]
      - name: denoiseStep
        params: [bounds: list[Bounds], t: u32, canvas_width: f32, canvas_height: f32]
        returns: void
      - name: applyConstraints
        params: [bounds: list[Bounds], canvas_width: f32, canvas_height: f32]
        returns: void

  - name: UILayerGNN
    description: "GNN для детекции UI слоёв (ULGNN)"
    fields:
      - num_layers: u32
      - hidden_dim: u32
      - adjacency: matrix[f32]
      - detections: u64
    methods:
      - name: buildGraph
        params: [elements: list[Bounds]]
        returns: void
      - name: detectLayers
        params: [elements: list[Bounds]]
        returns: list[u32]
      - name: computeDistance
        params: [a: Bounds, b: Bounds]
        returns: f32

  - name: GradientUIOptimizer
    description: "Градиентный оптимизатор UI (GradUI)"
    fields:
      - learning_rate: f32
      - momentum: f32
      - iterations: u32
      - position_grads: list[[2]f32]
      - size_grads: list[[2]f32]
      - error_rate: f32
      - completion_time: f32
    methods:
      - name: optimize
        params: [elements: list[UIElement]]
        returns: void
      - name: computeGradients
        params: [elements: list[UIElement]]
        returns: void
      - name: applyGradients
        params: [elements: list[UIElement]]
        returns: void
      - name: getImprovement
        params: []
        returns: f32

  - name: ContentAwareGenerator
    description: "Генератор с учётом контента (CAG)"
    methods:
      - name: generateFromContent
        params: [content_types: list[ContentType], canvas_width: f32, canvas_height: f32]
        returns: list[Bounds]
      - name: getPreferredSize
        params: [content: ContentType, canvas_width: f32]
        returns: [2]f32

  - name: AdvancedUIGenerator
    description: "Интегрированный генератор UI"
    fields:
      - diffusion: UnifiedLayoutDiffusion
      - gnn: UILayerGNN
      - content_aware: ContentAwareGenerator
      - mode: GenerationMode
    methods:
      - name: generate
        params: [num_elements: u32, canvas_width: f32, canvas_height: f32]
        returns: UIElement
      - name: selectElementType
        params: [layer: u32]
        returns: UIElementType
      - name: getStats
        params: []
        returns: UIGenStats

# ═══════════════════════════════════════════════════════════════════════════
# ПОВЕДЕНИЯ
# ═══════════════════════════════════════════════════════════════════════════

behaviors:
  - name: diffusion_layout_generation
    given: Количество элементов и размер canvas
    when: Генерация layout через диффузию
    then: Элементы размещаются оптимально
    test_cases:
      - name: basic_layout
        input:
          num_elements: 5
          canvas_width: 800
          canvas_height: 600
        expected:
          elements_count: 5
          all_within_bounds: true
          min_width: 50
          min_height: 30

  - name: gnn_layer_detection
    given: Список bounds элементов
    when: Детекция слоёв через GNN
    then: Элементы группируются по близости
    test_cases:
      - name: cluster_detection
        input:
          bounds:
            - {x: 0, y: 0, width: 100, height: 50}
            - {x: 50, y: 0, width: 100, height: 50}
            - {x: 500, y: 500, width: 100, height: 50}
        expected:
          layers_count_min: 2
          nearby_same_layer: true

  - name: content_aware_generation
    given: Типы контента
    when: Генерация с учётом контента
    then: Размеры соответствуют типу контента
    test_cases:
      - name: header_paragraph_button
        input:
          content_types: [header, paragraph, button]
          canvas_width: 800
        expected:
          header_height: 60
          button_width: 120

  - name: gradient_optimization
    given: UI элементы
    when: Оптимизация через градиентный спуск
    then: Метрики улучшаются
    test_cases:
      - name: fitts_law_optimization
        input:
          iterations: 100
        expected:
          error_rate_decreased: true
          completion_time_decreased: true

  - name: hybrid_ui_generation
    given: Параметры генерации
    when: Гибридная генерация (все методы)
    then: UI генерируется с максимальным качеством
    test_cases:
      - name: full_ui
        input:
          num_elements: 10
          canvas_width: 1920
          canvas_height: 1080
        expected:
          has_hierarchy: true
          layers_detected: true
          constraints_satisfied: true

# ═══════════════════════════════════════════════════════════════════════════
# PAS ПРЕДСКАЗАНИЯ
# ═══════════════════════════════════════════════════════════════════════════

predictions:
  - name: unified_layout_diffusion
    component: UnifiedLayoutDiffusion
    current: "Ручное размещение"
    predicted: "Автоматическая диффузия"
    patterns: [ULD, MMF]
    confidence: 0.80
    speedup: 4.0
    timeline: "Q1 2026"

  - name: ui_layer_gnn
    component: UILayerGNN
    current: "Плоская структура"
    predicted: "Иерархическая детекция"
    patterns: [ULGNN, PRE]
    confidence: 0.75
    speedup: 2.0
    timeline: "Q2 2026"

  - name: gradient_ui_optimizer
    component: GradientUIOptimizer
    current: "Статические правила"
    predicted: "Градиентная оптимизация"
    patterns: [GradUI, ALG]
    confidence: 0.70
    speedup: 1.5
    timeline: "Q1 2026"

  - name: content_aware_layout
    component: ContentAwareGenerator
    current: "Фиксированные размеры"
    predicted: "Адаптивные размеры"
    patterns: [CAG, IOT]
    confidence: 0.78
    speedup: 3.0
    timeline: "Q2 2026"

  - name: world_generator_3d
    component: AdvancedUIGenerator
    current: "2D layout"
    predicted: "3D генерация миров"
    patterns: [MMF, GSP]
    confidence: 0.72
    speedup: 5.0
    timeline: "Q4 2026"

# ═══════════════════════════════════════════════════════════════════════════
# МЕТАДАННЫЕ
# ═══════════════════════════════════════════════════════════════════════════

metadata:
  author: "Дмитрий Васильев"
  date: "2026-01-14"
  status: "specification"
  total_patterns: 5
  total_components: 5
  total_behaviors: 5
  total_predictions: 5
  average_confidence: 0.75
  average_speedup: 3.1
  ui_element_types: 27  # 999 паттерн
