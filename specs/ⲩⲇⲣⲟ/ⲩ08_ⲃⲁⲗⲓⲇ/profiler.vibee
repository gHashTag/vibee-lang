# Profiler - Профилировщик
# PAS: Низкоуровневое профилирование
# Author: Dmitrii Vasilev
# Version: 1.0.0

name: profiler
version: "1.0.0"
language: 999
module: ⲡⲣⲟⲫⲓⲗⲉⲣ

creation_pattern:
  source: RunningProgram
  transformer: Profiler
  result: ProfileReport

pas_analysis:
  current: "Sampling profiler"
  target: "Hardware counters + sampling"
  speedup: "10x precision"
  confidence: 0.80
  patterns: ["PRE", "PRB"]

components:
  sampler:
    name: "ⲤⲀⲘⲠⲖⲈⲢ"
    description: "Сэмплирование стека"
  counter:
    name: "ⲤⲬⲈⲦⲬⲒⲔ"
    description: "Hardware counters"
  aggregator:
    name: "ⲀⲄⲢⲈⲄⲀⲦⲞⲢ"
    description: "Агрегация данных"
  visualizer:
    name: "ⲂⲒⲌⲨⲀⲖⲒⲌⲀⲦⲞⲢ"
    description: "Визуализация (flame graph)"

metrics:
  - "cpu_time"
  - "wall_time"
  - "memory_allocations"
  - "cache_misses"
  - "branch_mispredictions"
  - "instructions_retired"

behaviors:
  - name: start_profiling
    given: "Программа"
    when: "Запуск профилирования"
    then: "Сбор данных начат"
  - name: stop_profiling
    given: "Активная сессия"
    when: "Остановка"
    then: "Профиль собран"
  - name: generate_flamegraph
    given: "Профиль"
    when: "Визуализация"
    then: "Flame graph"
