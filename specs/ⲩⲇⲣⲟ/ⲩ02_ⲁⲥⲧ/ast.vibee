# AST - Абстрактное синтаксическое дерево
# PAS: Компактное представление
# Author: Dmitrii Vasilev
# Version: 1.0.0

name: ast
version: "1.0.0"
language: 999
module: ⲁⲥⲧ

creation_pattern:
  source: TokenStream
  transformer: ASTBuilder
  result: AbstractSyntaxTree

pas_analysis:
  current: "Pointer-based tree"
  target: "Arena-allocated flat"
  speedup: "2x memory, 3x traversal"
  confidence: 0.85
  patterns: ["PRE", "D&C"]

components:
  node_pool:
    name: "ⲠⲨⲖ.ⲨⲌⲖⲞⲂ"
    description: "Пул узлов AST"
  builder:
    name: "ⲂⲒⲖⲆⲈⲢ"
    description: "Построитель дерева"
  visitor:
    name: "ⲂⲒⲌⲒⲦⲞⲢ"
    description: "Обход дерева"

node_types:
  - "ⲘⲞⲆⲨⲖⲒ"        # module
  - "ⲪⲨⲚⲔⲤⲒⲀ"       # function
  - "ⲂⲨⲢⲀⲜⲈⲚⲒⲈ"     # expression
  - "ⲞⲠⲈⲢⲀⲦⲞⲢ"      # operator
  - "ⲖⲒⲦⲈⲢⲀⲖ"       # literal
  - "ⲒⲆⲈⲚⲦⲒⲪⲒⲔⲀⲦⲞⲢ" # identifier

behaviors:
  - name: build_ast
    given: "Поток токенов"
    when: "Построение"
    then: "AST дерево"
  - name: traverse
    given: "AST + visitor"
    when: "Обход"
    then: "Результат visitor"
  - name: serialize
    given: "AST"
    when: "Сериализация"
    then: "Компактное представление"
