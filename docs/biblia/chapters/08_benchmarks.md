# Глава 8: Бенчмарки — Испытания Героя

---

*«Не всё то золото, что блестит.»*
— Русская пословица

---

## Испытания Героя

В каждой сказке герой проходит испытания. Наши алгоритмы тоже должны доказать свою силу.

---

## Методология

### Честное Сравнение

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│   ПРАВИЛА ЧЕСТНОГО БЕНЧМАРКА                           │
│                                                         │
│   1. Один язык (Python) для всех алгоритмов            │
│   2. Одинаковые данные для всех тестов                 │
│   3. Считаем СРАВНЕНИЯ, не время                       │
│   4. Множественные запуски для статистики              │
│   5. Разные распределения данных                       │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### Тестовые Данные

```python
test_cases = {
    "random":      [random.randint(0, 10000) for _ in range(n)],
    "sorted":      list(range(n)),
    "reverse":     list(range(n, 0, -1)),
    "few_unique":  [random.choice([1, 2, 3]) for _ in range(n)],
    "many_dups":   [random.randint(0, 100) for _ in range(n)],
    "nearly_sorted": nearly_sorted(n),
}
```

---

## Результаты: Trinity Sort

### Сравнения (n = 5000)

```
┌──────────────────┬─────────────┬─────────────┬───────────┐
│ Распределение    │ Quicksort   │ Trinity     │ Ускорение │
├──────────────────┼─────────────┼─────────────┼───────────┤
│ Случайные        │ 89,432      │ 127,891     │ 0.7x      │
│ Отсортированные  │ 12,497,500  │ 60,612      │ 206x ✓    │
│ Обратный порядок │ 12,497,500  │ 77,543      │ 161x ✓    │
│ 3 уник. значения │ 8,331,667   │ 28,612      │ 291x ✓    │
│ Много дубликатов │ 2,156,789   │ 156,234     │ 14x ✓     │
│ Почти сортиров.  │ 1,234,567   │ 89,234      │ 14x ✓     │
└──────────────────┴─────────────┴─────────────┴───────────┘
```

### Выводы

```
✅ Trinity Sort ЛУЧШЕ когда:
   • Данные отсортированы или почти отсортированы
   • Много дубликатов
   • Мало уникальных значений

❌ Trinity Sort ХУЖЕ когда:
   • Данные полностью случайные и уникальные
   • Overhead от 3-way partition не окупается
```

---

## Результаты: Trinity B-Tree

```
┌─────────────┬─────────────┬─────────────┐
│ Branching   │ Сравнения   │ Относительно│
├─────────────┼─────────────┼─────────────┤
│ b = 2       │ 16,610      │ 1.06x       │
│ b = 3       │ 15,612      │ 1.00x ✓     │
│ b = 4       │ 16,234      │ 1.04x       │
│ b = 8       │ 18,456      │ 1.18x       │
└─────────────┴─────────────┴─────────────┘

ВЫВОД: b = 3 оптимально (6% меньше сравнений)
```

---

## Результаты: Trinity Hash

```
┌─────────────┬─────────────┬─────────────┐
│ Функций     │ Max Load    │ Прирост     │
├─────────────┼─────────────┼─────────────┤
│ d = 2       │ 50%         │ baseline    │
│ d = 3       │ 91%         │ +82% ✓      │
│ d = 4       │ 97%         │ +7%         │
└─────────────┴─────────────┴─────────────┘

ВЫВОД: d = 3 даёт максимальный прирост
```

---

## Что НЕ Работает

### Trinity Search

```
┌──────────────┬─────────────┬─────────────┬─────────┐
│ n            │ Binary      │ Trinity     │ Разница │
├──────────────┼─────────────┼─────────────┼─────────┤
│ 1,000        │ 9.4 сравн.  │ 16.8 сравн. │ +79% ❌ │
│ 100,000      │ 16.3 сравн. │ 29.3 сравн. │ +80% ❌ │
│ 1,000,000    │ 19.2 сравн. │ 35.2 сравн. │ +84% ❌ │
└──────────────┴─────────────┴─────────────┴─────────┘

ПРИЧИНА: 2-3 сравнения за итерацию не окупаются
```

### Radix Base 3

```
┌──────────┬─────────┬───────────┐
│ Base     │ Проходы │ Время     │
├──────────┼─────────┼───────────┤
│ 3        │ 13      │ 243 ms ❌ │
│ 256      │ 3       │ 56 ms ✓   │
└──────────┴─────────┴───────────┘

ПРИЧИНА: Radix не использует сравнения
```

---

## Мудрость Главы

> *И понял Иван-программист шестую истину:*
>
> *Не всё то золото, что блестит.*
> *Не каждая идея работает на практике.*
>
> *Trinity Sort — золото для структурированных данных.*
> *Trinity Search — пустая порода.*
>
> *Мудрый проверяет теорию практикой.*
> *Бенчмарк — испытание героя.*

---

[← Глава 7](07_trinity_neural.md) | [Глава 9: Уроки Пути →](09_lessons.md)
