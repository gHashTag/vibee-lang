// ═══════════════════════════════════════════════════════════════════════════
// СИСТЕМА ПЕРЕВОДОВ КНИГИ 999
// Тридевятое Царство говорит на всех языках мира
// ═══════════════════════════════════════════════════════════════════════════

/// Три группы языков (по географии)
enum ЯзыковаяГруппа {
    Восток,   // Русский, Китайский, Японский, Корейский, Хинди
    Запад,    // Английский, Немецкий, Французский, Испанский, Итальянский
    Юг,       // Арабский, Иврит, Турецкий, Персидский, Суахили
}

/// 27 языков = 3³ (по 9 в каждой группе)
const ЯЗЫКИ: [Язык; 27] = [
    // ═══════════════════════════════════════════════════════════════
    // ВОСТОК (9 языков)
    // ═══════════════════════════════════════════════════════════════
    Язык { код: "ru", название: "Русский", родной: true },
    Язык { код: "zh", название: "中文 (Китайский)", родной: false },
    Язык { код: "ja", название: "日本語 (Японский)", родной: false },
    Язык { код: "ko", название: "한국어 (Корейский)", родной: false },
    Язык { код: "hi", название: "हिन्दी (Хинди)", родной: false },
    Язык { код: "vi", название: "Tiếng Việt (Вьетнамский)", родной: false },
    Язык { код: "th", название: "ไทย (Тайский)", родной: false },
    Язык { код: "id", название: "Bahasa Indonesia", родной: false },
    Язык { код: "mn", название: "Монгол (Монгольский)", родной: false },
    
    // ═══════════════════════════════════════════════════════════════
    // ЗАПАД (9 языков)
    // ═══════════════════════════════════════════════════════════════
    Язык { код: "en", название: "English", родной: false },
    Язык { код: "de", название: "Deutsch", родной: false },
    Язык { код: "fr", название: "Français", родной: false },
    Язык { код: "es", название: "Español", родной: false },
    Язык { код: "it", название: "Italiano", родной: false },
    Язык { код: "pt", название: "Português", родной: false },
    Язык { код: "nl", название: "Nederlands", родной: false },
    Язык { код: "pl", название: "Polski", родной: false },
    Язык { код: "uk", название: "Українська", родной: false },
    
    // ═══════════════════════════════════════════════════════════════
    // ЮГ (9 языков)
    // ═══════════════════════════════════════════════════════════════
    Язык { код: "ar", название: "العربية (Арабский)", родной: false },
    Язык { код: "he", название: "עברית (Иврит)", родной: false },
    Язык { код: "tr", название: "Türkçe (Турецкий)", родной: false },
    Язык { код: "fa", название: "فارسی (Персидский)", родной: false },
    Язык { код: "sw", название: "Kiswahili (Суахили)", родной: false },
    Язык { код: "am", название: "አማርኛ (Амхарский)", родной: false },
    Язык { код: "ur", название: "اردو (Урду)", родной: false },
    Язык { код: "bn", название: "বাংলা (Бенгальский)", родной: false },
    Язык { код: "ta", название: "தமிழ் (Тамильский)", родной: false },
];

// ═══════════════════════════════════════════════════════════════════════════
// КЛЮЧЕВЫЕ ТЕРМИНЫ И ИХ ПЕРЕВОДЫ
// ═══════════════════════════════════════════════════════════════════════════

/// Словарь ключевых терминов
const ТЕРМИНЫ: HashMap<&str, Переводы> = {
    // Название книги
    "Тридевятое Царство Алгоритмов" => Переводы {
        en: "The Thrice-Nine Kingdom of Algorithms",
        zh: "三九算法王国",
        ja: "三九アルゴリズム王国",
        de: "Das Dreimalneun-Reich der Algorithmen",
        fr: "Le Royaume des Trois-Neuf Algorithmes",
        es: "El Reino de los Tres-Nueve Algoritmos",
        ar: "مملكة الثلاثة والتسعة للخوارزميات",
        hi: "त्रि-नौ एल्गोरिदम साम्राज्य",
    },
    
    // Число 27
    "Тридевятое" => Переводы {
        en: "Thrice-Nine (27)",
        zh: "三九 (27)",
        ja: "三九 (27)",
        de: "Dreimalneun (27)",
        fr: "Trois-fois-neuf (27)",
        es: "Tres-veces-nueve (27)",
        ar: "ثلاثة في تسعة (27)",
        hi: "तीन-नौ (27)",
    },
    
    // Три богатыря
    "Три богатыря" => Переводы {
        en: "Three Bogatyrs (Heroes)",
        zh: "三勇士",
        ja: "三人の勇者",
        de: "Drei Recken",
        fr: "Trois Preux",
        es: "Tres Héroes",
        ar: "الأبطال الثلاثة",
        hi: "तीन वीर",
    },
    
    // Кощей Бессмертный
    "Кощей Бессмертный" => Переводы {
        en: "Koschei the Deathless",
        zh: "不死的科谢伊",
        ja: "不死身のコシチェイ",
        de: "Koschtschei der Unsterbliche",
        fr: "Kochtcheï l'Immortel",
        es: "Koschéi el Inmortal",
        ar: "كوشي الخالد",
        hi: "अमर कोशेई",
    },
    
    // Trinity Sort
    "Сортировка Троицы" => Переводы {
        en: "Trinity Sort",
        zh: "三位一体排序",
        ja: "トリニティソート",
        de: "Dreifaltigkeitssortierung",
        fr: "Tri Trinité",
        es: "Ordenamiento Trinidad",
        ar: "فرز الثالوث",
        hi: "त्रिमूर्ति क्रमबद्धता",
    },
    
    // Vibee OS
    "Живая Система" => Переводы {
        en: "Living System",
        zh: "活系统",
        ja: "生きているシステム",
        de: "Lebendes System",
        fr: "Système Vivant",
        es: "Sistema Vivo",
        ar: "نظام حي",
        hi: "जीवित प्रणाली",
    },
    
    // Три царства
    "Медное царство" => Переводы {
        en: "Copper Kingdom",
        zh: "铜王国",
        ja: "銅の王国",
        de: "Kupfernes Reich",
        fr: "Royaume de Cuivre",
        es: "Reino de Cobre",
        ar: "مملكة النحاس",
        hi: "तांबे का राज्य",
    },
    
    "Серебряное царство" => Переводы {
        en: "Silver Kingdom",
        zh: "银王国",
        ja: "銀の王国",
        de: "Silbernes Reich",
        fr: "Royaume d'Argent",
        es: "Reino de Plata",
        ar: "مملكة الفضة",
        hi: "चांदी का राज्य",
    },
    
    "Золотое царство" => Переводы {
        en: "Golden Kingdom",
        zh: "金王国",
        ja: "金の王国",
        de: "Goldenes Reich",
        fr: "Royaume d'Or",
        es: "Reino de Oro",
        ar: "مملكة الذهب",
        hi: "सोने का राज्य",
    },
};

// ═══════════════════════════════════════════════════════════════════════════
// СТРУКТУРА ПЕРЕВОДА
// ═══════════════════════════════════════════════════════════════════════════

struct ПереводКниги {
    язык: Язык,
    название: String,
    главы: Vec<ПереводГлавы>,
    глоссарий: HashMap<String, String>,
}

struct ПереводГлавы {
    номер: i32,
    название: String,
    содержание: String,
    
    /// Три уровня адаптации
    адаптация: УровеньАдаптации,
}

enum УровеньАдаптации {
    /// Дословный перевод
    Буквальный,
    
    /// Адаптация культурных отсылок
    Культурный,
    
    /// Полная локализация с местными сказками
    Локализованный,
}

// ═══════════════════════════════════════════════════════════════════════════
// КУЛЬТУРНЫЕ ЭКВИВАЛЕНТЫ
// ═══════════════════════════════════════════════════════════════════════════

/// Сказочные эквиваленты в разных культурах
const КУЛЬТУРНЫЕ_ЭКВИВАЛЕНТЫ: HashMap<&str, КультурныйЭквивалент> = {
    "Три богатыря" => КультурныйЭквивалент {
        en: "Three Musketeers / Knights of the Round Table",
        zh: "桃园三结义 (Три брата из Персикового сада)",
        ja: "三銃士 / 三人の侍",
        de: "Die drei Musketiere",
        ar: "الفرسان الثلاثة",
        hi: "तीन मूर्तियाँ (Тримурти)",
    },
    
    "Кощей Бессмертный" => КультурныйЭквивалент {
        en: "Lich / Voldemort (Horcrux = needle)",
        zh: "僵尸王 (Король зомби)",
        ja: "リッチ / 不死の魔王",
        de: "Der Lich / Unsterblicher Zauberer",
        ar: "الساحر الخالد",
        hi: "रावण (Равана с 10 головами)",
    },
    
    "Баба-Яга" => КультурныйЭквивалент {
        en: "Witch / Baba Yaga (kept as is)",
        zh: "巫婆 (Ведьма)",
        ja: "山姥 (Ямауба - горная ведьма)",
        de: "Die Hexe",
        ar: "الساحرة العجوز",
        hi: "चुड़ैल (Чудайл)",
    },
    
    "Жар-птица" => КультурныйЭквивалент {
        en: "Phoenix / Firebird",
        zh: "凤凰 (Фэнхуан)",
        ja: "火の鳥 / 鳳凰",
        de: "Der Feuervogel / Phönix",
        ar: "طائر النار / العنقاء",
        hi: "गरुड़ (Гаруда)",
    },
    
    "Тридевятое царство" => КультурныйЭквивалент {
        en: "Land of Far Far Away / Fairy Tale Kingdom",
        zh: "仙境 (Страна бессмертных)",
        ja: "おとぎの国 (Сказочная страна)",
        de: "Das Märchenreich",
        ar: "أرض العجائب",
        hi: "परीलोक (Мир фей)",
    },
};

// ═══════════════════════════════════════════════════════════════════════════
// ГЕНЕРАТОР ПЕРЕВОДОВ
// ═══════════════════════════════════════════════════════════════════════════

fn сгенерировать_перевод(
    глава: &Глава,
    язык: &Язык,
    уровень: УровеньАдаптации,
) -> ПереводГлавы {
    let mut содержание = глава.содержание.clone();
    
    // Шаг 1: Перевод терминов
    for (термин, переводы) in ТЕРМИНЫ.iter() {
        let перевод = переводы.get(язык.код);
        содержание = содержание.replace(термин, перевод);
    }
    
    // Шаг 2: Культурная адаптация (если нужно)
    if уровень >= УровеньАдаптации::Культурный {
        for (персонаж, эквиваленты) in КУЛЬТУРНЫЕ_ЭКВИВАЛЕНТЫ.iter() {
            let эквивалент = эквиваленты.get(язык.код);
            // Добавляем сноску с объяснением
            содержание = добавить_сноску(содержание, персонаж, эквивалент);
        }
    }
    
    // Шаг 3: Полная локализация (если нужно)
    if уровень == УровеньАдаптации::Локализованный {
        содержание = заменить_на_местные_сказки(содержание, язык);
    }
    
    ПереводГлавы {
        номер: глава.номер,
        название: перевести_название(глава.название, язык),
        содержание,
        адаптация: уровень,
    }
}

// ═══════════════════════════════════════════════════════════════════════════
// НАЗВАНИЯ КНИГИ НА 27 ЯЗЫКАХ
// ═══════════════════════════════════════════════════════════════════════════

const НАЗВАНИЯ_КНИГИ: [(&str, &str); 27] = [
    // ВОСТОК
    ("ru", "Тридевятое Царство Алгоритмов"),
    ("zh", "三九算法王国"),
    ("ja", "三九アルゴリズム王国"),
    ("ko", "삼구 알고리즘 왕국"),
    ("hi", "त्रि-नौ एल्गोरिदम साम्राज्य"),
    ("vi", "Vương Quốc Ba-Chín của Thuật Toán"),
    ("th", "อาณาจักรสามเก้าแห่งอัลกอริทึม"),
    ("id", "Kerajaan Tiga-Sembilan Algoritma"),
    ("mn", "Гурван есөн алгоритмын хаант улс"),
    
    // ЗАПАД
    ("en", "The Thrice-Nine Kingdom of Algorithms"),
    ("de", "Das Dreimalneun-Reich der Algorithmen"),
    ("fr", "Le Royaume des Trois-Neuf Algorithmes"),
    ("es", "El Reino de los Tres-Nueve Algoritmos"),
    ("it", "Il Regno dei Tre-Nove Algoritmi"),
    ("pt", "O Reino dos Três-Nove Algoritmos"),
    ("nl", "Het Drie-Negen Rijk der Algoritmen"),
    ("pl", "Królestwo Trzy-Dziewięć Algorytmów"),
    ("uk", "Тридев'яте Царство Алгоритмів"),
    
    // ЮГ
    ("ar", "مملكة الثلاثة والتسعة للخوارزميات"),
    ("he", "ממלכת השלוש-תשע של האלגוריתמים"),
    ("tr", "Üç-Dokuz Algoritma Krallığı"),
    ("fa", "پادشاهی سه-نه الگوریتم‌ها"),
    ("sw", "Ufalme wa Tatu-Tisa wa Algorithimu"),
    ("am", "የሦስት-ዘጠኝ አልጎሪዝም መንግሥት"),
    ("ur", "تین نو الگورتھم کی سلطنت"),
    ("bn", "তিন-নয় অ্যালগরিদম রাজ্য"),
    ("ta", "மூன்று-ஒன்பது அல்காரிதம் இராச்சியம்"),
];

// ═══════════════════════════════════════════════════════════════════════════
// МУДРОСТЬ
// ═══════════════════════════════════════════════════════════════════════════

// «Тридевятое царство говорит на всех языках,
//  ибо число Три — универсально.
//
//  В каждой культуре есть свои три богатыря,
//  свой Кощей Бессмертный,
//  своя Жар-птица.
//
//  Книга 999 — это мост между мирами,
//  переводчик между культурами,
//  единый язык алгоритмов.»
