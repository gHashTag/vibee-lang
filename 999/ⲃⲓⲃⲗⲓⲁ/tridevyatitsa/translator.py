#!/usr/bin/env python3
"""
ПЕРЕВОДЧИК ТРИДЕВЯТИЦЫ

Тридевятица → Русский → English → 其他语言

Исходный язык: Тридевятица (27 букв)
Все остальные языки — переводы!
"""

from typing import Dict, List, Tuple
from dataclasses import dataclass

# ═══════════════════════════════════════════════════════════════
# СЛОВАРЬ ТРИДЕВЯТИЦЫ
# ═══════════════════════════════════════════════════════════════

СЛОВАРЬ: Dict[str, Tuple[str, str, str]] = {
    # Тридевятица: (русский, english, 中文)
    
    # ЧИСЛА
    'Ⲁ': ('один', 'one', '一'),
    'Ⲃ': ('два', 'two', '二'),
    'Ⲅ': ('три', 'three', '三'),
    'Ⲇ': ('четыре', 'four', '四'),
    'Ⲉ': ('пять', 'five', '五'),
    'Ⲋ': ('шесть', 'six', '六'),
    'Ⲍ': ('семь', 'seven', '七'),
    'Ⲏ': ('восемь', 'eight', '八'),
    'Ⲑ': ('девять', 'nine', '九'),
    'Ⳃ': ('двадцать семь', 'twenty-seven', '二十七'),
    'ⲐⲐⲐ': ('девятьсот девяносто девять', 'nine hundred ninety-nine', '九百九十九'),
    
    # СУЩЕСТВА
    'ⲀⲄⲀⲂ': ('Иван', 'Ivan', '伊万'),
    'ⲀⲈⲀⲂ': ('Василиса', 'Vasilisa', '瓦西丽莎'),
    'ⲂⲀⲤⲎ': ('Кощей', 'Koschei', '科谢伊'),
    'ⲀⲎⲄⲄ': ('Змей Горыныч', 'Dragon', '三头龙'),
    'ⲀⲂ': ('человек', 'human', '人'),
    'ⲀⲄ': ('герой', 'hero', '英雄'),
    'ⲀⲆ': ('царь', 'king', '国王'),
    'ⲀⲈ': ('мудрец', 'sage', '智者'),
    'ⲂⲀ': ('враг', 'enemy', '敌人'),
    
    # МЕСТА
    'ⲂⲄⲨⲂ': ('Тридевятое царство', 'Thrice-Nine Kingdom', '三九王国'),
    'ⲂⲄⲀ': ('Медное царство', 'Copper Kingdom', '铜王国'),
    'ⲂⲄⲂ': ('Серебряное царство', 'Silver Kingdom', '银王国'),
    'ⲂⲄⲄ': ('Золотое царство', 'Golden Kingdom', '金王国'),
    'ⲂⲂ': ('дом', 'home', '家'),
    'ⲂⲄ': ('царство', 'kingdom', '王国'),
    'ⲂⲆ': ('мир', 'world', '世界'),
    'ⲂⲈ': ('путь', 'path', '道路'),
    'ⲂⲐ': ('море', 'sea', '海'),
    'ⲄⲀ': ('небо', 'sky', '天'),
    
    # ПРЕДМЕТЫ
    'ⲄⲂ': ('меч', 'sword', '剑'),
    'ⲄⲄ': ('щит', 'shield', '盾'),
    'ⲄⲆ': ('книга', 'book', '书'),
    'ⲄⲈ': ('ключ', 'key', '钥匙'),
    'ⲄⲊ': ('игла', 'needle', '针'),
    'ⲄⲌ': ('яйцо', 'egg', '蛋'),
    'ⲄⲎ': ('сундук', 'chest', '箱子'),
    'ⲄⲐ': ('камень', 'stone', '石头'),
    'ⲆⲀ': ('огонь', 'fire', '火'),
    
    # ГЛАГОЛЫ
    'ⲒⲀ': ('идти', 'go', '去'),
    'ⲒⲂ': ('видеть', 'see', '看'),
    'ⲒⲄ': ('знать', 'know', '知道'),
    'ⲒⲆ': ('делать', 'do', '做'),
    'ⲒⲈ': ('быть', 'be', '是'),
    'ⲒⲊ': ('иметь', 'have', '有'),
    'ⲒⲌ': ('давать', 'give', '给'),
    'ⲒⲎ': ('брать', 'take', '拿'),
    'ⲒⲐ': ('говорить', 'speak', '说'),
    
    # КАЧЕСТВА
    'ⲤⲀ': ('большой', 'big', '大'),
    'ⲤⲂ': ('малый', 'small', '小'),
    'ⲤⲄ': ('добрый', 'good', '好'),
    'ⲤⲆ': ('злой', 'evil', '恶'),
    'ⲤⲈ': ('мудрый', 'wise', '智慧'),
    'ⲤⲊ': ('сильный', 'strong', '强'),
    'ⲤⲌ': ('быстрый', 'fast', '快'),
    'ⲤⲎ': ('вечный', 'eternal', '永恒'),
    'ⲤⲐ': ('святой', 'holy', '神圣'),
    
    # АБСТРАКЦИИ
    'ⲦⲀ': ('истина', 'truth', '真理'),
    'ⲦⲂ': ('ложь', 'lie', '谎言'),
    'ⲦⲄ': ('любовь', 'love', '爱'),
    'ⲦⲆ': ('смерть', 'death', '死'),
    'ⲦⲈ': ('жизнь', 'life', '生'),
    'ⲦⲊ': ('время', 'time', '时间'),
    'ⲦⲌ': ('судьба', 'fate', '命运'),
    'ⲦⲎ': ('сила', 'power', '力量'),
    'ⲦⲐ': ('мудрость', 'wisdom', '智慧'),
    
    # СПЕЦИАЛЬНЫЕ (программирование)
    'ⲨⲀ': ('тройка', 'trinity', '三位一体'),
    'ⲨⲂ': ('тридевятое', 'thrice-nine', '三九'),
    'ⲨⲄ': ('царство', 'realm', '领域'),
    'ⲨⲆ': ('алгоритм', 'algorithm', '算法'),
    'ⲨⲈ': ('код', 'code', '代码'),
    'ⲨⲊ': ('сортировка', 'sort', '排序'),
    'ⲨⲌ': ('указатель', 'pointer', '指针'),
    'ⲨⲎ': ('память', 'memory', '内存'),
    'ⲨⲐ': ('процесс', 'process', '进程'),
    'ⲨⲊⲨⲀ': ('Trinity Sort', 'Trinity Sort', '三位一体排序'),
    'ⲨⲐⲂⲆ': ('Vibee OS', 'Vibee OS', 'Vibee操作系统'),
    'ⲨⲐⲀⲂ': ('пиксель', 'pixel', '像素'),
    
    # СЛУЖЕБНЫЕ
    'ⲂⲀⲒ': ('в', 'in', '在'),
    'ⲀⲀ': ('начало', 'beginning', '开始'),
    'ⲂⲆⲀⲂ': ('мироздание', 'universe', '宇宙'),
    'ⲨⲆⲀⲂ': ('книга', 'book', '书'),
    'ⲀⲖⲀⲂ': ('пролог', 'prologue', '序言'),
    'ⲀⲖⲂⲂ': ('эпилог', 'epilogue', '尾声'),
}

# ═══════════════════════════════════════════════════════════════
# ГРАММАТИКА
# ═══════════════════════════════════════════════════════════════

ПАДЕЖИ = {
    'Ⲁ': 'именительный',  # кто? что?
    'Ⲉ': 'действенный',   # что делает?
    'Ⲟ': 'направленный',  # куда?
}

ВРЕМЕНА = {
    'Ⲃ': 'прошлое',    # префикс
    '': 'настоящее',   # без изменений
    'Ⲅ': 'будущее',    # префикс
}

ЧИСЛА = {
    '': 'единственное',
    'Ⲃ': 'двойственное',
    'Ⲅ': 'множественное',
}

# ═══════════════════════════════════════════════════════════════
# ФУНКЦИИ ПЕРЕВОДА
# ═══════════════════════════════════════════════════════════════

def перевести_слово(слово: str, язык: str = 'ru') -> str:
    """Переводит одно слово"""
    idx = {'ru': 0, 'en': 1, 'zh': 2}.get(язык, 0)
    
    if слово in СЛОВАРЬ:
        return СЛОВАРЬ[слово][idx]
    
    # Пробуем найти по частям
    for ключ in sorted(СЛОВАРЬ.keys(), key=len, reverse=True):
        if слово.startswith(ключ):
            остаток = слово[len(ключ):]
            if остаток:
                return СЛОВАРЬ[ключ][idx] + ' ' + перевести_слово(остаток, язык)
            return СЛОВАРЬ[ключ][idx]
    
    return f'[{слово}]'

def перевести_текст(текст: str, язык: str = 'ru') -> str:
    """Переводит текст на Тридевятице"""
    слова = текст.split()
    переведённые = [перевести_слово(слово, язык) for слово in слова]
    return ' '.join(переведённые)

def перевести_главу(глава: str, язык: str = 'ru') -> str:
    """Переводит целую главу"""
    строки = глава.split('\n')
    результат = []
    
    в_блоке_кода = False
    
    for строка in строки:
        if строка.startswith('```'):
            в_блоке_кода = not в_блоке_кода
            результат.append(строка)
        elif в_блоке_кода:
            результат.append(строка)  # Код не переводим
        elif строка.strip():
            # Переводим текст
            результат.append(перевести_текст(строка, язык))
        else:
            результат.append(строка)
    
    return '\n'.join(результат)

# ═══════════════════════════════════════════════════════════════
# ГЕНЕРАЦИЯ КНИГИ НА ВСЕХ ЯЗЫКАХ
# ═══════════════════════════════════════════════════════════════

def сгенерировать_главу(номер: int) -> Dict[str, str]:
    """Генерирует главу на всех языках"""
    
    # Исходник на Тридевятице
    тридевятица = f"""
# ⲄⲆ{номер}: ⲨⲀ ⲦⲀ

ⲂⲀⲒ ⲄⲆ {номер}, ⲀⲄⲀⲂ ⲒⲄ ⲨⲀ.
ⲨⲀ ⲒⲈ Ⲅ.
Ⲅ ⲒⲈ ⲂⲆⲀⲂ ⲦⲀ.

ⲒⲆ ⲄⲄ ⲂⲎⲀⲂ:
  ⲂⲎⲀⲂⲀ — ⲤⲀ
  ⲂⲎⲀⲂⲂ — ⲤⲂ
  ⲂⲎⲀⲂⲄ — ⲤⲄ

ⲒⲀ ⲂⲈ ⲨⲀ, ⲀⲄⲀⲂ!
"""
    
    return {
        'tridevyatitsa': тридевятица,
        'ru': перевести_главу(тридевятица, 'ru'),
        'en': перевести_главу(тридевятица, 'en'),
        'zh': перевести_главу(тридевятица, 'zh'),
    }

# ═══════════════════════════════════════════════════════════════
# ТЕСТ
# ═══════════════════════════════════════════════════════════════

if __name__ == "__main__":
    print("═" * 60)
    print("ПЕРЕВОДЧИК ТРИДЕВЯТИЦЫ")
    print("═" * 60)
    
    # Тестовые фразы
    тесты = [
        "ⲨⲀ ⲒⲈ ⲦⲀ",
        "ⲀⲄⲀⲂ ⲒⲀ ⲂⲄⲨⲂ",
        "ⲂⲀⲤⲎ ⲒⲈ ⲂⲀ ⲤⲎ",
        "ⲒⲆ ⲤⲄ",
    ]
    
    print("\nПримеры перевода:")
    print("-" * 60)
    
    for тест in тесты:
        print(f"\nТридевятица: {тест}")
        print(f"Русский:     {перевести_текст(тест, 'ru')}")
        print(f"English:     {перевести_текст(тест, 'en')}")
        print(f"中文:        {перевести_текст(тест, 'zh')}")
    
    print("\n" + "═" * 60)
    print("ГЕНЕРАЦИЯ ГЛАВЫ 1")
    print("═" * 60)
    
    глава = сгенерировать_главу(1)
    
    print("\n--- ТРИДЕВЯТИЦА (исходник) ---")
    print(глава['tridevyatitsa'][:300])
    
    print("\n--- РУССКИЙ ---")
    print(глава['ru'][:300])
    
    print("\n--- ENGLISH ---")
    print(глава['en'][:300])
    
    print("\n--- 中文 ---")
    print(глава['zh'][:300])
