// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// â²¦â²ˆâ²¬â²šâ²â²–â²â²„â²’â²€ â²†â²ˆâ²¢â²ˆâ²‚â² - Auto-Generated Technology Tree
// Inspired by: Civilization VI, Factorio, Stellaris
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â²® â²§â²‰â²­â²›â²

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TECHNOLOGY STATUS (Fog of War)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â¬¢ TechStatus {
    Researched,    // âœ… ĞŸĞ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ¸Ğ·ÑƒÑ‡ĞµĞ½Ğ¾
    InProgress,    // ğŸ”„ Ğ’ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞµ Ğ¸ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
    Available,     // ğŸ”“ Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ Ğ´Ğ»Ñ Ğ¸Ğ·ÑƒÑ‡ĞµĞ½Ğ¸Ñ
    Locked,        // ğŸ”’ Ğ—Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾ (Ğ½ÑƒĞ¶Ğ½Ñ‹ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸)
    FogOfWar,      // ğŸŒ«ï¸ Ğ¡ĞºÑ€Ñ‹Ñ‚Ğ¾ Ñ‚ÑƒĞ¼Ğ°Ğ½Ğ¾Ğ¼ Ğ²Ğ¾Ğ¹Ğ½Ñ‹
    Future         // ğŸ”® Ğ‘ÑƒĞ´ÑƒÑ‰Ğ°Ñ Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ (roadmap)
}

â¬¢ TechEra {
    Ancient,       // â²€â²£â²­â²â²“â² - Ğ”Ñ€ĞµĞ²Ğ½ÑÑ ÑÑ€Ğ°
    Classical,     // â²”â²—â²â²¥â²“â²•â² - ĞšĞ»Ğ°ÑÑĞ¸Ñ‡ĞµÑĞºĞ°Ñ
    Medieval,      // â²˜â²‰â²¥â²â²“â² - Ğ¡Ñ€ĞµĞ´Ğ½ĞµĞ²ĞµĞºĞ¾Ğ²ÑŒĞµ
    Renaissance,   // â²€â²›â²â²…â²‰â²›â²›â²â²¥â²“â²¥ - Ğ’Ğ¾Ğ·Ñ€Ğ¾Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ
    Industrial,    // â²‚â²“â²Ÿâ²™â²â²­â²â²›â²“â² - Ğ˜Ğ½Ğ´ÑƒÑÑ‚Ñ€Ğ¸Ğ°Ğ»ÑŒĞ½Ğ°Ñ
    Modern,        // â²šâ²‰â² - Ğ¡Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ
    Atomic,        // â²€â²§â²Ÿâ²™â²“â²•â² - ĞÑ‚Ğ¾Ğ¼Ğ½Ğ°Ñ
    Information,   // â² â²—â²â²£â²Ÿâ²«â²Ÿâ²£â²“â² - Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ğ°Ñ
    Future         // â²˜â²‰â²—â²—â²Ÿâ²› - Ğ‘ÑƒĞ´ÑƒÑ‰ĞµĞµ
}

â¬¢ TechCategory {
    Core,          // â²”â²Ÿâ²£â²‰ - Ğ¯Ğ´Ñ€Ğ¾ ÑĞ·Ñ‹ĞºĞ°
    Syntax,        // â²¤â²©â²›â²§â²â²â²“â²¥ - Ğ¡Ğ¸Ğ½Ñ‚Ğ°ĞºÑĞ¸Ñ
    Types,         // â²¦â²©â²¡â²Ÿâ²¥ - Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ñ‚Ğ¸Ğ¿Ğ¾Ğ²
    Optimization,  // â²â²¡â²§â²“â²™â²â²— - ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
    Runtime,       // â²¢â²â²›â²§â²â²“â²™ - Ğ Ğ°Ğ½Ñ‚Ğ°Ğ¹Ğ¼
    Ternary,       // â²¦â²£â²“â²§ - Ğ¢Ñ€Ğ¾Ğ¸Ñ‡Ğ½Ğ°Ñ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°
    Quantum,       // â²”â²ƒâ²â²›â²§ - ĞšĞ²Ğ°Ğ½Ñ‚Ğ¾Ğ²Ñ‹Ğµ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ
    AI,            // â²šâ²Ÿâ²â²§â²“â²¥ - Ğ˜Ğ˜/ML
    Security,      // â²€â²¥â²«â²â²—â²‰â²“â² - Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ
    Parallel       // â² â²â²£â²â²—â²—â²â²— - ĞŸĞ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»Ğ¸Ğ·Ğ¼
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TECHNOLOGY NODE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â² TechNode {
    â²‚ id: â²¦â²‰â²â²§                    // Ğ£Ğ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ID
    â²‚ name: â²¦â²‰â²â²§                  // ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ° ĞºĞ¾Ğ¿Ñ‚ÑĞºĞ¾Ğ¼
    â²‚ name_ru: â²¦â²‰â²â²§               // ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ° Ñ€ÑƒÑÑĞºĞ¾Ğ¼
    â²‚ description: â²¦â²‰â²â²§           // ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ
    â²‚ era: TechEra                // Ğ­Ñ€Ğ°
    â²‚ category: TechCategory      // ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ
    â²‚ status: TechStatus          // Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ğ¸ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
    â²‚ dependencies: [â²¦â²‰â²â²§]        // Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ (ID)
    â²‚ unlocks: [â²¦â²‰â²â²§]             // Ğ§Ñ‚Ğ¾ Ğ¾Ñ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚
    â²‚ files: [â²¦â²‰â²â²§]               // Ğ¤Ğ°Ğ¹Ğ»Ñ‹ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
    â²‚ speedup: â²ª64                // ĞœĞ½Ğ¾Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
    â²‚ research_cost: â²’â²›â²§          // Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ¸ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
    â²‚ research_progress: â²’â²›â²§      // ĞŸÑ€Ğ¾Ğ³Ñ€ĞµÑÑ Ğ¸ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
    â²‚ icon: â²¦â²‰â²â²§                  // Ğ˜ĞºĞ¾Ğ½ĞºĞ° (emoji/unicode)
    â²‚ x: â²’â²›â²§                      // ĞŸĞ¾Ğ·Ğ¸Ñ†Ğ¸Ñ X Ğ² Ğ´ĞµÑ€ĞµĞ²Ğµ
    â²‚ y: â²’â²›â²§                      // ĞŸĞ¾Ğ·Ğ¸Ñ†Ğ¸Ñ Y Ğ² Ğ´ĞµÑ€ĞµĞ²Ğµ
    
    â²ª new(â²€ id: â²¦â²‰â²â²§, â²€ name: â²¦â²‰â²â²§) â†’ TechNode {
        â²¢ TechNode {
            id: id,
            name: name,
            name_ru: "",
            description: "",
            era: TechEra.Ancient,
            category: TechCategory.Core,
            status: TechStatus.FogOfWar,
            dependencies: [],
            unlocks: [],
            files: [],
            speedup: 1.0,
            research_cost: 100,
            research_progress: 0,
            icon: "ğŸ”¬",
            x: 0,
            y: 0
        }
    }
    
    â²ª is_available(â²¤, â²€ tree: TechTree) â†’ Trit {
        â²ˆ â²¤.status == TechStatus.Researched { â²¢ â–½ }
        â²ˆ â²¤.status == TechStatus.InProgress { â²¢ â–³ }
        
        // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ²ÑĞµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
        â²œ dep_id âˆˆ â²¤.dependencies {
            â²‚ dep = tree.get_node(dep_id)
            â²ˆ dep == â—‹ || dep.status != TechStatus.Researched {
                â²¢ â–½
            }
        }
        â²¢ â–³
    }
    
    â²ª progress_percent(â²¤) â†’ â²’â²›â²§ {
        â²ˆ â²¤.research_cost == 0 { â²¢ 100 }
        â²¢ â²¤.research_progress * 100 / â²¤.research_cost
    }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TECHNOLOGY TREE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â² TechTree {
    â²‚ nodes: â²˜â²â²¡[â²¦â²‰â²â²§, TechNode]
    â²‚ root_path: â²¦â²‰â²â²§
    â²‚ total_speedup: â²ª64
    
    â²ª new(â²€ root_path: â²¦â²‰â²â²§) â†’ TechTree {
        â²¢ TechTree {
            nodes: {},
            root_path: root_path,
            total_speedup: 1.0
        }
    }
    
    â²ª add_node(â²¤, â²€ node: TechNode) {
        â²¤.nodes.set(node.id, node)
    }
    
    â²ª get_node(â²¤, â²€ id: â²¦â²‰â²â²§) â†’ TechNode? {
        â²¢ â²¤.nodes.get(id)
    }
    
    // Ğ¡ĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²ÑƒÑ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Ğ¸ Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Ğ´ĞµÑ€ĞµĞ²Ğ¾
    â²ª scan_filesystem(â²¤) {
        â²‚ dirs = fs_list_dirs(â²¤.root_path)
        
        â²œ dir âˆˆ dirs {
            â²‚ category = â²¤.dir_to_category(dir)
            â²‚ files = fs_list_files(â²¤.root_path + "/" + dir, "*.999")
            
            â²œ file âˆˆ files {
                â²‚ node = â²¤.parse_tech_file(dir, file)
                â²ˆ node != â—‹ {
                    â²¤.add_node(node)
                }
            }
        }
        
        // ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑÑ‹
        â²¤.update_statuses()
        // Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸
        â²¤.calculate_positions()
        // Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Ğ¾Ğ±Ñ‰Ğ¸Ğ¹ speedup
        â²¤.calculate_total_speedup()
    }
    
    // ĞŸĞ°Ñ€ÑĞ¸Ñ‚ÑŒ Ñ„Ğ°Ğ¹Ğ» Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸
    â²ª parse_tech_file(â²¤, â²€ dir: â²¦â²‰â²â²§, â²€ file: â²¦â²‰â²â²§) â†’ TechNode? {
        â²‚ content = fs_read(â²¤.root_path + "/" + dir + "/" + file)
        â²ˆ content == â—‹ { â²¢ â—‹ }
        
        â²‚ id = file.replace(".999", "")
        â²‚ node = TechNode.new(id, id)
        node.category = â²¤.dir_to_category(dir)
        node.files = [dir + "/" + file]
        
        // ĞŸĞ°Ñ€ÑĞ¸Ñ‚ÑŒ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸Ğ· ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸ĞµĞ²
        â²‚ lines = content.split("\n")
        â²œ line âˆˆ lines {
            â²ˆ line.starts_with("// @name:") {
                node.name = line.replace("// @name:", "").trim()
            }
            â²ˆ line.starts_with("// @name_ru:") {
                node.name_ru = line.replace("// @name_ru:", "").trim()
            }
            â²ˆ line.starts_with("// @era:") {
                node.era = â²¤.parse_era(line.replace("// @era:", "").trim())
            }
            â²ˆ line.starts_with("// @depends:") {
                node.dependencies = line.replace("// @depends:", "").trim().split(",")
            }
            â²ˆ line.starts_with("// @speedup:") {
                node.speedup = line.replace("// @speedup:", "").trim().parse_float()
            }
            â²ˆ line.starts_with("// @icon:") {
                node.icon = line.replace("// @icon:", "").trim()
            }
        }
        
        // ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ Ğ¿Ğ¾ Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ñ Ñ‚ĞµÑÑ‚Ğ¾Ğ²
        â²ˆ content.contains("âŠ¡ test") {
            node.status = TechStatus.Researched
            node.research_progress = node.research_cost
        } â²€ â²ˆ content.len() > 100 {
            node.status = TechStatus.InProgress
            node.research_progress = node.research_cost / 2
        }
        
        â²¢ node
    }
    
    â²ª dir_to_category(â²¤, â²€ dir: â²¦â²‰â²â²§) â†’ TechCategory {
        â²ˆ dir == "â²•â²‰â²£â²›â²‰â²—" || dir == "â²•â²Ÿâ²£â²‰" { â²¢ TechCategory.Core }
        â²ˆ dir == "â²¥â²©â²›â²§â²â²â²“â²¥" || dir == "â²—â²‰â²â²“â²¥" { â²¢ TechCategory.Syntax }
        â²ˆ dir == "â²§â²©â²¡â²Ÿâ²¥" { â²¢ TechCategory.Types }
        â²ˆ dir == "â²Ÿâ²¡â²§â²“â²™â²â²—" { â²¢ TechCategory.Optimization }
        â²ˆ dir == "â²£â²â²›â²§â²â²“â²™" { â²¢ TechCategory.Runtime }
        â²ˆ dir == "â²§â²£â²“â²§" { â²¢ TechCategory.Ternary }
        â²ˆ dir == "â²•â²ƒâ²â²›â²§" { â²¢ TechCategory.Quantum }
        â²ˆ dir == "â²›â²Ÿâ²â²§â²“â²¥" { â²¢ TechCategory.AI }
        â²ˆ dir == "â²â²¥â²«â²â²—â²‰â²“â²" || dir == "â²•â²£â²©â²¡â²§â²Ÿâ²¥" { â²¢ TechCategory.Security }
        â²ˆ dir == "â²¡â²â²£â²â²—â²—â²â²—" { â²¢ TechCategory.Parallel }
        â²¢ TechCategory.Core
    }
    
    â²ª parse_era(â²¤, â²€ s: â²¦â²‰â²â²§) â†’ TechEra {
        â²ˆ s == "ancient" { â²¢ TechEra.Ancient }
        â²ˆ s == "classical" { â²¢ TechEra.Classical }
        â²ˆ s == "medieval" { â²¢ TechEra.Medieval }
        â²ˆ s == "renaissance" { â²¢ TechEra.Renaissance }
        â²ˆ s == "industrial" { â²¢ TechEra.Industrial }
        â²ˆ s == "modern" { â²¢ TechEra.Modern }
        â²ˆ s == "atomic" { â²¢ TechEra.Atomic }
        â²ˆ s == "information" { â²¢ TechEra.Information }
        â²ˆ s == "future" { â²¢ TechEra.Future }
        â²¢ TechEra.Modern
    }
    
    // ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑÑ‹ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹
    â²ª update_statuses(â²¤) {
        â²‚ changed = â–³
        â²œ changed == â–³ {
            changed = â–½
            â²œ (id, node) âˆˆ â²¤.nodes {
                â²ˆ node.status == TechStatus.FogOfWar || node.status == TechStatus.Locked {
                    â²ˆ node.is_available(â²¤) == â–³ {
                        node.status = TechStatus.Available
                        changed = â–³
                    } â²€ {
                        // ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ, Ğ²Ğ¸Ğ´Ğ½Ğ° Ğ»Ğ¸ Ñ…Ğ¾Ñ‚Ñ Ğ±Ñ‹ Ğ¾Ğ´Ğ½Ğ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ÑŒ
                        â²‚ any_visible = â–½
                        â²œ dep_id âˆˆ node.dependencies {
                            â²‚ dep = â²¤.get_node(dep_id)
                            â²ˆ dep != â—‹ && dep.status != TechStatus.FogOfWar {
                                any_visible = â–³
                                âŠ˜
                            }
                        }
                        â²ˆ any_visible == â–³ {
                            node.status = TechStatus.Locked
                        }
                    }
                }
            }
        }
    }
    
    // Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸ Ğ´Ğ»Ñ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
    â²ª calculate_positions(â²¤) {
        // Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ ÑÑ€Ğ°Ğ¼ (X) Ğ¸ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸ÑĞ¼ (Y)
        â²‚ era_x: â²˜â²â²¡[TechEra, â²’â²›â²§] = {
            TechEra.Ancient: 0,
            TechEra.Classical: 1,
            TechEra.Medieval: 2,
            TechEra.Renaissance: 3,
            TechEra.Industrial: 4,
            TechEra.Modern: 5,
            TechEra.Atomic: 6,
            TechEra.Information: 7,
            TechEra.Future: 8
        }
        
        â²‚ category_y: â²˜â²â²¡[TechCategory, â²’â²›â²§] = {
            TechCategory.Core: 0,
            TechCategory.Syntax: 1,
            TechCategory.Types: 2,
            TechCategory.Optimization: 3,
            TechCategory.Runtime: 4,
            TechCategory.Ternary: 5,
            TechCategory.Quantum: 6,
            TechCategory.AI: 7,
            TechCategory.Security: 8,
            TechCategory.Parallel: 9
        }
        
        // Ğ¡Ñ‡ĞµÑ‚Ñ‡Ğ¸ĞºĞ¸ Ğ´Ğ»Ñ ÑĞ¼ĞµÑ‰ĞµĞ½Ğ¸Ñ Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ ÑÑ‡ĞµĞ¹ĞºĞ¸
        â²‚ cell_counts: â²˜â²â²¡[â²¦â²‰â²â²§, â²’â²›â²§] = {}
        
        â²œ (id, node) âˆˆ â²¤.nodes {
            â²‚ base_x = era_x.get(node.era) * 200
            â²‚ base_y = category_y.get(node.category) * 100
            
            â²‚ cell_key = node.era.to_string() + "_" + node.category.to_string()
            â²‚ offset = cell_counts.get(cell_key) ?? 0
            cell_counts.set(cell_key, offset + 1)
            
            node.x = base_x + (offset % 3) * 60
            node.y = base_y + (offset / 3) * 40
        }
    }
    
    // Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Ğ¾Ğ±Ñ‰Ğ¸Ğ¹ Ğ¼Ğ½Ğ¾Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
    â²ª calculate_total_speedup(â²¤) {
        â²¤.total_speedup = 1.0
        â²œ (id, node) âˆˆ â²¤.nodes {
            â²ˆ node.status == TechStatus.Researched {
                â²¤.total_speedup *= node.speedup
            }
        }
    }
    
    // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ
    â²ª stats(â²¤) â†’ TechStats {
        â²‚ total = 0
        â²‚ researched = 0
        â²‚ in_progress = 0
        â²‚ available = 0
        â²‚ locked = 0
        â²‚ fog = 0
        â²‚ future = 0
        
        â²œ (id, node) âˆˆ â²¤.nodes {
            total += 1
            â²ˆ node.status == TechStatus.Researched { researched += 1 }
            â²ˆ node.status == TechStatus.InProgress { in_progress += 1 }
            â²ˆ node.status == TechStatus.Available { available += 1 }
            â²ˆ node.status == TechStatus.Locked { locked += 1 }
            â²ˆ node.status == TechStatus.FogOfWar { fog += 1 }
            â²ˆ node.status == TechStatus.Future { future += 1 }
        }
        
        â²¢ TechStats {
            total: total,
            researched: researched,
            in_progress: in_progress,
            available: available,
            locked: locked,
            fog_of_war: fog,
            future: future,
            total_speedup: â²¤.total_speedup
        }
    }
}

â² TechStats {
    â²‚ total: â²’â²›â²§
    â²‚ researched: â²’â²›â²§
    â²‚ in_progress: â²’â²›â²§
    â²‚ available: â²’â²›â²§
    â²‚ locked: â²’â²›â²§
    â²‚ fog_of_war: â²’â²›â²§
    â²‚ future: â²’â²›â²§
    â²‚ total_speedup: â²ª64
    
    â²ª progress_percent(â²¤) â†’ â²’â²›â²§ {
        â²ˆ â²¤.total == 0 { â²¢ 0 }
        â²¢ â²¤.researched * 100 / â²¤.total
    }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FUTURE TECHNOLOGIES (ROADMAP)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â²ª add_future_techs(â²€ tree: TechTree) {
    // Quantum Computing
    â²‚ quantum_sim = TechNode.new("quantum_sim", "â²”â²ƒâ²â²›â²§â²Ÿâ²™ â²¤â²“â²™")
    quantum_sim.name_ru = "ĞšĞ²Ğ°Ğ½Ñ‚Ğ¾Ğ²Ñ‹Ğ¹ ÑĞ¸Ğ¼ÑƒĞ»ÑÑ‚Ğ¾Ñ€"
    quantum_sim.era = TechEra.Future
    quantum_sim.category = TechCategory.Quantum
    quantum_sim.status = TechStatus.Future
    quantum_sim.speedup = 100.0
    quantum_sim.icon = "âš›ï¸"
    quantum_sim.dependencies = ["ttq", "work_stealing"]
    tree.add_node(quantum_sim)
    
    // Neural Compiler
    â²‚ neural_compiler = TechNode.new("neural_compiler", "â²šâ²‰â²©â²£â²Ÿ â²”â²Ÿâ²™â²¡â²“â²—â²‰â²£")
    neural_compiler.name_ru = "ĞĞµĞ¹Ñ€Ğ¾ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ‚Ğ¾Ñ€"
    neural_compiler.era = TechEra.Future
    neural_compiler.category = TechCategory.AI
    neural_compiler.status = TechStatus.Future
    neural_compiler.speedup = 10.0
    neural_compiler.icon = "ğŸ§ "
    neural_compiler.dependencies = ["egraph_full", "ttq"]
    tree.add_node(neural_compiler)
    
    // Self-Evolving Code
    â²‚ self_evolve = TechNode.new("self_evolve", "â²€â²©â²§â²Ÿ â²ˆâ²ƒâ²Ÿâ²—â²©â²§â²“â²Ÿ")
    self_evolve.name_ru = "Ğ¡Ğ°Ğ¼Ğ¾ÑĞ²Ğ¾Ğ»ÑÑ†Ğ¸Ñ ĞºĞ¾Ğ´Ğ°"
    self_evolve.era = TechEra.Future
    self_evolve.category = TechCategory.AI
    self_evolve.status = TechStatus.Future
    self_evolve.speedup = 1000.0
    self_evolve.icon = "ğŸ¦‹"
    self_evolve.dependencies = ["neural_compiler", "quantum_sim"]
    tree.add_node(self_evolve)
    
    // Ternary Quantum Gates
    â²‚ ternary_quantum = TechNode.new("ternary_quantum", "â²¦â²£â²“â²§ â²”â²ƒâ²â²›â²§â²Ÿâ²™")
    ternary_quantum.name_ru = "Ğ¢Ñ€Ğ¾Ğ¸Ñ‡Ğ½Ñ‹Ğµ ĞºĞ²Ğ°Ğ½Ñ‚Ğ¾Ğ²Ñ‹Ğµ Ğ²ĞµĞ½Ñ‚Ğ¸Ğ»Ğ¸"
    ternary_quantum.era = TechEra.Future
    ternary_quantum.category = TechCategory.Quantum
    ternary_quantum.status = TechStatus.Future
    ternary_quantum.speedup = 50.0
    ternary_quantum.icon = "ğŸ”º"
    ternary_quantum.dependencies = ["balanced", "quantum_sim"]
    tree.add_node(ternary_quantum)
    
    // Holographic Memory
    â²‚ holo_mem = TechNode.new("holo_memory", "â²â²—â²Ÿ â²˜â²›â²â²™â²")
    holo_mem.name_ru = "Ğ“Ğ¾Ğ»Ğ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ"
    holo_mem.era = TechEra.Future
    holo_mem.category = TechCategory.Runtime
    holo_mem.status = TechStatus.Future
    holo_mem.speedup = 20.0
    holo_mem.icon = "ğŸ’"
    holo_mem.dependencies = ["packing", "work_stealing"]
    tree.add_node(holo_mem)
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MAIN ENTRY POINT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â²ª build_tech_tree(â²€ root_path: â²¦â²‰â²â²§) â†’ TechTree {
    â²‚ tree = TechTree.new(root_path)
    
    // Ğ¡ĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹
    tree.scan_filesystem()
    
    // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ±ÑƒĞ´ÑƒÑ‰Ğ¸Ğµ Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸
    add_future_techs(tree)
    
    // ĞŸĞµÑ€ĞµÑÑ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑÑ‹ Ğ¸ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸
    tree.update_statuses()
    tree.calculate_positions()
    tree.calculate_total_speedup()
    
    â²¢ tree
}
