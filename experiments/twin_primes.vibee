name: twin_primes
version: "1.0.0"
language: zig
module: twin_primes
description: |
  Creation Pattern Test: Twin Prime Conjecture
  Source: Prime number p
  Transformer: Check if p+2 is also prime (filter)
  Result: Twin prime pair (p, p+2)

behaviors:
  - name: is_twin_prime
    given: A prime number p
    when: is_twin_prime is called with p
    then: Returns true if p and p+2 are both prime
    test_cases:
      - name: twin_3
        input: {p: 3}
        expected: {is_twin: true, pair: [3, 5]}
      - name: twin_5
        input: {p: 5}
        expected: {is_twin: true, pair: [5, 7]}
      - name: twin_11
        input: {p: 11}
        expected: {is_twin: true, pair: [11, 13]}
      - name: not_twin_7
        input: {p: 7}
        expected: {is_twin: false, pair: null}
      - name: twin_41
        input: {p: 41}
        expected: {is_twin: true, pair: [41, 43]}

  - name: find_twin_primes_up_to
    given: A limit n
    when: find_twin_primes is called with n
    then: Returns all twin prime pairs up to n
    test_cases:
      - name: twins_up_to_20
        input: {limit: 20}
        expected: {pairs: [[3,5], [5,7], [11,13], [17,19]], count: 4}
      - name: twins_up_to_100
        input: {limit: 100}
        expected: {count: 8}
      - name: twins_up_to_1000
        input: {limit: 1000}
        expected: {count: 35}

  - name: twin_prime_density
    given: A range from start to end
    when: twin_prime_density is calculated
    then: Returns ratio of twin primes to all primes in range
    test_cases:
      - name: density_1_to_100
        input: {start: 1, end: 100}
        expected: {twin_count: 8, prime_count: 25}
      - name: density_1_to_1000
        input: {start: 1, end: 1000}
        expected: {twin_count: 35, prime_count: 168}

  - name: creation_pattern_twins
    given: Source prime p and Transformer twin_filter
    when: CREATE is applied to check twin property
    then: Returns creation result with twin status
    test_cases:
      - name: create_twin_from_17
        input: {source: 17}
        expected: {transformer: "twin_filter", result: [17, 19], created: true}
      - name: create_twin_from_23
        input: {source: 23}
        expected: {transformer: "twin_filter", result: null, created: false}
      - name: create_twin_from_29
        input: {source: 29}
        expected: {transformer: "twin_filter", result: [29, 31], created: true}

  - name: hardy_littlewood_prediction
    given: A limit n
    when: comparing actual twin count to Hardy-Littlewood prediction
    then: Returns ratio of actual to predicted
    test_cases:
      - name: hl_1000
        input: {limit: 1000}
        expected: {actual: 35, predicted_approx: 35, ratio_near_one: true}
      - name: hl_10000
        input: {limit: 10000}
        expected: {actual: 205, predicted_approx: 214, ratio_near_one: true}

types:
  TwinPair:
    first: int
    second: int

  TwinResult:
    is_twin: bool
    pair: [int]?

  TwinList:
    pairs: [[int]]
    count: int

  DensityResult:
    twin_count: int
    prime_count: int
    density: float

  CreationTwin:
    source: int
    transformer: str
    result: [int]?
    created: bool

  HLComparison:
    actual: int
    predicted_approx: int
    ratio_near_one: bool

functions:
  - name: is_prime
    params: {n: int}
    returns: bool

  - name: is_twin_prime
    params: {p: int}
    returns: TwinResult

  - name: find_twin_primes
    params: {limit: int}
    returns: TwinList

  - name: twin_prime_density
    params: {start: int, end: int}
    returns: DensityResult

  - name: create_twin
    params: {source: int}
    returns: CreationTwin

  - name: hardy_littlewood_compare
    params: {limit: int}
    returns: HLComparison
