name: maxwell_equations
version: "1.0.0"
language: zig
module: maxwell
description: |
  Паттерн Творения: Электромагнетизм (Уравнения Максвелла)
  
  Источник: Заряды и токи (ρ, J)
  Трансформер: Уравнения Максвелла
  Результат: Электромагнитные поля (E, B)
  
  Четыре уравнения Максвелла:
  1. ∇·E = ρ/ε₀ (закон Гаусса для E)
  2. ∇·B = 0 (закон Гаусса для B, нет магнитных монополей)
  3. ∇×E = -∂B/∂t (закон Фарадея)
  4. ∇×B = μ₀J + μ₀ε₀∂E/∂t (закон Ампера-Максвелла)

creation_pattern:
  source: ChargeCurrentDistribution
  transformer: maxwell_equations
  result: ElectromagneticField
  iteration: until_condition
  condition: steady_state

behaviors:
  # Закон Гаусса для электрического поля
  - name: gauss_law_electric
    given: Точечный заряд q
    when: Вычисляется поток E через сферу
    then: Φ_E = q/ε₀
    test_cases:
      - name: point_charge_flux
        input: {q: 1e-9, r: 1}
        expected: {flux: 113.1}
      - name: point_charge_field
        input: {q: 1e-9, r: 1}
        expected: {E: 8.99}

  # Закон Гаусса для магнитного поля
  - name: gauss_law_magnetic
    given: Любая замкнутая поверхность
    when: Вычисляется поток B
    then: Φ_B = 0 (нет магнитных монополей)
    test_cases:
      - name: magnetic_flux_closed
        input: {any_surface: true}
        expected: {flux: 0}

  # Закон Фарадея
  - name: faraday_law
    given: Изменяющееся магнитное поле
    when: Вычисляется ЭДС индукции
    then: ε = -dΦ_B/dt
    test_cases:
      - name: changing_flux
        input: {dPhi_dt: 0.1}
        expected: {emf: -0.1}
      - name: rotating_coil
        input: {B: 0.5, A: 0.01, omega: 100, t: 0}
        expected: {emf: 0.5}

  # Закон Ампера-Максвелла
  - name: ampere_maxwell_law
    given: Ток I в проводнике
    when: Вычисляется магнитное поле
    then: B = μ₀I/(2πr)
    test_cases:
      - name: wire_field
        input: {I: 1, r: 0.1}
        expected: {B: 2e-6}

  # Электромагнитные волны
  - name: electromagnetic_waves
    given: Колеблющиеся E и B поля
    when: Распространяются в вакууме
    then: c = 1/√(μ₀ε₀)
    test_cases:
      - name: speed_of_light
        input: {}
        expected: {c: 299792458}

  # Закон Кулона
  - name: coulomb_law
    given: Два точечных заряда
    when: Вычисляется сила взаимодействия
    then: F = kq₁q₂/r²
    test_cases:
      - name: two_electrons
        input: {q1: 1.6e-19, q2: 1.6e-19, r: 1e-10}
        expected: {F: 2.3e-8}

  # Закон Био-Савара
  - name: biot_savart_law
    given: Элемент тока Idl
    when: Вычисляется магнитное поле
    then: dB = (μ₀/4π) * Idl×r̂/r²
    test_cases:
      - name: current_element
        input: {I: 1, dl: 0.01, r: 0.1}
        expected: {dB: 1e-8}

  # Сила Лоренца
  - name: lorentz_force
    given: Заряд q движется со скоростью v в полях E и B
    when: Вычисляется сила
    then: F = q(E + v×B)
    test_cases:
      - name: electron_in_field
        input: {q: 1.6e-19, v: 1e6, B: 0.1}
        expected: {F: 1.6e-14}

transformers:
  - name: coulomb_field
    type: pure
    input: PointCharge
    output: ElectricField
    rule: E = kq/r² * r̂

  - name: biot_savart
    type: pure
    input: CurrentElement
    output: MagneticField
    rule: dB = (μ₀/4π) * Idl×r̂/r²

  - name: faraday_induction
    type: iterative
    input: MagneticFlux
    output: EMF
    rule: ε = -dΦ/dt

  - name: wave_propagation
    type: iterative
    input: EMField
    output: EMField
    rule: ∂²E/∂t² = c²∇²E

types:
  PointCharge:
    q: float      # заряд (Кл)
    x: float
    y: float
    z: float
    
  ElectricField:
    Ex: float
    Ey: float
    Ez: float
    
  MagneticField:
    Bx: float
    By: float
    Bz: float
    
  EMField:
    E: ElectricField
    B: MagneticField
    
  CurrentElement:
    I: float      # ток (А)
    dl: float     # длина элемента (м)
    direction: [float]

constants:
  epsilon_0: 8.854e-12  # электрическая постоянная (Ф/м)
  mu_0: 1.257e-6        # магнитная постоянная (Гн/м)
  k: 8.99e9             # постоянная Кулона (Н·м²/Кл²)
  c: 299792458          # скорость света (м/с)
  e: 1.602e-19          # заряд электрона (Кл)

functions:
  - name: coulomb_force
    params: {q1: float, q2: float, r: float}
    returns: float
    
  - name: electric_field
    params: {q: float, r: float}
    returns: float
    
  - name: magnetic_field_wire
    params: {I: float, r: float}
    returns: float
    
  - name: lorentz_force
    params: {q: float, v: float, E: float, B: float}
    returns: float

test_generation:
  boundary: true
  stress: true
  property: true
  coverage: 90
