name: quantum_mechanics
version: "1.0.0"
language: zig
module: quantum
description: |
  Паттерн Творения: Квантовая Механика
  
  Источник: Волновая функция ψ(x, t₀)
  Трансформер: Оператор Гамильтона Ĥ (уравнение Шрёдингера)
  Результат: Волновая функция ψ(x, t)
  
  Ключевые принципы:
  1. Уравнение Шрёдингера: iℏ∂ψ/∂t = Ĥψ
  2. Принцип неопределённости: ΔxΔp ≥ ℏ/2
  3. Принцип суперпозиции: ψ = Σcₙψₙ
  4. Коллапс волновой функции при измерении

creation_pattern:
  source: WaveFunction
  transformer: schrodinger_evolution
  result: WaveFunction
  iteration: until_condition
  condition: measurement

behaviors:
  # Уравнение Шрёдингера
  - name: schrodinger_equation
    given: Волновая функция ψ в момент t
    when: Применяется оператор эволюции
    then: ψ(t+dt) = exp(-iĤdt/ℏ)ψ(t)
    test_cases:
      - name: free_particle_evolution
        input: {psi_0: gaussian, t: 1e-15}
        expected: {spreading: true}
      - name: stationary_state
        input: {psi_0: eigenstate, E: 1}
        expected: {phase_rotation: true}

  # Принцип неопределённости
  - name: uncertainty_principle
    given: Квантовая частица
    when: Измеряются x и p
    then: ΔxΔp ≥ ℏ/2
    test_cases:
      - name: minimum_uncertainty
        input: {dx: 1e-10}
        expected: {dp_min: 5.27e-25}
      - name: electron_in_atom
        input: {dx: 1e-10}
        expected: {dp_min: 5.27e-25, v_min: 5.79e5}

  # Квантовый гармонический осциллятор
  - name: quantum_harmonic_oscillator
    given: Частица в параболическом потенциале
    when: Вычисляются энергетические уровни
    then: Eₙ = ℏω(n + 1/2)
    test_cases:
      - name: ground_state
        input: {n: 0, omega: 1e15}
        expected: {E: 5.27e-20}
      - name: first_excited
        input: {n: 1, omega: 1e15}
        expected: {E: 1.58e-19}

  # Частица в ящике
  - name: particle_in_box
    given: Частица в бесконечной потенциальной яме
    when: Вычисляются энергетические уровни
    then: Eₙ = n²π²ℏ²/(2mL²)
    test_cases:
      - name: electron_in_1nm_box
        input: {n: 1, L: 1e-9, m: 9.109e-31}
        expected: {E: 6.02e-20}
      - name: second_level
        input: {n: 2, L: 1e-9, m: 9.109e-31}
        expected: {E: 2.41e-19}

  # Туннельный эффект
  - name: quantum_tunneling
    given: Частица перед потенциальным барьером
    when: E < V₀ (классически запрещено)
    then: Вероятность туннелирования T > 0
    test_cases:
      - name: thin_barrier
        input: {E: 1, V0: 2, L: 1e-10, m: 9.109e-31}
        expected: {T_approx: 0.78}
      - name: thick_barrier
        input: {E: 1, V0: 2, L: 1e-9, m: 9.109e-31}
        expected: {T_approx: 1e-8}

  # Атом водорода
  - name: hydrogen_atom
    given: Электрон в кулоновском потенциале
    when: Вычисляются энергетические уровни
    then: Eₙ = -13.6/n² эВ
    test_cases:
      - name: ground_state_hydrogen
        input: {n: 1}
        expected: {E_eV: -13.6}
      - name: first_excited_hydrogen
        input: {n: 2}
        expected: {E_eV: -3.4}

  # Спин электрона
  - name: electron_spin
    given: Электрон в магнитном поле
    when: Измеряется проекция спина
    then: Sₓ = ±ℏ/2
    test_cases:
      - name: spin_up
        input: {state: up}
        expected: {Sz: 5.27e-35}
      - name: spin_down
        input: {state: down}
        expected: {Sz: -5.27e-35}

transformers:
  - name: schrodinger_evolution
    type: iterative
    input: WaveFunction
    output: WaveFunction
    rule: ψ(t+dt) = exp(-iĤdt/ℏ)ψ(t)

  - name: measurement
    type: pure
    input: WaveFunction
    output: MeasurementResult
    rule: |
      P(aₙ) = |⟨ψₙ|ψ⟩|²
      ψ → ψₙ (коллапс)

  - name: superposition
    type: pure
    input: [WaveFunction]
    output: WaveFunction
    rule: ψ = Σcₙψₙ

types:
  WaveFunction:
    amplitude: complex
    position: float
    
  MeasurementResult:
    value: float
    probability: float
    collapsed_state: WaveFunction
    
  QuantumState:
    n: int           # главное квантовое число
    l: int           # орбитальное
    m: int           # магнитное
    s: float         # спин

constants:
  hbar: 1.055e-34    # приведённая постоянная Планка (Дж·с)
  h: 6.626e-34       # постоянная Планка (Дж·с)
  m_e: 9.109e-31     # масса электрона (кг)
  eV: 1.602e-19      # электронвольт (Дж)
  a_0: 5.29e-11      # боровский радиус (м)
  E_H: 13.6          # энергия ионизации водорода (эВ)

functions:
  - name: energy_particle_in_box
    params: {n: int, L: float, m: float}
    returns: float
    
  - name: energy_harmonic_oscillator
    params: {n: int, omega: float}
    returns: float
    
  - name: tunneling_probability
    params: {E: float, V0: float, L: float, m: float}
    returns: float
    
  - name: hydrogen_energy
    params: {n: int}
    returns: float

test_generation:
  boundary: true
  stress: true
  property: true
  coverage: 90
