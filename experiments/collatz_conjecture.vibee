name: collatz_conjecture
version: "1.0.0"
language: zig
module: collatz
description: |
  Creation Pattern Test: Collatz Conjecture
  Source: Any positive integer n
  Transformer: n/2 if even, 3n+1 if odd
  Result: Sequence converging to 1

behaviors:
  - name: collatz_step_even
    given: An even positive integer n
    when: collatz_step is called with n
    then: Returns n divided by 2
    test_cases:
      - name: step_4
        input: {n: 4}
        expected: {result: 2}
      - name: step_10
        input: {n: 10}
        expected: {result: 5}
      - name: step_16
        input: {n: 16}
        expected: {result: 8}

  - name: collatz_step_odd
    given: An odd positive integer n greater than 1
    when: collatz_step is called with n
    then: Returns 3n + 1
    test_cases:
      - name: step_3
        input: {n: 3}
        expected: {result: 10}
      - name: step_7
        input: {n: 7}
        expected: {result: 22}
      - name: step_27
        input: {n: 27}
        expected: {result: 82}

  - name: collatz_converges
    given: A positive integer n
    when: collatz_sequence is computed until reaching 1
    then: The sequence reaches 1 within max_steps
    test_cases:
      - name: converge_1
        input: {n: 1}
        expected: {steps: 0, reached_one: true}
      - name: converge_2
        input: {n: 2}
        expected: {steps: 1, reached_one: true}
      - name: converge_7
        input: {n: 7}
        expected: {steps: 16, reached_one: true}
      - name: converge_27
        input: {n: 27}
        expected: {steps: 111, reached_one: true}
      - name: converge_97
        input: {n: 97}
        expected: {steps: 118, reached_one: true}

  - name: creation_pattern_collatz
    given: Source integer n and Transformer collatz_step
    when: CREATE is applied iteratively
    then: Result converges to 1
    test_cases:
      - name: create_from_6
        input: {source: 6}
        expected: {result: 1, pattern: "compression"}
      - name: create_from_11
        input: {source: 11}
        expected: {result: 1, pattern: "compression"}

types:
  CollatzResult:
    steps: int
    reached_one: bool
    max_value: int

  CreationResult:
    source: int
    result: int
    pattern: str

functions:
  - name: collatz_step
    params: {n: int}
    returns: int

  - name: collatz_sequence
    params: {n: int, max_steps: int}
    returns: CollatzResult

  - name: create_collatz
    params: {source: int}
    returns: CreationResult
