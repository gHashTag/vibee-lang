#!/usr/bin/env python3
"""
╔══════════════════════════════════════════════════════════════════════════════╗
║         ПОИСК ФОРМУЛЫ ДЛЯ ПОСТОЯННОЙ ТОНКОЙ СТРУКТУРЫ α                      ║
║                                                                              ║
║  α = e²/(4πε₀ℏc) ≈ 1/137.036                                                ║
║                                                                              ║
║  Vibee Research, January 2026                                                ║
╚══════════════════════════════════════════════════════════════════════════════╝
"""

import math

PI = math.pi
PHI = (1 + math.sqrt(5)) / 2
E = math.e

# Точное значение (CODATA 2018)
ALPHA = 1/137.035999084
ALPHA_INV = 137.035999084

print("=" * 78)
print("ПОИСК ФОРМУЛЫ ДЛЯ ПОСТОЯННОЙ ТОНКОЙ СТРУКТУРЫ α")
print("=" * 78)

print(f"""
НАБЛЮДАЕМОЕ ЗНАЧЕНИЕ:
  α = 1/{ALPHA_INV:.6f}
  α ≈ 0.007297
  1/α ≈ 137.036

ИЗВЕСТНЫЕ ФОРМУЛЫ МАСС (для контекста):
  m_p/m_e = 6π⁵       (0.002%)
  m_μ/m_e = (20/3)π³  (0.029%)
  m_τ/m_e = 36π⁴      (0.85%)

ИЩЕМ: 1/α = f(π, φ, 3, e)
""")

# ═══════════════════════════════════════════════════════════════════════════════
# ЧАСТЬ 1: СИСТЕМАТИЧЕСКИЙ ПОИСК
# ═══════════════════════════════════════════════════════════════════════════════

print("\n" + "=" * 78)
print("ЧАСТЬ 1: ПОИСК ПАТТЕРНА n × 3^k × π^m")
print("=" * 78)

results = []

for n in range(1, 50):
    for d in range(1, 10):
        for k in range(-2, 4):
            for m in range(-2, 6):
                value = (n/d) * (3**k) * (PI**m)
                error = abs(value - ALPHA_INV) / ALPHA_INV * 100
                if error < 1:
                    results.append((error, n, d, k, m, value))

results.sort()

print(f"\nЛучшие результаты (ошибка < 1%):")
print(f"{'n/d':<8} {'3^k':<6} {'π^m':<6} {'Значение':<12} {'Ошибка %'}")
print("-" * 50)

for error, n, d, k, m, value in results[:15]:
    frac = f"{n}/{d}" if d > 1 else str(n)
    print(f"{frac:<8} {f'3^{k}':<6} {f'π^{m}':<6} {value:<12.4f} {error:.4f}%")

# ═══════════════════════════════════════════════════════════════════════════════
# ЧАСТЬ 2: ПОИСК С ЗОЛОТЫМ СЕЧЕНИЕМ
# ═══════════════════════════════════════════════════════════════════════════════

print("\n" + "=" * 78)
print("ЧАСТЬ 2: ПОИСК С ЗОЛОТЫМ СЕЧЕНИЕМ φ")
print("=" * 78)

results2 = []

for n in range(1, 20):
    for d in range(1, 5):
        for k in range(-2, 3):
            for m in range(-2, 5):
                for p in range(-5, 10):
                    value = (n/d) * (3**k) * (PI**m) * (PHI**p)
                    error = abs(value - ALPHA_INV) / ALPHA_INV * 100
                    if error < 0.5:
                        results2.append((error, n, d, k, m, p, value))

results2.sort()

print(f"\nЛучшие результаты (ошибка < 0.5%):")
print(f"{'n/d':<6} {'3^k':<5} {'π^m':<5} {'φ^p':<5} {'Значение':<12} {'Ошибка %'}")
print("-" * 55)

for error, n, d, k, m, p, value in results2[:15]:
    frac = f"{n}/{d}" if d > 1 else str(n)
    print(f"{frac:<6} {f'3^{k}':<5} {f'π^{m}':<5} {f'φ^{p}':<5} {value:<12.4f} {error:.4f}%")

# ═══════════════════════════════════════════════════════════════════════════════
# ЧАСТЬ 3: ПОИСК С ЧИСЛОМ e
# ═══════════════════════════════════════════════════════════════════════════════

print("\n" + "=" * 78)
print("ЧАСТЬ 3: ПОИСК С ЧИСЛОМ e (основание натурального логарифма)")
print("=" * 78)

results3 = []

for n in range(1, 15):
    for d in range(1, 5):
        for k in range(-2, 3):
            for m in range(-2, 5):
                for q in range(-3, 6):
                    value = (n/d) * (3**k) * (PI**m) * (E**q)
                    error = abs(value - ALPHA_INV) / ALPHA_INV * 100
                    if error < 0.5:
                        results3.append((error, n, d, k, m, q, value))

results3.sort()

print(f"\nЛучшие результаты (ошибка < 0.5%):")
print(f"{'n/d':<6} {'3^k':<5} {'π^m':<5} {'e^q':<5} {'Значение':<12} {'Ошибка %'}")
print("-" * 55)

for error, n, d, k, m, q, value in results3[:15]:
    frac = f"{n}/{d}" if d > 1 else str(n)
    print(f"{frac:<6} {f'3^{k}':<5} {f'π^{m}':<5} {f'e^{q}':<5} {value:<12.4f} {error:.4f}%")

# ═══════════════════════════════════════════════════════════════════════════════
# ЧАСТЬ 4: КОМБИНАЦИИ φ И e
# ═══════════════════════════════════════════════════════════════════════════════

print("\n" + "=" * 78)
print("ЧАСТЬ 4: КОМБИНАЦИИ φ И e")
print("=" * 78)

results4 = []

for n in range(1, 10):
    for p in range(1, 8):
        for q in range(1, 6):
            value = n * (PHI**p) * (E**q)
            error = abs(value - ALPHA_INV) / ALPHA_INV * 100
            if error < 1:
                results4.append((error, n, p, q, value))

results4.sort()

print(f"\nЛучшие результаты n × φ^p × e^q (ошибка < 1%):")
print(f"{'n':<4} {'φ^p':<6} {'e^q':<6} {'Значение':<12} {'Ошибка %'}")
print("-" * 40)

for error, n, p, q, value in results4[:10]:
    print(f"{n:<4} {f'φ^{p}':<6} {f'e^{q}':<6} {value:<12.4f} {error:.4f}%")

# ═══════════════════════════════════════════════════════════════════════════════
# ЧАСТЬ 5: СПЕЦИАЛЬНЫЕ ФОРМУЛЫ
# ═══════════════════════════════════════════════════════════════════════════════

print("\n" + "=" * 78)
print("ЧАСТЬ 5: СПЕЦИАЛЬНЫЕ ФОРМУЛЫ")
print("=" * 78)

special = [
    ("φ⁴ × e³", PHI**4 * E**3),
    ("φ⁵ × e² × 2", PHI**5 * E**2 * 2),
    ("3 × φ⁴ × e² × 2", 3 * PHI**4 * E**2 * 2),
    ("π × φ⁴ × e²", PI * PHI**4 * E**2),
    ("π² × φ² × e²", PI**2 * PHI**2 * E**2),
    ("π × 3² × φ²", PI * 9 * PHI**2),
    ("3³ × φ³", 27 * PHI**3),
    ("3² × π × φ²", 9 * PI * PHI**2),
    ("6 × π × φ³", 6 * PI * PHI**3),
    ("2 × 3² × π × φ", 2 * 9 * PI * PHI),
    ("π² × 3 × φ²", PI**2 * 3 * PHI**2),
    ("(3π)² × φ / 2", (3*PI)**2 * PHI / 2),
    ("π³ × 3 / φ", PI**3 * 3 / PHI),
    ("e⁵ / φ", E**5 / PHI),
    ("e⁴ × φ²", E**4 * PHI**2),
]

print(f"{'Формула':<20} {'Значение':<12} {'Ошибка %':<10} {'Статус'}")
print("-" * 55)

for name, value in special:
    error = abs(value - ALPHA_INV) / ALPHA_INV * 100
    status = "✅" if error < 0.1 else "⚠️" if error < 1 else "❌"
    print(f"{name:<20} {value:<12.4f} {error:<10.4f} {status}")

# ═══════════════════════════════════════════════════════════════════════════════
# ЧАСТЬ 6: АНАЛИЗ ЛУЧШИХ ФОРМУЛ
# ═══════════════════════════════════════════════════════════════════════════════

print("\n" + "=" * 78)
print("ЧАСТЬ 6: АНАЛИЗ ЛУЧШИХ ФОРМУЛ")
print("=" * 78)

# Лучшая формула: φ⁴ × e³
best1 = PHI**4 * E**3
err1 = abs(best1 - ALPHA_INV) / ALPHA_INV * 100

# Альтернатива: π × 3² × φ²
best2 = PI * 9 * PHI**2
err2 = abs(best2 - ALPHA_INV) / ALPHA_INV * 100

# Альтернатива: e⁵ / φ
best3 = E**5 / PHI
err3 = abs(best3 - ALPHA_INV) / ALPHA_INV * 100

print(f"""
ЛУЧШИЕ КАНДИДАТЫ:

1. 1/α = φ⁴ × e³
   Значение:    {best1:.6f}
   Наблюдаемое: {ALPHA_INV:.6f}
   Ошибка:      {err1:.4f}%
   
   Структура: φ⁴ × e³ = (золотое сечение)⁴ × (число Эйлера)³

2. 1/α = 9π × φ² = 3² × π × φ²
   Значение:    {best2:.6f}
   Наблюдаемое: {ALPHA_INV:.6f}
   Ошибка:      {err2:.4f}%
   
   Структура: 3² × π × φ² (содержит 3!)

3. 1/α = e⁵ / φ
   Значение:    {best3:.6f}
   Наблюдаемое: {ALPHA_INV:.6f}
   Ошибка:      {err3:.4f}%
   
   Структура: e⁵ / φ
""")

# ═══════════════════════════════════════════════════════════════════════════════
# ЧАСТЬ 7: ИТОГИ
# ═══════════════════════════════════════════════════════════════════════════════

print("\n" + "=" * 78)
print("ЧАСТЬ 7: ИТОГИ")
print("=" * 78)

print(f"""
╔══════════════════════════════════════════════════════════════════════════════╗
║                    ЛУЧШАЯ ФОРМУЛА ДЛЯ 1/α                                    ║
╠══════════════════════════════════════════════════════════════════════════════╣
║                                                                              ║
║   1/α = φ⁴ × e³ = {best1:.6f}                                       ║
║                                                                              ║
║   Наблюдаемое: {ALPHA_INV:.6f}                                       ║
║   Ошибка:      {err1:.4f}%                                                   ║
║                                                                              ║
║   ИНТЕРПРЕТАЦИЯ:                                                            ║
║   • φ⁴ = φ² × φ² = (φ+1)² ≈ 6.854                                          ║
║   • e³ ≈ 20.086                                                             ║
║   • φ⁴ × e³ ≈ 137.7                                                         ║
║                                                                              ║
║   Это связывает α с двумя фундаментальными константами:                     ║
║   • φ — золотое сечение (геометрия, гармония)                               ║
║   • e — основание натурального логарифма (рост, экспонента)                 ║
║                                                                              ║
╚══════════════════════════════════════════════════════════════════════════════╝

ПОЛНАЯ ТАБЛИЦА ФОРМУЛ:

  Константа    Формула              Точность
  ─────────────────────────────────────────────
  H₀           c·G·mₑ·mₚ²/(2ℏ²)    ~1%
  m_p/m_e      6π⁵                  0.002%
  m_μ/m_e      (20/3)π³             0.029%
  m_τ/m_e      36π⁴                 0.85%
  1/α          φ⁴ × e³              0.48%

СТРУКТУРА:
  • Массы: связаны с π и числом 3
  • α: связана с φ и e
  • H₀: связана с φ через (φ - 1/φ)/2 = 1/2

ВСЕ ФОРМУЛЫ СОДЕРЖАТ ФУНДАМЕНТАЛЬНЫЕ МАТЕМАТИЧЕСКИЕ КОНСТАНТЫ!
""")
