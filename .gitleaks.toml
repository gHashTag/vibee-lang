title = "VIBEE Secret Detection"

[extend]
useDefault = true

# Custom rules for VIBEE project
[[rules]]
id = "openrouter-api-key"
description = "OpenRouter API Key"
regex = '''sk-or-v1-[a-zA-Z0-9]{64}'''
tags = ["key", "openrouter"]

[[rules]]
id = "anthropic-api-key"
description = "Anthropic API Key"
regex = '''sk-ant-[a-zA-Z0-9\-_]{40,}'''
tags = ["key", "anthropic"]

[[rules]]
id = "telegram-session-id"
description = "Telegram Session ID"
regex = '''sess_[a-z0-9]{12,}'''
tags = ["session", "telegram"]

[[rules]]
id = "telegram-bot-token"
description = "Telegram Bot Token"
regex = '''[0-9]{8,10}:[a-zA-Z0-9_-]{35}'''
tags = ["token", "telegram"]

[[rules]]
id = "neon-database-url"
description = "Neon Database URL with password"
regex = '''postgres://[^:]+:[^@]+@[^/]*neon[^/]*/'''
tags = ["database", "neon"]

[[rules]]
id = "openai-api-key"
description = "OpenAI API Key"
regex = '''sk-proj-[a-zA-Z0-9]{48,}'''
tags = ["key", "openai"]

[[rules]]
id = "elevenlabs-api-key"
description = "ElevenLabs API Key"
# ElevenLabs keys start with specific prefixes
regex = '''(?:ELEVENLABS_API_KEY|xi-api-key)[\s:=]+([a-f0-9]{32})'''
tags = ["key", "elevenlabs"]

[[rules]]
id = "fal-api-key"
description = "FAL.ai API Key"
# FAL.ai keys in context of FAL_KEY or fal.ai
regex = '''(?:FAL_KEY|fal\.ai|fal_key)[\s:=]+([a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12})'''
tags = ["key", "fal"]

# Allowlist for documentation, data, and examples
[allowlist]
description = "Allowed patterns in documentation and data files"
paths = [
  '''.env.example''',
  '''\.md$''',
  '''.claude/skills/''',
  '''.claude/plans/''',
  '''test/''',
  '''\.gitleaksignore''',
  '''gleam/data/''',
  '''erl_crash\.dump''',
  '''\.json$''',
  # Dev scripts (contain env var references, not actual secrets)
  '''gleam/auth_.*\.js$''',
  '''gleam/check_.*\.js$''',
  '''gleam/parse_.*\.ts$''',
  '''gleam/test_.*\.ts$''',
  '''gleam/.*\.sh$''',
  '''telegram-bridge/.*\.sh$'''
]

# Allow placeholder patterns
regexes = [
  '''sk-or-v1-your-key-here''',
  '''sk-ant-api03-xxx''',
  '''your-.*-key''',
  '''xxx.*xxx''',
  '''placeholder'''
]
